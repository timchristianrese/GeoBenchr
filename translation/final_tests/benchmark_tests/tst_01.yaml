name: countActiveFlightsInPeriod
source: "flight_points f"
source_data:
  type: csv
  path: "point_NRW_HIGH_0123.csv"
  geometry_column: wkt
  csv_options:
    delimiter: ";"
    header: false
    infer_schema: false
  schema:
    - { name: flightid }
    - { name: airplanetype }
    - { name: origin }
    - { name: destination }
    - { name: wkt }
    - { name: timestamp }
    - { name: altitude, type: double }

aggregations:
  - function: COUNT
    field: "DISTINCT f.flightid"
    alias: count

filter:
  time_filter:
    - field: f.timestamp
      start: "'2023-01-02 18:17:18'"
      end: "'2023-01-02 18:18:00'"