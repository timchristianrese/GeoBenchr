# ----------- POSTGIS OUTPUT -----------
(venv) 3s@Scalables-MacBook-Pro aviation % psql -d aviation -c "SELECT k.name, COUNT(DISTINCT f.flightid) AS flight_count
FROM counties k
INNER JOIN flight_points f ON (ST_Intersects(f.geom, k.geom))
WHERE (k.name = 'Krs Hochsauerlandkreis')
GROUP BY k.name;
"
          name          | flight_count 
------------------------+--------------
 Krs Hochsauerlandkreis |         9263
(1 row)

# ----------- SEDONA OUTPUT -----------

(venv_sedona) arthur@server-peter-lan:~/final_tsts/aviation$ python3 test.py
25/07/25 05:57:28 WARN Utils: Your hostname, server-peter-lan resolves to a loopback address: 127.0.1.1; using 141.23.28.216 instead (on interface eno8303)
25/07/25 05:57:28 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address
:: loading settings :: url = jar:file:/home/arthur/venv_sedona/lib/python3.10/site-packages/pyspark/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml
Ivy Default Cache set to: /home/arthur/.ivy2/cache
The jars for the packages stored in: /home/arthur/.ivy2/jars
org.apache.sedona#sedona-spark-3.4_2.12 added as a dependency
org.datasyslab#geotools-wrapper added as a dependency
:: resolving dependencies :: org.apache.spark#spark-submit-parent-3ee14033-bca0-40c1-be95-ad28c50d2f0f;1.0
	confs: [default]
	found org.apache.sedona#sedona-spark-3.4_2.12;1.7.2 in central
	found org.apache.sedona#sedona-common;1.7.2 in central
	found org.apache.commons#commons-math3;3.6.1 in central
	found org.locationtech.jts#jts-core;1.20.0 in central
	found org.wololo#jts2geojson;0.16.1 in central
	found org.locationtech.spatial4j#spatial4j;0.8 in central
	found com.google.geometry#s2-geometry;2.0.0 in central
	found com.google.guava#guava;25.1-jre in central
	found com.google.code.findbugs#jsr305;3.0.2 in central
	found org.checkerframework#checker-qual;2.0.0 in central
	found com.google.errorprone#error_prone_annotations;2.1.3 in central
	found com.google.j2objc#j2objc-annotations;1.1 in central
	found org.codehaus.mojo#animal-sniffer-annotations;1.14 in central
	found com.uber#h3;4.1.1 in central
	found net.sf.geographiclib#GeographicLib-Java;1.52 in central
	found com.github.ben-manes.caffeine#caffeine;2.9.2 in central
	found org.checkerframework#checker-qual;3.10.0 in central
	found com.google.errorprone#error_prone_annotations;2.5.1 in central
	found org.apache.sedona#sedona-spark-common-3.4_2.12;1.7.2 in central
	found org.apache.sedona#shade-proto;1.7.2 in central
	found org.xerial#sqlite-jdbc;3.41.2.2 in central
	found commons-lang#commons-lang;2.6 in central
	found graphframes#graphframes;0.8.3-spark3.4-s_2.12 in spark-packages
	found org.slf4j#slf4j-api;1.7.36 in central
	found org.scala-lang.modules#scala-collection-compat_2.12;2.5.0 in central
	found org.beryx#awt-color-factory;1.0.0 in central
	found org.datasyslab#geotools-wrapper;1.7.2-28.5 in central
:: resolution report :: resolve 528ms :: artifacts dl 14ms
	:: modules in use:
	com.github.ben-manes.caffeine#caffeine;2.9.2 from central in [default]
	com.google.code.findbugs#jsr305;3.0.2 from central in [default]
	com.google.errorprone#error_prone_annotations;2.5.1 from central in [default]
	com.google.geometry#s2-geometry;2.0.0 from central in [default]
	com.google.guava#guava;25.1-jre from central in [default]
	com.google.j2objc#j2objc-annotations;1.1 from central in [default]
	com.uber#h3;4.1.1 from central in [default]
	commons-lang#commons-lang;2.6 from central in [default]
	graphframes#graphframes;0.8.3-spark3.4-s_2.12 from spark-packages in [default]
	net.sf.geographiclib#GeographicLib-Java;1.52 from central in [default]
	org.apache.commons#commons-math3;3.6.1 from central in [default]
	org.apache.sedona#sedona-common;1.7.2 from central in [default]
	org.apache.sedona#sedona-spark-3.4_2.12;1.7.2 from central in [default]
	org.apache.sedona#sedona-spark-common-3.4_2.12;1.7.2 from central in [default]
	org.apache.sedona#shade-proto;1.7.2 from central in [default]
	org.beryx#awt-color-factory;1.0.0 from central in [default]
	org.checkerframework#checker-qual;3.10.0 from central in [default]
	org.codehaus.mojo#animal-sniffer-annotations;1.14 from central in [default]
	org.datasyslab#geotools-wrapper;1.7.2-28.5 from central in [default]
	org.locationtech.jts#jts-core;1.20.0 from central in [default]
	org.locationtech.spatial4j#spatial4j;0.8 from central in [default]
	org.scala-lang.modules#scala-collection-compat_2.12;2.5.0 from central in [default]
	org.slf4j#slf4j-api;1.7.36 from central in [default]
	org.wololo#jts2geojson;0.16.1 from central in [default]
	org.xerial#sqlite-jdbc;3.41.2.2 from central in [default]
	:: evicted modules:
	org.checkerframework#checker-qual;2.0.0 by [org.checkerframework#checker-qual;3.10.0] in [default]
	com.google.errorprone#error_prone_annotations;2.1.3 by [com.google.errorprone#error_prone_annotations;2.5.1] in [default]
	---------------------------------------------------------------------
	|                  |            modules            ||   artifacts   |
	|       conf       | number| search|dwnlded|evicted|| number|dwnlded|
	---------------------------------------------------------------------
	|      default     |   27  |   0   |   0   |   2   ||   25  |   0   |
	---------------------------------------------------------------------
:: retrieving :: org.apache.spark#spark-submit-parent-3ee14033-bca0-40c1-be95-ad28c50d2f0f
	confs: [default]
	0 artifacts copied, 25 already retrieved (0kB/11ms)
25/07/25 05:57:29 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
/home/arthur/final_tsts/aviation/test.py:28: DeprecationWarning: Call to deprecated function registerAll (Deprecated since 1.4.1, use SedonaContext.create() instead.).
  SedonaRegistrator.registerAll(spark)
25/07/25 05:57:39 WARN RangeJoinExec: [SedonaSQL] Join dominant side partition number 4 is larger than 1/2 of the dominant side count 1
25/07/25 05:57:39 WARN RangeJoinExec: [SedonaSQL] Try to use follower side partition number 48
25/07/25 05:57:39 WARN RangeJoinExec: [SedonaSQL] Join follower side partition number is also larger than 1/2 of the dominant side count 1
25/07/25 05:57:39 WARN RangeJoinExec: [SedonaSQL] Try to use 1/2 of the dominant side count 0 as the partition number of both sides
25/07/25 05:57:39 WARN RangeJoinExec: [SedonaSQL] 1/2 of 0 is equal to 0. Use 1 as the partition number of both sides instead.
25/07/25 05:57:40 WARN JoinQuery: UseIndex is true, but no index exists. Will build index on the fly.
+--------------------+------------+                                             
|              k.name|flight_count|
+--------------------+------------+
|Krs Hochsauerland...|        9263|
+--------------------+------------+