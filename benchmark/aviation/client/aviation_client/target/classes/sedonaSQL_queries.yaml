- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Nuembrecht' AND f.timestamp BETWEEN TIMESTAMP('2023-02-10 19:01:06') AND TIMESTAMP('2023-02-24 12:05:25') AND f.altitude < 1320 GROUP BY g.name, f.flightid;
  params:
  - - '2023-02-10 19:01:06'
    - '2023-02-24 12:05:25'
  - Gem Nuembrecht
  - 1320
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Rhein-Kreis Neuss' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-06-02 05:03:26') AND TIMESTAMP('2023-06-05 13:19:45');
  params:
  - - '2023-06-02 05:03:26'
    - '2023-06-05 13:19:45'
  - Krs Rhein-Kreis Neuss
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Oberhausen' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-08-28 20:33:14') AND TIMESTAMP('2023-09-02 11:40:17');
  params:
  - - '2023-08-28 20:33:14'
    - '2023-09-02 11:40:17'
  - Krs Oberhausen
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Warendorf' WHERE f.timestamp BETWEEN TIMESTAMP('2023-07-03 03:27:55') AND TIMESTAMP('2023-07-03 05:45:36') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-07-03 03:27:55'
    - '2023-07-03 05:45:36'
  - Krs Warendorf
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.5202546643062008e-05) WHERE c.name = 'Dorsten' AND f.timestamp BETWEEN TIMESTAMP('2023-01-30 18:20:57') AND TIMESTAMP('2023-02-07 00:35:44');
  params:
  - - '2023-01-30 18:20:57'
    - '2023-02-07 00:35:44'
  - Dorsten
  - 1.5202546643062008e-05
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Moenchengladbach' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-06-27 19:53:37') AND TIMESTAMP('2023-07-05 15:06:09');
  params:
  - - '2023-06-27 19:53:37'
    - '2023-07-05 15:06:09'
  - Krs Moenchengladbach
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Olfen' AND f.timestamp BETWEEN TIMESTAMP('2023-06-15 20:31:46') AND TIMESTAMP('2023-06-24 15:53:58') AND f.altitude < 1130 GROUP BY g.name, f.flightid;
  params:
  - - '2023-06-15 20:31:46'
    - '2023-06-24 15:53:58'
  - Gem Olfen
  - 1130
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Hamm' AND f.timestamp BETWEEN TIMESTAMP('2023-07-28 17:38:40') AND TIMESTAMP('2023-08-02 22:58:05') AND f.altitude < 1300 GROUP BY g.name, f.flightid;
  params:
  - - '2023-07-28 17:38:40'
    - '2023-08-02 22:58:05'
  - Gem Hamm
  - 1300
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Wadersloh' AND f.timestamp BETWEEN TIMESTAMP('2023-10-20 08:00:38') AND TIMESTAMP('2023-10-28 03:25:55') AND f.altitude < 580 GROUP BY g.name, f.flightid;
  params:
  - - '2023-10-20 08:00:38'
    - '2023-10-28 03:25:55'
  - Gem Wadersloh
  - 580
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Lippe' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-07-04 06:25:45') AND TIMESTAMP('2023-07-07 16:24:26');
  params:
  - - '2023-07-04 06:25:45'
    - '2023-07-07 16:24:26'
  - Krs Lippe
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-08-19 05:55:21' GROUP BY b.name;
  params:
  - '2023-08-19 05:55:21'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-09-30 12:52:53' GROUP BY b.name;
  params:
  - '2023-09-30 12:52:53'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Dinslaken' AND f.timestamp BETWEEN TIMESTAMP('2023-04-02 14:48:39') AND TIMESTAMP('2023-04-08 15:30:13') AND f.altitude < 1280 GROUP BY g.name, f.flightid;
  params:
  - - '2023-04-02 14:48:39'
    - '2023-04-08 15:30:13'
  - Gem Dinslaken
  - 1280
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.96910177108693e-06) WHERE c.name = 'Voerde' AND f.timestamp BETWEEN TIMESTAMP('2023-06-13 19:27:31') AND TIMESTAMP('2023-06-24 00:25:23');
  params:
  - - '2023-06-13 19:27:31'
    - '2023-06-24 00:25:23'
  - Voerde
  - 7.96910177108693e-06
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Bad Honnef' AND f.timestamp BETWEEN TIMESTAMP('2023-08-16 12:07:25') AND TIMESTAMP('2023-08-27 08:18:05') AND f.altitude < 970 GROUP BY g.name, f.flightid;
  params:
  - - '2023-08-16 12:07:25'
    - '2023-08-27 08:18:05'
  - Gem Bad Honnef
  - 970
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Bielefeld' WHERE f.timestamp BETWEEN TIMESTAMP('2023-07-21 05:19:41') AND TIMESTAMP('2023-07-22 14:08:26') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-07-21 05:19:41'
    - '2023-07-22 14:08:26'
  - Krs Bielefeld
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Dortmund' WHERE f.timestamp BETWEEN TIMESTAMP('2023-01-17 22:02:56') AND TIMESTAMP('2023-01-18 11:13:17') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-01-17 22:02:56'
    - '2023-01-18 11:13:17'
  - Krs Dortmund
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Warendorf' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-04-09 14:26:13') AND TIMESTAMP('2023-04-23 19:42:47');
  params:
  - - '2023-04-09 14:26:13'
    - '2023-04-23 19:42:47'
  - Krs Warendorf
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.0211620937828783e-05) WHERE c.name = 'Voerde' AND f.timestamp BETWEEN TIMESTAMP('2023-10-25 03:01:48') AND TIMESTAMP('2023-11-08 11:29:15');
  params:
  - - '2023-10-25 03:01:48'
    - '2023-11-08 11:29:15'
  - Voerde
  - 1.0211620937828783e-05
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Hochsauerlandkreis' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-03-28 02:15:06') AND TIMESTAMP('2023-04-01 11:14:16');
  params:
  - - '2023-03-28 02:15:06'
    - '2023-04-01 11:14:16'
  - Krs Hochsauerlandkreis
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 5.750360327612004e-06) WHERE c.name = 'Luedenscheid' AND f.timestamp BETWEEN TIMESTAMP('2023-09-27 02:20:38') AND TIMESTAMP('2023-10-05 20:50:03');
  params:
  - - '2023-09-27 02:20:38'
    - '2023-10-05 20:50:03'
  - Luedenscheid
  - 5.750360327612004e-06
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Rheinisch-Bergischer Kreis' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-09-03 09:27:22') AND TIMESTAMP('2023-09-15 15:53:10');
  params:
  - - '2023-09-03 09:27:22'
    - '2023-09-15 15:53:10'
  - Krs Rheinisch-Bergischer Kreis
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-01-09 10:54:39' GROUP BY b.name;
  params:
  - '2023-01-09 10:54:39'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-10-07 20:34:28' GROUP BY b.name;
  params:
  - '2023-10-07 20:34:28'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Rhein-Sieg-Kreis' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-10-28 00:11:02') AND TIMESTAMP('2023-11-04 10:01:35');
  params:
  - - '2023-10-28 00:11:02'
    - '2023-11-04 10:01:35'
  - Krs Rhein-Sieg-Kreis
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Hilchenbach' AND f.timestamp BETWEEN TIMESTAMP('2023-08-19 14:48:39') AND TIMESTAMP('2023-08-25 13:27:02') AND f.altitude < 1310 GROUP BY g.name, f.flightid;
  params:
  - - '2023-08-19 14:48:39'
    - '2023-08-25 13:27:02'
  - Gem Hilchenbach
  - 1310
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 9.27310633947772e-06) WHERE c.name = 'Lichtenau' AND f.timestamp BETWEEN TIMESTAMP('2023-05-22 14:04:38') AND TIMESTAMP('2023-06-05 21:56:53');
  params:
  - - '2023-05-22 14:04:38'
    - '2023-06-05 21:56:53'
  - Lichtenau
  - 9.27310633947772e-06
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-12-04 08:12:30' GROUP BY b.name;
  params:
  - '2023-12-04 08:12:30'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Bottrop' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-08-10 10:36:14') AND TIMESTAMP('2023-08-20 19:17:12');
  params:
  - - '2023-08-10 10:36:14'
    - '2023-08-20 19:17:12'
  - Krs Bottrop
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Stolberg (Rhld.)' AND f.timestamp BETWEEN TIMESTAMP('2023-03-06 15:36:29') AND TIMESTAMP('2023-03-09 15:29:48') AND f.altitude < 1060 GROUP BY g.name, f.flightid;
  params:
  - - '2023-03-06 15:36:29'
    - '2023-03-09 15:29:48'
  - Gem Stolberg (Rhld.)
  - 1060
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.095706788170948e-05) WHERE c.name = 'Erftstadt' AND f.timestamp BETWEEN TIMESTAMP('2023-10-28 05:36:36') AND TIMESTAMP('2023-11-05 18:25:39');
  params:
  - - '2023-10-28 05:36:36'
    - '2023-11-05 18:25:39'
  - Erftstadt
  - 1.095706788170948e-05
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Soest' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-03-20 04:30:01') AND TIMESTAMP('2023-04-04 01:20:08');
  params:
  - - '2023-03-20 04:30:01'
    - '2023-04-04 01:20:08'
  - Krs Soest
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Paderborn' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-04-27 10:04:30') AND TIMESTAMP('2023-05-02 22:36:46');
  params:
  - - '2023-04-27 10:04:30'
    - '2023-05-02 22:36:46'
  - Krs Paderborn
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Boenen' AND f.timestamp BETWEEN TIMESTAMP('2023-02-08 11:05:28') AND TIMESTAMP('2023-02-20 03:35:24') AND f.altitude < 1490 GROUP BY g.name, f.flightid;
  params:
  - - '2023-02-08 11:05:28'
    - '2023-02-20 03:35:24'
  - Gem Boenen
  - 1490
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-07-16 20:49:35' GROUP BY b.name;
  params:
  - '2023-07-16 20:49:35'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 9.147907311153572e-06) WHERE c.name = 'Radevormwald' AND f.timestamp BETWEEN TIMESTAMP('2023-11-19 02:56:34') AND TIMESTAMP('2023-11-30 15:58:47');
  params:
  - - '2023-11-19 02:56:34'
    - '2023-11-30 15:58:47'
  - Radevormwald
  - 9.147907311153572e-06
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.3302577973386491e-05) WHERE c.name = 'Paderborn' AND f.timestamp BETWEEN TIMESTAMP('2023-04-23 23:39:01') AND TIMESTAMP('2023-05-04 08:32:48');
  params:
  - - '2023-04-23 23:39:01'
    - '2023-05-04 08:32:48'
  - Paderborn
  - 1.3302577973386491e-05
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Burscheid' AND f.timestamp BETWEEN TIMESTAMP('2023-07-20 17:03:25') AND TIMESTAMP('2023-07-26 02:32:45') AND f.altitude < 550 GROUP BY g.name, f.flightid;
  params:
  - - '2023-07-20 17:03:25'
    - '2023-07-26 02:32:45'
  - Gem Burscheid
  - 550
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Viersen' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-02-02 01:01:53') AND TIMESTAMP('2023-02-16 03:01:46');
  params:
  - - '2023-02-02 01:01:53'
    - '2023-02-16 03:01:46'
  - Krs Viersen
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.4469351422213305e-05) WHERE c.name = 'Brilon' AND f.timestamp BETWEEN TIMESTAMP('2023-12-03 18:12:24') AND TIMESTAMP('2023-12-10 11:05:50');
  params:
  - - '2023-12-03 18:12:24'
    - '2023-12-10 11:05:50'
  - Brilon
  - 1.4469351422213305e-05
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Soest' WHERE f.timestamp BETWEEN TIMESTAMP('2023-02-10 22:23:30') AND TIMESTAMP('2023-02-12 14:35:24') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-02-10 22:23:30'
    - '2023-02-12 14:35:24'
  - Krs Soest
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Remscheid' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-12-15 19:57:51') AND TIMESTAMP('2023-12-22 04:31:25');
  params:
  - - '2023-12-15 19:57:51'
    - '2023-12-22 04:31:25'
  - Krs Remscheid
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Bielefeld' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-02-03 02:31:38') AND TIMESTAMP('2023-02-09 06:14:24');
  params:
  - - '2023-02-03 02:31:38'
    - '2023-02-09 06:14:24'
  - Krs Bielefeld
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.33320433494857e-06) WHERE c.name = 'Bueren' AND f.timestamp BETWEEN TIMESTAMP('2023-10-29 02:54:28') AND TIMESTAMP('2023-11-05 19:59:12');
  params:
  - - '2023-10-29 02:54:28'
    - '2023-11-05 19:59:12'
  - Bueren
  - 7.33320433494857e-06
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Warendorf' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-02-28 10:40:03') AND TIMESTAMP('2023-03-11 04:43:55');
  params:
  - - '2023-02-28 10:40:03'
    - '2023-03-11 04:43:55'
  - Krs Warendorf
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-02-16 20:35:41' GROUP BY b.name;
  params:
  - '2023-02-16 20:35:41'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Lippe' WHERE f.timestamp BETWEEN TIMESTAMP('2023-09-21 06:52:57') AND TIMESTAMP('2023-09-21 10:21:07') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-09-21 06:52:57'
    - '2023-09-21 10:21:07'
  - Krs Lippe
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Minden-Luebbecke' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-01-05 10:52:19') AND TIMESTAMP('2023-01-13 06:03:08');
  params:
  - - '2023-01-05 10:52:19'
    - '2023-01-13 06:03:08'
  - Krs Minden-Luebbecke
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.441944807186462e-05) WHERE c.name = 'Bruehl' AND f.timestamp BETWEEN TIMESTAMP('2023-02-19 21:05:18') AND TIMESTAMP('2023-03-04 00:51:55');
  params:
  - - '2023-02-19 21:05:18'
    - '2023-03-04 00:51:55'
  - Bruehl
  - 1.441944807186462e-05
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Paderborn' AND f.timestamp BETWEEN TIMESTAMP('2023-10-05 22:07:22') AND TIMESTAMP('2023-10-14 00:13:47') AND f.altitude < 1390 GROUP BY g.name, f.flightid;
  params:
  - - '2023-10-05 22:07:22'
    - '2023-10-14 00:13:47'
  - Gem Paderborn
  - 1390
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-11-10 07:18:01' GROUP BY b.name;
  params:
  - '2023-11-10 07:18:01'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 5.726452982261951e-06) WHERE c.name = 'Velbert' AND f.timestamp BETWEEN TIMESTAMP('2023-08-16 18:00:28') AND TIMESTAMP('2023-08-30 14:43:32');
  params:
  - - '2023-08-16 18:00:28'
    - '2023-08-30 14:43:32'
  - Velbert
  - 5.726452982261951e-06
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Guetersloh' AND f.timestamp BETWEEN TIMESTAMP('2023-01-17 21:36:00') AND TIMESTAMP('2023-01-25 09:22:43') AND f.altitude < 1480 GROUP BY g.name, f.flightid;
  params:
  - - '2023-01-17 21:36:00'
    - '2023-01-25 09:22:43'
  - Gem Guetersloh
  - 1480
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Heinsberg' WHERE f.timestamp BETWEEN TIMESTAMP('2023-10-07 06:58:20') AND TIMESTAMP('2023-10-08 08:26:52') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-10-07 06:58:20'
    - '2023-10-08 08:26:52'
  - Krs Heinsberg
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Bonn' WHERE f.timestamp BETWEEN TIMESTAMP('2023-09-28 05:22:30') AND TIMESTAMP('2023-09-29 17:34:07') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-09-28 05:22:30'
    - '2023-09-29 17:34:07'
  - Krs Bonn
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Moenchengladbach' WHERE f.timestamp BETWEEN TIMESTAMP('2023-10-09 04:13:12') AND TIMESTAMP('2023-10-10 00:19:50') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-10-09 04:13:12'
    - '2023-10-10 00:19:50'
  - Krs Moenchengladbach
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.1159307733142802e-05) WHERE c.name = 'Heimbach' AND f.timestamp BETWEEN TIMESTAMP('2023-08-17 20:15:44') AND TIMESTAMP('2023-08-31 00:27:33');
  params:
  - - '2023-08-17 20:15:44'
    - '2023-08-31 00:27:33'
  - Heimbach
  - 1.1159307733142802e-05
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Paderborn' WHERE f.timestamp BETWEEN TIMESTAMP('2023-06-30 03:13:25') AND TIMESTAMP('2023-07-01 14:50:51') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-06-30 03:13:25'
    - '2023-07-01 14:50:51'
  - Krs Paderborn
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.0784956468406415e-05) WHERE c.name = 'Espelkamp' AND f.timestamp BETWEEN TIMESTAMP('2023-11-19 23:37:33') AND TIMESTAMP('2023-12-03 04:45:40');
  params:
  - - '2023-11-19 23:37:33'
    - '2023-12-03 04:45:40'
  - Espelkamp
  - 1.0784956468406415e-05
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.2191515406801953e-05) WHERE c.name = 'Kreuztal' AND f.timestamp BETWEEN TIMESTAMP('2023-10-04 07:09:50') AND TIMESTAMP('2023-10-15 03:08:12');
  params:
  - - '2023-10-04 07:09:50'
    - '2023-10-15 03:08:12'
  - Kreuztal
  - 1.2191515406801953e-05
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Kleve' WHERE f.timestamp BETWEEN TIMESTAMP('2023-05-01 16:31:41') AND TIMESTAMP('2023-05-02 03:25:59') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-05-01 16:31:41'
    - '2023-05-02 03:25:59'
  - Krs Kleve
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-01-02 04:28:55' GROUP BY b.name;
  params:
  - '2023-01-02 04:28:55'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Schieder-Schwalenberg' AND f.timestamp BETWEEN TIMESTAMP('2023-01-31 16:56:24') AND TIMESTAMP('2023-02-10 09:49:15') AND f.altitude < 770 GROUP BY g.name, f.flightid;
  params:
  - - '2023-01-31 16:56:24'
    - '2023-02-10 09:49:15'
  - Gem Schieder-Schwalenberg
  - 770
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Alfter' AND f.timestamp BETWEEN TIMESTAMP('2023-10-19 04:12:52') AND TIMESTAMP('2023-10-23 23:06:58') AND f.altitude < 750 GROUP BY g.name, f.flightid;
  params:
  - - '2023-10-19 04:12:52'
    - '2023-10-23 23:06:58'
  - Gem Alfter
  - 750
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Brilon' AND f.timestamp BETWEEN TIMESTAMP('2023-10-10 03:55:21') AND TIMESTAMP('2023-10-18 09:37:32') AND f.altitude < 1360 GROUP BY g.name, f.flightid;
  params:
  - - '2023-10-10 03:55:21'
    - '2023-10-18 09:37:32'
  - Gem Brilon
  - 1360
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-03-07 00:19:22' GROUP BY b.name;
  params:
  - '2023-03-07 00:19:22'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Borken' AND f.timestamp BETWEEN TIMESTAMP('2023-07-06 22:58:36') AND TIMESTAMP('2023-07-14 06:19:54') AND f.altitude < 1220 GROUP BY g.name, f.flightid;
  params:
  - - '2023-07-06 22:58:36'
    - '2023-07-14 06:19:54'
  - Gem Borken
  - 1220
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-08-25 13:27:12' GROUP BY b.name;
  params:
  - '2023-08-25 13:27:12'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-02-20 05:27:43' GROUP BY b.name;
  params:
  - '2023-02-20 05:27:43'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Bielefeld' WHERE f.timestamp BETWEEN TIMESTAMP('2023-11-20 03:42:26') AND TIMESTAMP('2023-11-22 01:57:56') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-11-20 03:42:26'
    - '2023-11-22 01:57:56'
  - Krs Bielefeld
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Maerkischer Kreis' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-01-18 10:45:12') AND TIMESTAMP('2023-01-29 00:55:57');
  params:
  - - '2023-01-18 10:45:12'
    - '2023-01-29 00:55:57'
  - Krs Maerkischer Kreis
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.964458578836917e-06) WHERE c.name = 'Korschenbroich' AND f.timestamp BETWEEN TIMESTAMP('2023-11-27 20:25:35') AND TIMESTAMP('2023-12-12 11:40:37');
  params:
  - - '2023-11-27 20:25:35'
    - '2023-12-12 11:40:37'
  - Korschenbroich
  - 7.964458578836917e-06
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Hamm' AND f.timestamp BETWEEN TIMESTAMP('2023-02-18 00:42:08') AND TIMESTAMP('2023-03-02 08:08:49') AND f.altitude < 670 GROUP BY g.name, f.flightid;
  params:
  - - '2023-02-18 00:42:08'
    - '2023-03-02 08:08:49'
  - Gem Hamm
  - 670
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Coesfeld' WHERE f.timestamp BETWEEN TIMESTAMP('2023-04-01 08:01:28') AND TIMESTAMP('2023-04-02 01:34:30') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-04-01 08:01:28'
    - '2023-04-02 01:34:30'
  - Krs Coesfeld
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Soest' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-03-18 08:19:04') AND TIMESTAMP('2023-03-25 23:57:49');
  params:
  - - '2023-03-18 08:19:04'
    - '2023-03-25 23:57:49'
  - Krs Soest
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-12-22 12:17:22' GROUP BY b.name;
  params:
  - '2023-12-22 12:17:22'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Doerentrup' AND f.timestamp BETWEEN TIMESTAMP('2023-10-03 14:01:07') AND TIMESTAMP('2023-10-18 02:43:17') AND f.altitude < 640 GROUP BY g.name, f.flightid;
  params:
  - - '2023-10-03 14:01:07'
    - '2023-10-18 02:43:17'
  - Gem Doerentrup
  - 640
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Gelsenkirchen' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-02-14 22:36:36') AND TIMESTAMP('2023-02-20 18:42:51');
  params:
  - - '2023-02-14 22:36:36'
    - '2023-02-20 18:42:51'
  - Krs Gelsenkirchen
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Solingen' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-12-03 16:43:04') AND TIMESTAMP('2023-12-10 14:26:36');
  params:
  - - '2023-12-03 16:43:04'
    - '2023-12-10 14:26:36'
  - Krs Solingen
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-03-31 17:22:54' GROUP BY b.name;
  params:
  - '2023-03-31 17:22:54'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Herford' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-08-04 04:33:23') AND TIMESTAMP('2023-08-12 04:54:57');
  params:
  - - '2023-08-04 04:33:23'
    - '2023-08-12 04:54:57'
  - Krs Herford
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Kirchhundem' AND f.timestamp BETWEEN TIMESTAMP('2023-03-03 02:08:37') AND TIMESTAMP('2023-03-17 06:32:28') AND f.altitude < 760 GROUP BY g.name, f.flightid;
  params:
  - - '2023-03-03 02:08:37'
    - '2023-03-17 06:32:28'
  - Gem Kirchhundem
  - 760
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-09-14 04:01:45' GROUP BY b.name;
  params:
  - '2023-09-14 04:01:45'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Paderborn' AND f.timestamp BETWEEN TIMESTAMP('2023-01-21 07:26:12') AND TIMESTAMP('2023-01-28 14:54:10') AND f.altitude < 1460 GROUP BY g.name, f.flightid;
  params:
  - - '2023-01-21 07:26:12'
    - '2023-01-28 14:54:10'
  - Gem Paderborn
  - 1460
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-05-27 12:43:19' GROUP BY b.name;
  params:
  - '2023-05-27 12:43:19'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3.8541058429581974e-06) WHERE c.name = 'Gladbeck' AND f.timestamp BETWEEN TIMESTAMP('2023-07-15 14:17:08') AND TIMESTAMP('2023-07-22 20:11:00');
  params:
  - - '2023-07-15 14:17:08'
    - '2023-07-22 20:11:00'
  - Gladbeck
  - 3.8541058429581974e-06
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Oberbergischer Kreis' WHERE f.timestamp BETWEEN TIMESTAMP('2023-10-15 03:09:48') AND TIMESTAMP('2023-10-16 22:10:15') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-10-15 03:09:48'
    - '2023-10-16 22:10:15'
  - Krs Oberbergischer Kreis
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Oberbergischer Kreis' WHERE f.timestamp BETWEEN TIMESTAMP('2023-10-17 17:30:22') AND TIMESTAMP('2023-10-18 21:11:36') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-10-17 17:30:22'
    - '2023-10-18 21:11:36'
  - Krs Oberbergischer Kreis
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Meinerzhagen' AND f.timestamp BETWEEN TIMESTAMP('2023-04-14 12:30:17') AND TIMESTAMP('2023-04-20 07:42:51') AND f.altitude < 630 GROUP BY g.name, f.flightid;
  params:
  - - '2023-04-14 12:30:17'
    - '2023-04-20 07:42:51'
  - Gem Meinerzhagen
  - 630
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Koeln' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-09-15 13:07:42') AND TIMESTAMP('2023-09-18 07:14:54');
  params:
  - - '2023-09-15 13:07:42'
    - '2023-09-18 07:14:54'
  - Krs Koeln
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 5.913542021157406e-06) WHERE c.name = 'Werl' AND f.timestamp BETWEEN TIMESTAMP('2023-07-07 00:33:40') AND TIMESTAMP('2023-07-16 02:48:32');
  params:
  - - '2023-07-07 00:33:40'
    - '2023-07-16 02:48:32'
  - Werl
  - 5.913542021157406e-06
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.428862250128166e-06) WHERE c.name = 'Duelmen' AND f.timestamp BETWEEN TIMESTAMP('2023-04-07 10:31:04') AND TIMESTAMP('2023-04-09 10:51:40');
  params:
  - - '2023-04-07 10:31:04'
    - '2023-04-09 10:51:40'
  - Duelmen
  - 7.428862250128166e-06
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-11-11 08:31:12' GROUP BY b.name;
  params:
  - '2023-11-11 08:31:12'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Maerkischer Kreis' WHERE f.timestamp BETWEEN TIMESTAMP('2023-09-19 02:27:18') AND TIMESTAMP('2023-09-20 16:50:33') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-09-19 02:27:18'
    - '2023-09-20 16:50:33'
  - Krs Maerkischer Kreis
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-05-19 04:48:00' GROUP BY b.name;
  params:
  - '2023-05-19 04:48:00'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Steinfurt' WHERE f.timestamp BETWEEN TIMESTAMP('2023-04-07 07:42:23') AND TIMESTAMP('2023-04-07 12:47:41') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-04-07 07:42:23'
    - '2023-04-07 12:47:41'
  - Krs Steinfurt
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-12-21 14:20:54' GROUP BY b.name;
  params:
  - '2023-12-21 14:20:54'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Wesel' WHERE f.timestamp BETWEEN TIMESTAMP('2023-06-03 21:40:06') AND TIMESTAMP('2023-06-05 03:23:05') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-06-03 21:40:06'
    - '2023-06-05 03:23:05'
  - Krs Wesel
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Finnentrop' AND f.timestamp BETWEEN TIMESTAMP('2023-05-28 06:08:32') AND TIMESTAMP('2023-06-09 19:02:40') AND f.altitude < 1070 GROUP BY g.name, f.flightid;
  params:
  - - '2023-05-28 06:08:32'
    - '2023-06-09 19:02:40'
  - Gem Finnentrop
  - 1070
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Hagen' WHERE f.timestamp BETWEEN TIMESTAMP('2023-05-15 16:58:31') AND TIMESTAMP('2023-05-16 02:09:12') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-05-15 16:58:31'
    - '2023-05-16 02:09:12'
  - Krs Hagen
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3.53490044746857e-06) WHERE c.name = 'Menden' AND f.timestamp BETWEEN TIMESTAMP('2023-05-28 02:58:36') AND TIMESTAMP('2023-06-02 05:22:21');
  params:
  - - '2023-05-28 02:58:36'
    - '2023-06-02 05:22:21'
  - Menden
  - 3.53490044746857e-06
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Wettringen' AND f.timestamp BETWEEN TIMESTAMP('2023-06-23 17:43:36') AND TIMESTAMP('2023-06-30 04:00:31') AND f.altitude < 1370 GROUP BY g.name, f.flightid;
  params:
  - - '2023-06-23 17:43:36'
    - '2023-06-30 04:00:31'
  - Gem Wettringen
  - 1370
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 5.005715386556924e-06) WHERE c.name = 'Hoerstel' AND f.timestamp BETWEEN TIMESTAMP('2023-07-26 02:37:05') AND TIMESTAMP('2023-07-30 17:47:22');
  params:
  - - '2023-07-26 02:37:05'
    - '2023-07-30 17:47:22'
  - Hoerstel
  - 5.005715386556924e-06
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-06-15 16:22:11' GROUP BY b.name;
  params:
  - '2023-06-15 16:22:11'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-04-23 05:04:40' GROUP BY b.name;
  params:
  - '2023-04-23 05:04:40'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Hamm' WHERE f.timestamp BETWEEN TIMESTAMP('2023-06-18 03:35:37') AND TIMESTAMP('2023-06-19 13:21:42') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-06-18 03:35:37'
    - '2023-06-19 13:21:42'
  - Krs Hamm
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-10-31 09:00:17' GROUP BY b.name;
  params:
  - '2023-10-31 09:00:17'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Viersen' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-06-11 22:00:23') AND TIMESTAMP('2023-06-24 11:21:00');
  params:
  - - '2023-06-11 22:00:23'
    - '2023-06-24 11:21:00'
  - Krs Viersen
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.167496973578997e-06) WHERE c.name = 'Rahden' AND f.timestamp BETWEEN TIMESTAMP('2023-11-10 19:07:04') AND TIMESTAMP('2023-11-12 19:36:07');
  params:
  - - '2023-11-10 19:07:04'
    - '2023-11-12 19:36:07'
  - Rahden
  - 7.167496973578997e-06
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-08-03 14:13:18' GROUP BY b.name;
  params:
  - '2023-08-03 14:13:18'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Kerpen' AND f.timestamp BETWEEN TIMESTAMP('2023-11-18 23:35:17') AND TIMESTAMP('2023-11-22 13:01:56') AND f.altitude < 710 GROUP BY g.name, f.flightid;
  params:
  - - '2023-11-18 23:35:17'
    - '2023-11-22 13:01:56'
  - Gem Kerpen
  - 710
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-05-25 21:02:26' GROUP BY b.name;
  params:
  - '2023-05-25 21:02:26'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Krefeld' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-11-29 20:52:02') AND TIMESTAMP('2023-12-10 12:05:36');
  params:
  - - '2023-11-29 20:52:02'
    - '2023-12-10 12:05:36'
  - Krs Krefeld
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Unna' WHERE f.timestamp BETWEEN TIMESTAMP('2023-11-29 04:04:12') AND TIMESTAMP('2023-11-29 17:04:12') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-11-29 04:04:12'
    - '2023-11-29 17:04:12'
  - Krs Unna
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Oberhausen' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-09-10 07:21:22') AND TIMESTAMP('2023-09-19 09:02:37');
  params:
  - - '2023-09-10 07:21:22'
    - '2023-09-19 09:02:37'
  - Krs Oberhausen
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-12-01 03:30:39' GROUP BY b.name;
  params:
  - '2023-12-01 03:30:39'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Barntrup' AND f.timestamp BETWEEN TIMESTAMP('2023-01-14 02:57:15') AND TIMESTAMP('2023-01-23 02:36:25') AND f.altitude < 520 GROUP BY g.name, f.flightid;
  params:
  - - '2023-01-14 02:57:15'
    - '2023-01-23 02:36:25'
  - Gem Barntrup
  - 520
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Marienmuenster' AND f.timestamp BETWEEN TIMESTAMP('2023-10-27 23:20:40') AND TIMESTAMP('2023-11-06 12:04:58') AND f.altitude < 910 GROUP BY g.name, f.flightid;
  params:
  - - '2023-10-27 23:20:40'
    - '2023-11-06 12:04:58'
  - Gem Marienmuenster
  - 910
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Stolberg (Rhld.)' AND f.timestamp BETWEEN TIMESTAMP('2023-02-27 19:18:24') AND TIMESTAMP('2023-03-08 21:07:26') AND f.altitude < 1170 GROUP BY g.name, f.flightid;
  params:
  - - '2023-02-27 19:18:24'
    - '2023-03-08 21:07:26'
  - Gem Stolberg (Rhld.)
  - 1170
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Bielefeld' AND f.timestamp BETWEEN TIMESTAMP('2023-03-13 13:39:00') AND TIMESTAMP('2023-03-21 11:06:51') AND f.altitude < 1460 GROUP BY g.name, f.flightid;
  params:
  - - '2023-03-13 13:39:00'
    - '2023-03-21 11:06:51'
  - Gem Bielefeld
  - 1460
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Minden-Luebbecke' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-05-13 04:45:57') AND TIMESTAMP('2023-05-17 17:49:49');
  params:
  - - '2023-05-13 04:45:57'
    - '2023-05-17 17:49:49'
  - Krs Minden-Luebbecke
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Kevelaer' AND f.timestamp BETWEEN TIMESTAMP('2023-07-16 13:50:22') AND TIMESTAMP('2023-07-24 06:44:48') AND f.altitude < 1220 GROUP BY g.name, f.flightid;
  params:
  - - '2023-07-16 13:50:22'
    - '2023-07-24 06:44:48'
  - Gem Kevelaer
  - 1220
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-10-07 06:47:52' GROUP BY b.name;
  params:
  - '2023-10-07 06:47:52'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-06-12 01:34:17' GROUP BY b.name;
  params:
  - '2023-06-12 01:34:17'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Schieder-Schwalenberg' AND f.timestamp BETWEEN TIMESTAMP('2023-04-08 09:19:54') AND TIMESTAMP('2023-04-18 16:14:34') AND f.altitude < 1240 GROUP BY g.name, f.flightid;
  params:
  - - '2023-04-08 09:19:54'
    - '2023-04-18 16:14:34'
  - Gem Schieder-Schwalenberg
  - 1240
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Unna' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-05-28 06:39:51') AND TIMESTAMP('2023-05-31 12:09:53');
  params:
  - - '2023-05-28 06:39:51'
    - '2023-05-31 12:09:53'
  - Krs Unna
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.28528872765263e-06) WHERE c.name = 'Vlotho' AND f.timestamp BETWEEN TIMESTAMP('2023-05-17 17:16:25') AND TIMESTAMP('2023-05-20 16:33:10');
  params:
  - - '2023-05-17 17:16:25'
    - '2023-05-20 16:33:10'
  - Vlotho
  - 7.28528872765263e-06
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Hemer' AND f.timestamp BETWEEN TIMESTAMP('2023-05-07 17:17:50') AND TIMESTAMP('2023-05-10 14:42:50') AND f.altitude < 1230 GROUP BY g.name, f.flightid;
  params:
  - - '2023-05-07 17:17:50'
    - '2023-05-10 14:42:50'
  - Gem Hemer
  - 1230
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Gronau (Westf.)' AND f.timestamp BETWEEN TIMESTAMP('2023-09-11 20:34:32') AND TIMESTAMP('2023-09-16 10:41:33') AND f.altitude < 610 GROUP BY g.name, f.flightid;
  params:
  - - '2023-09-11 20:34:32'
    - '2023-09-16 10:41:33'
  - Gem Gronau (Westf.)
  - 610
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Euskirchen' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-01-15 05:26:12') AND TIMESTAMP('2023-01-24 10:05:49');
  params:
  - - '2023-01-15 05:26:12'
    - '2023-01-24 10:05:49'
  - Krs Euskirchen
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Lippe' WHERE f.timestamp BETWEEN TIMESTAMP('2023-08-15 20:27:26') AND TIMESTAMP('2023-08-17 03:10:05') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-08-15 20:27:26'
    - '2023-08-17 03:10:05'
  - Krs Lippe
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Ennepe-Ruhr-Kreis' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-01-02 23:44:16') AND TIMESTAMP('2023-01-07 08:06:31');
  params:
  - - '2023-01-02 23:44:16'
    - '2023-01-07 08:06:31'
  - Krs Ennepe-Ruhr-Kreis
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Wesel' WHERE f.timestamp BETWEEN TIMESTAMP('2023-04-07 10:10:12') AND TIMESTAMP('2023-04-08 00:40:36') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-04-07 10:10:12'
    - '2023-04-08 00:40:36'
  - Krs Wesel
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Lippetal' AND f.timestamp BETWEEN TIMESTAMP('2023-08-03 13:44:21') AND TIMESTAMP('2023-08-07 02:41:45') AND f.altitude < 830 GROUP BY g.name, f.flightid;
  params:
  - - '2023-08-03 13:44:21'
    - '2023-08-07 02:41:45'
  - Gem Lippetal
  - 830
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Euskirchen' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-03-13 02:30:48') AND TIMESTAMP('2023-03-23 15:04:43');
  params:
  - - '2023-03-13 02:30:48'
    - '2023-03-23 15:04:43'
  - Krs Euskirchen
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Breckerfeld' AND f.timestamp BETWEEN TIMESTAMP('2023-01-09 11:37:52') AND TIMESTAMP('2023-01-16 06:58:57') AND f.altitude < 1170 GROUP BY g.name, f.flightid;
  params:
  - - '2023-01-09 11:37:52'
    - '2023-01-16 06:58:57'
  - Gem Breckerfeld
  - 1170
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Rhein-Kreis Neuss' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-07-13 06:02:14') AND TIMESTAMP('2023-07-15 08:45:45');
  params:
  - - '2023-07-13 06:02:14'
    - '2023-07-15 08:45:45'
  - Krs Rhein-Kreis Neuss
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Lippe' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-08-04 12:23:29') AND TIMESTAMP('2023-08-08 03:23:15');
  params:
  - - '2023-08-04 12:23:29'
    - '2023-08-08 03:23:15'
  - Krs Lippe
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Rheinisch-Bergischer Kreis' WHERE f.timestamp BETWEEN TIMESTAMP('2023-10-28 07:04:37') AND TIMESTAMP('2023-10-28 09:55:46') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-10-28 07:04:37'
    - '2023-10-28 09:55:46'
  - Krs Rheinisch-Bergischer Kreis
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-06-18 08:34:03' GROUP BY b.name;
  params:
  - '2023-06-18 08:34:03'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.0306207891280328e-05) WHERE c.name = 'Bad Laasphe' AND f.timestamp BETWEEN TIMESTAMP('2023-03-27 14:54:52') AND TIMESTAMP('2023-04-08 18:11:30');
  params:
  - - '2023-03-27 14:54:52'
    - '2023-04-08 18:11:30'
  - Bad Laasphe
  - 1.0306207891280328e-05
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 6.102203468957656e-06) WHERE c.name = 'Lippstadt' AND f.timestamp BETWEEN TIMESTAMP('2023-10-31 19:33:53') AND TIMESTAMP('2023-11-03 01:53:05');
  params:
  - - '2023-10-31 19:33:53'
    - '2023-11-03 01:53:05'
  - Lippstadt
  - 6.102203468957656e-06
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Oberbergischer Kreis' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-08-11 23:46:47') AND TIMESTAMP('2023-08-14 11:37:04');
  params:
  - - '2023-08-11 23:46:47'
    - '2023-08-14 11:37:04'
  - Krs Oberbergischer Kreis
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Heinsberg' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-01-10 19:31:22') AND TIMESTAMP('2023-01-19 03:12:14');
  params:
  - - '2023-01-10 19:31:22'
    - '2023-01-19 03:12:14'
  - Krs Heinsberg
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-10-14 16:18:40' GROUP BY b.name;
  params:
  - '2023-10-14 16:18:40'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 8.805539191330539e-06) WHERE c.name = 'Siegburg' AND f.timestamp BETWEEN TIMESTAMP('2023-10-27 00:35:25') AND TIMESTAMP('2023-11-09 19:14:23');
  params:
  - - '2023-10-27 00:35:25'
    - '2023-11-09 19:14:23'
  - Siegburg
  - 8.805539191330539e-06
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Herford' WHERE f.timestamp BETWEEN TIMESTAMP('2023-09-20 18:15:22') AND TIMESTAMP('2023-09-21 06:12:00') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-09-20 18:15:22'
    - '2023-09-21 06:12:00'
  - Krs Herford
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Windeck' AND f.timestamp BETWEEN TIMESTAMP('2023-10-11 07:35:43') AND TIMESTAMP('2023-10-21 20:49:59') AND f.altitude < 940 GROUP BY g.name, f.flightid;
  params:
  - - '2023-10-11 07:35:43'
    - '2023-10-21 20:49:59'
  - Gem Windeck
  - 940
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Coesfeld' WHERE f.timestamp BETWEEN TIMESTAMP('2023-06-16 10:07:49') AND TIMESTAMP('2023-06-17 01:22:02') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-06-16 10:07:49'
    - '2023-06-17 01:22:02'
  - Krs Coesfeld
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Hochsauerlandkreis' WHERE f.timestamp BETWEEN TIMESTAMP('2023-03-10 08:34:18') AND TIMESTAMP('2023-03-10 12:31:43') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-03-10 08:34:18'
    - '2023-03-10 12:31:43'
  - Krs Hochsauerlandkreis
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Hochsauerlandkreis' WHERE f.timestamp BETWEEN TIMESTAMP('2023-11-26 01:55:50') AND TIMESTAMP('2023-11-27 18:08:26') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-11-26 01:55:50'
    - '2023-11-27 18:08:26'
  - Krs Hochsauerlandkreis
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Mettmann' WHERE f.timestamp BETWEEN TIMESTAMP('2023-10-30 19:26:49') AND TIMESTAMP('2023-10-30 20:13:08') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-10-30 19:26:49'
    - '2023-10-30 20:13:08'
  - Krs Mettmann
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-12-12 12:30:13' GROUP BY b.name;
  params:
  - '2023-12-12 12:30:13'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-02-27 03:57:57' GROUP BY b.name;
  params:
  - '2023-02-27 03:57:57'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Lippe' WHERE f.timestamp BETWEEN TIMESTAMP('2023-10-13 05:27:01') AND TIMESTAMP('2023-10-14 04:19:41') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-10-13 05:27:01'
    - '2023-10-14 04:19:41'
  - Krs Lippe
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Steinfurt' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-08-27 00:47:49') AND TIMESTAMP('2023-09-01 12:41:59');
  params:
  - - '2023-08-27 00:47:49'
    - '2023-09-01 12:41:59'
  - Krs Steinfurt
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-01-28 23:03:27' GROUP BY b.name;
  params:
  - '2023-01-28 23:03:27'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-10-26 15:02:21' GROUP BY b.name;
  params:
  - '2023-10-26 15:02:21'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Rhein-Sieg-Kreis' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-03-22 12:37:55') AND TIMESTAMP('2023-03-25 15:24:08');
  params:
  - - '2023-03-22 12:37:55'
    - '2023-03-25 15:24:08'
  - Krs Rhein-Sieg-Kreis
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Hamm' WHERE f.timestamp BETWEEN TIMESTAMP('2023-09-27 10:37:45') AND TIMESTAMP('2023-09-28 02:56:40') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-09-27 10:37:45'
    - '2023-09-28 02:56:40'
  - Krs Hamm
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.3909847282138495e-05) WHERE c.name = 'Moenchengladbach' AND f.timestamp BETWEEN TIMESTAMP('2023-12-31 03:31:31') AND TIMESTAMP('2023-12-31 23:59:59');
  params:
  - - '2023-12-31 03:31:31'
    - '2023-12-31 23:59:59'
  - Moenchengladbach
  - 1.3909847282138495e-05
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Herford' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-08-15 05:35:54') AND TIMESTAMP('2023-08-17 23:13:09');
  params:
  - - '2023-08-15 05:35:54'
    - '2023-08-17 23:13:09'
  - Krs Herford
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.3088584500147583e-05) WHERE c.name = 'Hilchenbach' AND f.timestamp BETWEEN TIMESTAMP('2023-09-22 20:11:29') AND TIMESTAMP('2023-10-03 08:49:05');
  params:
  - - '2023-09-22 20:11:29'
    - '2023-10-03 08:49:05'
  - Hilchenbach
  - 1.3088584500147583e-05
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-01-09 11:00:06' GROUP BY b.name;
  params:
  - '2023-01-09 11:00:06'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.144384162269529e-06) WHERE c.name = 'Borgholzhausen' AND f.timestamp BETWEEN TIMESTAMP('2023-09-26 05:11:27') AND TIMESTAMP('2023-10-01 16:06:45');
  params:
  - - '2023-09-26 05:11:27'
    - '2023-10-01 16:06:45'
  - Borgholzhausen
  - 7.144384162269529e-06
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Bad Salzuflen' AND f.timestamp BETWEEN TIMESTAMP('2023-08-28 04:19:55') AND TIMESTAMP('2023-09-03 02:43:13') AND f.altitude < 960 GROUP BY g.name, f.flightid;
  params:
  - - '2023-08-28 04:19:55'
    - '2023-09-03 02:43:13'
  - Gem Bad Salzuflen
  - 960
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-02-24 15:20:09' GROUP BY b.name;
  params:
  - '2023-02-24 15:20:09'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Iserlohn' AND f.timestamp BETWEEN TIMESTAMP('2023-09-14 02:55:41') AND TIMESTAMP('2023-09-21 02:15:14') AND f.altitude < 1460 GROUP BY g.name, f.flightid;
  params:
  - - '2023-09-14 02:55:41'
    - '2023-09-21 02:15:14'
  - Gem Iserlohn
  - 1460
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Senden' AND f.timestamp BETWEEN TIMESTAMP('2023-05-16 05:07:34') AND TIMESTAMP('2023-05-19 06:46:53') AND f.altitude < 1110 GROUP BY g.name, f.flightid;
  params:
  - - '2023-05-16 05:07:34'
    - '2023-05-19 06:46:53'
  - Gem Senden
  - 1110
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Wegberg' AND f.timestamp BETWEEN TIMESTAMP('2023-01-10 14:01:38') AND TIMESTAMP('2023-01-15 20:09:13') AND f.altitude < 1500 GROUP BY g.name, f.flightid;
  params:
  - - '2023-01-10 14:01:38'
    - '2023-01-15 20:09:13'
  - Gem Wegberg
  - 1500
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Herford' WHERE f.timestamp BETWEEN TIMESTAMP('2023-08-08 00:24:51') AND TIMESTAMP('2023-08-08 04:19:18') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-08-08 00:24:51'
    - '2023-08-08 04:19:18'
  - Krs Herford
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Lindlar' AND f.timestamp BETWEEN TIMESTAMP('2023-07-04 06:44:45') AND TIMESTAMP('2023-07-13 17:40:55') AND f.altitude < 740 GROUP BY g.name, f.flightid;
  params:
  - - '2023-07-04 06:44:45'
    - '2023-07-13 17:40:55'
  - Gem Lindlar
  - 740
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Essen' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-11-14 19:29:18') AND TIMESTAMP('2023-11-18 23:25:53');
  params:
  - - '2023-11-14 19:29:18'
    - '2023-11-18 23:25:53'
  - Krs Essen
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-03-13 14:19:49' GROUP BY b.name;
  params:
  - '2023-03-13 14:19:49'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Soest' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-08-04 22:17:09') AND TIMESTAMP('2023-08-19 22:09:59');
  params:
  - - '2023-08-04 22:17:09'
    - '2023-08-19 22:09:59'
  - Krs Soest
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Rhein-Erft-Kreis' WHERE f.timestamp BETWEEN TIMESTAMP('2023-04-20 21:57:25') AND TIMESTAMP('2023-04-22 21:23:05') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-04-20 21:57:25'
    - '2023-04-22 21:23:05'
  - Krs Rhein-Erft-Kreis
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-03-15 06:08:01' GROUP BY b.name;
  params:
  - '2023-03-15 06:08:01'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Essen' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-03-31 03:03:45') AND TIMESTAMP('2023-04-13 16:38:53');
  params:
  - - '2023-03-31 03:03:45'
    - '2023-04-13 16:38:53'
  - Krs Essen
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Vlotho' AND f.timestamp BETWEEN TIMESTAMP('2023-10-14 10:05:15') AND TIMESTAMP('2023-10-25 22:30:56') AND f.altitude < 820 GROUP BY g.name, f.flightid;
  params:
  - - '2023-10-14 10:05:15'
    - '2023-10-25 22:30:56'
  - Gem Vlotho
  - 820
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Anroechte' AND f.timestamp BETWEEN TIMESTAMP('2023-09-06 12:12:25') AND TIMESTAMP('2023-09-19 06:50:33') AND f.altitude < 710 GROUP BY g.name, f.flightid;
  params:
  - - '2023-09-06 12:12:25'
    - '2023-09-19 06:50:33'
  - Gem Anroechte
  - 710
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Lippe' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-02-05 00:09:44') AND TIMESTAMP('2023-02-07 13:21:05');
  params:
  - - '2023-02-05 00:09:44'
    - '2023-02-07 13:21:05'
  - Krs Lippe
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-12-07 12:42:25' GROUP BY b.name;
  params:
  - '2023-12-07 12:42:25'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 6.255235076151577e-06) WHERE c.name = 'Sprockhoevel' AND f.timestamp BETWEEN TIMESTAMP('2023-06-05 20:42:37') AND TIMESTAMP('2023-06-11 03:38:37');
  params:
  - - '2023-06-05 20:42:37'
    - '2023-06-11 03:38:37'
  - Sprockhoevel
  - 6.255235076151577e-06
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-06-09 08:36:15' GROUP BY b.name;
  params:
  - '2023-06-09 08:36:15'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.512506339905528e-05) WHERE c.name = 'Rahden' AND f.timestamp BETWEEN TIMESTAMP('2023-09-14 16:06:20') AND TIMESTAMP('2023-09-28 13:48:22');
  params:
  - - '2023-09-14 16:06:20'
    - '2023-09-28 13:48:22'
  - Rahden
  - 1.512506339905528e-05
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Siegen-Wittgenstein' WHERE f.timestamp BETWEEN TIMESTAMP('2023-08-25 06:33:43') AND TIMESTAMP('2023-08-27 02:04:39') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-08-25 06:33:43'
    - '2023-08-27 02:04:39'
  - Krs Siegen-Wittgenstein
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.4411426480833667e-05) WHERE c.name = 'Steinheim' AND f.timestamp BETWEEN TIMESTAMP('2023-10-19 22:24:13') AND TIMESTAMP('2023-10-24 15:27:09');
  params:
  - - '2023-10-19 22:24:13'
    - '2023-10-24 15:27:09'
  - Steinheim
  - 1.4411426480833667e-05
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 4.797266683155384e-06) WHERE c.name = 'Aachen' AND f.timestamp BETWEEN TIMESTAMP('2023-02-28 17:15:56') AND TIMESTAMP('2023-03-06 05:09:49');
  params:
  - - '2023-02-28 17:15:56'
    - '2023-03-06 05:09:49'
  - Aachen
  - 4.797266683155384e-06
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Olpe' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-04-24 04:00:54') AND TIMESTAMP('2023-05-04 05:30:55');
  params:
  - - '2023-04-24 04:00:54'
    - '2023-05-04 05:30:55'
  - Krs Olpe
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-06-10 22:46:58' GROUP BY b.name;
  params:
  - '2023-06-10 22:46:58'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-02-17 08:16:42' GROUP BY b.name;
  params:
  - '2023-02-17 08:16:42'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 4.256084969059301e-06) WHERE c.name = 'Moenchengladbach' AND f.timestamp BETWEEN TIMESTAMP('2023-05-02 03:03:34') AND TIMESTAMP('2023-05-09 08:36:26');
  params:
  - - '2023-05-02 03:03:34'
    - '2023-05-09 08:36:26'
  - Moenchengladbach
  - 4.256084969059301e-06
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Siegen-Wittgenstein' WHERE f.timestamp BETWEEN TIMESTAMP('2023-07-18 00:24:42') AND TIMESTAMP('2023-07-18 07:00:39') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-07-18 00:24:42'
    - '2023-07-18 07:00:39'
  - Krs Siegen-Wittgenstein
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-09-13 17:06:10' GROUP BY b.name;
  params:
  - '2023-09-13 17:06:10'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Koenigswinter' AND f.timestamp BETWEEN TIMESTAMP('2023-03-01 12:44:52') AND TIMESTAMP('2023-03-08 17:31:59') AND f.altitude < 860 GROUP BY g.name, f.flightid;
  params:
  - - '2023-03-01 12:44:52'
    - '2023-03-08 17:31:59'
  - Gem Koenigswinter
  - 860
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-11-26 19:13:06' GROUP BY b.name;
  params:
  - '2023-11-26 19:13:06'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Oberbergischer Kreis' WHERE f.timestamp BETWEEN TIMESTAMP('2023-09-20 19:05:44') AND TIMESTAMP('2023-09-21 11:42:47') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-09-20 19:05:44'
    - '2023-09-21 11:42:47'
  - Krs Oberbergischer Kreis
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.530446280692093e-05) WHERE c.name = 'Hamminkeln' AND f.timestamp BETWEEN TIMESTAMP('2023-04-19 01:34:53') AND TIMESTAMP('2023-04-24 04:08:55');
  params:
  - - '2023-04-19 01:34:53'
    - '2023-04-24 04:08:55'
  - Hamminkeln
  - 1.530446280692093e-05
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 8.228751607018429e-06) WHERE c.name = 'Warburg' AND f.timestamp BETWEEN TIMESTAMP('2023-06-03 02:13:05') AND TIMESTAMP('2023-06-09 10:53:10');
  params:
  - - '2023-06-03 02:13:05'
    - '2023-06-09 10:53:10'
  - Warburg
  - 8.228751607018429e-06
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Lohmar' AND f.timestamp BETWEEN TIMESTAMP('2023-11-24 05:49:11') AND TIMESTAMP('2023-12-04 02:30:17') AND f.altitude < 1230 GROUP BY g.name, f.flightid;
  params:
  - - '2023-11-24 05:49:11'
    - '2023-12-04 02:30:17'
  - Gem Lohmar
  - 1230
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 5.182765219185811e-06) WHERE c.name = 'Preuisch Oldendorf' AND f.timestamp BETWEEN TIMESTAMP('2023-09-07 14:06:14') AND TIMESTAMP('2023-09-11 21:35:54');
  params:
  - - '2023-09-07 14:06:14'
    - '2023-09-11 21:35:54'
  - Preuisch Oldendorf
  - 5.182765219185811e-06
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-10-19 09:59:57' GROUP BY b.name;
  params:
  - '2023-10-19 09:59:57'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Steinfurt' WHERE f.timestamp BETWEEN TIMESTAMP('2023-05-03 01:14:14') AND TIMESTAMP('2023-05-03 06:33:13') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-05-03 01:14:14'
    - '2023-05-03 06:33:13'
  - Krs Steinfurt
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Minden-Luebbecke' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-02-20 17:05:20') AND TIMESTAMP('2023-02-28 06:44:42');
  params:
  - - '2023-02-20 17:05:20'
    - '2023-02-28 06:44:42'
  - Krs Minden-Luebbecke
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Schlangen' AND f.timestamp BETWEEN TIMESTAMP('2023-10-16 16:16:53') AND TIMESTAMP('2023-10-27 01:45:51') AND f.altitude < 1040 GROUP BY g.name, f.flightid;
  params:
  - - '2023-10-16 16:16:53'
    - '2023-10-27 01:45:51'
  - Gem Schlangen
  - 1040
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-07-02 19:50:52' GROUP BY b.name;
  params:
  - '2023-07-02 19:50:52'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.125584648236579e-05) WHERE c.name = 'Leichlingen' AND f.timestamp BETWEEN TIMESTAMP('2023-01-11 15:38:05') AND TIMESTAMP('2023-01-22 15:40:42');
  params:
  - - '2023-01-11 15:38:05'
    - '2023-01-22 15:40:42'
  - Leichlingen
  - 1.125584648236579e-05
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-11-19 10:56:34' GROUP BY b.name;
  params:
  - '2023-11-19 10:56:34'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Recke' AND f.timestamp BETWEEN TIMESTAMP('2023-09-28 12:49:53') AND TIMESTAMP('2023-10-12 20:04:02') AND f.altitude < 980 GROUP BY g.name, f.flightid;
  params:
  - - '2023-09-28 12:49:53'
    - '2023-10-12 20:04:02'
  - Gem Recke
  - 980
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Werdohl' AND f.timestamp BETWEEN TIMESTAMP('2023-05-06 09:00:44') AND TIMESTAMP('2023-05-15 21:12:34') AND f.altitude < 680 GROUP BY g.name, f.flightid;
  params:
  - - '2023-05-06 09:00:44'
    - '2023-05-15 21:12:34'
  - Gem Werdohl
  - 680
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Paderborn' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-04-25 06:32:31') AND TIMESTAMP('2023-04-28 13:46:11');
  params:
  - - '2023-04-25 06:32:31'
    - '2023-04-28 13:46:11'
  - Krs Paderborn
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Guetersloh' WHERE f.timestamp BETWEEN TIMESTAMP('2023-03-24 05:37:29') AND TIMESTAMP('2023-03-25 14:40:40') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-03-24 05:37:29'
    - '2023-03-25 14:40:40'
  - Krs Guetersloh
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Lippe' WHERE f.timestamp BETWEEN TIMESTAMP('2023-09-23 17:00:52') AND TIMESTAMP('2023-09-24 14:45:11') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-09-23 17:00:52'
    - '2023-09-24 14:45:11'
  - Krs Lippe
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.5333138708105715e-05) WHERE c.name = 'Gladbeck' AND f.timestamp BETWEEN TIMESTAMP('2023-09-22 16:18:48') AND TIMESTAMP('2023-09-27 23:32:03');
  params:
  - - '2023-09-22 16:18:48'
    - '2023-09-27 23:32:03'
  - Gladbeck
  - 1.5333138708105715e-05
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.4347363711768255e-05) WHERE c.name = 'Herzogenrath' AND f.timestamp BETWEEN TIMESTAMP('2023-04-21 09:06:55') AND TIMESTAMP('2023-04-23 18:24:44');
  params:
  - - '2023-04-21 09:06:55'
    - '2023-04-23 18:24:44'
  - Herzogenrath
  - 1.4347363711768255e-05
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Recklinghausen' AND f.timestamp BETWEEN TIMESTAMP('2023-08-04 12:47:41') AND TIMESTAMP('2023-08-17 15:46:42') AND f.altitude < 760 GROUP BY g.name, f.flightid;
  params:
  - - '2023-08-04 12:47:41'
    - '2023-08-17 15:46:42'
  - Gem Recklinghausen
  - 760
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-09-28 15:14:10' GROUP BY b.name;
  params:
  - '2023-09-28 15:14:10'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Maerkischer Kreis' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-01-01 10:11:36') AND TIMESTAMP('2023-01-04 12:48:22');
  params:
  - - '2023-01-01 10:11:36'
    - '2023-01-04 12:48:22'
  - Krs Maerkischer Kreis
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.016988715317341e-05) WHERE c.name = 'Bueren' AND f.timestamp BETWEEN TIMESTAMP('2023-09-25 22:41:31') AND TIMESTAMP('2023-09-29 18:28:08');
  params:
  - - '2023-09-25 22:41:31'
    - '2023-09-29 18:28:08'
  - Bueren
  - 1.016988715317341e-05
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Dueren' WHERE f.timestamp BETWEEN TIMESTAMP('2023-02-05 00:16:20') AND TIMESTAMP('2023-02-06 07:25:15') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-02-05 00:16:20'
    - '2023-02-06 07:25:15'
  - Krs Dueren
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3.7029154723411353e-06) WHERE c.name = 'Bedburg' AND f.timestamp BETWEEN TIMESTAMP('2023-01-19 01:10:37') AND TIMESTAMP('2023-01-31 18:32:12');
  params:
  - - '2023-01-19 01:10:37'
    - '2023-01-31 18:32:12'
  - Bedburg
  - 3.7029154723411353e-06
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Herford' WHERE f.timestamp BETWEEN TIMESTAMP('2023-07-28 09:59:34') AND TIMESTAMP('2023-07-29 20:04:01') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-07-28 09:59:34'
    - '2023-07-29 20:04:01'
  - Krs Herford
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Coesfeld' WHERE f.timestamp BETWEEN TIMESTAMP('2023-07-15 17:56:13') AND TIMESTAMP('2023-07-17 03:54:28') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-07-15 17:56:13'
    - '2023-07-17 03:54:28'
  - Krs Coesfeld
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-02-14 14:56:37' GROUP BY b.name;
  params:
  - '2023-02-14 14:56:37'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.655039088680139e-06) WHERE c.name = 'Halver' AND f.timestamp BETWEEN TIMESTAMP('2023-01-20 01:26:33') AND TIMESTAMP('2023-01-30 11:19:36');
  params:
  - - '2023-01-20 01:26:33'
    - '2023-01-30 11:19:36'
  - Halver
  - 7.655039088680139e-06
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Wesel' WHERE f.timestamp BETWEEN TIMESTAMP('2023-03-31 02:25:32') AND TIMESTAMP('2023-03-31 04:13:14') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-03-31 02:25:32'
    - '2023-03-31 04:13:14'
  - Krs Wesel
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.453255360305922e-05) WHERE c.name = 'Rheinbach' AND f.timestamp BETWEEN TIMESTAMP('2023-07-10 09:18:29') AND TIMESTAMP('2023-07-14 01:05:39');
  params:
  - - '2023-07-10 09:18:29'
    - '2023-07-14 01:05:39'
  - Rheinbach
  - 1.453255360305922e-05
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Koeln' AND f.timestamp BETWEEN TIMESTAMP('2023-07-26 05:01:06') AND TIMESTAMP('2023-07-30 03:57:10') AND f.altitude < 850 GROUP BY g.name, f.flightid;
  params:
  - - '2023-07-26 05:01:06'
    - '2023-07-30 03:57:10'
  - Gem Koeln
  - 850
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.4784750879297675e-05) WHERE c.name = 'Emmerich' AND f.timestamp BETWEEN TIMESTAMP('2023-04-05 10:20:03') AND TIMESTAMP('2023-04-07 16:41:04');
  params:
  - - '2023-04-05 10:20:03'
    - '2023-04-07 16:41:04'
  - Emmerich
  - 1.4784750879297675e-05
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Geseke' AND f.timestamp BETWEEN TIMESTAMP('2023-04-28 15:12:33') AND TIMESTAMP('2023-05-07 08:58:18') AND f.altitude < 1280 GROUP BY g.name, f.flightid;
  params:
  - - '2023-04-28 15:12:33'
    - '2023-05-07 08:58:18'
  - Gem Geseke
  - 1280
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.528137004903446e-06) WHERE c.name = 'Witten' AND f.timestamp BETWEEN TIMESTAMP('2023-03-25 21:12:29') AND TIMESTAMP('2023-04-07 21:47:45');
  params:
  - - '2023-03-25 21:12:29'
    - '2023-04-07 21:47:45'
  - Witten
  - 7.528137004903446e-06
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.0760846734884941e-05) WHERE c.name = 'Bueren' AND f.timestamp BETWEEN TIMESTAMP('2023-02-10 22:20:30') AND TIMESTAMP('2023-02-17 08:04:37');
  params:
  - - '2023-02-10 22:20:30'
    - '2023-02-17 08:04:37'
  - Bueren
  - 1.0760846734884941e-05
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Muenster' AND f.timestamp BETWEEN TIMESTAMP('2023-01-16 06:29:44') AND TIMESTAMP('2023-01-22 20:54:39') AND f.altitude < 1060 GROUP BY g.name, f.flightid;
  params:
  - - '2023-01-16 06:29:44'
    - '2023-01-22 20:54:39'
  - Gem Muenster
  - 1060
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Guetersloh' WHERE f.timestamp BETWEEN TIMESTAMP('2023-02-07 10:06:26') AND TIMESTAMP('2023-02-07 23:46:20') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-02-07 10:06:26'
    - '2023-02-07 23:46:20'
  - Krs Guetersloh
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Staedteregion Aachen' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-07-19 13:16:39') AND TIMESTAMP('2023-08-01 20:36:59');
  params:
  - - '2023-07-19 13:16:39'
    - '2023-08-01 20:36:59'
  - Krs Staedteregion Aachen
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Heinsberg' AND f.timestamp BETWEEN TIMESTAMP('2023-09-06 15:51:41') AND TIMESTAMP('2023-09-10 17:41:57') AND f.altitude < 520 GROUP BY g.name, f.flightid;
  params:
  - - '2023-09-06 15:51:41'
    - '2023-09-10 17:41:57'
  - Gem Heinsberg
  - 520
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Dortmund' AND f.timestamp BETWEEN TIMESTAMP('2023-08-21 03:09:39') AND TIMESTAMP('2023-08-29 12:54:27') AND f.altitude < 710 GROUP BY g.name, f.flightid;
  params:
  - - '2023-08-21 03:09:39'
    - '2023-08-29 12:54:27'
  - Gem Dortmund
  - 710
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Maerkischer Kreis' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-12-05 23:43:33') AND TIMESTAMP('2023-12-18 11:41:17');
  params:
  - - '2023-12-05 23:43:33'
    - '2023-12-18 11:41:17'
  - Krs Maerkischer Kreis
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Burscheid' AND f.timestamp BETWEEN TIMESTAMP('2023-08-16 23:13:19') AND TIMESTAMP('2023-08-25 18:16:35') AND f.altitude < 1190 GROUP BY g.name, f.flightid;
  params:
  - - '2023-08-16 23:13:19'
    - '2023-08-25 18:16:35'
  - Gem Burscheid
  - 1190
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.0103341928948839e-05) WHERE c.name = 'Olsberg' AND f.timestamp BETWEEN TIMESTAMP('2023-08-29 15:15:58') AND TIMESTAMP('2023-09-03 13:25:59');
  params:
  - - '2023-08-29 15:15:58'
    - '2023-09-03 13:25:59'
  - Olsberg
  - 1.0103341928948839e-05
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Gelsenkirchen' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-03-24 11:33:00') AND TIMESTAMP('2023-04-01 20:26:03');
  params:
  - - '2023-03-24 11:33:00'
    - '2023-04-01 20:26:03'
  - Krs Gelsenkirchen
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Rhein-Sieg-Kreis' WHERE f.timestamp BETWEEN TIMESTAMP('2023-12-25 07:44:01') AND TIMESTAMP('2023-12-27 04:11:35') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-12-25 07:44:01'
    - '2023-12-27 04:11:35'
  - Krs Rhein-Sieg-Kreis
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Maerkischer Kreis' WHERE f.timestamp BETWEEN TIMESTAMP('2023-11-29 11:39:35') AND TIMESTAMP('2023-11-30 00:45:03') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-11-29 11:39:35'
    - '2023-11-30 00:45:03'
  - Krs Maerkischer Kreis
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Erkrath' AND f.timestamp BETWEEN TIMESTAMP('2023-05-21 04:36:19') AND TIMESTAMP('2023-05-26 14:45:26') AND f.altitude < 1410 GROUP BY g.name, f.flightid;
  params:
  - - '2023-05-21 04:36:19'
    - '2023-05-26 14:45:26'
  - Gem Erkrath
  - 1410
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Solingen' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-05-14 23:05:58') AND TIMESTAMP('2023-05-17 06:02:38');
  params:
  - - '2023-05-14 23:05:58'
    - '2023-05-17 06:02:38'
  - Krs Solingen
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.1045882421516932e-05) WHERE c.name = 'Roesrath' AND f.timestamp BETWEEN TIMESTAMP('2023-11-20 11:18:24') AND TIMESTAMP('2023-11-29 03:49:20');
  params:
  - - '2023-11-20 11:18:24'
    - '2023-11-29 03:49:20'
  - Roesrath
  - 1.1045882421516932e-05
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Borken' WHERE f.timestamp BETWEEN TIMESTAMP('2023-06-07 01:26:52') AND TIMESTAMP('2023-06-07 21:03:26') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-06-07 01:26:52'
    - '2023-06-07 21:03:26'
  - Krs Borken
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.4735974446045791e-05) WHERE c.name = 'Geldern' AND f.timestamp BETWEEN TIMESTAMP('2023-03-10 02:06:16') AND TIMESTAMP('2023-03-20 00:19:28');
  params:
  - - '2023-03-10 02:06:16'
    - '2023-03-20 00:19:28'
  - Geldern
  - 1.4735974446045791e-05
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Paderborn' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-01-27 11:26:38') AND TIMESTAMP('2023-01-30 01:09:15');
  params:
  - - '2023-01-27 11:26:38'
    - '2023-01-30 01:09:15'
  - Krs Paderborn
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Essen' WHERE f.timestamp BETWEEN TIMESTAMP('2023-09-19 02:42:32') AND TIMESTAMP('2023-09-21 02:33:15') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-09-19 02:42:32'
    - '2023-09-21 02:33:15'
  - Krs Essen
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Iserlohn' AND f.timestamp BETWEEN TIMESTAMP('2023-10-02 09:01:27') AND TIMESTAMP('2023-10-06 10:48:05') AND f.altitude < 840 GROUP BY g.name, f.flightid;
  params:
  - - '2023-10-02 09:01:27'
    - '2023-10-06 10:48:05'
  - Gem Iserlohn
  - 840
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Soest' WHERE f.timestamp BETWEEN TIMESTAMP('2023-06-14 16:42:17') AND TIMESTAMP('2023-06-15 00:00:37') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-06-14 16:42:17'
    - '2023-06-15 00:00:37'
  - Krs Soest
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Netphen' AND f.timestamp BETWEEN TIMESTAMP('2023-09-19 12:22:58') AND TIMESTAMP('2023-09-29 06:14:27') AND f.altitude < 970 GROUP BY g.name, f.flightid;
  params:
  - - '2023-09-19 12:22:58'
    - '2023-09-29 06:14:27'
  - Gem Netphen
  - 970
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Hagen' WHERE f.timestamp BETWEEN TIMESTAMP('2023-12-25 07:55:12') AND TIMESTAMP('2023-12-26 01:49:39') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-12-25 07:55:12'
    - '2023-12-26 01:49:39'
  - Krs Hagen
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Rhein-Sieg-Kreis' WHERE f.timestamp BETWEEN TIMESTAMP('2023-02-05 06:49:25') AND TIMESTAMP('2023-02-06 10:04:27') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-02-05 06:49:25'
    - '2023-02-06 10:04:27'
  - Krs Rhein-Sieg-Kreis
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.2572208341648625e-05) WHERE c.name = 'Erkrath' AND f.timestamp BETWEEN TIMESTAMP('2023-04-22 11:12:25') AND TIMESTAMP('2023-05-07 07:10:15');
  params:
  - - '2023-04-22 11:12:25'
    - '2023-05-07 07:10:15'
  - Erkrath
  - 1.2572208341648625e-05
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-11-18 18:26:00' GROUP BY b.name;
  params:
  - '2023-11-18 18:26:00'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-05-15 02:09:08' GROUP BY b.name;
  params:
  - '2023-05-15 02:09:08'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Moenchengladbach' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-10-31 20:12:32') AND TIMESTAMP('2023-11-11 03:27:33');
  params:
  - - '2023-10-31 20:12:32'
    - '2023-11-11 03:27:33'
  - Krs Moenchengladbach
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Olpe' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-04-25 09:04:54') AND TIMESTAMP('2023-05-05 05:01:37');
  params:
  - - '2023-04-25 09:04:54'
    - '2023-05-05 05:01:37'
  - Krs Olpe
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Rhein-Sieg-Kreis' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-11-29 13:21:59') AND TIMESTAMP('2023-12-07 13:18:35');
  params:
  - - '2023-11-29 13:21:59'
    - '2023-12-07 13:18:35'
  - Krs Rhein-Sieg-Kreis
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.4939130926428047e-05) WHERE c.name = 'Schmallenberg' AND f.timestamp BETWEEN TIMESTAMP('2023-12-16 07:46:39') AND TIMESTAMP('2023-12-24 18:24:59');
  params:
  - - '2023-12-16 07:46:39'
    - '2023-12-24 18:24:59'
  - Schmallenberg
  - 1.4939130926428047e-05
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Hamm' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-04-08 14:56:33') AND TIMESTAMP('2023-04-20 12:04:09');
  params:
  - - '2023-04-08 14:56:33'
    - '2023-04-20 12:04:09'
  - Krs Hamm
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-07-31 06:48:37' GROUP BY b.name;
  params:
  - '2023-07-31 06:48:37'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 9.81803150431616e-06) WHERE c.name = 'Castrop-Rauxel' AND f.timestamp BETWEEN TIMESTAMP('2023-10-11 00:29:20') AND TIMESTAMP('2023-10-16 02:17:53');
  params:
  - - '2023-10-11 00:29:20'
    - '2023-10-16 02:17:53'
  - Castrop-Rauxel
  - 9.81803150431616e-06
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Minden-Luebbecke' WHERE f.timestamp BETWEEN TIMESTAMP('2023-05-29 13:06:32') AND TIMESTAMP('2023-05-31 10:23:46') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-05-29 13:06:32'
    - '2023-05-31 10:23:46'
  - Krs Minden-Luebbecke
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Paderborn' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-09-24 06:13:20') AND TIMESTAMP('2023-10-05 21:17:08');
  params:
  - - '2023-09-24 06:13:20'
    - '2023-10-05 21:17:08'
  - Krs Paderborn
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Koeln' AND f.timestamp BETWEEN TIMESTAMP('2023-11-09 03:11:58') AND TIMESTAMP('2023-11-19 03:41:52') AND f.altitude < 1350 GROUP BY g.name, f.flightid;
  params:
  - - '2023-11-09 03:11:58'
    - '2023-11-19 03:41:52'
  - Gem Koeln
  - 1350
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Lennestadt' AND f.timestamp BETWEEN TIMESTAMP('2023-12-30 11:33:54') AND TIMESTAMP('2023-12-31 23:59:59') AND f.altitude < 700 GROUP BY g.name, f.flightid;
  params:
  - - '2023-12-30 11:33:54'
    - '2023-12-31 23:59:59'
  - Gem Lennestadt
  - 700
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Doerentrup' AND f.timestamp BETWEEN TIMESTAMP('2023-06-18 05:54:28') AND TIMESTAMP('2023-06-24 11:40:40') AND f.altitude < 1500 GROUP BY g.name, f.flightid;
  params:
  - - '2023-06-18 05:54:28'
    - '2023-06-24 11:40:40'
  - Gem Doerentrup
  - 1500
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Bad Honnef' AND f.timestamp BETWEEN TIMESTAMP('2023-12-05 16:09:42') AND TIMESTAMP('2023-12-17 04:59:54') AND f.altitude < 610 GROUP BY g.name, f.flightid;
  params:
  - - '2023-12-05 16:09:42'
    - '2023-12-17 04:59:54'
  - Gem Bad Honnef
  - 610
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.720210042450926e-06) WHERE c.name = 'Nideggen' AND f.timestamp BETWEEN TIMESTAMP('2023-09-04 07:38:10') AND TIMESTAMP('2023-09-14 14:06:41');
  params:
  - - '2023-09-04 07:38:10'
    - '2023-09-14 14:06:41'
  - Nideggen
  - 7.720210042450926e-06
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Soest' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-02-08 08:30:00') AND TIMESTAMP('2023-02-13 22:15:34');
  params:
  - - '2023-02-08 08:30:00'
    - '2023-02-13 22:15:34'
  - Krs Soest
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 8.072739821142533e-06) WHERE c.name = 'Duisburg' AND f.timestamp BETWEEN TIMESTAMP('2023-08-07 13:45:11') AND TIMESTAMP('2023-08-18 03:31:32');
  params:
  - - '2023-08-07 13:45:11'
    - '2023-08-18 03:31:32'
  - Duisburg
  - 8.072739821142533e-06
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 6.060289200482508e-06) WHERE c.name = 'Paderborn' AND f.timestamp BETWEEN TIMESTAMP('2023-03-10 17:32:29') AND TIMESTAMP('2023-03-17 09:05:24');
  params:
  - - '2023-03-10 17:32:29'
    - '2023-03-17 09:05:24'
  - Paderborn
  - 6.060289200482508e-06
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Wachtberg' AND f.timestamp BETWEEN TIMESTAMP('2023-10-05 17:20:35') AND TIMESTAMP('2023-10-08 02:04:08') AND f.altitude < 500 GROUP BY g.name, f.flightid;
  params:
  - - '2023-10-05 17:20:35'
    - '2023-10-08 02:04:08'
  - Gem Wachtberg
  - 500
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Staedteregion Aachen' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-01-16 16:50:31') AND TIMESTAMP('2023-01-23 03:13:36');
  params:
  - - '2023-01-16 16:50:31'
    - '2023-01-23 03:13:36'
  - Krs Staedteregion Aachen
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Dortmund' AND f.timestamp BETWEEN TIMESTAMP('2023-08-06 10:30:25') AND TIMESTAMP('2023-08-15 06:22:35') AND f.altitude < 1000 GROUP BY g.name, f.flightid;
  params:
  - - '2023-08-06 10:30:25'
    - '2023-08-15 06:22:35'
  - Gem Dortmund
  - 1000
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-11-28 10:11:57' GROUP BY b.name;
  params:
  - '2023-11-28 10:11:57'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.0366974701475678e-05) WHERE c.name = 'Castrop-Rauxel' AND f.timestamp BETWEEN TIMESTAMP('2023-04-07 02:38:11') AND TIMESTAMP('2023-04-16 08:26:27');
  params:
  - - '2023-04-07 02:38:11'
    - '2023-04-16 08:26:27'
  - Castrop-Rauxel
  - 1.0366974701475678e-05
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 4.222579415240359e-06) WHERE c.name = 'Kleve' AND f.timestamp BETWEEN TIMESTAMP('2023-12-19 07:32:41') AND TIMESTAMP('2023-12-29 08:29:47');
  params:
  - - '2023-12-19 07:32:41'
    - '2023-12-29 08:29:47'
  - Kleve
  - 4.222579415240359e-06
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Roedinghausen' AND f.timestamp BETWEEN TIMESTAMP('2023-04-28 04:55:36') AND TIMESTAMP('2023-05-03 22:15:44') AND f.altitude < 970 GROUP BY g.name, f.flightid;
  params:
  - - '2023-04-28 04:55:36'
    - '2023-05-03 22:15:44'
  - Gem Roedinghausen
  - 970
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Soest' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-11-20 15:20:41') AND TIMESTAMP('2023-11-30 13:47:21');
  params:
  - - '2023-11-20 15:20:41'
    - '2023-11-30 13:47:21'
  - Krs Soest
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Lengerich' AND f.timestamp BETWEEN TIMESTAMP('2023-01-26 00:38:57') AND TIMESTAMP('2023-02-01 20:45:18') AND f.altitude < 1500 GROUP BY g.name, f.flightid;
  params:
  - - '2023-01-26 00:38:57'
    - '2023-02-01 20:45:18'
  - Gem Lengerich
  - 1500
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.3190579266416781e-05) WHERE c.name = 'Borgholzhausen' AND f.timestamp BETWEEN TIMESTAMP('2023-12-27 01:50:39') AND TIMESTAMP('2023-12-31 18:33:35');
  params:
  - - '2023-12-27 01:50:39'
    - '2023-12-31 18:33:35'
  - Borgholzhausen
  - 1.3190579266416781e-05
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-03-26 05:48:39' GROUP BY b.name;
  params:
  - '2023-03-26 05:48:39'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.557493400104431e-06) WHERE c.name = 'Bad Driburg' AND f.timestamp BETWEEN TIMESTAMP('2023-10-24 00:36:02') AND TIMESTAMP('2023-10-27 22:14:36');
  params:
  - - '2023-10-24 00:36:02'
    - '2023-10-27 22:14:36'
  - Bad Driburg
  - 7.557493400104431e-06
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-04-09 16:54:00' GROUP BY b.name;
  params:
  - '2023-04-09 16:54:00'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Heinsberg' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-02-10 06:33:06') AND TIMESTAMP('2023-02-15 03:09:43');
  params:
  - - '2023-02-10 06:33:06'
    - '2023-02-15 03:09:43'
  - Krs Heinsberg
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Erkrath' AND f.timestamp BETWEEN TIMESTAMP('2023-10-21 20:32:00') AND TIMESTAMP('2023-10-28 14:33:57') AND f.altitude < 900 GROUP BY g.name, f.flightid;
  params:
  - - '2023-10-21 20:32:00'
    - '2023-10-28 14:33:57'
  - Gem Erkrath
  - 900
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 9.589689064735544e-06) WHERE c.name = 'Krefeld' AND f.timestamp BETWEEN TIMESTAMP('2023-06-23 04:48:25') AND TIMESTAMP('2023-06-30 07:14:55');
  params:
  - - '2023-06-23 04:48:25'
    - '2023-06-30 07:14:55'
  - Krefeld
  - 9.589689064735544e-06
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-09-08 06:14:17' GROUP BY b.name;
  params:
  - '2023-09-08 06:14:17'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.919646146116138e-06) WHERE c.name = 'Hueckelhoven' AND f.timestamp BETWEEN TIMESTAMP('2023-12-08 07:54:55') AND TIMESTAMP('2023-12-21 08:57:01');
  params:
  - - '2023-12-08 07:54:55'
    - '2023-12-21 08:57:01'
  - Hueckelhoven
  - 7.919646146116138e-06
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-07-29 04:59:12' GROUP BY b.name;
  params:
  - '2023-07-29 04:59:12'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-04-23 18:01:09' GROUP BY b.name;
  params:
  - '2023-04-23 18:01:09'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Marienheide' AND f.timestamp BETWEEN TIMESTAMP('2023-07-07 02:12:52') AND TIMESTAMP('2023-07-16 17:11:29') AND f.altitude < 1380 GROUP BY g.name, f.flightid;
  params:
  - - '2023-07-07 02:12:52'
    - '2023-07-16 17:11:29'
  - Gem Marienheide
  - 1380
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Maerkischer Kreis' WHERE f.timestamp BETWEEN TIMESTAMP('2023-05-24 11:17:39') AND TIMESTAMP('2023-05-25 13:08:26') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-05-24 11:17:39'
    - '2023-05-25 13:08:26'
  - Krs Maerkischer Kreis
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Dortmund' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-10-01 03:41:49') AND TIMESTAMP('2023-10-03 18:00:58');
  params:
  - - '2023-10-01 03:41:49'
    - '2023-10-03 18:00:58'
  - Krs Dortmund
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-02-10 13:40:07' GROUP BY b.name;
  params:
  - '2023-02-10 13:40:07'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Hellenthal' AND f.timestamp BETWEEN TIMESTAMP('2023-09-05 11:24:44') AND TIMESTAMP('2023-09-15 13:31:19') AND f.altitude < 1370 GROUP BY g.name, f.flightid;
  params:
  - - '2023-09-05 11:24:44'
    - '2023-09-15 13:31:19'
  - Gem Hellenthal
  - 1370
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 9.79082037546225e-06) WHERE c.name = 'Meschede' AND f.timestamp BETWEEN TIMESTAMP('2023-07-18 10:56:10') AND TIMESTAMP('2023-07-25 10:32:00');
  params:
  - - '2023-07-18 10:56:10'
    - '2023-07-25 10:32:00'
  - Meschede
  - 9.79082037546225e-06
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-07-02 20:24:00' GROUP BY b.name;
  params:
  - '2023-07-02 20:24:00'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Meschede' AND f.timestamp BETWEEN TIMESTAMP('2023-02-11 11:28:25') AND TIMESTAMP('2023-02-17 20:12:10') AND f.altitude < 520 GROUP BY g.name, f.flightid;
  params:
  - - '2023-02-11 11:28:25'
    - '2023-02-17 20:12:10'
  - Gem Meschede
  - 520
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Oberbergischer Kreis' WHERE f.timestamp BETWEEN TIMESTAMP('2023-06-18 00:13:13') AND TIMESTAMP('2023-06-19 13:41:09') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-06-18 00:13:13'
    - '2023-06-19 13:41:09'
  - Krs Oberbergischer Kreis
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-03-09 06:24:03' GROUP BY b.name;
  params:
  - '2023-03-09 06:24:03'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.249486320179533e-05) WHERE c.name = 'Lage' AND f.timestamp BETWEEN TIMESTAMP('2023-06-30 01:40:08') AND TIMESTAMP('2023-07-11 05:45:19');
  params:
  - - '2023-06-30 01:40:08'
    - '2023-07-11 05:45:19'
  - Lage
  - 1.249486320179533e-05
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Hoexter' WHERE f.timestamp BETWEEN TIMESTAMP('2023-06-23 08:08:18') AND TIMESTAMP('2023-06-24 19:56:37') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-06-23 08:08:18'
    - '2023-06-24 19:56:37'
  - Krs Hoexter
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Soest' AND f.timestamp BETWEEN TIMESTAMP('2023-05-30 13:39:25') AND TIMESTAMP('2023-06-08 02:08:02') AND f.altitude < 1300 GROUP BY g.name, f.flightid;
  params:
  - - '2023-05-30 13:39:25'
    - '2023-06-08 02:08:02'
  - Gem Soest
  - 1300
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 9.205139943429103e-06) WHERE c.name = 'Haltern am See' AND f.timestamp BETWEEN TIMESTAMP('2023-09-15 07:57:56') AND TIMESTAMP('2023-09-26 02:24:11');
  params:
  - - '2023-09-15 07:57:56'
    - '2023-09-26 02:24:11'
  - Haltern am See
  - 9.205139943429103e-06
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Soest' WHERE f.timestamp BETWEEN TIMESTAMP('2023-01-01 11:35:39') AND TIMESTAMP('2023-01-03 03:19:14') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-01-01 11:35:39'
    - '2023-01-03 03:19:14'
  - Krs Soest
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Maerkischer Kreis' WHERE f.timestamp BETWEEN TIMESTAMP('2023-06-22 23:28:56') AND TIMESTAMP('2023-06-23 00:18:45') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-06-22 23:28:56'
    - '2023-06-23 00:18:45'
  - Krs Maerkischer Kreis
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Koeln' WHERE f.timestamp BETWEEN TIMESTAMP('2023-04-18 10:12:20') AND TIMESTAMP('2023-04-18 17:25:29') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-04-18 10:12:20'
    - '2023-04-18 17:25:29'
  - Krs Koeln
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Erwitte' AND f.timestamp BETWEEN TIMESTAMP('2023-07-03 20:45:32') AND TIMESTAMP('2023-07-12 06:27:49') AND f.altitude < 990 GROUP BY g.name, f.flightid;
  params:
  - - '2023-07-03 20:45:32'
    - '2023-07-12 06:27:49'
  - Gem Erwitte
  - 990
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-12-04 05:17:35' GROUP BY b.name;
  params:
  - '2023-12-04 05:17:35'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-09-08 11:12:02' GROUP BY b.name;
  params:
  - '2023-09-08 11:12:02'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-12-19 22:10:28' GROUP BY b.name;
  params:
  - '2023-12-19 22:10:28'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Welver' AND f.timestamp BETWEEN TIMESTAMP('2023-05-11 02:34:57') AND TIMESTAMP('2023-05-13 06:24:44') AND f.altitude < 1230 GROUP BY g.name, f.flightid;
  params:
  - - '2023-05-11 02:34:57'
    - '2023-05-13 06:24:44'
  - Gem Welver
  - 1230
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Coesfeld' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-02-26 08:03:27') AND TIMESTAMP('2023-03-11 10:21:14');
  params:
  - - '2023-02-26 08:03:27'
    - '2023-03-11 10:21:14'
  - Krs Coesfeld
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.2402024734084212e-05) WHERE c.name = 'Sassenberg' AND f.timestamp BETWEEN TIMESTAMP('2023-04-09 17:54:22') AND TIMESTAMP('2023-04-17 21:19:32');
  params:
  - - '2023-04-09 17:54:22'
    - '2023-04-17 21:19:32'
  - Sassenberg
  - 1.2402024734084212e-05
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Mettmann' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-06-20 17:29:28') AND TIMESTAMP('2023-07-03 20:14:13');
  params:
  - - '2023-06-20 17:29:28'
    - '2023-07-03 20:14:13'
  - Krs Mettmann
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.5413750552719896e-05) WHERE c.name = 'Halle' AND f.timestamp BETWEEN TIMESTAMP('2023-11-14 01:37:38') AND TIMESTAMP('2023-11-27 04:30:34');
  params:
  - - '2023-11-14 01:37:38'
    - '2023-11-27 04:30:34'
  - Halle
  - 1.5413750552719896e-05
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-06-12 11:09:56' GROUP BY b.name;
  params:
  - '2023-06-12 11:09:56'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Kirchhundem' AND f.timestamp BETWEEN TIMESTAMP('2023-01-13 12:07:57') AND TIMESTAMP('2023-01-15 18:15:34') AND f.altitude < 590 GROUP BY g.name, f.flightid;
  params:
  - - '2023-01-13 12:07:57'
    - '2023-01-15 18:15:34'
  - Gem Kirchhundem
  - 590
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.09079408195546e-06) WHERE c.name = 'Hamminkeln' AND f.timestamp BETWEEN TIMESTAMP('2023-09-19 12:41:41') AND TIMESTAMP('2023-10-04 03:52:50');
  params:
  - - '2023-09-19 12:41:41'
    - '2023-10-04 03:52:50'
  - Hamminkeln
  - 7.09079408195546e-06
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Hagen' WHERE f.timestamp BETWEEN TIMESTAMP('2023-08-15 08:33:36') AND TIMESTAMP('2023-08-15 17:50:24') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-08-15 08:33:36'
    - '2023-08-15 17:50:24'
  - Krs Hagen
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Viersen' WHERE f.timestamp BETWEEN TIMESTAMP('2023-10-06 01:17:22') AND TIMESTAMP('2023-10-07 07:06:30') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-10-06 01:17:22'
    - '2023-10-07 07:06:30'
  - Krs Viersen
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-12-19 21:33:26' GROUP BY b.name;
  params:
  - '2023-12-19 21:33:26'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 5.839213199288191e-06) WHERE c.name = 'Sendenhorst' AND f.timestamp BETWEEN TIMESTAMP('2023-02-17 08:32:29') AND TIMESTAMP('2023-02-20 09:56:15');
  params:
  - - '2023-02-17 08:32:29'
    - '2023-02-20 09:56:15'
  - Sendenhorst
  - 5.839213199288191e-06
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.679745701528134e-06) WHERE c.name = 'Muelheim an der Ruhr' AND f.timestamp BETWEEN TIMESTAMP('2023-10-05 10:37:11') AND TIMESTAMP('2023-10-17 06:36:21');
  params:
  - - '2023-10-05 10:37:11'
    - '2023-10-17 06:36:21'
  - Muelheim an der Ruhr
  - 7.679745701528134e-06
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Duesseldorf' WHERE f.timestamp BETWEEN TIMESTAMP('2023-10-22 20:03:23') AND TIMESTAMP('2023-10-24 00:04:09') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-10-22 20:03:23'
    - '2023-10-24 00:04:09'
  - Krs Duesseldorf
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Lippe' WHERE f.timestamp BETWEEN TIMESTAMP('2023-08-07 13:40:17') AND TIMESTAMP('2023-08-09 09:41:40') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-08-07 13:40:17'
    - '2023-08-09 09:41:40'
  - Krs Lippe
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Neunkirchen-Seelscheid' AND f.timestamp BETWEEN TIMESTAMP('2023-08-20 01:03:27') AND TIMESTAMP('2023-08-26 21:24:52') AND f.altitude < 1300 GROUP BY g.name, f.flightid;
  params:
  - - '2023-08-20 01:03:27'
    - '2023-08-26 21:24:52'
  - Gem Neunkirchen-Seelscheid
  - 1300
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-01-19 08:57:14' GROUP BY b.name;
  params:
  - '2023-01-19 08:57:14'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Recklinghausen' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-11-30 00:33:50') AND TIMESTAMP('2023-12-14 00:55:46');
  params:
  - - '2023-11-30 00:33:50'
    - '2023-12-14 00:55:46'
  - Krs Recklinghausen
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-10-31 16:26:59' GROUP BY b.name;
  params:
  - '2023-10-31 16:26:59'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3.8008537108336557e-06) WHERE c.name = 'Hilchenbach' AND f.timestamp BETWEEN TIMESTAMP('2023-10-04 18:56:45') AND TIMESTAMP('2023-10-15 23:23:27');
  params:
  - - '2023-10-04 18:56:45'
    - '2023-10-15 23:23:27'
  - Hilchenbach
  - 3.8008537108336557e-06
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Recklinghausen' WHERE f.timestamp BETWEEN TIMESTAMP('2023-10-15 12:17:29') AND TIMESTAMP('2023-10-15 23:14:26') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-10-15 12:17:29'
    - '2023-10-15 23:14:26'
  - Krs Recklinghausen
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Krefeld' WHERE f.timestamp BETWEEN TIMESTAMP('2023-09-14 07:27:07') AND TIMESTAMP('2023-09-16 07:00:41') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-09-14 07:27:07'
    - '2023-09-16 07:00:41'
  - Krs Krefeld
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Unna' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-12-23 21:41:32') AND TIMESTAMP('2023-12-31 23:59:59');
  params:
  - - '2023-12-23 21:41:32'
    - '2023-12-31 23:59:59'
  - Krs Unna
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Moehnesee' AND f.timestamp BETWEEN TIMESTAMP('2023-05-07 18:01:43') AND TIMESTAMP('2023-05-16 23:28:42') AND f.altitude < 810 GROUP BY g.name, f.flightid;
  params:
  - - '2023-05-07 18:01:43'
    - '2023-05-16 23:28:42'
  - Gem Moehnesee
  - 810
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-03-19 13:50:52' GROUP BY b.name;
  params:
  - '2023-03-19 13:50:52'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3.2143674930471897e-06) WHERE c.name = 'Porta Westfalica' AND f.timestamp BETWEEN TIMESTAMP('2023-11-19 07:43:54') AND TIMESTAMP('2023-11-24 11:56:48');
  params:
  - - '2023-11-19 07:43:54'
    - '2023-11-24 11:56:48'
  - Porta Westfalica
  - 3.2143674930471897e-06
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Loehne' AND f.timestamp BETWEEN TIMESTAMP('2023-11-24 22:29:49') AND TIMESTAMP('2023-12-02 14:07:09') AND f.altitude < 560 GROUP BY g.name, f.flightid;
  params:
  - - '2023-11-24 22:29:49'
    - '2023-12-02 14:07:09'
  - Gem Loehne
  - 560
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-03-03 17:40:40' GROUP BY b.name;
  params:
  - '2023-03-03 17:40:40'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Olpe' WHERE f.timestamp BETWEEN TIMESTAMP('2023-05-11 07:07:48') AND TIMESTAMP('2023-05-12 08:34:53') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-05-11 07:07:48'
    - '2023-05-12 08:34:53'
  - Krs Olpe
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-03-21 00:51:53' GROUP BY b.name;
  params:
  - '2023-03-21 00:51:53'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 5.29412564719243e-06) WHERE c.name = 'Rhede' AND f.timestamp BETWEEN TIMESTAMP('2023-02-27 05:13:09') AND TIMESTAMP('2023-03-02 04:12:40');
  params:
  - - '2023-02-27 05:13:09'
    - '2023-03-02 04:12:40'
  - Rhede
  - 5.29412564719243e-06
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Hilden' AND f.timestamp BETWEEN TIMESTAMP('2023-10-07 02:05:04') AND TIMESTAMP('2023-10-11 01:52:29') AND f.altitude < 1450 GROUP BY g.name, f.flightid;
  params:
  - - '2023-10-07 02:05:04'
    - '2023-10-11 01:52:29'
  - Gem Hilden
  - 1450
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-07-04 14:01:05' GROUP BY b.name;
  params:
  - '2023-07-04 14:01:05'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Hochsauerlandkreis' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-07-05 02:45:21') AND TIMESTAMP('2023-07-09 19:35:22');
  params:
  - - '2023-07-05 02:45:21'
    - '2023-07-09 19:35:22'
  - Krs Hochsauerlandkreis
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Hochsauerlandkreis' WHERE f.timestamp BETWEEN TIMESTAMP('2023-12-09 19:20:48') AND TIMESTAMP('2023-12-09 22:27:49') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-12-09 19:20:48'
    - '2023-12-09 22:27:49'
  - Krs Hochsauerlandkreis
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Duesseldorf' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-07-24 19:13:08') AND TIMESTAMP('2023-08-06 00:00:20');
  params:
  - - '2023-07-24 19:13:08'
    - '2023-08-06 00:00:20'
  - Krs Duesseldorf
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-05-04 00:21:21' GROUP BY b.name;
  params:
  - '2023-05-04 00:21:21'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-10-24 16:16:21' GROUP BY b.name;
  params:
  - '2023-10-24 16:16:21'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Much' AND f.timestamp BETWEEN TIMESTAMP('2023-11-22 03:22:57') AND TIMESTAMP('2023-12-03 15:45:13') AND f.altitude < 960 GROUP BY g.name, f.flightid;
  params:
  - - '2023-11-22 03:22:57'
    - '2023-12-03 15:45:13'
  - Gem Much
  - 960
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-04-19 16:03:02' GROUP BY b.name;
  params:
  - '2023-04-19 16:03:02'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Bonn' AND f.timestamp BETWEEN TIMESTAMP('2023-06-29 12:47:11') AND TIMESTAMP('2023-07-03 11:33:10') AND f.altitude < 1000 GROUP BY g.name, f.flightid;
  params:
  - - '2023-06-29 12:47:11'
    - '2023-07-03 11:33:10'
  - Gem Bonn
  - 1000
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Minden-Luebbecke' WHERE f.timestamp BETWEEN TIMESTAMP('2023-12-06 22:03:40') AND TIMESTAMP('2023-12-08 16:44:17') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-12-06 22:03:40'
    - '2023-12-08 16:44:17'
  - Krs Minden-Luebbecke
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.1001453807608508e-05) WHERE c.name = 'Sprockhoevel' AND f.timestamp BETWEEN TIMESTAMP('2023-11-11 01:25:54') AND TIMESTAMP('2023-11-18 09:32:40');
  params:
  - - '2023-11-11 01:25:54'
    - '2023-11-18 09:32:40'
  - Sprockhoevel
  - 1.1001453807608508e-05
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 4.421395205885443e-06) WHERE c.name = 'Gronau' AND f.timestamp BETWEEN TIMESTAMP('2023-11-16 09:10:31') AND TIMESTAMP('2023-12-01 08:38:47');
  params:
  - - '2023-11-16 09:10:31'
    - '2023-12-01 08:38:47'
  - Gronau
  - 4.421395205885443e-06
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-07-12 19:33:32' GROUP BY b.name;
  params:
  - '2023-07-12 19:33:32'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-02-22 03:19:38' GROUP BY b.name;
  params:
  - '2023-02-22 03:19:38'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.1766425022533765e-05) WHERE c.name = 'Lemgo' AND f.timestamp BETWEEN TIMESTAMP('2023-04-10 00:20:41') AND TIMESTAMP('2023-04-16 23:37:30');
  params:
  - - '2023-04-10 00:20:41'
    - '2023-04-16 23:37:30'
  - Lemgo
  - 1.1766425022533765e-05
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 4.755954278429255e-06) WHERE c.name = 'Luegde' AND f.timestamp BETWEEN TIMESTAMP('2023-05-23 22:58:33') AND TIMESTAMP('2023-05-28 07:40:48');
  params:
  - - '2023-05-23 22:58:33'
    - '2023-05-28 07:40:48'
  - Luegde
  - 4.755954278429255e-06
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Duesseldorf' WHERE f.timestamp BETWEEN TIMESTAMP('2023-02-12 10:27:28') AND TIMESTAMP('2023-02-13 20:15:30') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-02-12 10:27:28'
    - '2023-02-13 20:15:30'
  - Krs Duesseldorf
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Nuembrecht' AND f.timestamp BETWEEN TIMESTAMP('2023-08-29 14:27:54') AND TIMESTAMP('2023-09-06 11:45:16') AND f.altitude < 1270 GROUP BY g.name, f.flightid;
  params:
  - - '2023-08-29 14:27:54'
    - '2023-09-06 11:45:16'
  - Gem Nuembrecht
  - 1270
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-10-28 06:37:47' GROUP BY b.name;
  params:
  - '2023-10-28 06:37:47'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Luedenscheid' AND f.timestamp BETWEEN TIMESTAMP('2023-05-29 12:44:12') AND TIMESTAMP('2023-06-03 13:58:23') AND f.altitude < 1120 GROUP BY g.name, f.flightid;
  params:
  - - '2023-05-29 12:44:12'
    - '2023-06-03 13:58:23'
  - Gem Luedenscheid
  - 1120
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Koenigswinter' AND f.timestamp BETWEEN TIMESTAMP('2023-06-28 07:53:48') AND TIMESTAMP('2023-07-04 15:01:28') AND f.altitude < 980 GROUP BY g.name, f.flightid;
  params:
  - - '2023-06-28 07:53:48'
    - '2023-07-04 15:01:28'
  - Gem Koenigswinter
  - 980
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Lippetal' AND f.timestamp BETWEEN TIMESTAMP('2023-02-16 18:24:39') AND TIMESTAMP('2023-02-25 05:08:05') AND f.altitude < 950 GROUP BY g.name, f.flightid;
  params:
  - - '2023-02-16 18:24:39'
    - '2023-02-25 05:08:05'
  - Gem Lippetal
  - 950
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 4.826688269482137e-06) WHERE c.name = 'Emmerich' AND f.timestamp BETWEEN TIMESTAMP('2023-03-18 11:13:07') AND TIMESTAMP('2023-04-02 10:37:14');
  params:
  - - '2023-03-18 11:13:07'
    - '2023-04-02 10:37:14'
  - Emmerich
  - 4.826688269482137e-06
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Viersen' WHERE f.timestamp BETWEEN TIMESTAMP('2023-04-03 20:01:33') AND TIMESTAMP('2023-04-05 08:25:44') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-04-03 20:01:33'
    - '2023-04-05 08:25:44'
  - Krs Viersen
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 8.483419724517468e-06) WHERE c.name = 'Hallenberg' AND f.timestamp BETWEEN TIMESTAMP('2023-11-30 04:00:55') AND TIMESTAMP('2023-12-14 23:04:45');
  params:
  - - '2023-11-30 04:00:55'
    - '2023-12-14 23:04:45'
  - Hallenberg
  - 8.483419724517468e-06
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Waldfeucht' AND f.timestamp BETWEEN TIMESTAMP('2023-02-08 08:02:56') AND TIMESTAMP('2023-02-21 22:48:22') AND f.altitude < 1360 GROUP BY g.name, f.flightid;
  params:
  - - '2023-02-08 08:02:56'
    - '2023-02-21 22:48:22'
  - Gem Waldfeucht
  - 1360
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-11-18 18:38:49' GROUP BY b.name;
  params:
  - '2023-11-18 18:38:49'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.026174574995702e-06) WHERE c.name = 'Werl' AND f.timestamp BETWEEN TIMESTAMP('2023-09-29 15:22:34') AND TIMESTAMP('2023-10-10 13:12:50');
  params:
  - - '2023-09-29 15:22:34'
    - '2023-10-10 13:12:50'
  - Werl
  - 7.026174574995702e-06
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Koeln' WHERE f.timestamp BETWEEN TIMESTAMP('2023-02-16 03:16:38') AND TIMESTAMP('2023-02-16 12:12:26') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-02-16 03:16:38'
    - '2023-02-16 12:12:26'
  - Krs Koeln
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Ennepe-Ruhr-Kreis' WHERE f.timestamp BETWEEN TIMESTAMP('2023-08-23 09:41:50') AND TIMESTAMP('2023-08-24 21:21:53') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-08-23 09:41:50'
    - '2023-08-24 21:21:53'
  - Krs Ennepe-Ruhr-Kreis
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-06-29 01:03:36' GROUP BY b.name;
  params:
  - '2023-06-29 01:03:36'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Hochsauerlandkreis' WHERE f.timestamp BETWEEN TIMESTAMP('2023-12-01 23:47:29') AND TIMESTAMP('2023-12-02 22:10:49') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-12-01 23:47:29'
    - '2023-12-02 22:10:49'
  - Krs Hochsauerlandkreis
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-02-01 00:11:24' GROUP BY b.name;
  params:
  - '2023-02-01 00:11:24'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Brilon' AND f.timestamp BETWEEN TIMESTAMP('2023-01-01 00:00:01') AND TIMESTAMP('2023-01-09 16:49:57') AND f.altitude < 1460 GROUP BY g.name, f.flightid;
  params:
  - - '2023-01-01 00:00:01'
    - '2023-01-09 16:49:57'
  - Gem Brilon
  - 1460
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Hochsauerlandkreis' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-06-27 06:49:30') AND TIMESTAMP('2023-07-03 22:46:55');
  params:
  - - '2023-06-27 06:49:30'
    - '2023-07-03 22:46:55'
  - Krs Hochsauerlandkreis
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Bielefeld' WHERE f.timestamp BETWEEN TIMESTAMP('2023-03-30 00:46:25') AND TIMESTAMP('2023-03-30 14:22:07') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-03-30 00:46:25'
    - '2023-03-30 14:22:07'
  - Krs Bielefeld
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-10-11 12:57:03' GROUP BY b.name;
  params:
  - '2023-10-11 12:57:03'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 8.521000705706373e-06) WHERE c.name = 'Euskirchen' AND f.timestamp BETWEEN TIMESTAMP('2023-10-06 05:46:34') AND TIMESTAMP('2023-10-16 22:52:03');
  params:
  - - '2023-10-06 05:46:34'
    - '2023-10-16 22:52:03'
  - Euskirchen
  - 8.521000705706373e-06
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-05-20 00:03:53' GROUP BY b.name;
  params:
  - '2023-05-20 00:03:53'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Muenster' WHERE f.timestamp BETWEEN TIMESTAMP('2023-02-13 08:12:20') AND TIMESTAMP('2023-02-15 07:54:51') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-02-13 08:12:20'
    - '2023-02-15 07:54:51'
  - Krs Muenster
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Mettmann' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-04-30 11:35:01') AND TIMESTAMP('2023-05-10 22:10:22');
  params:
  - - '2023-04-30 11:35:01'
    - '2023-05-10 22:10:22'
  - Krs Mettmann
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Rietberg' AND f.timestamp BETWEEN TIMESTAMP('2023-11-22 18:09:41') AND TIMESTAMP('2023-11-29 16:39:06') AND f.altitude < 1070 GROUP BY g.name, f.flightid;
  params:
  - - '2023-11-22 18:09:41'
    - '2023-11-29 16:39:06'
  - Gem Rietberg
  - 1070
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Hochsauerlandkreis' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-09-04 22:07:18') AND TIMESTAMP('2023-09-17 03:00:40');
  params:
  - - '2023-09-04 22:07:18'
    - '2023-09-17 03:00:40'
  - Krs Hochsauerlandkreis
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Warendorf' WHERE f.timestamp BETWEEN TIMESTAMP('2023-02-16 15:08:42') AND TIMESTAMP('2023-02-18 10:37:32') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-02-16 15:08:42'
    - '2023-02-18 10:37:32'
  - Krs Warendorf
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Blankenheim' AND f.timestamp BETWEEN TIMESTAMP('2023-11-07 20:36:59') AND TIMESTAMP('2023-11-12 16:08:44') AND f.altitude < 1270 GROUP BY g.name, f.flightid;
  params:
  - - '2023-11-07 20:36:59'
    - '2023-11-12 16:08:44'
  - Gem Blankenheim
  - 1270
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.679547553936864e-06) WHERE c.name = 'Hamm' AND f.timestamp BETWEEN TIMESTAMP('2023-07-21 10:08:29') AND TIMESTAMP('2023-07-26 23:30:04');
  params:
  - - '2023-07-21 10:08:29'
    - '2023-07-26 23:30:04'
  - Hamm
  - 7.679547553936864e-06
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Paderborn' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-02-10 04:47:19') AND TIMESTAMP('2023-02-21 13:56:17');
  params:
  - - '2023-02-10 04:47:19'
    - '2023-02-21 13:56:17'
  - Krs Paderborn
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 6.937306175249713e-06) WHERE c.name = 'Guetersloh' AND f.timestamp BETWEEN TIMESTAMP('2023-06-10 17:14:07') AND TIMESTAMP('2023-06-21 01:30:51');
  params:
  - - '2023-06-10 17:14:07'
    - '2023-06-21 01:30:51'
  - Guetersloh
  - 6.937306175249713e-06
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Hochsauerlandkreis' WHERE f.timestamp BETWEEN TIMESTAMP('2023-06-12 07:20:18') AND TIMESTAMP('2023-06-13 05:59:38') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-06-12 07:20:18'
    - '2023-06-13 05:59:38'
  - Krs Hochsauerlandkreis
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Hochsauerlandkreis' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-12-03 12:46:11') AND TIMESTAMP('2023-12-06 19:56:13');
  params:
  - - '2023-12-03 12:46:11'
    - '2023-12-06 19:56:13'
  - Krs Hochsauerlandkreis
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Muenster' WHERE f.timestamp BETWEEN TIMESTAMP('2023-02-07 01:26:30') AND TIMESTAMP('2023-02-08 23:15:51') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-02-07 01:26:30'
    - '2023-02-08 23:15:51'
  - Krs Muenster
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Duisburg' AND f.timestamp BETWEEN TIMESTAMP('2023-04-26 04:19:52') AND TIMESTAMP('2023-04-28 08:19:51') AND f.altitude < 1450 GROUP BY g.name, f.flightid;
  params:
  - - '2023-04-26 04:19:52'
    - '2023-04-28 08:19:51'
  - Gem Duisburg
  - 1450
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Muenster' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-08-20 09:01:34') AND TIMESTAMP('2023-09-02 11:19:03');
  params:
  - - '2023-08-20 09:01:34'
    - '2023-09-02 11:19:03'
  - Krs Muenster
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-08-12 05:20:04' GROUP BY b.name;
  params:
  - '2023-08-12 05:20:04'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Remscheid' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-05-26 09:20:25') AND TIMESTAMP('2023-06-04 03:03:00');
  params:
  - - '2023-05-26 09:20:25'
    - '2023-06-04 03:03:00'
  - Krs Remscheid
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-07-10 07:55:01' GROUP BY b.name;
  params:
  - '2023-07-10 07:55:01'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 8.0110816877628e-06) WHERE c.name = 'Euskirchen' AND f.timestamp BETWEEN TIMESTAMP('2023-12-05 04:03:00') AND TIMESTAMP('2023-12-13 15:39:48');
  params:
  - - '2023-12-05 04:03:00'
    - '2023-12-13 15:39:48'
  - Euskirchen
  - 8.0110816877628e-06
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Heinsberg' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-03-06 17:18:13') AND TIMESTAMP('2023-03-11 19:07:32');
  params:
  - - '2023-03-06 17:18:13'
    - '2023-03-11 19:07:32'
  - Krs Heinsberg
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Maerkischer Kreis' WHERE f.timestamp BETWEEN TIMESTAMP('2023-05-22 14:25:56') AND TIMESTAMP('2023-05-23 10:48:20') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-05-22 14:25:56'
    - '2023-05-23 10:48:20'
  - Krs Maerkischer Kreis
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.4675506702560621e-05) WHERE c.name = 'Oer-Erkenschwick' AND f.timestamp BETWEEN TIMESTAMP('2023-01-10 18:47:16') AND TIMESTAMP('2023-01-19 12:10:50');
  params:
  - - '2023-01-10 18:47:16'
    - '2023-01-19 12:10:50'
  - Oer-Erkenschwick
  - 1.4675506702560621e-05
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-04-05 11:06:28' GROUP BY b.name;
  params:
  - '2023-04-05 11:06:28'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-07-30 14:06:49' GROUP BY b.name;
  params:
  - '2023-07-30 14:06:49'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Dortmund' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-07-05 16:26:20') AND TIMESTAMP('2023-07-14 03:48:38');
  params:
  - - '2023-07-05 16:26:20'
    - '2023-07-14 03:48:38'
  - Krs Dortmund
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-10-11 14:53:55' GROUP BY b.name;
  params:
  - '2023-10-11 14:53:55'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Oberbergischer Kreis' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-04-12 23:45:37') AND TIMESTAMP('2023-04-23 15:12:07');
  params:
  - - '2023-04-12 23:45:37'
    - '2023-04-23 15:12:07'
  - Krs Oberbergischer Kreis
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Siegen-Wittgenstein' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-02-22 06:21:32') AND TIMESTAMP('2023-02-25 03:52:22');
  params:
  - - '2023-02-22 06:21:32'
    - '2023-02-25 03:52:22'
  - Krs Siegen-Wittgenstein
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Coesfeld' WHERE f.timestamp BETWEEN TIMESTAMP('2023-03-27 10:09:54') AND TIMESTAMP('2023-03-28 00:20:51') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-03-27 10:09:54'
    - '2023-03-28 00:20:51'
  - Krs Coesfeld
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 9.906834372447161e-06) WHERE c.name = 'Detmold' AND f.timestamp BETWEEN TIMESTAMP('2023-07-25 10:10:05') AND TIMESTAMP('2023-07-31 16:50:05');
  params:
  - - '2023-07-25 10:10:05'
    - '2023-07-31 16:50:05'
  - Detmold
  - 9.906834372447161e-06
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-08-01 14:58:17' GROUP BY b.name;
  params:
  - '2023-08-01 14:58:17'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Sundern (Sauerland)' AND f.timestamp BETWEEN TIMESTAMP('2023-02-04 00:39:02') AND TIMESTAMP('2023-02-11 05:52:53') AND f.altitude < 1410 GROUP BY g.name, f.flightid;
  params:
  - - '2023-02-04 00:39:02'
    - '2023-02-11 05:52:53'
  - Gem Sundern (Sauerland)
  - 1410
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Bottrop' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-06-19 19:06:06') AND TIMESTAMP('2023-06-25 00:38:01');
  params:
  - - '2023-06-19 19:06:06'
    - '2023-06-25 00:38:01'
  - Krs Bottrop
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.482085978890196e-05) WHERE c.name = 'Kreuztal' AND f.timestamp BETWEEN TIMESTAMP('2023-04-25 02:32:52') AND TIMESTAMP('2023-05-08 20:18:08');
  params:
  - - '2023-04-25 02:32:52'
    - '2023-05-08 20:18:08'
  - Kreuztal
  - 1.482085978890196e-05
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Paderborn' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-10-08 16:02:03') AND TIMESTAMP('2023-10-23 05:12:49');
  params:
  - - '2023-10-08 16:02:03'
    - '2023-10-23 05:12:49'
  - Krs Paderborn
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Unna' WHERE f.timestamp BETWEEN TIMESTAMP('2023-05-26 11:48:32') AND TIMESTAMP('2023-05-27 14:21:24') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-05-26 11:48:32'
    - '2023-05-27 14:21:24'
  - Krs Unna
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-01-28 14:07:11' GROUP BY b.name;
  params:
  - '2023-01-28 14:07:11'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Plettenberg' AND f.timestamp BETWEEN TIMESTAMP('2023-07-16 12:21:10') AND TIMESTAMP('2023-07-22 22:58:41') AND f.altitude < 1280 GROUP BY g.name, f.flightid;
  params:
  - - '2023-07-16 12:21:10'
    - '2023-07-22 22:58:41'
  - Gem Plettenberg
  - 1280
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Dortmund' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-01-01 00:00:01') AND TIMESTAMP('2023-01-08 08:55:23');
  params:
  - - '2023-01-01 00:00:01'
    - '2023-01-08 08:55:23'
  - Krs Dortmund
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Unna' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-12-30 23:15:24') AND TIMESTAMP('2023-12-31 23:59:59');
  params:
  - - '2023-12-30 23:15:24'
    - '2023-12-31 23:59:59'
  - Krs Unna
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Hoexter' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-05-28 15:51:18') AND TIMESTAMP('2023-06-07 23:47:06');
  params:
  - - '2023-05-28 15:51:18'
    - '2023-06-07 23:47:06'
  - Krs Hoexter
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Warendorf' WHERE f.timestamp BETWEEN TIMESTAMP('2023-10-15 19:41:34') AND TIMESTAMP('2023-10-16 07:46:53') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-10-15 19:41:34'
    - '2023-10-16 07:46:53'
  - Krs Warendorf
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Gelsenkirchen' WHERE f.timestamp BETWEEN TIMESTAMP('2023-11-09 13:02:34') AND TIMESTAMP('2023-11-10 15:32:10') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-11-09 13:02:34'
    - '2023-11-10 15:32:10'
  - Krs Gelsenkirchen
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 5.923772027190447e-06) WHERE c.name = 'Gelsenkirchen' AND f.timestamp BETWEEN TIMESTAMP('2023-04-24 13:07:24') AND TIMESTAMP('2023-05-03 08:54:07');
  params:
  - - '2023-04-24 13:07:24'
    - '2023-05-03 08:54:07'
  - Gelsenkirchen
  - 5.923772027190447e-06
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-11-03 18:56:21' GROUP BY b.name;
  params:
  - '2023-11-03 18:56:21'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Hagen' WHERE f.timestamp BETWEEN TIMESTAMP('2023-12-18 02:42:44') AND TIMESTAMP('2023-12-19 09:25:54') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-12-18 02:42:44'
    - '2023-12-19 09:25:54'
  - Krs Hagen
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-12-22 11:19:54' GROUP BY b.name;
  params:
  - '2023-12-22 11:19:54'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.1863919635014077e-05) WHERE c.name = 'Bad Lippspringe' AND f.timestamp BETWEEN TIMESTAMP('2023-12-23 18:06:12') AND TIMESTAMP('2023-12-31 23:59:59');
  params:
  - - '2023-12-23 18:06:12'
    - '2023-12-31 23:59:59'
  - Bad Lippspringe
  - 1.1863919635014077e-05
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Coesfeld' WHERE f.timestamp BETWEEN TIMESTAMP('2023-05-14 14:34:45') AND TIMESTAMP('2023-05-15 04:27:04') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-05-14 14:34:45'
    - '2023-05-15 04:27:04'
  - Krs Coesfeld
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Breckerfeld' AND f.timestamp BETWEEN TIMESTAMP('2023-11-28 19:21:21') AND TIMESTAMP('2023-12-12 01:59:18') AND f.altitude < 1490 GROUP BY g.name, f.flightid;
  params:
  - - '2023-11-28 19:21:21'
    - '2023-12-12 01:59:18'
  - Gem Breckerfeld
  - 1490
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3.1385355951145207e-06) WHERE c.name = 'Greven' AND f.timestamp BETWEEN TIMESTAMP('2023-03-27 05:14:14') AND TIMESTAMP('2023-04-06 07:17:30');
  params:
  - - '2023-03-27 05:14:14'
    - '2023-04-06 07:17:30'
  - Greven
  - 3.1385355951145207e-06
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Maerkischer Kreis' WHERE f.timestamp BETWEEN TIMESTAMP('2023-02-17 10:47:16') AND TIMESTAMP('2023-02-19 03:39:37') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-02-17 10:47:16'
    - '2023-02-19 03:39:37'
  - Krs Maerkischer Kreis
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-10-24 17:59:55' GROUP BY b.name;
  params:
  - '2023-10-24 17:59:55'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Muenster' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-12-05 12:11:25') AND TIMESTAMP('2023-12-16 06:14:01');
  params:
  - - '2023-12-05 12:11:25'
    - '2023-12-16 06:14:01'
  - Krs Muenster
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Hochsauerlandkreis' WHERE f.timestamp BETWEEN TIMESTAMP('2023-06-06 20:20:26') AND TIMESTAMP('2023-06-07 18:10:26') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-06-06 20:20:26'
    - '2023-06-07 18:10:26'
  - Krs Hochsauerlandkreis
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Hochsauerlandkreis' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-02-14 16:05:51') AND TIMESTAMP('2023-02-21 05:25:06');
  params:
  - - '2023-02-14 16:05:51'
    - '2023-02-21 05:25:06'
  - Krs Hochsauerlandkreis
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Mettmann' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-01-20 17:01:21') AND TIMESTAMP('2023-01-25 22:03:15');
  params:
  - - '2023-01-20 17:01:21'
    - '2023-01-25 22:03:15'
  - Krs Mettmann
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Wesel' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-10-27 18:40:06') AND TIMESTAMP('2023-11-01 18:08:16');
  params:
  - - '2023-10-27 18:40:06'
    - '2023-11-01 18:08:16'
  - Krs Wesel
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-06-29 10:14:12' GROUP BY b.name;
  params:
  - '2023-06-29 10:14:12'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Schermbeck' AND f.timestamp BETWEEN TIMESTAMP('2023-02-12 17:22:04') AND TIMESTAMP('2023-02-16 18:02:24') AND f.altitude < 1130 GROUP BY g.name, f.flightid;
  params:
  - - '2023-02-12 17:22:04'
    - '2023-02-16 18:02:24'
  - Gem Schermbeck
  - 1130
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Solingen' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-08-01 21:37:38') AND TIMESTAMP('2023-08-04 01:26:44');
  params:
  - - '2023-08-01 21:37:38'
    - '2023-08-04 01:26:44'
  - Krs Solingen
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Dortmund' WHERE f.timestamp BETWEEN TIMESTAMP('2023-12-08 19:52:24') AND TIMESTAMP('2023-12-09 05:44:52') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-12-08 19:52:24'
    - '2023-12-09 05:44:52'
  - Krs Dortmund
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Rhein-Sieg-Kreis' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-06-19 03:57:03') AND TIMESTAMP('2023-07-01 11:46:40');
  params:
  - - '2023-06-19 03:57:03'
    - '2023-07-01 11:46:40'
  - Krs Rhein-Sieg-Kreis
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-09-25 03:43:30' GROUP BY b.name;
  params:
  - '2023-09-25 03:43:30'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Kleve' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-11-12 17:34:50') AND TIMESTAMP('2023-11-15 19:58:39');
  params:
  - - '2023-11-12 17:34:50'
    - '2023-11-15 19:58:39'
  - Krs Kleve
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.5232713867916812e-05) WHERE c.name = 'Halver' AND f.timestamp BETWEEN TIMESTAMP('2023-02-24 01:25:07') AND TIMESTAMP('2023-03-03 20:24:12');
  params:
  - - '2023-02-24 01:25:07'
    - '2023-03-03 20:24:12'
  - Halver
  - 1.5232713867916812e-05
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.1060621131497357e-05) WHERE c.name = 'Borgholzhausen' AND f.timestamp BETWEEN TIMESTAMP('2023-04-07 17:02:39') AND TIMESTAMP('2023-04-21 15:38:12');
  params:
  - - '2023-04-07 17:02:39'
    - '2023-04-21 15:38:12'
  - Borgholzhausen
  - 1.1060621131497357e-05
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-09-04 08:42:06' GROUP BY b.name;
  params:
  - '2023-09-04 08:42:06'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Muenster' WHERE f.timestamp BETWEEN TIMESTAMP('2023-01-10 09:28:05') AND TIMESTAMP('2023-01-11 00:29:29') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-01-10 09:28:05'
    - '2023-01-11 00:29:29'
  - Krs Muenster
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.4589611567490364e-05) WHERE c.name = 'Bad Lippspringe' AND f.timestamp BETWEEN TIMESTAMP('2023-12-18 13:23:36') AND TIMESTAMP('2023-12-31 23:59:59');
  params:
  - - '2023-12-18 13:23:36'
    - '2023-12-31 23:59:59'
  - Bad Lippspringe
  - 1.4589611567490364e-05
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.453101983131698e-06) WHERE c.name = 'Petershagen' AND f.timestamp BETWEEN TIMESTAMP('2023-04-06 22:18:16') AND TIMESTAMP('2023-04-18 03:20:46');
  params:
  - - '2023-04-06 22:18:16'
    - '2023-04-18 03:20:46'
  - Petershagen
  - 7.453101983131698e-06
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Guetersloh' AND f.timestamp BETWEEN TIMESTAMP('2023-06-02 00:50:28') AND TIMESTAMP('2023-06-12 14:39:23') AND f.altitude < 1250 GROUP BY g.name, f.flightid;
  params:
  - - '2023-06-02 00:50:28'
    - '2023-06-12 14:39:23'
  - Gem Guetersloh
  - 1250
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Schwerte' AND f.timestamp BETWEEN TIMESTAMP('2023-09-01 14:32:36') AND TIMESTAMP('2023-09-11 12:51:37') AND f.altitude < 1400 GROUP BY g.name, f.flightid;
  params:
  - - '2023-09-01 14:32:36'
    - '2023-09-11 12:51:37'
  - Gem Schwerte
  - 1400
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.996008550285931e-06) WHERE c.name = 'Marienmuenster' AND f.timestamp BETWEEN TIMESTAMP('2023-10-25 07:25:51') AND TIMESTAMP('2023-10-29 13:31:05');
  params:
  - - '2023-10-25 07:25:51'
    - '2023-10-29 13:31:05'
  - Marienmuenster
  - 7.996008550285931e-06
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Hochsauerlandkreis' WHERE f.timestamp BETWEEN TIMESTAMP('2023-01-07 19:17:56') AND TIMESTAMP('2023-01-08 16:46:09') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-01-07 19:17:56'
    - '2023-01-08 16:46:09'
  - Krs Hochsauerlandkreis
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Oberbergischer Kreis' WHERE f.timestamp BETWEEN TIMESTAMP('2023-04-06 14:23:54') AND TIMESTAMP('2023-04-08 08:44:22') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-04-06 14:23:54'
    - '2023-04-08 08:44:22'
  - Krs Oberbergischer Kreis
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-06-14 14:26:12' GROUP BY b.name;
  params:
  - '2023-06-14 14:26:12'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Essen' WHERE f.timestamp BETWEEN TIMESTAMP('2023-12-11 18:38:25') AND TIMESTAMP('2023-12-12 16:27:41') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-12-11 18:38:25'
    - '2023-12-12 16:27:41'
  - Krs Essen
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Bielefeld' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-03-16 14:43:34') AND TIMESTAMP('2023-03-21 07:39:17');
  params:
  - - '2023-03-16 14:43:34'
    - '2023-03-21 07:39:17'
  - Krs Bielefeld
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Rheinisch-Bergischer Kreis' WHERE f.timestamp BETWEEN TIMESTAMP('2023-10-30 07:01:18') AND TIMESTAMP('2023-10-30 12:54:10') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-10-30 07:01:18'
    - '2023-10-30 12:54:10'
  - Krs Rheinisch-Bergischer Kreis
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.0223068299777741e-05) WHERE c.name = 'Hemer' AND f.timestamp BETWEEN TIMESTAMP('2023-09-18 14:43:54') AND TIMESTAMP('2023-09-25 14:02:17');
  params:
  - - '2023-09-18 14:43:54'
    - '2023-09-25 14:02:17'
  - Hemer
  - 1.0223068299777741e-05
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 5.3084326295192096e-06) WHERE c.name = 'Ibbenbueren' AND f.timestamp BETWEEN TIMESTAMP('2023-09-09 04:25:09') AND TIMESTAMP('2023-09-14 12:25:17');
  params:
  - - '2023-09-09 04:25:09'
    - '2023-09-14 12:25:17'
  - Ibbenbueren
  - 5.3084326295192096e-06
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Maerkischer Kreis' WHERE f.timestamp BETWEEN TIMESTAMP('2023-09-18 05:23:40') AND TIMESTAMP('2023-09-18 07:07:18') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-09-18 05:23:40'
    - '2023-09-18 07:07:18'
  - Krs Maerkischer Kreis
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Olpe' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-02-01 00:30:36') AND TIMESTAMP('2023-02-04 07:32:24');
  params:
  - - '2023-02-01 00:30:36'
    - '2023-02-04 07:32:24'
  - Krs Olpe
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 6.060586837832779e-06) WHERE c.name = 'Marsberg' AND f.timestamp BETWEEN TIMESTAMP('2023-07-14 15:57:57') AND TIMESTAMP('2023-07-16 22:35:42');
  params:
  - - '2023-07-14 15:57:57'
    - '2023-07-16 22:35:42'
  - Marsberg
  - 6.060586837832779e-06
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 5.6745602655499065e-06) WHERE c.name = 'Loehne' AND f.timestamp BETWEEN TIMESTAMP('2023-10-06 07:41:36') AND TIMESTAMP('2023-10-12 00:54:20');
  params:
  - - '2023-10-06 07:41:36'
    - '2023-10-12 00:54:20'
  - Loehne
  - 5.6745602655499065e-06
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Bottrop' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-09-17 15:56:28') AND TIMESTAMP('2023-09-20 16:42:17');
  params:
  - - '2023-09-17 15:56:28'
    - '2023-09-20 16:42:17'
  - Krs Bottrop
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Recklinghausen' WHERE f.timestamp BETWEEN TIMESTAMP('2023-09-15 11:27:18') AND TIMESTAMP('2023-09-16 17:35:21') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-09-15 11:27:18'
    - '2023-09-16 17:35:21'
  - Krs Recklinghausen
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Maerkischer Kreis' WHERE f.timestamp BETWEEN TIMESTAMP('2023-01-11 20:53:33') AND TIMESTAMP('2023-01-12 23:24:33') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-01-11 20:53:33'
    - '2023-01-12 23:24:33'
  - Krs Maerkischer Kreis
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Euskirchen' AND f.timestamp BETWEEN TIMESTAMP('2023-05-22 16:57:38') AND TIMESTAMP('2023-05-25 07:12:49') AND f.altitude < 600 GROUP BY g.name, f.flightid;
  params:
  - - '2023-05-22 16:57:38'
    - '2023-05-25 07:12:49'
  - Gem Euskirchen
  - 600
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Wesel' WHERE f.timestamp BETWEEN TIMESTAMP('2023-07-13 17:07:28') AND TIMESTAMP('2023-07-14 00:00:10') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-07-13 17:07:28'
    - '2023-07-14 00:00:10'
  - Krs Wesel
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Unna' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-06-16 01:56:06') AND TIMESTAMP('2023-06-22 08:22:32');
  params:
  - - '2023-06-16 01:56:06'
    - '2023-06-22 08:22:32'
  - Krs Unna
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Hochsauerlandkreis' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-06-02 00:50:41') AND TIMESTAMP('2023-06-13 04:38:46');
  params:
  - - '2023-06-02 00:50:41'
    - '2023-06-13 04:38:46'
  - Krs Hochsauerlandkreis
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Maerkischer Kreis' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-12-22 08:35:24') AND TIMESTAMP('2023-12-25 02:54:44');
  params:
  - - '2023-12-22 08:35:24'
    - '2023-12-25 02:54:44'
  - Krs Maerkischer Kreis
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Maerkischer Kreis' WHERE f.timestamp BETWEEN TIMESTAMP('2023-02-26 02:50:06') AND TIMESTAMP('2023-02-27 19:01:27') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-02-26 02:50:06'
    - '2023-02-27 19:01:27'
  - Krs Maerkischer Kreis
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Dortmund' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-01-12 00:37:46') AND TIMESTAMP('2023-01-22 08:18:40');
  params:
  - - '2023-01-12 00:37:46'
    - '2023-01-22 08:18:40'
  - Krs Dortmund
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Olpe' AND f.timestamp BETWEEN TIMESTAMP('2023-09-28 03:32:53') AND TIMESTAMP('2023-10-03 15:50:03') AND f.altitude < 1110 GROUP BY g.name, f.flightid;
  params:
  - - '2023-09-28 03:32:53'
    - '2023-10-03 15:50:03'
  - Gem Olpe
  - 1110
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Schwerte' AND f.timestamp BETWEEN TIMESTAMP('2023-05-02 17:53:18') AND TIMESTAMP('2023-05-07 00:33:09') AND f.altitude < 850 GROUP BY g.name, f.flightid;
  params:
  - - '2023-05-02 17:53:18'
    - '2023-05-07 00:33:09'
  - Gem Schwerte
  - 850
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Rhein-Erft-Kreis' WHERE f.timestamp BETWEEN TIMESTAMP('2023-06-28 19:21:28') AND TIMESTAMP('2023-06-30 13:11:33') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-06-28 19:21:28'
    - '2023-06-30 13:11:33'
  - Krs Rhein-Erft-Kreis
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Rees' AND f.timestamp BETWEEN TIMESTAMP('2023-06-07 11:13:05') AND TIMESTAMP('2023-06-17 23:03:28') AND f.altitude < 660 GROUP BY g.name, f.flightid;
  params:
  - - '2023-06-07 11:13:05'
    - '2023-06-17 23:03:28'
  - Gem Rees
  - 660
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Hamm' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-12-11 20:51:30') AND TIMESTAMP('2023-12-15 05:36:17');
  params:
  - - '2023-12-11 20:51:30'
    - '2023-12-15 05:36:17'
  - Krs Hamm
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Soest' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-07-20 11:45:11') AND TIMESTAMP('2023-07-27 22:40:53');
  params:
  - - '2023-07-20 11:45:11'
    - '2023-07-27 22:40:53'
  - Krs Soest
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-06-25 09:35:31' GROUP BY b.name;
  params:
  - '2023-06-25 09:35:31'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Viersen' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-06-30 01:20:34') AND TIMESTAMP('2023-07-04 16:24:50');
  params:
  - - '2023-06-30 01:20:34'
    - '2023-07-04 16:24:50'
  - Krs Viersen
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-07-27 08:44:41' GROUP BY b.name;
  params:
  - '2023-07-27 08:44:41'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-07-02 00:18:37' GROUP BY b.name;
  params:
  - '2023-07-02 00:18:37'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Hamm' WHERE f.timestamp BETWEEN TIMESTAMP('2023-11-01 00:48:39') AND TIMESTAMP('2023-11-01 22:52:51') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-11-01 00:48:39'
    - '2023-11-01 22:52:51'
  - Krs Hamm
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Heimbach' AND f.timestamp BETWEEN TIMESTAMP('2023-10-23 07:26:23') AND TIMESTAMP('2023-11-06 02:07:25') AND f.altitude < 1500 GROUP BY g.name, f.flightid;
  params:
  - - '2023-10-23 07:26:23'
    - '2023-11-06 02:07:25'
  - Gem Heimbach
  - 1500
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 4.666571294500089e-06) WHERE c.name = 'Kierspe' AND f.timestamp BETWEEN TIMESTAMP('2023-06-06 12:56:41') AND TIMESTAMP('2023-06-18 14:33:33');
  params:
  - - '2023-06-06 12:56:41'
    - '2023-06-18 14:33:33'
  - Kierspe
  - 4.666571294500089e-06
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Siegen-Wittgenstein' WHERE f.timestamp BETWEEN TIMESTAMP('2023-06-13 22:19:00') AND TIMESTAMP('2023-06-14 11:47:38') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-06-13 22:19:00'
    - '2023-06-14 11:47:38'
  - Krs Siegen-Wittgenstein
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Warstein' AND f.timestamp BETWEEN TIMESTAMP('2023-05-31 03:08:59') AND TIMESTAMP('2023-06-03 04:19:37') AND f.altitude < 720 GROUP BY g.name, f.flightid;
  params:
  - - '2023-05-31 03:08:59'
    - '2023-06-03 04:19:37'
  - Gem Warstein
  - 720
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Rheinisch-Bergischer Kreis' WHERE f.timestamp BETWEEN TIMESTAMP('2023-08-08 16:46:40') AND TIMESTAMP('2023-08-09 05:26:19') ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-08-08 16:46:40'
    - '2023-08-09 05:26:19'
  - Krs Rheinisch-Bergischer Kreis
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Viersen' AND ST_Intersects(f.geom,k.geom) AND f.timestamp BETWEEN TIMESTAMP('2023-02-01 22:25:33') AND TIMESTAMP('2023-02-15 17:05:24');
  params:
  - - '2023-02-01 22:25:33'
    - '2023-02-15 17:05:24'
  - Krs Viersen
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE ST_Intersects(f.geom,b.geom) AND f.timestamp = '2023-09-05 03:45:13' GROUP BY b.name;
  params:
  - '2023-09-05 03:45:13'
