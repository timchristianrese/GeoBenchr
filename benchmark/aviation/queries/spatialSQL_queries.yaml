- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Duesseldorf' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-02-14 23:34:16' AND '2023-02-18 14:28:18';
  params:
  - - '2023-02-14 23:34:16'
    - '2023-02-18 14:28:18'
  - Krs Duesseldorf
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Maerkischer Kreis' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-09-04 19:01:24' AND '2023-09-17 17:34:02';
  params:
  - - '2023-09-04 19:01:24'
    - '2023-09-17 17:34:02'
  - Krs Maerkischer Kreis
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-11-12 05:43:10' GROUP BY b.name;
  params:
  - '2023-11-12 05:43:10'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Soest' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-09-12 06:46:10' AND '2023-09-19 13:21:34';
  params:
  - - '2023-09-12 06:46:10'
    - '2023-09-19 13:21:34'
  - Krs Soest
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-07-30'::timestamp, DATE '2023-07-30'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Altenbeken' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-07-30'
  - Gem Altenbeken
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-11-19 14:56:32' GROUP BY b.name;
  params:
  - '2023-11-19 14:56:32'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Remscheid' WHERE f.timestamp BETWEEN '2023-06-30 19:27:02' AND '2023-07-02 00:50:49' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-06-30 19:27:02'
    - '2023-07-02 00:50:49'
  - Krs Remscheid
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Wuppertal' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-02-21 06:37:15' AND '2023-03-03 06:41:50';
  params:
  - - '2023-02-21 06:37:15'
    - '2023-03-03 06:41:50'
  - Krs Wuppertal
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-12-27'::timestamp, DATE '2023-12-27'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Ennepetal' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-12-27'
  - Gem Ennepetal
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-03-04 21:25:22' GROUP BY b.name;
  params:
  - '2023-03-04 21:25:22'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 5.893913884029298e-06) WHERE c.name = 'Warburg' AND f.timestamp BETWEEN '2023-09-12 07:05:12' AND '2023-09-20 00:59:42';
  params:
  - - '2023-09-12 07:05:12'
    - '2023-09-20 00:59:42'
  - Warburg
  - 5.893913884029298e-06
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.402039519867146e-05) WHERE c.name = 'Nettetal' AND f.timestamp BETWEEN '2023-10-28 21:08:04' AND '2023-11-12 01:54:34';
  params:
  - - '2023-10-28 21:08:04'
    - '2023-11-12 01:54:34'
  - Nettetal
  - 1.402039519867146e-05
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-06-20'::timestamp, DATE '2023-06-20'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Olfen' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-06-20'
  - Gem Olfen
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-10-01'::timestamp, DATE '2023-10-01'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Hoevelhof' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-10-01'
  - Gem Hoevelhof
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Soest' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-04-28 03:35:08' AND '2023-05-01 12:29:28';
  params:
  - - '2023-04-28 03:35:08'
    - '2023-05-01 12:29:28'
  - Krs Soest
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Minden-Luebbecke' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-01-08 09:46:04' AND '2023-01-17 05:51:30';
  params:
  - - '2023-01-08 09:46:04'
    - '2023-01-17 05:51:30'
  - Krs Minden-Luebbecke
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Olpe' WHERE f.timestamp BETWEEN '2023-06-30 13:23:53' AND '2023-06-30 20:07:06' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-06-30 13:23:53'
    - '2023-06-30 20:07:06'
  - Krs Olpe
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.289638463021194e-06) WHERE c.name = 'Ennepetal' AND f.timestamp BETWEEN '2023-06-30 05:32:45' AND '2023-07-12 23:31:49';
  params:
  - - '2023-06-30 05:32:45'
    - '2023-07-12 23:31:49'
  - Ennepetal
  - 7.289638463021194e-06
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-07-23 01:05:33' GROUP BY b.name;
  params:
  - '2023-07-23 01:05:33'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Haltern am See' AND f.timestamp BETWEEN '2023-10-11 04:29:30' AND '2023-10-23 05:28:48' AND f.altitude < 1440 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-10-11 04:29:30'
    - '2023-10-23 05:28:48'
  - Gem Haltern am See
  - 1440
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Recklinghausen' WHERE f.timestamp BETWEEN '2023-04-21 18:51:06' AND '2023-04-23 15:04:32' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-04-21 18:51:06'
    - '2023-04-23 15:04:32'
  - Krs Recklinghausen
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-08-17 02:10:19' GROUP BY b.name;
  params:
  - '2023-08-17 02:10:19'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Warendorf' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-04-05 14:54:09' AND '2023-04-10 09:24:08';
  params:
  - - '2023-04-05 14:54:09'
    - '2023-04-10 09:24:08'
  - Krs Warendorf
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Ruethen' AND f.timestamp BETWEEN '2023-02-24 21:49:05' AND '2023-02-28 10:50:22' AND f.altitude < 1020 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-02-24 21:49:05'
    - '2023-02-28 10:50:22'
  - Gem Ruethen
  - 1020
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-08-06'::timestamp, DATE '2023-08-06'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Lindlar' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-08-06'
  - Gem Lindlar
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Mettmann' WHERE f.timestamp BETWEEN '2023-10-31 07:25:33' AND '2023-10-31 10:35:10' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-10-31 07:25:33'
    - '2023-10-31 10:35:10'
  - Krs Mettmann
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Wuppertal' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-04-09 13:08:48' AND '2023-04-13 06:08:36';
  params:
  - - '2023-04-09 13:08:48'
    - '2023-04-13 06:08:36'
  - Krs Wuppertal
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Gelsenkirchen' WHERE f.timestamp BETWEEN '2023-09-03 14:24:30' AND '2023-09-03 15:40:35' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-09-03 14:24:30'
    - '2023-09-03 15:40:35'
  - Krs Gelsenkirchen
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Lengerich' AND f.timestamp BETWEEN '2023-04-24 02:13:11' AND '2023-05-07 01:58:03' AND f.altitude < 1080 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-04-24 02:13:11'
    - '2023-05-07 01:58:03'
  - Gem Lengerich
  - 1080
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-11-20'::timestamp, DATE '2023-11-20'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Pulheim' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-11-20'
  - Gem Pulheim
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Recklinghausen' AND f.timestamp BETWEEN '2023-07-05 00:49:43' AND '2023-07-09 22:37:52' AND f.altitude < 1350 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-07-05 00:49:43'
    - '2023-07-09 22:37:52'
  - Gem Recklinghausen
  - 1350
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Lippe' WHERE f.timestamp BETWEEN '2023-02-10 17:54:09' AND '2023-02-11 05:16:31' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-02-10 17:54:09'
    - '2023-02-11 05:16:31'
  - Krs Lippe
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.3408526058471033e-05) WHERE c.name = 'Nideggen' AND f.timestamp BETWEEN '2023-01-01 00:00:01' AND '2023-01-06 00:25:23';
  params:
  - - '2023-01-01 00:00:01'
    - '2023-01-06 00:25:23'
  - Nideggen
  - 1.3408526058471033e-05
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Soest' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-11-20 18:24:46' AND '2023-11-29 00:11:11';
  params:
  - - '2023-11-20 18:24:46'
    - '2023-11-29 00:11:11'
  - Krs Soest
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Nettersheim' AND f.timestamp BETWEEN '2023-01-29 22:35:34' AND '2023-02-13 01:45:07' AND f.altitude < 680 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-01-29 22:35:34'
    - '2023-02-13 01:45:07'
  - Gem Nettersheim
  - 680
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-05-18'::timestamp, DATE '2023-05-18'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Unna' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-05-18'
  - Gem Unna
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Bueren' AND f.timestamp BETWEEN '2023-08-03 17:27:25' AND '2023-08-13 20:21:49' AND f.altitude < 710 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-08-03 17:27:25'
    - '2023-08-13 20:21:49'
  - Gem Bueren
  - 710
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Olpe' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-02-02 18:31:17' AND '2023-02-10 15:50:37';
  params:
  - - '2023-02-02 18:31:17'
    - '2023-02-10 15:50:37'
  - Krs Olpe
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Lippe' WHERE f.timestamp BETWEEN '2023-09-27 20:26:55' AND '2023-09-29 01:01:38' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-09-27 20:26:55'
    - '2023-09-29 01:01:38'
  - Krs Lippe
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Mettmann' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-11-24 00:33:24' AND '2023-11-29 19:56:32';
  params:
  - - '2023-11-24 00:33:24'
    - '2023-11-29 19:56:32'
  - Krs Mettmann
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-03-11 15:27:24' GROUP BY b.name;
  params:
  - '2023-03-11 15:27:24'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 8.811236437282061e-06) WHERE c.name = 'Halle' AND f.timestamp BETWEEN '2023-02-07 18:24:14' AND '2023-02-20 06:25:22';
  params:
  - - '2023-02-07 18:24:14'
    - '2023-02-20 06:25:22'
  - Halle
  - 8.811236437282061e-06
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Borgholzhausen' AND f.timestamp BETWEEN '2023-10-03 18:10:35' AND '2023-10-13 06:21:47' AND f.altitude < 980 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-10-03 18:10:35'
    - '2023-10-13 06:21:47'
  - Gem Borgholzhausen
  - 980
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Menden (Sauerland)' AND f.timestamp BETWEEN '2023-04-26 04:18:20' AND '2023-05-10 13:11:09' AND f.altitude < 1390 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-04-26 04:18:20'
    - '2023-05-10 13:11:09'
  - Gem Menden (Sauerland)
  - 1390
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-10-21'::timestamp, DATE '2023-10-21'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Euskirchen' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-10-21'
  - Gem Euskirchen
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Rhein-Kreis Neuss' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-09-18 01:48:51' AND '2023-09-27 01:08:55';
  params:
  - - '2023-09-18 01:48:51'
    - '2023-09-27 01:08:55'
  - Krs Rhein-Kreis Neuss
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 9.03294335976185e-06) WHERE c.name = 'Castrop-Rauxel' AND f.timestamp BETWEEN '2023-01-06 07:15:40' AND '2023-01-10 21:51:31';
  params:
  - - '2023-01-06 07:15:40'
    - '2023-01-10 21:51:31'
  - Castrop-Rauxel
  - 9.03294335976185e-06
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Lennestadt' AND f.timestamp BETWEEN '2023-03-29 19:21:33' AND '2023-04-08 17:17:47' AND f.altitude < 680 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-03-29 19:21:33'
    - '2023-04-08 17:17:47'
  - Gem Lennestadt
  - 680
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.571836141061434e-06) WHERE c.name = 'Horstmar' AND f.timestamp BETWEEN '2023-02-27 14:31:30' AND '2023-03-10 23:24:26';
  params:
  - - '2023-02-27 14:31:30'
    - '2023-03-10 23:24:26'
  - Horstmar
  - 7.571836141061434e-06
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-10-14'::timestamp, DATE '2023-10-14'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Pulheim' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-10-14'
  - Gem Pulheim
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Hellenthal' AND f.timestamp BETWEEN '2023-05-25 20:15:53' AND '2023-06-07 18:49:14' AND f.altitude < 1470 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-05-25 20:15:53'
    - '2023-06-07 18:49:14'
  - Gem Hellenthal
  - 1470
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Essen' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-01-07 08:17:57' AND '2023-01-12 12:28:18';
  params:
  - - '2023-01-07 08:17:57'
    - '2023-01-12 12:28:18'
  - Krs Essen
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-04-11'::timestamp, DATE '2023-04-11'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Bad Wuennenberg' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-04-11'
  - Gem Bad Wuennenberg
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-07-24 06:42:26' GROUP BY b.name;
  params:
  - '2023-07-24 06:42:26'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Soest' WHERE f.timestamp BETWEEN '2023-07-26 07:09:58' AND '2023-07-27 23:38:27' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-07-26 07:09:58'
    - '2023-07-27 23:38:27'
  - Krs Soest
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Rhein-Erft-Kreis' WHERE f.timestamp BETWEEN '2023-12-11 18:28:00' AND '2023-12-12 16:18:26' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-12-11 18:28:00'
    - '2023-12-12 16:18:26'
  - Krs Rhein-Erft-Kreis
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-01-24 17:07:28' GROUP BY b.name;
  params:
  - '2023-01-24 17:07:28'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Arnsberg' AND f.timestamp BETWEEN '2023-12-07 14:50:00' AND '2023-12-10 18:04:31' AND f.altitude < 550 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-12-07 14:50:00'
    - '2023-12-10 18:04:31'
  - Gem Arnsberg
  - 550
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-07-19'::timestamp, DATE '2023-07-19'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Luedinghausen' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-07-19'
  - Gem Luedinghausen
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Mettmann' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-10-31 00:05:23' AND '2023-11-05 04:03:54';
  params:
  - - '2023-10-31 00:05:23'
    - '2023-11-05 04:03:54'
  - Krs Mettmann
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-04-28'::timestamp, DATE '2023-04-28'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Drensteinfurt' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-04-28'
  - Gem Drensteinfurt
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Hochsauerlandkreis' WHERE f.timestamp BETWEEN '2023-12-13 11:44:31' AND '2023-12-14 22:27:39' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-12-13 11:44:31'
    - '2023-12-14 22:27:39'
  - Krs Hochsauerlandkreis
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Hoexter' WHERE f.timestamp BETWEEN '2023-06-02 15:46:30' AND '2023-06-04 08:29:40' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-06-02 15:46:30'
    - '2023-06-04 08:29:40'
  - Krs Hoexter
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-10-24 13:53:43' GROUP BY b.name;
  params:
  - '2023-10-24 13:53:43'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 5.452940807507658e-06) WHERE c.name = 'Bielefeld' AND f.timestamp BETWEEN '2023-10-05 15:39:16' AND '2023-10-16 07:27:39';
  params:
  - - '2023-10-05 15:39:16'
    - '2023-10-16 07:27:39'
  - Bielefeld
  - 5.452940807507658e-06
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Siegen-Wittgenstein' WHERE f.timestamp BETWEEN '2023-02-26 21:44:56' AND '2023-02-28 18:25:05' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-02-26 21:44:56'
    - '2023-02-28 18:25:05'
  - Krs Siegen-Wittgenstein
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-11-07 23:32:06' GROUP BY b.name;
  params:
  - '2023-11-07 23:32:06'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Meschede' AND f.timestamp BETWEEN '2023-10-21 03:35:35' AND '2023-10-30 18:31:36' AND f.altitude < 540 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-10-21 03:35:35'
    - '2023-10-30 18:31:36'
  - Gem Meschede
  - 540
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Warendorf' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-08-30 06:44:04' AND '2023-09-10 22:22:10';
  params:
  - - '2023-08-30 06:44:04'
    - '2023-09-10 22:22:10'
  - Krs Warendorf
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Kreuztal' AND f.timestamp BETWEEN '2023-05-21 00:34:20' AND '2023-05-27 15:43:05' AND f.altitude < 1350 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-05-21 00:34:20'
    - '2023-05-27 15:43:05'
  - Gem Kreuztal
  - 1350
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.1780682471705128e-05) WHERE c.name = 'Meschede' AND f.timestamp BETWEEN '2023-06-06 16:30:44' AND '2023-06-11 11:19:51';
  params:
  - - '2023-06-06 16:30:44'
    - '2023-06-11 11:19:51'
  - Meschede
  - 1.1780682471705128e-05
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-05-21 10:31:27' GROUP BY b.name;
  params:
  - '2023-05-21 10:31:27'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 4.139608134686815e-06) WHERE c.name = 'Borgholzhausen' AND f.timestamp BETWEEN '2023-06-02 07:30:34' AND '2023-06-05 02:28:01';
  params:
  - - '2023-06-02 07:30:34'
    - '2023-06-05 02:28:01'
  - Borgholzhausen
  - 4.139608134686815e-06
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Ennepe-Ruhr-Kreis' WHERE f.timestamp BETWEEN '2023-06-09 19:00:26' AND '2023-06-11 03:55:18' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-06-09 19:00:26'
    - '2023-06-11 03:55:18'
  - Krs Ennepe-Ruhr-Kreis
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Rheinisch-Bergischer Kreis' WHERE f.timestamp BETWEEN '2023-07-08 19:22:53' AND '2023-07-09 06:45:29' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-07-08 19:22:53'
    - '2023-07-09 06:45:29'
  - Krs Rheinisch-Bergischer Kreis
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-11-14'::timestamp, DATE '2023-11-14'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Kirchlengern' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-11-14'
  - Gem Kirchlengern
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-01-13 17:15:08' GROUP BY b.name;
  params:
  - '2023-01-13 17:15:08'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Soest' WHERE f.timestamp BETWEEN '2023-02-15 16:53:09' AND '2023-02-16 04:18:30' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-02-15 16:53:09'
    - '2023-02-16 04:18:30'
  - Krs Soest
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Euskirchen' WHERE f.timestamp BETWEEN '2023-07-01 10:20:47' AND '2023-07-02 13:36:33' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-07-01 10:20:47'
    - '2023-07-02 13:36:33'
  - Krs Euskirchen
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Salzkotten' AND f.timestamp BETWEEN '2023-09-13 15:22:23' AND '2023-09-17 15:01:08' AND f.altitude < 1160 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-09-13 15:22:23'
    - '2023-09-17 15:01:08'
  - Gem Salzkotten
  - 1160
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-08-31 23:41:09' GROUP BY b.name;
  params:
  - '2023-08-31 23:41:09'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Erwitte' AND f.timestamp BETWEEN '2023-05-22 12:17:59' AND '2023-06-04 09:49:21' AND f.altitude < 1500 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-05-22 12:17:59'
    - '2023-06-04 09:49:21'
  - Gem Erwitte
  - 1500
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Olpe' WHERE f.timestamp BETWEEN '2023-06-08 01:09:47' AND '2023-06-10 00:22:01' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-06-08 01:09:47'
    - '2023-06-10 00:22:01'
  - Krs Olpe
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-12-08 11:20:47' GROUP BY b.name;
  params:
  - '2023-12-08 11:20:47'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-12-01 23:49:44' GROUP BY b.name;
  params:
  - '2023-12-01 23:49:44'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-11-06 02:06:27' GROUP BY b.name;
  params:
  - '2023-11-06 02:06:27'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Maerkischer Kreis' WHERE f.timestamp BETWEEN '2023-12-28 01:09:01' AND '2023-12-29 09:58:30' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-12-28 01:09:01'
    - '2023-12-29 09:58:30'
  - Krs Maerkischer Kreis
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-01-07 07:41:56' GROUP BY b.name;
  params:
  - '2023-01-07 07:41:56'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Meschede' AND f.timestamp BETWEEN '2023-06-09 23:53:43' AND '2023-06-24 18:03:34' AND f.altitude < 1130 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-06-09 23:53:43'
    - '2023-06-24 18:03:34'
  - Gem Meschede
  - 1130
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Guetersloh' WHERE f.timestamp BETWEEN '2023-11-05 12:54:54' AND '2023-11-05 13:23:38' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-11-05 12:54:54'
    - '2023-11-05 13:23:38'
  - Krs Guetersloh
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Paderborn' WHERE f.timestamp BETWEEN '2023-08-15 08:28:37' AND '2023-08-15 10:29:45' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-08-15 08:28:37'
    - '2023-08-15 10:29:45'
  - Krs Paderborn
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.4502537261333928e-05) WHERE c.name = 'Lohmar' AND f.timestamp BETWEEN '2023-03-31 12:05:30' AND '2023-04-10 02:17:10';
  params:
  - - '2023-03-31 12:05:30'
    - '2023-04-10 02:17:10'
  - Lohmar
  - 1.4502537261333928e-05
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-03-31 15:15:23' GROUP BY b.name;
  params:
  - '2023-03-31 15:15:23'
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-02-15'::timestamp, DATE '2023-02-15'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Gummersbach' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-02-15'
  - Gem Gummersbach
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-09-04'::timestamp, DATE '2023-09-04'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Wadersloh' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-09-04'
  - Gem Wadersloh
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Dueren' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-01-26 07:23:10' AND '2023-02-09 15:11:39';
  params:
  - - '2023-01-26 07:23:10'
    - '2023-02-09 15:11:39'
  - Krs Dueren
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-01-23 18:35:59' GROUP BY b.name;
  params:
  - '2023-01-23 18:35:59'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-11-22 04:45:58' GROUP BY b.name;
  params:
  - '2023-11-22 04:45:58'
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-06-03'::timestamp, DATE '2023-06-03'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Werne' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-06-03'
  - Gem Werne
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Nottuln' AND f.timestamp BETWEEN '2023-10-31 15:04:09' AND '2023-11-05 11:42:25' AND f.altitude < 860 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-10-31 15:04:09'
    - '2023-11-05 11:42:25'
  - Gem Nottuln
  - 860
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-08-16'::timestamp, DATE '2023-08-16'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Siegen' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-08-16'
  - Gem Siegen
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-08-25'::timestamp, DATE '2023-08-25'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Ense' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-08-25'
  - Gem Ense
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-08-25'::timestamp, DATE '2023-08-25'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Hamm' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-08-25'
  - Gem Hamm
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Borken' AND f.timestamp BETWEEN '2023-08-12 17:13:16' AND '2023-08-26 09:09:07' AND f.altitude < 610 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-08-12 17:13:16'
    - '2023-08-26 09:09:07'
  - Gem Borken
  - 610
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Staedteregion Aachen' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-03-15 01:50:19' AND '2023-03-22 15:06:16';
  params:
  - - '2023-03-15 01:50:19'
    - '2023-03-22 15:06:16'
  - Krs Staedteregion Aachen
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-05-08'::timestamp, DATE '2023-05-08'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Bad Oeynhausen' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-05-08'
  - Gem Bad Oeynhausen
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Neunkirchen-Seelscheid' AND f.timestamp BETWEEN '2023-02-09 20:16:43' AND '2023-02-22 16:45:46' AND f.altitude < 650 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-02-09 20:16:43'
    - '2023-02-22 16:45:46'
  - Gem Neunkirchen-Seelscheid
  - 650
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.4665135992928996e-05) WHERE c.name = 'Erftstadt' AND f.timestamp BETWEEN '2023-10-13 03:21:11' AND '2023-10-15 11:22:33';
  params:
  - - '2023-10-13 03:21:11'
    - '2023-10-15 11:22:33'
  - Erftstadt
  - 1.4665135992928996e-05
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 6.769008767678631e-06) WHERE c.name = 'Delbrueck' AND f.timestamp BETWEEN '2023-04-15 19:28:46' AND '2023-04-21 17:19:27';
  params:
  - - '2023-04-15 19:28:46'
    - '2023-04-21 17:19:27'
  - Delbrueck
  - 6.769008767678631e-06
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-05-11 17:50:30' GROUP BY b.name;
  params:
  - '2023-05-11 17:50:30'
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-10-01'::timestamp, DATE '2023-10-01'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Vreden' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-10-01'
  - Gem Vreden
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Rhein-Erft-Kreis' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-02-09 23:40:34' AND '2023-02-13 04:17:44';
  params:
  - - '2023-02-09 23:40:34'
    - '2023-02-13 04:17:44'
  - Krs Rhein-Erft-Kreis
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Lippetal' AND f.timestamp BETWEEN '2023-05-07 04:34:38' AND '2023-05-15 05:58:12' AND f.altitude < 880 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-05-07 04:34:38'
    - '2023-05-15 05:58:12'
  - Gem Lippetal
  - 880
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Neuss' AND f.timestamp BETWEEN '2023-12-03 05:37:44' AND '2023-12-08 12:09:20' AND f.altitude < 1220 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-12-03 05:37:44'
    - '2023-12-08 12:09:20'
  - Gem Neuss
  - 1220
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-10-05'::timestamp, DATE '2023-10-05'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Dinslaken' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-10-05'
  - Gem Dinslaken
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Siegen-Wittgenstein' WHERE f.timestamp BETWEEN '2023-07-02 12:10:57' AND '2023-07-04 09:45:00' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-07-02 12:10:57'
    - '2023-07-04 09:45:00'
  - Krs Siegen-Wittgenstein
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Bottrop' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-12-17 05:40:24' AND '2023-12-26 18:54:39';
  params:
  - - '2023-12-17 05:40:24'
    - '2023-12-26 18:54:39'
  - Krs Bottrop
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-01-03'::timestamp, DATE '2023-01-03'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Hattingen' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-01-03'
  - Gem Hattingen
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Rheinisch-Bergischer Kreis' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-03-12 04:49:59' AND '2023-03-16 09:28:24';
  params:
  - - '2023-03-12 04:49:59'
    - '2023-03-16 09:28:24'
  - Krs Rheinisch-Bergischer Kreis
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Remscheid' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-06-26 12:49:30' AND '2023-07-07 05:50:18';
  params:
  - - '2023-06-26 12:49:30'
    - '2023-07-07 05:50:18'
  - Krs Remscheid
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.5488621946310142e-05) WHERE c.name = 'Rheine' AND f.timestamp BETWEEN '2023-07-06 10:55:09' AND '2023-07-12 02:25:22';
  params:
  - - '2023-07-06 10:55:09'
    - '2023-07-12 02:25:22'
  - Rheine
  - 1.5488621946310142e-05
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Uedem' AND f.timestamp BETWEEN '2023-09-17 01:43:35' AND '2023-09-28 19:55:55' AND f.altitude < 1200 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-09-17 01:43:35'
    - '2023-09-28 19:55:55'
  - Gem Uedem
  - 1200
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Wipperfuerth' AND f.timestamp BETWEEN '2023-10-25 17:55:26' AND '2023-10-28 06:19:45' AND f.altitude < 950 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-10-25 17:55:26'
    - '2023-10-28 06:19:45'
  - Gem Wipperfuerth
  - 950
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Lippe' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-06-27 14:38:17' AND '2023-07-09 05:42:58';
  params:
  - - '2023-06-27 14:38:17'
    - '2023-07-09 05:42:58'
  - Krs Lippe
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-11-29 11:50:45' GROUP BY b.name;
  params:
  - '2023-11-29 11:50:45'
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-06-11'::timestamp, DATE '2023-06-11'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Sprockhoevel' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-06-11'
  - Gem Sprockhoevel
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-01-18'::timestamp, DATE '2023-01-18'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Nideggen' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-01-18'
  - Gem Nideggen
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-05-13 09:21:14' GROUP BY b.name;
  params:
  - '2023-05-13 09:21:14'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.4790976706556723e-05) WHERE c.name = 'Sprockhoevel' AND f.timestamp BETWEEN '2023-11-30 15:31:56' AND '2023-12-12 22:27:57';
  params:
  - - '2023-11-30 15:31:56'
    - '2023-12-12 22:27:57'
  - Sprockhoevel
  - 1.4790976706556723e-05
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.1993729968482502e-05) WHERE c.name = 'Duisburg' AND f.timestamp BETWEEN '2023-11-03 19:41:26' AND '2023-11-08 13:05:45';
  params:
  - - '2023-11-03 19:41:26'
    - '2023-11-08 13:05:45'
  - Duisburg
  - 1.1993729968482502e-05
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-09-11'::timestamp, DATE '2023-09-11'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Morsbach' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-09-11'
  - Gem Morsbach
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Brilon' AND f.timestamp BETWEEN '2023-07-04 20:03:55' AND '2023-07-16 05:53:35' AND f.altitude < 1150 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-07-04 20:03:55'
    - '2023-07-16 05:53:35'
  - Gem Brilon
  - 1150
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-12-26 16:28:20' GROUP BY b.name;
  params:
  - '2023-12-26 16:28:20'
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-08-11'::timestamp, DATE '2023-08-11'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Bad Driburg' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-08-11'
  - Gem Bad Driburg
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 9.571828221153142e-06) WHERE c.name = 'Mettmann' AND f.timestamp BETWEEN '2023-02-08 00:16:12' AND '2023-02-22 00:32:59';
  params:
  - - '2023-02-08 00:16:12'
    - '2023-02-22 00:32:59'
  - Mettmann
  - 9.571828221153142e-06
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-03-30 13:31:31' GROUP BY b.name;
  params:
  - '2023-03-30 13:31:31'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-07-16 09:08:09' GROUP BY b.name;
  params:
  - '2023-07-16 09:08:09'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Bielefeld' WHERE f.timestamp BETWEEN '2023-07-09 10:41:18' AND '2023-07-11 06:10:08' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-07-09 10:41:18'
    - '2023-07-11 06:10:08'
  - Krs Bielefeld
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Remscheid' WHERE f.timestamp BETWEEN '2023-05-02 20:47:03' AND '2023-05-04 08:36:07' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-05-02 20:47:03'
    - '2023-05-04 08:36:07'
  - Krs Remscheid
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-08-06 12:36:35' GROUP BY b.name;
  params:
  - '2023-08-06 12:36:35'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Hochsauerlandkreis' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-06-05 13:37:52' AND '2023-06-13 09:42:14';
  params:
  - - '2023-06-05 13:37:52'
    - '2023-06-13 09:42:14'
  - Krs Hochsauerlandkreis
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-11-21'::timestamp, DATE '2023-11-21'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Much' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-11-21'
  - Gem Much
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.046386839648585e-05) WHERE c.name = 'Voerde' AND f.timestamp BETWEEN '2023-03-22 15:04:42' AND '2023-03-24 23:31:09';
  params:
  - - '2023-03-22 15:04:42'
    - '2023-03-24 23:31:09'
  - Voerde
  - 1.046386839648585e-05
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Recklinghausen' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-08-19 00:03:33' AND '2023-08-23 02:19:20';
  params:
  - - '2023-08-19 00:03:33'
    - '2023-08-23 02:19:20'
  - Krs Recklinghausen
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Eitorf' AND f.timestamp BETWEEN '2023-06-29 05:14:29' AND '2023-07-06 23:10:09' AND f.altitude < 710 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-06-29 05:14:29'
    - '2023-07-06 23:10:09'
  - Gem Eitorf
  - 710
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Bottrop' WHERE f.timestamp BETWEEN '2023-01-18 18:11:27' AND '2023-01-19 03:29:29' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-01-18 18:11:27'
    - '2023-01-19 03:29:29'
  - Krs Bottrop
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.3798954889255241e-05) WHERE c.name = 'Rahden' AND f.timestamp BETWEEN '2023-11-14 14:51:32' AND '2023-11-19 23:35:02';
  params:
  - - '2023-11-14 14:51:32'
    - '2023-11-19 23:35:02'
  - Rahden
  - 1.3798954889255241e-05
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Preu?sch Oldendorf' AND f.timestamp BETWEEN '2023-05-16 14:04:13' AND '2023-05-28 08:59:39' AND f.altitude < 1030 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-05-16 14:04:13'
    - '2023-05-28 08:59:39'
  - Gem Preu?sch Oldendorf
  - 1030
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Bielefeld' AND f.timestamp BETWEEN '2023-03-25 12:50:11' AND '2023-04-02 19:01:05' AND f.altitude < 1440 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-03-25 12:50:11'
    - '2023-04-02 19:01:05'
  - Gem Bielefeld
  - 1440
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-10-18'::timestamp, DATE '2023-10-18'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Bergisch Gladbach' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-10-18'
  - Gem Bergisch Gladbach
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Ruethen' AND f.timestamp BETWEEN '2023-05-14 19:32:09' AND '2023-05-27 22:16:01' AND f.altitude < 630 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-05-14 19:32:09'
    - '2023-05-27 22:16:01'
  - Gem Ruethen
  - 630
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-08-23 21:42:15' GROUP BY b.name;
  params:
  - '2023-08-23 21:42:15'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.5177467519901415e-05) WHERE c.name = 'Neukirchen-Vluyn' AND f.timestamp BETWEEN '2023-03-14 14:11:39' AND '2023-03-16 16:02:43';
  params:
  - - '2023-03-14 14:11:39'
    - '2023-03-16 16:02:43'
  - Neukirchen-Vluyn
  - 1.5177467519901415e-05
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-11-14'::timestamp, DATE '2023-11-14'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Iserlohn' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-11-14'
  - Gem Iserlohn
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.468741204014875e-06) WHERE c.name = 'Gummersbach' AND f.timestamp BETWEEN '2023-07-05 08:31:23' AND '2023-07-11 19:13:19';
  params:
  - - '2023-07-05 08:31:23'
    - '2023-07-11 19:13:19'
  - Gummersbach
  - 7.468741204014875e-06
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Koeln' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-12-16 07:07:40' AND '2023-12-20 08:29:58';
  params:
  - - '2023-12-16 07:07:40'
    - '2023-12-20 08:29:58'
  - Krs Koeln
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Netphen' AND f.timestamp BETWEEN '2023-01-13 16:58:48' AND '2023-01-26 15:57:38' AND f.altitude < 670 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-01-13 16:58:48'
    - '2023-01-26 15:57:38'
  - Gem Netphen
  - 670
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Hamm' WHERE f.timestamp BETWEEN '2023-09-26 10:36:09' AND '2023-09-27 22:04:32' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-09-26 10:36:09'
    - '2023-09-27 22:04:32'
  - Krs Hamm
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-08-09 10:08:33' GROUP BY b.name;
  params:
  - '2023-08-09 10:08:33'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Maerkischer Kreis' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-05-24 02:52:20' AND '2023-05-29 13:02:57';
  params:
  - - '2023-05-24 02:52:20'
    - '2023-05-29 13:02:57'
  - Krs Maerkischer Kreis
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Oberbergischer Kreis' WHERE f.timestamp BETWEEN '2023-07-28 08:00:17' AND '2023-07-28 13:31:24' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-07-28 08:00:17'
    - '2023-07-28 13:31:24'
  - Krs Oberbergischer Kreis
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Muenster' WHERE f.timestamp BETWEEN '2023-09-09 18:49:01' AND '2023-09-11 10:21:33' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-09-09 18:49:01'
    - '2023-09-11 10:21:33'
  - Krs Muenster
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Rhein-Erft-Kreis' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-05-03 17:10:09' AND '2023-05-11 02:56:03';
  params:
  - - '2023-05-03 17:10:09'
    - '2023-05-11 02:56:03'
  - Krs Rhein-Erft-Kreis
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Oberbergischer Kreis' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-06-25 07:23:56' AND '2023-07-02 05:52:25';
  params:
  - - '2023-06-25 07:23:56'
    - '2023-07-02 05:52:25'
  - Krs Oberbergischer Kreis
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Unna' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-05-08 12:10:49' AND '2023-05-23 01:38:08';
  params:
  - - '2023-05-08 12:10:49'
    - '2023-05-23 01:38:08'
  - Krs Unna
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Bottrop' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-06-15 17:07:40' AND '2023-06-27 08:24:19';
  params:
  - - '2023-06-15 17:07:40'
    - '2023-06-27 08:24:19'
  - Krs Bottrop
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.872200734659667e-06) WHERE c.name = 'Geldern' AND f.timestamp BETWEEN '2023-03-30 09:50:47' AND '2023-04-06 20:53:12';
  params:
  - - '2023-03-30 09:50:47'
    - '2023-04-06 20:53:12'
  - Geldern
  - 7.872200734659667e-06
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Rheinisch-Bergischer Kreis' WHERE f.timestamp BETWEEN '2023-02-17 13:04:45' AND '2023-02-18 03:40:07' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-02-17 13:04:45'
    - '2023-02-18 03:40:07'
  - Krs Rheinisch-Bergischer Kreis
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Dueren' WHERE f.timestamp BETWEEN '2023-09-22 18:25:47' AND '2023-09-23 03:20:22' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-09-22 18:25:47'
    - '2023-09-23 03:20:22'
  - Krs Dueren
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-03-24 12:34:34' GROUP BY b.name;
  params:
  - '2023-03-24 12:34:34'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Hochsauerlandkreis' WHERE f.timestamp BETWEEN '2023-09-24 13:39:57' AND '2023-09-26 09:22:08' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-09-24 13:39:57'
    - '2023-09-26 09:22:08'
  - Krs Hochsauerlandkreis
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-03-17'::timestamp, DATE '2023-03-17'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Solingen' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-03-17'
  - Gem Solingen
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Leverkusen' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-06-11 22:16:22' AND '2023-06-21 10:50:49';
  params:
  - - '2023-06-11 22:16:22'
    - '2023-06-21 10:50:49'
  - Krs Leverkusen
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Staedteregion Aachen' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-04-26 06:14:30' AND '2023-04-29 16:39:26';
  params:
  - - '2023-04-26 06:14:30'
    - '2023-04-29 16:39:26'
  - Krs Staedteregion Aachen
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Hamm' WHERE f.timestamp BETWEEN '2023-04-10 11:39:39' AND '2023-04-11 22:00:35' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-04-10 11:39:39'
    - '2023-04-11 22:00:35'
  - Krs Hamm
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Rheinisch-Bergischer Kreis' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-11-12 17:49:41' AND '2023-11-22 14:24:36';
  params:
  - - '2023-11-12 17:49:41'
    - '2023-11-22 14:24:36'
  - Krs Rheinisch-Bergischer Kreis
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-06-07'::timestamp, DATE '2023-06-07'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Ruethen' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-06-07'
  - Gem Ruethen
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-07-29 08:45:01' GROUP BY b.name;
  params:
  - '2023-07-29 08:45:01'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Herford' WHERE f.timestamp BETWEEN '2023-11-04 08:17:28' AND '2023-11-05 23:46:13' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-11-04 08:17:28'
    - '2023-11-05 23:46:13'
  - Krs Herford
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Rheinisch-Bergischer Kreis' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-06-20 20:20:57' AND '2023-07-03 00:10:59';
  params:
  - - '2023-06-20 20:20:57'
    - '2023-07-03 00:10:59'
  - Krs Rheinisch-Bergischer Kreis
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-10-18'::timestamp, DATE '2023-10-18'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Issum' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-10-18'
  - Gem Issum
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.509897468612252e-06) WHERE c.name = 'Bergneustadt' AND f.timestamp BETWEEN '2023-02-13 14:05:50' AND '2023-02-25 00:07:25';
  params:
  - - '2023-02-13 14:05:50'
    - '2023-02-25 00:07:25'
  - Bergneustadt
  - 7.509897468612252e-06
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.2376693378564153e-05) WHERE c.name = 'Bad Honnef' AND f.timestamp BETWEEN '2023-03-04 13:17:14' AND '2023-03-18 09:21:10';
  params:
  - - '2023-03-04 13:17:14'
    - '2023-03-18 09:21:10'
  - Bad Honnef
  - 1.2376693378564153e-05
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Soest' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-08-25 08:24:03' AND '2023-09-08 01:27:54';
  params:
  - - '2023-08-25 08:24:03'
    - '2023-09-08 01:27:54'
  - Krs Soest
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-02-05 18:44:03' GROUP BY b.name;
  params:
  - '2023-02-05 18:44:03'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Remscheid' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-08-01 21:41:55' AND '2023-08-06 23:33:23';
  params:
  - - '2023-08-01 21:41:55'
    - '2023-08-06 23:33:23'
  - Krs Remscheid
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-06-03 17:56:41' GROUP BY b.name;
  params:
  - '2023-06-03 17:56:41'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Steinfurt' WHERE f.timestamp BETWEEN '2023-10-07 11:02:36' AND '2023-10-07 17:25:46' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-10-07 11:02:36'
    - '2023-10-07 17:25:46'
  - Krs Steinfurt
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Stolberg (Rhld.)' AND f.timestamp BETWEEN '2023-07-17 22:16:37' AND '2023-07-28 00:03:49' AND f.altitude < 600 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-07-17 22:16:37'
    - '2023-07-28 00:03:49'
  - Gem Stolberg (Rhld.)
  - 600
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 8.870799841558338e-06) WHERE c.name = 'Spenge' AND f.timestamp BETWEEN '2023-07-29 02:07:05' AND '2023-08-10 15:00:34';
  params:
  - - '2023-07-29 02:07:05'
    - '2023-08-10 15:00:34'
  - Spenge
  - 8.870799841558338e-06
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Brilon' AND f.timestamp BETWEEN '2023-11-13 12:55:48' AND '2023-11-27 18:04:56' AND f.altitude < 1400 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-11-13 12:55:48'
    - '2023-11-27 18:04:56'
  - Gem Brilon
  - 1400
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Solingen' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-05-05 00:11:40' AND '2023-05-19 05:30:12';
  params:
  - - '2023-05-05 00:11:40'
    - '2023-05-19 05:30:12'
  - Krs Solingen
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-04-09 07:10:13' GROUP BY b.name;
  params:
  - '2023-04-09 07:10:13'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Heinsberg' AND f.timestamp BETWEEN '2023-09-26 06:08:46' AND '2023-10-03 10:25:07' AND f.altitude < 1330 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-09-26 06:08:46'
    - '2023-10-03 10:25:07'
  - Gem Heinsberg
  - 1330
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-02-17 19:04:15' GROUP BY b.name;
  params:
  - '2023-02-17 19:04:15'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Recklinghausen' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-08-14 01:55:42' AND '2023-08-25 12:44:30';
  params:
  - - '2023-08-14 01:55:42'
    - '2023-08-25 12:44:30'
  - Krs Recklinghausen
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Stolberg (Rhld.)' AND f.timestamp BETWEEN '2023-01-01 00:00:01' AND '2023-01-07 15:17:04' AND f.altitude < 810 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-01-01 00:00:01'
    - '2023-01-07 15:17:04'
  - Gem Stolberg (Rhld.)
  - 810
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-07-13'::timestamp, DATE '2023-07-13'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Wipperfuerth' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-07-13'
  - Gem Wipperfuerth
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Kamp-Lintfort' AND f.timestamp BETWEEN '2023-05-21 14:40:24' AND '2023-06-01 11:59:48' AND f.altitude < 1490 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-05-21 14:40:24'
    - '2023-06-01 11:59:48'
  - Gem Kamp-Lintfort
  - 1490
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 8.35887991932033e-06) WHERE c.name = 'Luedenscheid' AND f.timestamp BETWEEN '2023-03-17 19:23:14' AND '2023-03-20 20:46:53';
  params:
  - - '2023-03-17 19:23:14'
    - '2023-03-20 20:46:53'
  - Luedenscheid
  - 8.35887991932033e-06
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Hoevelhof' AND f.timestamp BETWEEN '2023-04-26 03:55:47' AND '2023-05-05 14:05:06' AND f.altitude < 910 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-04-26 03:55:47'
    - '2023-05-05 14:05:06'
  - Gem Hoevelhof
  - 910
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Hamm' AND f.timestamp BETWEEN '2023-08-23 03:02:04' AND '2023-09-01 07:01:52' AND f.altitude < 1460 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-08-23 03:02:04'
    - '2023-09-01 07:01:52'
  - Gem Hamm
  - 1460
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.5512484510789613e-05) WHERE c.name = 'Ennigerloh' AND f.timestamp BETWEEN '2023-10-20 21:46:05' AND '2023-10-26 13:00:46';
  params:
  - - '2023-10-20 21:46:05'
    - '2023-10-26 13:00:46'
  - Ennigerloh
  - 1.5512484510789613e-05
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.4636458385519748e-05) WHERE c.name = 'Bueren' AND f.timestamp BETWEEN '2023-05-29 21:31:04' AND '2023-06-06 14:42:08';
  params:
  - - '2023-05-29 21:31:04'
    - '2023-06-06 14:42:08'
  - Bueren
  - 1.4636458385519748e-05
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-12-14 18:04:12' GROUP BY b.name;
  params:
  - '2023-12-14 18:04:12'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-02-09 14:53:08' GROUP BY b.name;
  params:
  - '2023-02-09 14:53:08'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.4125903878343345e-05) WHERE c.name = 'Drolshagen' AND f.timestamp BETWEEN '2023-08-28 17:55:10' AND '2023-09-05 23:40:01';
  params:
  - - '2023-08-28 17:55:10'
    - '2023-09-05 23:40:01'
  - Drolshagen
  - 1.4125903878343345e-05
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Rheinisch-Bergischer Kreis' WHERE f.timestamp BETWEEN '2023-09-13 00:47:00' AND '2023-09-14 18:45:20' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-09-13 00:47:00'
    - '2023-09-14 18:45:20'
  - Krs Rheinisch-Bergischer Kreis
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Bielefeld' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-03-08 19:00:53' AND '2023-03-22 18:39:03';
  params:
  - - '2023-03-08 19:00:53'
    - '2023-03-22 18:39:03'
  - Krs Bielefeld
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 4.914770224936562e-06) WHERE c.name = 'Gescher' AND f.timestamp BETWEEN '2023-03-05 21:25:22' AND '2023-03-20 02:48:58';
  params:
  - - '2023-03-05 21:25:22'
    - '2023-03-20 02:48:58'
  - Gescher
  - 4.914770224936562e-06
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Bad Oeynhausen' AND f.timestamp BETWEEN '2023-09-01 17:32:21' AND '2023-09-12 05:36:31' AND f.altitude < 1220 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-09-01 17:32:21'
    - '2023-09-12 05:36:31'
  - Gem Bad Oeynhausen
  - 1220
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Recklinghausen' WHERE f.timestamp BETWEEN '2023-07-06 02:49:31' AND '2023-07-06 10:48:52' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-07-06 02:49:31'
    - '2023-07-06 10:48:52'
  - Krs Recklinghausen
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Staedteregion Aachen' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-07-31 10:44:26' AND '2023-08-11 17:14:48';
  params:
  - - '2023-07-31 10:44:26'
    - '2023-08-11 17:14:48'
  - Krs Staedteregion Aachen
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 9.151624874693724e-06) WHERE c.name = 'Rheinbach' AND f.timestamp BETWEEN '2023-01-08 12:46:33' AND '2023-01-15 10:40:29';
  params:
  - - '2023-01-08 12:46:33'
    - '2023-01-15 10:40:29'
  - Rheinbach
  - 9.151624874693724e-06
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Bonn' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-02-28 01:31:10' AND '2023-03-09 10:53:44';
  params:
  - - '2023-02-28 01:31:10'
    - '2023-03-09 10:53:44'
  - Krs Bonn
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Nideggen' AND f.timestamp BETWEEN '2023-01-01 00:00:01' AND '2023-01-15 00:51:06' AND f.altitude < 1140 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-01-01 00:00:01'
    - '2023-01-15 00:51:06'
  - Gem Nideggen
  - 1140
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Maerkischer Kreis' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-12-13 18:45:41' AND '2023-12-17 03:54:33';
  params:
  - - '2023-12-13 18:45:41'
    - '2023-12-17 03:54:33'
  - Krs Maerkischer Kreis
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 8.173657239077352e-06) WHERE c.name = 'Wuerselen' AND f.timestamp BETWEEN '2023-07-01 13:20:22' AND '2023-07-15 18:40:40';
  params:
  - - '2023-07-01 13:20:22'
    - '2023-07-15 18:40:40'
  - Wuerselen
  - 8.173657239077352e-06
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Wermelskirchen' AND f.timestamp BETWEEN '2023-11-14 17:06:54' AND '2023-11-26 12:40:09' AND f.altitude < 1160 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-11-14 17:06:54'
    - '2023-11-26 12:40:09'
  - Gem Wermelskirchen
  - 1160
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Wuerselen' AND f.timestamp BETWEEN '2023-10-19 01:50:15' AND '2023-10-25 02:18:04' AND f.altitude < 790 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-10-19 01:50:15'
    - '2023-10-25 02:18:04'
  - Gem Wuerselen
  - 790
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Viersen' WHERE f.timestamp BETWEEN '2023-12-02 13:41:48' AND '2023-12-04 12:26:39' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-12-02 13:41:48'
    - '2023-12-04 12:26:39'
  - Krs Viersen
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Minden-Luebbecke' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-01-24 19:41:23' AND '2023-01-28 06:58:32';
  params:
  - - '2023-01-24 19:41:23'
    - '2023-01-28 06:58:32'
  - Krs Minden-Luebbecke
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Hochsauerlandkreis' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-04-22 18:40:41' AND '2023-05-01 06:00:12';
  params:
  - - '2023-04-22 18:40:41'
    - '2023-05-01 06:00:12'
  - Krs Hochsauerlandkreis
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Herford' WHERE f.timestamp BETWEEN '2023-10-18 17:52:28' AND '2023-10-19 12:14:28' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-10-18 17:52:28'
    - '2023-10-19 12:14:28'
  - Krs Herford
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-02-22'::timestamp, DATE '2023-02-22'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Schmallenberg' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-02-22'
  - Gem Schmallenberg
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Hamminkeln' AND f.timestamp BETWEEN '2023-02-28 05:00:36' AND '2023-03-08 18:05:56' AND f.altitude < 710 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-02-28 05:00:36'
    - '2023-03-08 18:05:56'
  - Gem Hamminkeln
  - 710
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-02-16'::timestamp, DATE '2023-02-16'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Versmold' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-02-16'
  - Gem Versmold
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Greven' AND f.timestamp BETWEEN '2023-11-02 22:59:48' AND '2023-11-14 21:37:01' AND f.altitude < 980 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-11-02 22:59:48'
    - '2023-11-14 21:37:01'
  - Gem Greven
  - 980
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-02-05'::timestamp, DATE '2023-02-05'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Blankenheim' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-02-05'
  - Gem Blankenheim
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Guetersloh' WHERE f.timestamp BETWEEN '2023-08-06 07:31:56' AND '2023-08-08 03:00:14' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-08-06 07:31:56'
    - '2023-08-08 03:00:14'
  - Krs Guetersloh
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Heinsberg' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-06-27 09:20:57' AND '2023-07-07 09:46:40';
  params:
  - - '2023-06-27 09:20:57'
    - '2023-07-07 09:46:40'
  - Krs Heinsberg
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 4.19383880060809e-06) WHERE c.name = 'Emmerich' AND f.timestamp BETWEEN '2023-11-17 15:50:10' AND '2023-11-26 08:16:21';
  params:
  - - '2023-11-17 15:50:10'
    - '2023-11-26 08:16:21'
  - Emmerich
  - 4.19383880060809e-06
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-04-29'::timestamp, DATE '2023-04-29'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Juechen' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-04-29'
  - Gem Juechen
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Rhein-Sieg-Kreis' WHERE f.timestamp BETWEEN '2023-02-17 01:31:11' AND '2023-02-17 23:30:32' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-02-17 01:31:11'
    - '2023-02-17 23:30:32'
  - Krs Rhein-Sieg-Kreis
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Rhein-Sieg-Kreis' WHERE f.timestamp BETWEEN '2023-08-31 23:26:33' AND '2023-09-02 20:25:48' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-08-31 23:26:33'
    - '2023-09-02 20:25:48'
  - Krs Rhein-Sieg-Kreis
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-08-04'::timestamp, DATE '2023-08-04'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Mettmann' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-08-04'
  - Gem Mettmann
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-09-27 22:13:18' GROUP BY b.name;
  params:
  - '2023-09-27 22:13:18'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-06-07 11:13:33' GROUP BY b.name;
  params:
  - '2023-06-07 11:13:33'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Lippe' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-11-20 15:04:26' AND '2023-11-25 03:33:26';
  params:
  - - '2023-11-20 15:04:26'
    - '2023-11-25 03:33:26'
  - Krs Lippe
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-03-24'::timestamp, DATE '2023-03-24'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Marsberg' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-03-24'
  - Gem Marsberg
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Herzogenrath' AND f.timestamp BETWEEN '2023-04-26 09:59:04' AND '2023-04-28 23:07:27' AND f.altitude < 690 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-04-26 09:59:04'
    - '2023-04-28 23:07:27'
  - Gem Herzogenrath
  - 690
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-10-08'::timestamp, DATE '2023-10-08'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Schwelm' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-10-08'
  - Gem Schwelm
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Legden' AND f.timestamp BETWEEN '2023-02-03 10:58:16' AND '2023-02-07 19:20:30' AND f.altitude < 1080 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-02-03 10:58:16'
    - '2023-02-07 19:20:30'
  - Gem Legden
  - 1080
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.3467939701958059e-05) WHERE c.name = 'Marsberg' AND f.timestamp BETWEEN '2023-10-16 19:06:37' AND '2023-10-23 00:58:04';
  params:
  - - '2023-10-16 19:06:37'
    - '2023-10-23 00:58:04'
  - Marsberg
  - 1.3467939701958059e-05
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Everswinkel' AND f.timestamp BETWEEN '2023-05-25 20:28:45' AND '2023-05-29 07:01:23' AND f.altitude < 870 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-05-25 20:28:45'
    - '2023-05-29 07:01:23'
  - Gem Everswinkel
  - 870
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Rhein-Sieg-Kreis' WHERE f.timestamp BETWEEN '2023-03-07 10:59:19' AND '2023-03-09 02:57:58' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-03-07 10:59:19'
    - '2023-03-09 02:57:58'
  - Krs Rhein-Sieg-Kreis
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.2277645912030423e-05) WHERE c.name = 'Billerbeck' AND f.timestamp BETWEEN '2023-12-23 01:54:54' AND '2023-12-30 09:18:13';
  params:
  - - '2023-12-23 01:54:54'
    - '2023-12-30 09:18:13'
  - Billerbeck
  - 1.2277645912030423e-05
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-11-16 00:37:11' GROUP BY b.name;
  params:
  - '2023-11-16 00:37:11'
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-12-19'::timestamp, DATE '2023-12-19'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Saerbeck' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-12-19'
  - Gem Saerbeck
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Recklinghausen' WHERE f.timestamp BETWEEN '2023-03-31 14:11:02' AND '2023-04-02 00:06:54' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-03-31 14:11:02'
    - '2023-04-02 00:06:54'
  - Krs Recklinghausen
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Herne' WHERE f.timestamp BETWEEN '2023-06-22 12:51:42' AND '2023-06-23 14:54:31' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-06-22 12:51:42'
    - '2023-06-23 14:54:31'
  - Krs Herne
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-03-31'::timestamp, DATE '2023-03-31'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Blankenheim' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-03-31'
  - Gem Blankenheim
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.535709944781481e-05) WHERE c.name = 'Herdecke' AND f.timestamp BETWEEN '2023-10-31 20:39:17' AND '2023-11-06 11:28:46';
  params:
  - - '2023-10-31 20:39:17'
    - '2023-11-06 11:28:46'
  - Herdecke
  - 1.535709944781481e-05
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Bottrop' WHERE f.timestamp BETWEEN '2023-12-26 18:53:33' AND '2023-12-27 22:05:37' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-12-26 18:53:33'
    - '2023-12-27 22:05:37'
  - Krs Bottrop
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-09-03'::timestamp, DATE '2023-09-03'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Steinheim' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-09-03'
  - Gem Steinheim
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 4.902807298104783e-06) WHERE c.name = 'Alsdorf' AND f.timestamp BETWEEN '2023-08-18 09:01:08' AND '2023-08-27 00:49:33';
  params:
  - - '2023-08-18 09:01:08'
    - '2023-08-27 00:49:33'
  - Alsdorf
  - 4.902807298104783e-06
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-02-01 10:45:50' GROUP BY b.name;
  params:
  - '2023-02-01 10:45:50'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Siegen-Wittgenstein' WHERE f.timestamp BETWEEN '2023-05-08 18:02:30' AND '2023-05-10 10:50:22' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-05-08 18:02:30'
    - '2023-05-10 10:50:22'
  - Krs Siegen-Wittgenstein
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Soest' WHERE f.timestamp BETWEEN '2023-03-28 13:28:39' AND '2023-03-29 03:12:20' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-03-28 13:28:39'
    - '2023-03-29 03:12:20'
  - Krs Soest
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Rhein-Kreis Neuss' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-08-17 23:55:01' AND '2023-08-20 23:41:05';
  params:
  - - '2023-08-17 23:55:01'
    - '2023-08-20 23:41:05'
  - Krs Rhein-Kreis Neuss
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.4908803178679039e-05) WHERE c.name = 'Ruethen' AND f.timestamp BETWEEN '2023-10-29 01:43:12' AND '2023-11-11 09:15:57';
  params:
  - - '2023-10-29 01:43:12'
    - '2023-11-11 09:15:57'
  - Ruethen
  - 1.4908803178679039e-05
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Hochsauerlandkreis' WHERE f.timestamp BETWEEN '2023-10-13 06:19:56' AND '2023-10-13 18:03:22' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-10-13 06:19:56'
    - '2023-10-13 18:03:22'
  - Krs Hochsauerlandkreis
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 6.453435233640122e-06) WHERE c.name = 'Wipperfuerth' AND f.timestamp BETWEEN '2023-09-01 04:49:14' AND '2023-09-13 08:33:21';
  params:
  - - '2023-09-01 04:49:14'
    - '2023-09-13 08:33:21'
  - Wipperfuerth
  - 6.453435233640122e-06
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-03-03 20:18:10' GROUP BY b.name;
  params:
  - '2023-03-03 20:18:10'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Herford' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-08-23 20:30:34' AND '2023-09-02 22:23:24';
  params:
  - - '2023-08-23 20:30:34'
    - '2023-09-02 22:23:24'
  - Krs Herford
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Koeln' WHERE f.timestamp BETWEEN '2023-09-18 03:45:07' AND '2023-09-19 00:24:12' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-09-18 03:45:07'
    - '2023-09-19 00:24:12'
  - Krs Koeln
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-06-15'::timestamp, DATE '2023-06-15'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Selm' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-06-15'
  - Gem Selm
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Dortmund' WHERE f.timestamp BETWEEN '2023-01-07 10:31:51' AND '2023-01-07 19:43:28' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-01-07 10:31:51'
    - '2023-01-07 19:43:28'
  - Krs Dortmund
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Ruethen' AND f.timestamp BETWEEN '2023-05-04 09:39:10' AND '2023-05-10 13:06:28' AND f.altitude < 1110 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-05-04 09:39:10'
    - '2023-05-10 13:06:28'
  - Gem Ruethen
  - 1110
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 9.529379607576835e-06) WHERE c.name = 'Alsdorf' AND f.timestamp BETWEEN '2023-10-01 16:34:48' AND '2023-10-07 18:02:52';
  params:
  - - '2023-10-01 16:34:48'
    - '2023-10-07 18:02:52'
  - Alsdorf
  - 9.529379607576835e-06
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-12-20 23:44:26' GROUP BY b.name;
  params:
  - '2023-12-20 23:44:26'
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-01-13'::timestamp, DATE '2023-01-13'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Drolshagen' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-01-13'
  - Gem Drolshagen
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.4831590094130378e-05) WHERE c.name = 'Schlo Holte-Stukenbrock' AND f.timestamp BETWEEN '2023-07-20 12:35:03' AND '2023-08-01 01:46:28';
  params:
  - - '2023-07-20 12:35:03'
    - '2023-08-01 01:46:28'
  - Schlo Holte-Stukenbrock
  - 1.4831590094130378e-05
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-08-08'::timestamp, DATE '2023-08-08'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Essen' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-08-08'
  - Gem Essen
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Lippe' WHERE f.timestamp BETWEEN '2023-03-27 00:49:22' AND '2023-03-27 08:52:58' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-03-27 00:49:22'
    - '2023-03-27 08:52:58'
  - Krs Lippe
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.5064628741159607e-05) WHERE c.name = 'Wipperfuerth' AND f.timestamp BETWEEN '2023-02-03 01:22:04' AND '2023-02-11 13:09:29';
  params:
  - - '2023-02-03 01:22:04'
    - '2023-02-11 13:09:29'
  - Wipperfuerth
  - 1.5064628741159607e-05
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Bielefeld' AND f.timestamp BETWEEN '2023-12-17 20:16:46' AND '2023-12-20 12:32:39' AND f.altitude < 1090 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-12-17 20:16:46'
    - '2023-12-20 12:32:39'
  - Gem Bielefeld
  - 1090
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Telgte' AND f.timestamp BETWEEN '2023-01-01 00:00:01' AND '2023-01-07 23:42:07' AND f.altitude < 570 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-01-01 00:00:01'
    - '2023-01-07 23:42:07'
  - Gem Telgte
  - 570
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-07-20 08:30:57' GROUP BY b.name;
  params:
  - '2023-07-20 08:30:57'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-04-04 10:15:41' GROUP BY b.name;
  params:
  - '2023-04-04 10:15:41'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Bielefeld' WHERE f.timestamp BETWEEN '2023-04-04 21:25:49' AND '2023-04-05 01:32:08' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-04-04 21:25:49'
    - '2023-04-05 01:32:08'
  - Krs Bielefeld
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Dueren' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-01-03 07:33:26' AND '2023-01-07 04:07:36';
  params:
  - - '2023-01-03 07:33:26'
    - '2023-01-07 04:07:36'
  - Krs Dueren
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-05-05 22:19:38' GROUP BY b.name;
  params:
  - '2023-05-05 22:19:38'
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-09-04'::timestamp, DATE '2023-09-04'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Swisttal' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-09-04'
  - Gem Swisttal
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Hochsauerlandkreis' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-04-23 04:47:15' AND '2023-05-04 12:59:49';
  params:
  - - '2023-04-23 04:47:15'
    - '2023-05-04 12:59:49'
  - Krs Hochsauerlandkreis
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Rees' AND f.timestamp BETWEEN '2023-07-06 23:44:15' AND '2023-07-11 14:25:36' AND f.altitude < 1410 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-07-06 23:44:15'
    - '2023-07-11 14:25:36'
  - Gem Rees
  - 1410
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Dortmund' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-01-24 12:06:45' AND '2023-02-03 09:35:47';
  params:
  - - '2023-01-24 12:06:45'
    - '2023-02-03 09:35:47'
  - Krs Dortmund
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-03-31'::timestamp, DATE '2023-03-31'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Schieder-Schwalenberg' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-03-31'
  - Gem Schieder-Schwalenberg
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Lippe' WHERE f.timestamp BETWEEN '2023-09-06 12:11:36' AND '2023-09-07 19:46:58' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-09-06 12:11:36'
    - '2023-09-07 19:46:58'
  - Krs Lippe
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.2663348097436557e-05) WHERE c.name = 'Heiligenhaus' AND f.timestamp BETWEEN '2023-10-12 03:47:28' AND '2023-10-16 11:24:46';
  params:
  - - '2023-10-12 03:47:28'
    - '2023-10-16 11:24:46'
  - Heiligenhaus
  - 1.2663348097436557e-05
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Coesfeld' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-02-20 21:23:57' AND '2023-03-06 05:28:28';
  params:
  - - '2023-02-20 21:23:57'
    - '2023-03-06 05:28:28'
  - Krs Coesfeld
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Muelheim a.d. Ruhr' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-01-01 00:00:01' AND '2023-01-11 04:46:30';
  params:
  - - '2023-01-01 00:00:01'
    - '2023-01-11 04:46:30'
  - Krs Muelheim a.d. Ruhr
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-05-28'::timestamp, DATE '2023-05-28'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Kaarst' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-05-28'
  - Gem Kaarst
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Sprockhoevel' AND f.timestamp BETWEEN '2023-01-18 22:51:14' AND '2023-01-25 05:00:37' AND f.altitude < 1080 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-01-18 22:51:14'
    - '2023-01-25 05:00:37'
  - Gem Sprockhoevel
  - 1080
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Viersen' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-10-09 22:20:45' AND '2023-10-22 22:31:40';
  params:
  - - '2023-10-09 22:20:45'
    - '2023-10-22 22:31:40'
  - Krs Viersen
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Hochsauerlandkreis' WHERE f.timestamp BETWEEN '2023-11-26 14:30:48' AND '2023-11-28 06:52:55' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-11-26 14:30:48'
    - '2023-11-28 06:52:55'
  - Krs Hochsauerlandkreis
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Minden-Luebbecke' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-09-07 03:46:41' AND '2023-09-18 11:51:35';
  params:
  - - '2023-09-07 03:46:41'
    - '2023-09-18 11:51:35'
  - Krs Minden-Luebbecke
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3.6788571047115563e-06) WHERE c.name = 'Hamminkeln' AND f.timestamp BETWEEN '2023-11-27 03:32:18' AND '2023-11-29 11:16:40';
  params:
  - - '2023-11-27 03:32:18'
    - '2023-11-29 11:16:40'
  - Hamminkeln
  - 3.6788571047115563e-06
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-01-02'::timestamp, DATE '2023-01-02'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Hellenthal' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-01-02'
  - Gem Hellenthal
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Guetersloh' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-05-11 12:46:48' AND '2023-05-22 11:54:18';
  params:
  - - '2023-05-11 12:46:48'
    - '2023-05-22 11:54:18'
  - Krs Guetersloh
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-06-18 01:21:43' GROUP BY b.name;
  params:
  - '2023-06-18 01:21:43'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Mettmann' WHERE f.timestamp BETWEEN '2023-05-22 16:38:32' AND '2023-05-23 03:08:35' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-05-22 16:38:32'
    - '2023-05-23 03:08:35'
  - Krs Mettmann
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-10-05 20:52:24' GROUP BY b.name;
  params:
  - '2023-10-05 20:52:24'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.0596227258820684e-05) WHERE c.name = 'Meerbusch' AND f.timestamp BETWEEN '2023-01-30 05:54:28' AND '2023-02-11 19:51:32';
  params:
  - - '2023-01-30 05:54:28'
    - '2023-02-11 19:51:32'
  - Meerbusch
  - 1.0596227258820684e-05
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Steinfurt' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-06-09 20:22:40' AND '2023-06-16 16:38:15';
  params:
  - - '2023-06-09 20:22:40'
    - '2023-06-16 16:38:15'
  - Krs Steinfurt
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Koeln' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-12-15 18:08:07' AND '2023-12-17 22:08:14';
  params:
  - - '2023-12-15 18:08:07'
    - '2023-12-17 22:08:14'
  - Krs Koeln
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 4.859809335957206e-06) WHERE c.name = 'Krefeld' AND f.timestamp BETWEEN '2023-03-10 13:29:55' AND '2023-03-22 13:31:01';
  params:
  - - '2023-03-10 13:29:55'
    - '2023-03-22 13:31:01'
  - Krefeld
  - 4.859809335957206e-06
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Hoexter' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-08-22 12:01:44' AND '2023-08-25 06:44:22';
  params:
  - - '2023-08-22 12:01:44'
    - '2023-08-25 06:44:22'
  - Krs Hoexter
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-04-09'::timestamp, DATE '2023-04-09'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Rees' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-04-09'
  - Gem Rees
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Solingen' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-09-03 08:47:39' AND '2023-09-06 23:35:34';
  params:
  - - '2023-09-03 08:47:39'
    - '2023-09-06 23:35:34'
  - Krs Solingen
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Hoexter' WHERE f.timestamp BETWEEN '2023-08-28 04:45:10' AND '2023-08-29 05:39:01' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-08-28 04:45:10'
    - '2023-08-29 05:39:01'
  - Krs Hoexter
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.626965819707464e-06) WHERE c.name = 'Drolshagen' AND f.timestamp BETWEEN '2023-12-18 03:12:57' AND '2023-12-31 10:02:06';
  params:
  - - '2023-12-18 03:12:57'
    - '2023-12-31 10:02:06'
  - Drolshagen
  - 7.626965819707464e-06
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-02-25'::timestamp, DATE '2023-02-25'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Lichtenau' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-02-25'
  - Gem Lichtenau
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Solingen' AND f.timestamp BETWEEN '2023-08-05 01:05:19' AND '2023-08-18 11:12:54' AND f.altitude < 920 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-08-05 01:05:19'
    - '2023-08-18 11:12:54'
  - Gem Solingen
  - 920
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 5.831503059209651e-06) WHERE c.name = 'Kamen' AND f.timestamp BETWEEN '2023-10-25 17:36:49' AND '2023-11-01 13:06:47';
  params:
  - - '2023-10-25 17:36:49'
    - '2023-11-01 13:06:47'
  - Kamen
  - 5.831503059209651e-06
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Soest' WHERE f.timestamp BETWEEN '2023-09-20 06:54:29' AND '2023-09-21 19:56:38' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-09-20 06:54:29'
    - '2023-09-21 19:56:38'
  - Krs Soest
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.1366007143910513e-05) WHERE c.name = 'Sassenberg' AND f.timestamp BETWEEN '2023-09-10 14:14:27' AND '2023-09-17 14:22:29';
  params:
  - - '2023-09-10 14:14:27'
    - '2023-09-17 14:22:29'
  - Sassenberg
  - 1.1366007143910513e-05
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Mettmann' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-03-12 23:07:00' AND '2023-03-25 07:32:25';
  params:
  - - '2023-03-12 23:07:00'
    - '2023-03-25 07:32:25'
  - Krs Mettmann
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-12-17 01:18:19' GROUP BY b.name;
  params:
  - '2023-12-17 01:18:19'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.2084192846070269e-05) WHERE c.name = 'Emmerich' AND f.timestamp BETWEEN '2023-12-15 05:53:16' AND '2023-12-24 14:18:57';
  params:
  - - '2023-12-15 05:53:16'
    - '2023-12-24 14:18:57'
  - Emmerich
  - 1.2084192846070269e-05
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-10-05'::timestamp, DATE '2023-10-05'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Lennestadt' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-10-05'
  - Gem Lennestadt
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Warendorf' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-09-07 20:33:38' AND '2023-09-14 08:58:56';
  params:
  - - '2023-09-07 20:33:38'
    - '2023-09-14 08:58:56'
  - Krs Warendorf
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-05-18 16:47:51' GROUP BY b.name;
  params:
  - '2023-05-18 16:47:51'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Hagen' AND f.timestamp BETWEEN '2023-09-20 10:16:17' AND '2023-10-03 15:32:00' AND f.altitude < 590 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-09-20 10:16:17'
    - '2023-10-03 15:32:00'
  - Gem Hagen
  - 590
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Kreuztal' AND f.timestamp BETWEEN '2023-03-03 19:26:02' AND '2023-03-12 08:26:39' AND f.altitude < 1260 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-03-03 19:26:02'
    - '2023-03-12 08:26:39'
  - Gem Kreuztal
  - 1260
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Paderborn' AND f.timestamp BETWEEN '2023-09-03 15:26:58' AND '2023-09-18 09:42:17' AND f.altitude < 570 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-09-03 15:26:58'
    - '2023-09-18 09:42:17'
  - Gem Paderborn
  - 570
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Erndtebrueck' AND f.timestamp BETWEEN '2023-03-15 11:13:37' AND '2023-03-28 15:49:26' AND f.altitude < 1000 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-03-15 11:13:37'
    - '2023-03-28 15:49:26'
  - Gem Erndtebrueck
  - 1000
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-07-03'::timestamp, DATE '2023-07-03'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Bochum' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-07-03'
  - Gem Bochum
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Oberhausen' AND f.timestamp BETWEEN '2023-11-06 04:27:44' AND '2023-11-18 19:53:21' AND f.altitude < 1470 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-11-06 04:27:44'
    - '2023-11-18 19:53:21'
  - Gem Oberhausen
  - 1470
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-12-29 00:48:10' GROUP BY b.name;
  params:
  - '2023-12-29 00:48:10'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.0108598006006402e-05) WHERE c.name = 'Barntrup' AND f.timestamp BETWEEN '2023-01-10 22:39:30' AND '2023-01-19 15:20:35';
  params:
  - - '2023-01-10 22:39:30'
    - '2023-01-19 15:20:35'
  - Barntrup
  - 1.0108598006006402e-05
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.5341896734986933e-05) WHERE c.name = 'Bueren' AND f.timestamp BETWEEN '2023-11-13 07:45:21' AND '2023-11-23 07:26:25';
  params:
  - - '2023-11-13 07:45:21'
    - '2023-11-23 07:26:25'
  - Bueren
  - 1.5341896734986933e-05
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.0854819180763365e-05) WHERE c.name = 'Alsdorf' AND f.timestamp BETWEEN '2023-08-28 22:49:36' AND '2023-09-04 22:45:21';
  params:
  - - '2023-08-28 22:49:36'
    - '2023-09-04 22:45:21'
  - Alsdorf
  - 1.0854819180763365e-05
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Olpe' WHERE f.timestamp BETWEEN '2023-12-03 22:57:33' AND '2023-12-04 12:08:29' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-12-03 22:57:33'
    - '2023-12-04 12:08:29'
  - Krs Olpe
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-02-20 19:50:38' GROUP BY b.name;
  params:
  - '2023-02-20 19:50:38'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.390701549248237e-06) WHERE c.name = 'Marienmuenster' AND f.timestamp BETWEEN '2023-03-15 21:00:24' AND '2023-03-24 16:43:32';
  params:
  - - '2023-03-15 21:00:24'
    - '2023-03-24 16:43:32'
  - Marienmuenster
  - 7.390701549248237e-06
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-10-06 04:48:09' GROUP BY b.name;
  params:
  - '2023-10-06 04:48:09'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Hochsauerlandkreis' WHERE f.timestamp BETWEEN '2023-10-31 13:40:35' AND '2023-11-01 19:18:42' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-10-31 13:40:35'
    - '2023-11-01 19:18:42'
  - Krs Hochsauerlandkreis
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Wesel' WHERE f.timestamp BETWEEN '2023-12-23 01:58:20' AND '2023-12-24 14:36:49' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-12-23 01:58:20'
    - '2023-12-24 14:36:49'
  - Krs Wesel
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-09-30'::timestamp, DATE '2023-09-30'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Wadersloh' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-09-30'
  - Gem Wadersloh
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-11-28'::timestamp, DATE '2023-11-28'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Olpe' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-11-28'
  - Gem Olpe
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.0981225870027226e-05) WHERE c.name = 'Voerde' AND f.timestamp BETWEEN '2023-06-30 04:06:52' AND '2023-07-07 18:58:16';
  params:
  - - '2023-06-30 04:06:52'
    - '2023-07-07 18:58:16'
  - Voerde
  - 1.0981225870027226e-05
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-08-03 04:15:00' GROUP BY b.name;
  params:
  - '2023-08-03 04:15:00'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Lohmar' AND f.timestamp BETWEEN '2023-09-30 05:21:54' AND '2023-10-05 02:12:21' AND f.altitude < 860 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-09-30 05:21:54'
    - '2023-10-05 02:12:21'
  - Gem Lohmar
  - 860
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3.7551696863551868e-06) WHERE c.name = 'Breckerfeld' AND f.timestamp BETWEEN '2023-01-05 01:46:49' AND '2023-01-10 23:41:36';
  params:
  - - '2023-01-05 01:46:49'
    - '2023-01-10 23:41:36'
  - Breckerfeld
  - 3.7551696863551868e-06
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Niederzier' AND f.timestamp BETWEEN '2023-10-30 08:31:35' AND '2023-11-09 07:00:22' AND f.altitude < 1190 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-10-30 08:31:35'
    - '2023-11-09 07:00:22'
  - Gem Niederzier
  - 1190
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-07-24 09:05:13' GROUP BY b.name;
  params:
  - '2023-07-24 09:05:13'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-07-19 11:33:26' GROUP BY b.name;
  params:
  - '2023-07-19 11:33:26'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Hochsauerlandkreis' WHERE f.timestamp BETWEEN '2023-05-27 03:42:10' AND '2023-05-28 13:33:14' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-05-27 03:42:10'
    - '2023-05-28 13:33:14'
  - Krs Hochsauerlandkreis
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-12-17 12:45:34' GROUP BY b.name;
  params:
  - '2023-12-17 12:45:34'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Soest' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-12-07 06:55:50' AND '2023-12-19 21:46:02';
  params:
  - - '2023-12-07 06:55:50'
    - '2023-12-19 21:46:02'
  - Krs Soest
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Ennepe-Ruhr-Kreis' WHERE f.timestamp BETWEEN '2023-12-19 23:46:22' AND '2023-12-20 09:08:51' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-12-19 23:46:22'
    - '2023-12-20 09:08:51'
  - Krs Ennepe-Ruhr-Kreis
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-07-09'::timestamp, DATE '2023-07-09'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Velbert' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-07-09'
  - Gem Velbert
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Hoexter' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-04-06 19:01:11' AND '2023-04-13 20:38:23';
  params:
  - - '2023-04-06 19:01:11'
    - '2023-04-13 20:38:23'
  - Krs Hoexter
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Mettmann' WHERE f.timestamp BETWEEN '2023-11-07 12:38:40' AND '2023-11-08 09:16:16' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-11-07 12:38:40'
    - '2023-11-08 09:16:16'
  - Krs Mettmann
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Wesel' WHERE f.timestamp BETWEEN '2023-05-05 03:16:55' AND '2023-05-05 05:32:14' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-05-05 03:16:55'
    - '2023-05-05 05:32:14'
  - Krs Wesel
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Altenberge' AND f.timestamp BETWEEN '2023-03-09 03:54:27' AND '2023-03-12 21:00:35' AND f.altitude < 960 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-03-09 03:54:27'
    - '2023-03-12 21:00:35'
  - Gem Altenberge
  - 960
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Luebbecke' AND f.timestamp BETWEEN '2023-09-07 02:01:01' AND '2023-09-09 04:34:24' AND f.altitude < 1090 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-09-07 02:01:01'
    - '2023-09-09 04:34:24'
  - Gem Luebbecke
  - 1090
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.4050655252836427e-05) WHERE c.name = 'Leverkusen' AND f.timestamp BETWEEN '2023-01-26 20:45:04' AND '2023-01-29 20:00:46';
  params:
  - - '2023-01-26 20:45:04'
    - '2023-01-29 20:00:46'
  - Leverkusen
  - 1.4050655252836427e-05
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-10-29 06:50:24' GROUP BY b.name;
  params:
  - '2023-10-29 06:50:24'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 4.2409321499605455e-06) WHERE c.name = 'Muelheim an der Ruhr' AND f.timestamp BETWEEN '2023-04-05 17:11:53' AND '2023-04-19 18:22:30';
  params:
  - - '2023-04-05 17:11:53'
    - '2023-04-19 18:22:30'
  - Muelheim an der Ruhr
  - 4.2409321499605455e-06
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Marienmuenster' AND f.timestamp BETWEEN '2023-07-26 14:46:47' AND '2023-08-02 16:47:27' AND f.altitude < 790 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-07-26 14:46:47'
    - '2023-08-02 16:47:27'
  - Gem Marienmuenster
  - 790
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Arnsberg' AND f.timestamp BETWEEN '2023-04-29 23:28:10' AND '2023-05-05 21:52:16' AND f.altitude < 610 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-04-29 23:28:10'
    - '2023-05-05 21:52:16'
  - Gem Arnsberg
  - 610
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-04-29 03:32:10' GROUP BY b.name;
  params:
  - '2023-04-29 03:32:10'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Bochum' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-03-28 18:50:31' AND '2023-04-06 16:32:16';
  params:
  - - '2023-03-28 18:50:31'
    - '2023-04-06 16:32:16'
  - Krs Bochum
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Hamm' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-11-23 07:05:17' AND '2023-12-06 19:52:56';
  params:
  - - '2023-11-23 07:05:17'
    - '2023-12-06 19:52:56'
  - Krs Hamm
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-05-14 04:36:15' GROUP BY b.name;
  params:
  - '2023-05-14 04:36:15'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Coesfeld' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-04-03 23:25:49' AND '2023-04-11 23:17:44';
  params:
  - - '2023-04-03 23:25:49'
    - '2023-04-11 23:17:44'
  - Krs Coesfeld
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-12-17 17:21:54' GROUP BY b.name;
  params:
  - '2023-12-17 17:21:54'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Welver' AND f.timestamp BETWEEN '2023-08-30 02:03:38' AND '2023-09-10 01:05:01' AND f.altitude < 1110 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-08-30 02:03:38'
    - '2023-09-10 01:05:01'
  - Gem Welver
  - 1110
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Hochsauerlandkreis' WHERE f.timestamp BETWEEN '2023-03-26 18:37:57' AND '2023-03-27 22:56:34' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-03-26 18:37:57'
    - '2023-03-27 22:56:34'
  - Krs Hochsauerlandkreis
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-05-07 01:50:28' GROUP BY b.name;
  params:
  - '2023-05-07 01:50:28'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Lippetal' AND f.timestamp BETWEEN '2023-08-05 07:13:03' AND '2023-08-15 19:52:07' AND f.altitude < 950 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-08-05 07:13:03'
    - '2023-08-15 19:52:07'
  - Gem Lippetal
  - 950
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Maerkischer Kreis' WHERE f.timestamp BETWEEN '2023-08-28 08:42:02' AND '2023-08-30 02:16:56' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-08-28 08:42:02'
    - '2023-08-30 02:16:56'
  - Krs Maerkischer Kreis
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Coesfeld' WHERE f.timestamp BETWEEN '2023-08-03 19:05:39' AND '2023-08-03 19:24:21' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-08-03 19:05:39'
    - '2023-08-03 19:24:21'
  - Krs Coesfeld
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Attendorn' AND f.timestamp BETWEEN '2023-06-24 00:48:09' AND '2023-07-08 22:20:13' AND f.altitude < 1240 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-06-24 00:48:09'
    - '2023-07-08 22:20:13'
  - Gem Attendorn
  - 1240
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 9.745867165105957e-06) WHERE c.name = 'Juelich' AND f.timestamp BETWEEN '2023-11-18 03:59:40' AND '2023-11-23 02:23:44';
  params:
  - - '2023-11-18 03:59:40'
    - '2023-11-23 02:23:44'
  - Juelich
  - 9.745867165105957e-06
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-09-28'::timestamp, DATE '2023-09-28'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Blankenheim' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-09-28'
  - Gem Blankenheim
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Rhein-Sieg-Kreis' WHERE f.timestamp BETWEEN '2023-11-16 14:14:57' AND '2023-11-17 06:02:06' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-11-16 14:14:57'
    - '2023-11-17 06:02:06'
  - Krs Rhein-Sieg-Kreis
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Petershagen' AND f.timestamp BETWEEN '2023-01-11 07:03:48' AND '2023-01-19 05:37:19' AND f.altitude < 1150 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-01-11 07:03:48'
    - '2023-01-19 05:37:19'
  - Gem Petershagen
  - 1150
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Hellenthal' AND f.timestamp BETWEEN '2023-12-13 13:04:46' AND '2023-12-24 01:36:37' AND f.altitude < 950 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-12-13 13:04:46'
    - '2023-12-24 01:36:37'
  - Gem Hellenthal
  - 950
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-02-08 21:34:46' GROUP BY b.name;
  params:
  - '2023-02-08 21:34:46'
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-08-10'::timestamp, DATE '2023-08-10'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Windeck' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-08-10'
  - Gem Windeck
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Recklinghausen' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-06-29 10:26:57' AND '2023-07-04 21:29:22';
  params:
  - - '2023-06-29 10:26:57'
    - '2023-07-04 21:29:22'
  - Krs Recklinghausen
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Mettmann' WHERE f.timestamp BETWEEN '2023-03-19 02:48:27' AND '2023-03-20 14:46:17' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-03-19 02:48:27'
    - '2023-03-20 14:46:17'
  - Krs Mettmann
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-02-13 12:43:04' GROUP BY b.name;
  params:
  - '2023-02-13 12:43:04'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-05-14 12:25:28' GROUP BY b.name;
  params:
  - '2023-05-14 12:25:28'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3.78686158218906e-06) WHERE c.name = 'Bad Honnef' AND f.timestamp BETWEEN '2023-08-01 12:57:08' AND '2023-08-06 15:31:27';
  params:
  - - '2023-08-01 12:57:08'
    - '2023-08-06 15:31:27'
  - Bad Honnef
  - 3.78686158218906e-06
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-06-03 06:07:54' GROUP BY b.name;
  params:
  - '2023-06-03 06:07:54'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 8.096417703672571e-06) WHERE c.name = 'Beckum' AND f.timestamp BETWEEN '2023-06-26 09:07:12' AND '2023-06-30 18:10:02';
  params:
  - - '2023-06-26 09:07:12'
    - '2023-06-30 18:10:02'
  - Beckum
  - 8.096417703672571e-06
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-07-17 03:08:36' GROUP BY b.name;
  params:
  - '2023-07-17 03:08:36'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3.7997911490506665e-06) WHERE c.name = 'Bueren' AND f.timestamp BETWEEN '2023-01-20 15:46:16' AND '2023-01-24 15:25:01';
  params:
  - - '2023-01-20 15:46:16'
    - '2023-01-24 15:25:01'
  - Bueren
  - 3.7997911490506665e-06
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-04-23 21:32:31' GROUP BY b.name;
  params:
  - '2023-04-23 21:32:31'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Wesel' WHERE f.timestamp BETWEEN '2023-12-28 09:48:36' AND '2023-12-28 16:41:44' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-12-28 09:48:36'
    - '2023-12-28 16:41:44'
  - Krs Wesel
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-02-01'::timestamp, DATE '2023-02-01'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Attendorn' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-02-01'
  - Gem Attendorn
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-03-26'::timestamp, DATE '2023-03-26'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Extertal' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-03-26'
  - Gem Extertal
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.273101124950583e-06) WHERE c.name = 'Zuelpich' AND f.timestamp BETWEEN '2023-10-02 21:40:12' AND '2023-10-05 15:50:02';
  params:
  - - '2023-10-02 21:40:12'
    - '2023-10-05 15:50:02'
  - Zuelpich
  - 7.273101124950583e-06
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-06-13'::timestamp, DATE '2023-06-13'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Leverkusen' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-06-13'
  - Gem Leverkusen
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-10-24'::timestamp, DATE '2023-10-24'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Bueren' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-10-24'
  - Gem Bueren
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-08-06 11:43:23' GROUP BY b.name;
  params:
  - '2023-08-06 11:43:23'
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-03-21'::timestamp, DATE '2023-03-21'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Voerde (Niederrhein)' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-03-21'
  - Gem Voerde (Niederrhein)
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Minden-Luebbecke' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-06-01 09:58:17' AND '2023-06-10 15:00:20';
  params:
  - - '2023-06-01 09:58:17'
    - '2023-06-10 15:00:20'
  - Krs Minden-Luebbecke
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Bedburg' AND f.timestamp BETWEEN '2023-08-01 22:16:06' AND '2023-08-09 05:46:35' AND f.altitude < 960 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-08-01 22:16:06'
    - '2023-08-09 05:46:35'
  - Gem Bedburg
  - 960
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Hochsauerlandkreis' WHERE f.timestamp BETWEEN '2023-08-21 01:25:36' AND '2023-08-21 08:26:37' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-08-21 01:25:36'
    - '2023-08-21 08:26:37'
  - Krs Hochsauerlandkreis
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.3749270785516189e-05) WHERE c.name = 'Neuss' AND f.timestamp BETWEEN '2023-01-15 00:35:12' AND '2023-01-29 06:17:42';
  params:
  - - '2023-01-15 00:35:12'
    - '2023-01-29 06:17:42'
  - Neuss
  - 1.3749270785516189e-05
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Oberhausen' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-10-09 04:19:46' AND '2023-10-21 01:30:48';
  params:
  - - '2023-10-09 04:19:46'
    - '2023-10-21 01:30:48'
  - Krs Oberhausen
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Steinfurt' WHERE f.timestamp BETWEEN '2023-12-25 20:35:11' AND '2023-12-27 04:26:16' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-12-25 20:35:11'
    - '2023-12-27 04:26:16'
  - Krs Steinfurt
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-09-26'::timestamp, DATE '2023-09-26'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Bielefeld' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-09-26'
  - Gem Bielefeld
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 6.4631324886749854e-06) WHERE c.name = 'Hoerstel' AND f.timestamp BETWEEN '2023-02-27 04:34:29' AND '2023-03-10 06:42:51';
  params:
  - - '2023-02-27 04:34:29'
    - '2023-03-10 06:42:51'
  - Hoerstel
  - 6.4631324886749854e-06
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Siegen-Wittgenstein' WHERE f.timestamp BETWEEN '2023-04-24 23:24:35' AND '2023-04-25 16:09:53' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-04-24 23:24:35'
    - '2023-04-25 16:09:53'
  - Krs Siegen-Wittgenstein
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.056845621890015e-05) WHERE c.name = 'Wiehl' AND f.timestamp BETWEEN '2023-01-29 06:05:03' AND '2023-02-12 21:54:04';
  params:
  - - '2023-01-29 06:05:03'
    - '2023-02-12 21:54:04'
  - Wiehl
  - 1.056845621890015e-05
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-06-14 21:29:29' GROUP BY b.name;
  params:
  - '2023-06-14 21:29:29'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Borken' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-04-28 17:49:15' AND '2023-05-04 01:02:15';
  params:
  - - '2023-04-28 17:49:15'
    - '2023-05-04 01:02:15'
  - Krs Borken
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-01-02 08:34:08' GROUP BY b.name;
  params:
  - '2023-01-02 08:34:08'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Euskirchen' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-08-01 11:34:30' AND '2023-08-10 19:08:39';
  params:
  - - '2023-08-01 11:34:30'
    - '2023-08-10 19:08:39'
  - Krs Euskirchen
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Niederkruechten' AND f.timestamp BETWEEN '2023-05-30 14:54:20' AND '2023-06-10 20:31:18' AND f.altitude < 1320 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-05-30 14:54:20'
    - '2023-06-10 20:31:18'
  - Gem Niederkruechten
  - 1320
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Mettmann' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-12-16 10:15:37' AND '2023-12-22 19:31:42';
  params:
  - - '2023-12-16 10:15:37'
    - '2023-12-22 19:31:42'
  - Krs Mettmann
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Paderborn' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-05-01 00:10:38' AND '2023-05-04 22:36:44';
  params:
  - - '2023-05-01 00:10:38'
    - '2023-05-04 22:36:44'
  - Krs Paderborn
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-12-20 16:04:03' GROUP BY b.name;
  params:
  - '2023-12-20 16:04:03'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.303896176334784e-05) WHERE c.name = 'Kaarst' AND f.timestamp BETWEEN '2023-11-17 02:13:08' AND '2023-11-27 05:54:24';
  params:
  - - '2023-11-17 02:13:08'
    - '2023-11-27 05:54:24'
  - Kaarst
  - 1.303896176334784e-05
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-02-04 12:30:38' GROUP BY b.name;
  params:
  - '2023-02-04 12:30:38'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 6.187161548477455e-06) WHERE c.name = 'Sassenberg' AND f.timestamp BETWEEN '2023-05-23 15:23:11' AND '2023-05-26 10:22:07';
  params:
  - - '2023-05-23 15:23:11'
    - '2023-05-26 10:22:07'
  - Sassenberg
  - 6.187161548477455e-06
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-07-29 01:47:34' GROUP BY b.name;
  params:
  - '2023-07-29 01:47:34'
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-01-01'::timestamp, DATE '2023-01-01'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Drolshagen' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-01-01'
  - Gem Drolshagen
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-02-01'::timestamp, DATE '2023-02-01'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Willebadessen' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-02-01'
  - Gem Willebadessen
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.459604001016752e-06) WHERE c.name = 'Straelen' AND f.timestamp BETWEEN '2023-04-09 16:11:16' AND '2023-04-14 07:20:43';
  params:
  - - '2023-04-09 16:11:16'
    - '2023-04-14 07:20:43'
  - Straelen
  - 7.459604001016752e-06
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Nieheim' AND f.timestamp BETWEEN '2023-12-30 18:20:58' AND '2023-12-31 23:59:59' AND f.altitude < 710 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-12-30 18:20:58'
    - '2023-12-31 23:59:59'
  - Gem Nieheim
  - 710
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Windeck' AND f.timestamp BETWEEN '2023-12-25 22:00:12' AND '2023-12-31 23:59:59' AND f.altitude < 750 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-12-25 22:00:12'
    - '2023-12-31 23:59:59'
  - Gem Windeck
  - 750
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 6.1552717085757965e-06) WHERE c.name = 'Koenigswinter' AND f.timestamp BETWEEN '2023-10-11 07:08:34' AND '2023-10-24 18:14:48';
  params:
  - - '2023-10-11 07:08:34'
    - '2023-10-24 18:14:48'
  - Koenigswinter
  - 6.1552717085757965e-06
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-10-01'::timestamp, DATE '2023-10-01'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Wuppertal' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-10-01'
  - Gem Wuppertal
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Frechen' AND f.timestamp BETWEEN '2023-10-13 00:01:04' AND '2023-10-16 14:39:16' AND f.altitude < 990 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-10-13 00:01:04'
    - '2023-10-16 14:39:16'
  - Gem Frechen
  - 990
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Detmold' AND f.timestamp BETWEEN '2023-03-28 15:58:18' AND '2023-04-02 22:13:39' AND f.altitude < 1260 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-03-28 15:58:18'
    - '2023-04-02 22:13:39'
  - Gem Detmold
  - 1260
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Ascheberg' AND f.timestamp BETWEEN '2023-03-21 18:57:38' AND '2023-03-29 16:15:13' AND f.altitude < 970 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-03-21 18:57:38'
    - '2023-03-29 16:15:13'
  - Gem Ascheberg
  - 970
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Hamminkeln' AND f.timestamp BETWEEN '2023-07-03 22:34:58' AND '2023-07-14 18:59:05' AND f.altitude < 530 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-07-03 22:34:58'
    - '2023-07-14 18:59:05'
  - Gem Hamminkeln
  - 530
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Hoexter' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-10-05 21:09:16' AND '2023-10-16 21:32:42';
  params:
  - - '2023-10-05 21:09:16'
    - '2023-10-16 21:32:42'
  - Krs Hoexter
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Viersen' WHERE f.timestamp BETWEEN '2023-03-24 13:43:16' AND '2023-03-25 08:20:32' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-03-24 13:43:16'
    - '2023-03-25 08:20:32'
  - Krs Viersen
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Unna' WHERE f.timestamp BETWEEN '2023-04-02 15:14:54' AND '2023-04-04 03:44:47' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-04-02 15:14:54'
    - '2023-04-04 03:44:47'
  - Krs Unna
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Herne' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-04-27 03:53:55' AND '2023-05-07 09:39:46';
  params:
  - - '2023-04-27 03:53:55'
    - '2023-05-07 09:39:46'
  - Krs Herne
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Ahaus' AND f.timestamp BETWEEN '2023-06-20 10:37:51' AND '2023-07-03 15:13:42' AND f.altitude < 1290 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-06-20 10:37:51'
    - '2023-07-03 15:13:42'
  - Gem Ahaus
  - 1290
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Borken' WHERE f.timestamp BETWEEN '2023-12-22 21:35:53' AND '2023-12-23 11:06:31' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-12-22 21:35:53'
    - '2023-12-23 11:06:31'
  - Krs Borken
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Wesel' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-04-11 00:27:28' AND '2023-04-15 16:18:55';
  params:
  - - '2023-04-11 00:27:28'
    - '2023-04-15 16:18:55'
  - Krs Wesel
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.2730288374432752e-05) WHERE c.name = 'Neuenrade' AND f.timestamp BETWEEN '2023-12-21 08:07:30' AND '2023-12-30 21:12:31';
  params:
  - - '2023-12-21 08:07:30'
    - '2023-12-30 21:12:31'
  - Neuenrade
  - 1.2730288374432752e-05
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-03-05'::timestamp, DATE '2023-03-05'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Halver' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-03-05'
  - Gem Halver
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Solingen' AND f.timestamp BETWEEN '2023-10-11 09:11:09' AND '2023-10-23 04:09:19' AND f.altitude < 1060 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-10-11 09:11:09'
    - '2023-10-23 04:09:19'
  - Gem Solingen
  - 1060
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Warendorf' WHERE f.timestamp BETWEEN '2023-12-24 05:07:26' AND '2023-12-24 23:00:16' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-12-24 05:07:26'
    - '2023-12-24 23:00:16'
  - Krs Warendorf
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Muelheim an der Ruhr' AND f.timestamp BETWEEN '2023-02-11 03:46:33' AND '2023-02-21 10:42:50' AND f.altitude < 670 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-02-11 03:46:33'
    - '2023-02-21 10:42:50'
  - Gem Muelheim an der Ruhr
  - 670
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Raesfeld' AND f.timestamp BETWEEN '2023-08-02 07:40:25' AND '2023-08-08 11:20:29' AND f.altitude < 960 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-08-02 07:40:25'
    - '2023-08-08 11:20:29'
  - Gem Raesfeld
  - 960
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 6.661526887123284e-06) WHERE c.name = 'Minden' AND f.timestamp BETWEEN '2023-12-02 10:45:48' AND '2023-12-04 19:29:52';
  params:
  - - '2023-12-02 10:45:48'
    - '2023-12-04 19:29:52'
  - Minden
  - 6.661526887123284e-06
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Leichlingen (Rhld.)' AND f.timestamp BETWEEN '2023-10-01 03:31:16' AND '2023-10-05 09:56:15' AND f.altitude < 1420 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-10-01 03:31:16'
    - '2023-10-05 09:56:15'
  - Gem Leichlingen (Rhld.)
  - 1420
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3.962909811714108e-06) WHERE c.name = 'Schwerte' AND f.timestamp BETWEEN '2023-07-01 15:18:12' AND '2023-07-11 14:00:01';
  params:
  - - '2023-07-01 15:18:12'
    - '2023-07-11 14:00:01'
  - Schwerte
  - 3.962909811714108e-06
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-04-10 22:39:54' GROUP BY b.name;
  params:
  - '2023-04-10 22:39:54'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-01-02 22:43:55' GROUP BY b.name;
  params:
  - '2023-01-02 22:43:55'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Mettmann' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-05-09 04:49:52' AND '2023-05-16 13:07:32';
  params:
  - - '2023-05-09 04:49:52'
    - '2023-05-16 13:07:32'
  - Krs Mettmann
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Bochum' WHERE f.timestamp BETWEEN '2023-07-12 16:50:56' AND '2023-07-13 02:52:05' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-07-12 16:50:56'
    - '2023-07-13 02:52:05'
  - Krs Bochum
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-03-07'::timestamp, DATE '2023-03-07'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Hoerstel' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-03-07'
  - Gem Hoerstel
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-03-13'::timestamp, DATE '2023-03-13'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Schieder-Schwalenberg' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-03-13'
  - Gem Schieder-Schwalenberg
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Dortmund' WHERE f.timestamp BETWEEN '2023-02-23 01:38:06' AND '2023-02-23 19:14:58' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-02-23 01:38:06'
    - '2023-02-23 19:14:58'
  - Krs Dortmund
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Soest' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-02-23 00:33:15' AND '2023-03-05 09:46:12';
  params:
  - - '2023-02-23 00:33:15'
    - '2023-03-05 09:46:12'
  - Krs Soest
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-08-28'::timestamp, DATE '2023-08-28'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Ense' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-08-28'
  - Gem Ense
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-09-26 02:17:52' GROUP BY b.name;
  params:
  - '2023-09-26 02:17:52'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Oberhausen' WHERE f.timestamp BETWEEN '2023-10-01 12:48:59' AND '2023-10-03 03:43:36' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-10-01 12:48:59'
    - '2023-10-03 03:43:36'
  - Krs Oberhausen
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Duisburg' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-07-17 04:01:14' AND '2023-07-29 20:16:20';
  params:
  - - '2023-07-17 04:01:14'
    - '2023-07-29 20:16:20'
  - Krs Duisburg
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Kleve' WHERE f.timestamp BETWEEN '2023-03-21 10:55:09' AND '2023-03-23 06:55:27' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-03-21 10:55:09'
    - '2023-03-23 06:55:27'
  - Krs Kleve
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-08-16 19:03:31' GROUP BY b.name;
  params:
  - '2023-08-16 19:03:31'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Hochsauerlandkreis' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-02-26 03:13:04' AND '2023-03-08 03:18:38';
  params:
  - - '2023-02-26 03:13:04'
    - '2023-03-08 03:18:38'
  - Krs Hochsauerlandkreis
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 8.398356280620984e-06) WHERE c.name = 'Bad Wuennenberg' AND f.timestamp BETWEEN '2023-03-16 20:42:40' AND '2023-03-26 06:59:42';
  params:
  - - '2023-03-16 20:42:40'
    - '2023-03-26 06:59:42'
  - Bad Wuennenberg
  - 8.398356280620984e-06
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.2966173285411694e-05) WHERE c.name = 'Brilon' AND f.timestamp BETWEEN '2023-10-11 05:15:27' AND '2023-10-19 01:32:06';
  params:
  - - '2023-10-11 05:15:27'
    - '2023-10-19 01:32:06'
  - Brilon
  - 1.2966173285411694e-05
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.448427211572745e-05) WHERE c.name = 'Linnich' AND f.timestamp BETWEEN '2023-07-10 11:36:40' AND '2023-07-19 08:57:03';
  params:
  - - '2023-07-10 11:36:40'
    - '2023-07-19 08:57:03'
  - Linnich
  - 1.448427211572745e-05
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Werl' AND f.timestamp BETWEEN '2023-04-19 20:24:15' AND '2023-04-26 19:05:51' AND f.altitude < 890 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-04-19 20:24:15'
    - '2023-04-26 19:05:51'
  - Gem Werl
  - 890
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Soest' WHERE f.timestamp BETWEEN '2023-05-22 09:03:34' AND '2023-05-23 05:34:32' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-05-22 09:03:34'
    - '2023-05-23 05:34:32'
  - Krs Soest
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-10-27 13:17:47' GROUP BY b.name;
  params:
  - '2023-10-27 13:17:47'
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-06-30'::timestamp, DATE '2023-06-30'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Bad Laasphe' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-06-30'
  - Gem Bad Laasphe
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 6.177085499751546e-06) WHERE c.name = 'Luedinghausen' AND f.timestamp BETWEEN '2023-10-10 04:42:55' AND '2023-10-17 17:50:00';
  params:
  - - '2023-10-10 04:42:55'
    - '2023-10-17 17:50:00'
  - Luedinghausen
  - 6.177085499751546e-06
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 8.643208713676293e-06) WHERE c.name = 'Baesweiler' AND f.timestamp BETWEEN '2023-10-19 12:13:52' AND '2023-11-01 07:17:13';
  params:
  - - '2023-10-19 12:13:52'
    - '2023-11-01 07:17:13'
  - Baesweiler
  - 8.643208713676293e-06
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-06-25 21:26:40' GROUP BY b.name;
  params:
  - '2023-06-25 21:26:40'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Balve' AND f.timestamp BETWEEN '2023-12-20 23:08:38' AND '2023-12-30 18:35:10' AND f.altitude < 1000 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-12-20 23:08:38'
    - '2023-12-30 18:35:10'
  - Gem Balve
  - 1000
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-02-23'::timestamp, DATE '2023-02-23'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Geilenkirchen' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-02-23'
  - Gem Geilenkirchen
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Unna' WHERE f.timestamp BETWEEN '2023-09-28 02:33:05' AND '2023-09-30 02:04:49' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-09-28 02:33:05'
    - '2023-09-30 02:04:49'
  - Krs Unna
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Dueren' WHERE f.timestamp BETWEEN '2023-12-20 22:31:38' AND '2023-12-22 09:54:46' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-12-20 22:31:38'
    - '2023-12-22 09:54:46'
  - Krs Dueren
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-03-02'::timestamp, DATE '2023-03-02'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Siegen' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-03-02'
  - Gem Siegen
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 4.590959961430919e-06) WHERE c.name = 'Nieheim' AND f.timestamp BETWEEN '2023-10-21 15:02:53' AND '2023-10-24 07:03:25';
  params:
  - - '2023-10-21 15:02:53'
    - '2023-10-24 07:03:25'
  - Nieheim
  - 4.590959961430919e-06
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-04-16 13:54:43' GROUP BY b.name;
  params:
  - '2023-04-16 13:54:43'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.4504378450434123e-05) WHERE c.name = 'Sendenhorst' AND f.timestamp BETWEEN '2023-03-13 18:35:49' AND '2023-03-20 00:00:58';
  params:
  - - '2023-03-13 18:35:49'
    - '2023-03-20 00:00:58'
  - Sendenhorst
  - 1.4504378450434123e-05
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.2011270097172693e-05) WHERE c.name = 'Olpe' AND f.timestamp BETWEEN '2023-03-18 07:27:10' AND '2023-03-21 18:13:05';
  params:
  - - '2023-03-18 07:27:10'
    - '2023-03-21 18:13:05'
  - Olpe
  - 1.2011270097172693e-05
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-01-26 08:46:51' GROUP BY b.name;
  params:
  - '2023-01-26 08:46:51'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Soest' WHERE f.timestamp BETWEEN '2023-12-02 22:34:18' AND '2023-12-03 07:21:25' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-12-02 22:34:18'
    - '2023-12-03 07:21:25'
  - Krs Soest
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Oberbergischer Kreis' WHERE f.timestamp BETWEEN '2023-06-17 07:58:37' AND '2023-06-17 20:49:35' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-06-17 07:58:37'
    - '2023-06-17 20:49:35'
  - Krs Oberbergischer Kreis
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Gevelsberg' AND f.timestamp BETWEEN '2023-07-17 04:27:39' AND '2023-07-19 20:37:50' AND f.altitude < 760 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-07-17 04:27:39'
    - '2023-07-19 20:37:50'
  - Gem Gevelsberg
  - 760
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Euskirchen' WHERE f.timestamp BETWEEN '2023-08-04 03:51:52' AND '2023-08-04 20:53:05' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-08-04 03:51:52'
    - '2023-08-04 20:53:05'
  - Krs Euskirchen
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-02-03'::timestamp, DATE '2023-02-03'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Lohmar' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-02-03'
  - Gem Lohmar
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Wickede (Ruhr)' AND f.timestamp BETWEEN '2023-08-09 11:33:06' AND '2023-08-13 09:53:11' AND f.altitude < 1460 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-08-09 11:33:06'
    - '2023-08-13 09:53:11'
  - Gem Wickede (Ruhr)
  - 1460
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-04-03'::timestamp, DATE '2023-04-03'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Minden' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-04-03'
  - Gem Minden
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-03-11'::timestamp, DATE '2023-03-11'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Datteln' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-03-11'
  - Gem Datteln
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Maerkischer Kreis' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-11-03 20:22:06' AND '2023-11-12 11:21:46';
  params:
  - - '2023-11-03 20:22:06'
    - '2023-11-12 11:21:46'
  - Krs Maerkischer Kreis
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.0194626849954635e-05) WHERE c.name = 'Rheda-Wiedenbrueck' AND f.timestamp BETWEEN '2023-04-09 20:12:28' AND '2023-04-20 00:25:11';
  params:
  - - '2023-04-09 20:12:28'
    - '2023-04-20 00:25:11'
  - Rheda-Wiedenbrueck
  - 1.0194626849954635e-05
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Coesfeld' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-06-20 11:48:48' AND '2023-06-27 21:15:05';
  params:
  - - '2023-06-20 11:48:48'
    - '2023-06-27 21:15:05'
  - Krs Coesfeld
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Brilon' AND f.timestamp BETWEEN '2023-04-20 07:07:21' AND '2023-04-25 08:51:14' AND f.altitude < 840 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-04-20 07:07:21'
    - '2023-04-25 08:51:14'
  - Gem Brilon
  - 840
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.4207502365800909e-05) WHERE c.name = 'Menden' AND f.timestamp BETWEEN '2023-03-18 04:52:04' AND '2023-04-02 04:10:44';
  params:
  - - '2023-03-18 04:52:04'
    - '2023-04-02 04:10:44'
  - Menden
  - 1.4207502365800909e-05
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Gronau (Westf.)' AND f.timestamp BETWEEN '2023-07-09 05:20:09' AND '2023-07-20 18:41:38' AND f.altitude < 1470 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-07-09 05:20:09'
    - '2023-07-20 18:41:38'
  - Gem Gronau (Westf.)
  - 1470
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Rheinisch-Bergischer Kreis' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-02-06 01:56:13' AND '2023-02-10 17:43:49';
  params:
  - - '2023-02-06 01:56:13'
    - '2023-02-10 17:43:49'
  - Krs Rheinisch-Bergischer Kreis
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Rhein-Sieg-Kreis' WHERE f.timestamp BETWEEN '2023-06-19 08:58:34' AND '2023-06-20 16:59:50' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-06-19 08:58:34'
    - '2023-06-20 16:59:50'
  - Krs Rhein-Sieg-Kreis
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 4.818024108123425e-06) WHERE c.name = 'Herne city' AND f.timestamp BETWEEN '2023-09-16 07:23:16' AND '2023-09-22 10:31:02';
  params:
  - - '2023-09-16 07:23:16'
    - '2023-09-22 10:31:02'
  - Herne city
  - 4.818024108123425e-06
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.2933666084738226e-05) WHERE c.name = 'Straelen' AND f.timestamp BETWEEN '2023-05-19 12:22:20' AND '2023-05-26 11:02:46';
  params:
  - - '2023-05-19 12:22:20'
    - '2023-05-26 11:02:46'
  - Straelen
  - 1.2933666084738226e-05
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Hagen' WHERE f.timestamp BETWEEN '2023-10-19 21:26:36' AND '2023-10-20 07:18:57' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-10-19 21:26:36'
    - '2023-10-20 07:18:57'
  - Krs Hagen
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Hoexter' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-06-15 07:56:20' AND '2023-06-28 23:51:26';
  params:
  - - '2023-06-15 07:56:20'
    - '2023-06-28 23:51:26'
  - Krs Hoexter
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3.6720911151730696e-06) WHERE c.name = 'Wassenberg' AND f.timestamp BETWEEN '2023-05-01 06:35:32' AND '2023-05-06 23:19:14';
  params:
  - - '2023-05-01 06:35:32'
    - '2023-05-06 23:19:14'
  - Wassenberg
  - 3.6720911151730696e-06
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Selm' AND f.timestamp BETWEEN '2023-07-20 15:29:03' AND '2023-07-23 07:09:46' AND f.altitude < 960 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-07-20 15:29:03'
    - '2023-07-23 07:09:46'
  - Gem Selm
  - 960
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Mettmann' WHERE f.timestamp BETWEEN '2023-09-05 17:57:17' AND '2023-09-07 00:07:23' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-09-05 17:57:17'
    - '2023-09-07 00:07:23'
  - Krs Mettmann
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-01-23 13:44:45' GROUP BY b.name;
  params:
  - '2023-01-23 13:44:45'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 9.173563475525345e-06) WHERE c.name = 'Luedinghausen' AND f.timestamp BETWEEN '2023-05-15 06:24:33' AND '2023-05-25 05:07:33';
  params:
  - - '2023-05-15 06:24:33'
    - '2023-05-25 05:07:33'
  - Luedinghausen
  - 9.173563475525345e-06
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Dortmund' AND f.timestamp BETWEEN '2023-07-09 14:07:27' AND '2023-07-18 15:50:46' AND f.altitude < 880 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-07-09 14:07:27'
    - '2023-07-18 15:50:46'
  - Gem Dortmund
  - 880
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Leverkusen' WHERE f.timestamp BETWEEN '2023-06-23 23:53:35' AND '2023-06-25 20:52:38' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-06-23 23:53:35'
    - '2023-06-25 20:52:38'
  - Krs Leverkusen
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Soest' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-04-15 22:08:29' AND '2023-04-24 08:53:24';
  params:
  - - '2023-04-15 22:08:29'
    - '2023-04-24 08:53:24'
  - Krs Soest
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.4540274450928619e-05) WHERE c.name = 'Duisburg' AND f.timestamp BETWEEN '2023-03-05 08:50:47' AND '2023-03-18 02:33:36';
  params:
  - - '2023-03-05 08:50:47'
    - '2023-03-18 02:33:36'
  - Duisburg
  - 1.4540274450928619e-05
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3.785747152882168e-06) WHERE c.name = 'Minden' AND f.timestamp BETWEEN '2023-09-16 04:40:23' AND '2023-09-21 19:33:11';
  params:
  - - '2023-09-16 04:40:23'
    - '2023-09-21 19:33:11'
  - Minden
  - 3.785747152882168e-06
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Hagen' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-11-07 11:07:35' AND '2023-11-09 20:52:51';
  params:
  - - '2023-11-07 11:07:35'
    - '2023-11-09 20:52:51'
  - Krs Hagen
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-04-07'::timestamp, DATE '2023-04-07'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Bad Lippspringe' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-04-07'
  - Gem Bad Lippspringe
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-04-28'::timestamp, DATE '2023-04-28'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Datteln' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-04-28'
  - Gem Datteln
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Leopoldshoehe' AND f.timestamp BETWEEN '2023-11-16 10:44:04' AND '2023-11-22 09:49:50' AND f.altitude < 1030 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-11-16 10:44:04'
    - '2023-11-22 09:49:50'
  - Gem Leopoldshoehe
  - 1030
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-11-01 15:12:18' GROUP BY b.name;
  params:
  - '2023-11-01 15:12:18'
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-05-28'::timestamp, DATE '2023-05-28'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Anroechte' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-05-28'
  - Gem Anroechte
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Essen' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-06-15 18:12:31' AND '2023-06-22 16:13:06';
  params:
  - - '2023-06-15 18:12:31'
    - '2023-06-22 16:13:06'
  - Krs Essen
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.5238258480615645e-05) WHERE c.name = 'Paderborn' AND f.timestamp BETWEEN '2023-03-20 06:41:49' AND '2023-03-29 07:02:12';
  params:
  - - '2023-03-20 06:41:49'
    - '2023-03-29 07:02:12'
  - Paderborn
  - 1.5238258480615645e-05
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Wuppertal' AND f.timestamp BETWEEN '2023-05-15 04:18:19' AND '2023-05-20 21:49:00' AND f.altitude < 930 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-05-15 04:18:19'
    - '2023-05-20 21:49:00'
  - Gem Wuppertal
  - 930
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-10-27'::timestamp, DATE '2023-10-27'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Hamminkeln' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-10-27'
  - Gem Hamminkeln
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Moenchengladbach' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-05-28 23:14:26' AND '2023-06-08 14:16:46';
  params:
  - - '2023-05-28 23:14:26'
    - '2023-06-08 14:16:46'
  - Krs Moenchengladbach
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-02-01'::timestamp, DATE '2023-02-01'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Havixbeck' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-02-01'
  - Gem Havixbeck
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-08-18'::timestamp, DATE '2023-08-18'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Hoexter' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-08-18'
  - Gem Hoexter
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 9.416643840441103e-06) WHERE c.name = 'Grevenbroich' AND f.timestamp BETWEEN '2023-03-20 08:18:17' AND '2023-04-01 13:13:52';
  params:
  - - '2023-03-20 08:18:17'
    - '2023-04-01 13:13:52'
  - Grevenbroich
  - 9.416643840441103e-06
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-06-30 06:34:57' GROUP BY b.name;
  params:
  - '2023-06-30 06:34:57'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 5.761249244797127e-06) WHERE c.name = 'Nideggen' AND f.timestamp BETWEEN '2023-04-18 00:02:14' AND '2023-04-20 22:36:11';
  params:
  - - '2023-04-18 00:02:14'
    - '2023-04-20 22:36:11'
  - Nideggen
  - 5.761249244797127e-06
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.046267115492436e-05) WHERE c.name = 'Warendorf' AND f.timestamp BETWEEN '2023-01-26 02:35:14' AND '2023-02-06 05:45:42';
  params:
  - - '2023-01-26 02:35:14'
    - '2023-02-06 05:45:42'
  - Warendorf
  - 1.046267115492436e-05
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-11-11 10:32:57' GROUP BY b.name;
  params:
  - '2023-11-11 10:32:57'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-04-15 03:36:37' GROUP BY b.name;
  params:
  - '2023-04-15 03:36:37'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.252245511333309e-06) WHERE c.name = 'Coesfeld' AND f.timestamp BETWEEN '2023-03-17 05:47:21' AND '2023-03-23 03:30:06';
  params:
  - - '2023-03-17 05:47:21'
    - '2023-03-23 03:30:06'
  - Coesfeld
  - 7.252245511333309e-06
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Minden-Luebbecke' WHERE f.timestamp BETWEEN '2023-05-10 19:58:20' AND '2023-05-12 19:00:12' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-05-10 19:58:20'
    - '2023-05-12 19:00:12'
  - Krs Minden-Luebbecke
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Staedteregion Aachen' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-06-09 23:36:21' AND '2023-06-22 23:17:01';
  params:
  - - '2023-06-09 23:36:21'
    - '2023-06-22 23:17:01'
  - Krs Staedteregion Aachen
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Goch' AND f.timestamp BETWEEN '2023-05-22 23:10:00' AND '2023-05-29 06:08:41' AND f.altitude < 680 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-05-22 23:10:00'
    - '2023-05-29 06:08:41'
  - Gem Goch
  - 680
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Maerkischer Kreis' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-06-27 15:24:34' AND '2023-07-03 17:25:27';
  params:
  - - '2023-06-27 15:24:34'
    - '2023-07-03 17:25:27'
  - Krs Maerkischer Kreis
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Bochum' AND f.timestamp BETWEEN '2023-03-17 22:34:51' AND '2023-03-24 10:35:31' AND f.altitude < 1340 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-03-17 22:34:51'
    - '2023-03-24 10:35:31'
  - Gem Bochum
  - 1340
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Bielefeld' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-01-14 20:08:47' AND '2023-01-27 13:11:05';
  params:
  - - '2023-01-14 20:08:47'
    - '2023-01-27 13:11:05'
  - Krs Bielefeld
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Wiehl' AND f.timestamp BETWEEN '2023-01-24 01:05:22' AND '2023-01-31 09:20:01' AND f.altitude < 1190 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-01-24 01:05:22'
    - '2023-01-31 09:20:01'
  - Gem Wiehl
  - 1190
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-04-21 11:04:08' GROUP BY b.name;
  params:
  - '2023-04-21 11:04:08'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Maerkischer Kreis' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-05-28 05:52:26' AND '2023-06-11 16:30:56';
  params:
  - - '2023-05-28 05:52:26'
    - '2023-06-11 16:30:56'
  - Krs Maerkischer Kreis
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Hagen' AND f.timestamp BETWEEN '2023-11-03 13:17:02' AND '2023-11-10 23:42:32' AND f.altitude < 1480 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-11-03 13:17:02'
    - '2023-11-10 23:42:32'
  - Gem Hagen
  - 1480
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-04-12'::timestamp, DATE '2023-04-12'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Olpe' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-04-12'
  - Gem Olpe
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Minden-Luebbecke' WHERE f.timestamp BETWEEN '2023-06-13 05:30:52' AND '2023-06-13 10:35:05' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-06-13 05:30:52'
    - '2023-06-13 10:35:05'
  - Krs Minden-Luebbecke
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Guetersloh' WHERE f.timestamp BETWEEN '2023-10-19 22:23:56' AND '2023-10-20 03:41:08' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-10-19 22:23:56'
    - '2023-10-20 03:41:08'
  - Krs Guetersloh
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Steinfurt' WHERE f.timestamp BETWEEN '2023-08-02 07:37:11' AND '2023-08-03 19:28:20' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-08-02 07:37:11'
    - '2023-08-03 19:28:20'
  - Krs Steinfurt
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-08-10'::timestamp, DATE '2023-08-10'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Schalksmuehle' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-08-10'
  - Gem Schalksmuehle
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-05-31'::timestamp, DATE '2023-05-31'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Essen' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-05-31'
  - Gem Essen
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-05-16'::timestamp, DATE '2023-05-16'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Blankenheim' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-05-16'
  - Gem Blankenheim
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Ostbevern' AND f.timestamp BETWEEN '2023-07-17 20:15:37' AND '2023-07-28 22:04:22' AND f.altitude < 970 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-07-17 20:15:37'
    - '2023-07-28 22:04:22'
  - Gem Ostbevern
  - 970
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Duesseldorf' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-11-13 20:49:09' AND '2023-11-22 08:37:08';
  params:
  - - '2023-11-13 20:49:09'
    - '2023-11-22 08:37:08'
  - Krs Duesseldorf
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Unna' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-01-01 00:00:01' AND '2023-01-09 23:04:12';
  params:
  - - '2023-01-01 00:00:01'
    - '2023-01-09 23:04:12'
  - Krs Unna
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-06-11 23:06:19' GROUP BY b.name;
  params:
  - '2023-06-11 23:06:19'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-01-17 10:06:20' GROUP BY b.name;
  params:
  - '2023-01-17 10:06:20'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-04-28 15:41:44' GROUP BY b.name;
  params:
  - '2023-04-28 15:41:44'
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-04-01'::timestamp, DATE '2023-04-01'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Meschede' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-04-01'
  - Gem Meschede
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-03-03'::timestamp, DATE '2023-03-03'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Grevenbroich' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-03-03'
  - Gem Grevenbroich
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.1795885102403807e-05) WHERE c.name = 'Espelkamp' AND f.timestamp BETWEEN '2023-09-12 12:42:18' AND '2023-09-24 11:14:43';
  params:
  - - '2023-09-12 12:42:18'
    - '2023-09-24 11:14:43'
  - Espelkamp
  - 1.1795885102403807e-05
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Paderborn' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-01-01 09:56:19' AND '2023-01-09 18:44:15';
  params:
  - - '2023-01-01 09:56:19'
    - '2023-01-09 18:44:15'
  - Krs Paderborn
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Dinslaken' AND f.timestamp BETWEEN '2023-07-29 09:33:38' AND '2023-08-10 00:48:51' AND f.altitude < 1110 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-07-29 09:33:38'
    - '2023-08-10 00:48:51'
  - Gem Dinslaken
  - 1110
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Duisburg' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-03-08 07:05:05' AND '2023-03-11 04:09:10';
  params:
  - - '2023-03-08 07:05:05'
    - '2023-03-11 04:09:10'
  - Krs Duisburg
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-05-10'::timestamp, DATE '2023-05-10'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Bielefeld' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-05-10'
  - Gem Bielefeld
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Blankenheim' AND f.timestamp BETWEEN '2023-01-01 00:00:01' AND '2023-01-04 05:08:02' AND f.altitude < 960 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-01-01 00:00:01'
    - '2023-01-04 05:08:02'
  - Gem Blankenheim
  - 960
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-09-06 22:22:50' GROUP BY b.name;
  params:
  - '2023-09-06 22:22:50'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Minden-Luebbecke' WHERE f.timestamp BETWEEN '2023-11-16 10:48:22' AND '2023-11-18 04:03:57' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-11-16 10:48:22'
    - '2023-11-18 04:03:57'
  - Krs Minden-Luebbecke
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-07-29'::timestamp, DATE '2023-07-29'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Leverkusen' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-07-29'
  - Gem Leverkusen
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Bad Berleburg' AND f.timestamp BETWEEN '2023-09-13 00:46:57' AND '2023-09-15 17:00:44' AND f.altitude < 530 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-09-13 00:46:57'
    - '2023-09-15 17:00:44'
  - Gem Bad Berleburg
  - 530
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-10-18 17:35:11' GROUP BY b.name;
  params:
  - '2023-10-18 17:35:11'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Hochsauerlandkreis' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-01-16 19:25:20' AND '2023-01-25 18:32:57';
  params:
  - - '2023-01-16 19:25:20'
    - '2023-01-25 18:32:57'
  - Krs Hochsauerlandkreis
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Leverkusen' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-11-23 03:58:53' AND '2023-11-30 07:46:56';
  params:
  - - '2023-11-23 03:58:53'
    - '2023-11-30 07:46:56'
  - Krs Leverkusen
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-02-28 01:04:53' GROUP BY b.name;
  params:
  - '2023-02-28 01:04:53'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Rhein-Sieg-Kreis' WHERE f.timestamp BETWEEN '2023-03-30 09:28:47' AND '2023-03-30 19:14:36' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-03-30 09:28:47'
    - '2023-03-30 19:14:36'
  - Krs Rhein-Sieg-Kreis
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-11-08'::timestamp, DATE '2023-11-08'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Iserlohn' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-11-08'
  - Gem Iserlohn
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-10-19'::timestamp, DATE '2023-10-19'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Wegberg' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-10-19'
  - Gem Wegberg
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Hochsauerlandkreis' WHERE f.timestamp BETWEEN '2023-12-23 21:17:03' AND '2023-12-25 19:12:22' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-12-23 21:17:03'
    - '2023-12-25 19:12:22'
  - Krs Hochsauerlandkreis
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 8.444717901078181e-06) WHERE c.name = 'Gummersbach' AND f.timestamp BETWEEN '2023-02-10 04:47:48' AND '2023-02-18 04:42:15';
  params:
  - - '2023-02-10 04:47:48'
    - '2023-02-18 04:42:15'
  - Gummersbach
  - 8.444717901078181e-06
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-09-23 05:58:16' GROUP BY b.name;
  params:
  - '2023-09-23 05:58:16'
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-05-27'::timestamp, DATE '2023-05-27'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Kreuzau' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-05-27'
  - Gem Kreuzau
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.936568494671043e-06) WHERE c.name = 'Wuelfrath' AND f.timestamp BETWEEN '2023-07-01 07:22:14' AND '2023-07-09 16:03:31';
  params:
  - - '2023-07-01 07:22:14'
    - '2023-07-09 16:03:31'
  - Wuelfrath
  - 7.936568494671043e-06
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.3683503774503217e-05) WHERE c.name = 'Heimbach' AND f.timestamp BETWEEN '2023-11-20 20:59:35' AND '2023-11-27 08:45:02';
  params:
  - - '2023-11-20 20:59:35'
    - '2023-11-27 08:45:02'
  - Heimbach
  - 1.3683503774503217e-05
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = 'Krs Mettmann' AND f.geom && k.geom AND f.timestamp BETWEEN '2023-03-30 06:34:25' AND '2023-04-13 15:58:03';
  params:
  - - '2023-03-30 06:34:25'
    - '2023-04-13 15:58:03'
  - Krs Mettmann
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-02-10 11:34:08' GROUP BY b.name;
  params:
  - '2023-02-10 11:34:08'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.1220808414255579e-05) WHERE c.name = 'Willebadessen' AND f.timestamp BETWEEN '2023-01-01 02:25:16' AND '2023-01-04 19:08:28';
  params:
  - - '2023-01-01 02:25:16'
    - '2023-01-04 19:08:28'
  - Willebadessen
  - 1.1220808414255579e-05
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Lippe' WHERE f.timestamp BETWEEN '2023-04-18 15:53:56' AND '2023-04-20 03:07:38' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-04-18 15:53:56'
    - '2023-04-20 03:07:38'
  - Krs Lippe
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-06-13 04:46:17' GROUP BY b.name;
  params:
  - '2023-06-13 04:46:17'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-10-25 21:43:35' GROUP BY b.name;
  params:
  - '2023-10-25 21:43:35'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-09-12 19:42:55' GROUP BY b.name;
  params:
  - '2023-09-12 19:42:55'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.607146666606265e-06) WHERE c.name = 'Bornheim' AND f.timestamp BETWEEN '2023-09-07 23:34:04' AND '2023-09-11 07:26:30';
  params:
  - - '2023-09-07 23:34:04'
    - '2023-09-11 07:26:30'
  - Bornheim
  - 7.607146666606265e-06
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-09-04'::timestamp, DATE '2023-09-04'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Schalksmuehle' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-09-04'
  - Gem Schalksmuehle
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Overath' AND f.timestamp BETWEEN '2023-09-16 09:41:29' AND '2023-09-23 08:04:13' AND f.altitude < 770 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-09-16 09:41:29'
    - '2023-09-23 08:04:13'
  - Gem Overath
  - 770
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Lippe' WHERE f.timestamp BETWEEN '2023-05-19 13:00:52' AND '2023-05-20 17:32:12' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-05-19 13:00:52'
    - '2023-05-20 17:32:12'
  - Krs Lippe
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-06-10'::timestamp, DATE '2023-06-10'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Stolberg (Rhld.)' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-06-10'
  - Gem Stolberg (Rhld.)
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = 'Krs Maerkischer Kreis' WHERE f.timestamp BETWEEN '2023-04-08 17:34:26' AND '2023-04-09 10:33:05' ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2023-04-08 17:34:26'
    - '2023-04-09 10:33:05'
  - Krs Maerkischer Kreis
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-08-20'::timestamp, DATE '2023-08-20'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Beckum' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-08-20'
  - Gem Beckum
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2023-04-14'::timestamp, DATE '2023-04-14'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = 'Gem Rheurdt' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2023-04-14'
  - Gem Rheurdt
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2023-05-09 14:34:21' GROUP BY b.name;
  params:
  - '2023-05-09 14:34:21'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = 'Gem Wipperfuerth' AND f.timestamp BETWEEN '2023-10-29 10:49:57' AND '2023-11-02 04:27:21' AND f.altitude < 780 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2023-10-29 10:49:57'
    - '2023-11-02 04:27:21'
  - Gem Wipperfuerth
  - 780
