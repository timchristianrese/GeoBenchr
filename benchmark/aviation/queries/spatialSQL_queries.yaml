- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-06-26 21:04:03', '2019-06-27 04:41:48'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-06-26 21:04:03'
    - '2019-06-27 04:41:48'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 9.957451229065043e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-10-24 18:17:38', '2019-10-26 20:19:56'];
  params:
  - - '2019-10-24 18:17:38'
    - '2019-10-26 20:19:56'
  - ''
  - 9.957451229065043e-06
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-02-28 03:19:48', '2019-03-10 17:26:48'] AND f.altitude < 1470 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-02-28 03:19:48'
    - '2019-03-10 17:26:48'
  - ''
  - 1470
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-08-28 13:09:43', '2019-09-08 10:39:42'] AND f.altitude < 660 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-08-28 13:09:43'
    - '2019-09-08 10:39:42'
  - ''
  - 660
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.2123189375465488e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-07-05 17:02:41', '2019-07-19 17:55:53'];
  params:
  - - '2019-07-05 17:02:41'
    - '2019-07-19 17:55:53'
  - ''
  - 1.2123189375465488e-05
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-10-27 08:21:18' GROUP BY b.name;
  params:
  - '2019-10-27 08:21:18'
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-01-30'::timestamp, DATE '2019-01-30'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-01-30'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-06-17 20:49:35' GROUP BY b.name;
  params:
  - '2019-06-17 20:49:35'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-09-25 03:10:33', '2019-10-03 06:06:40'];
  params:
  - - '2019-09-25 03:10:33'
    - '2019-10-03 06:06:40'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-07-19 11:19:52' GROUP BY b.name;
  params:
  - '2019-07-19 11:19:52'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-04-08 22:30:44', '2019-04-13 14:36:28'] AND f.altitude < 1210 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-04-08 22:30:44'
    - '2019-04-13 14:36:28'
  - ''
  - 1210
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-01-02 15:53:40' GROUP BY b.name;
  params:
  - '2019-01-02 15:53:40'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-04-11 18:28:53', '2019-04-24 08:46:37'] AND f.altitude < 1080 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-04-11 18:28:53'
    - '2019-04-24 08:46:37'
  - ''
  - 1080
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-03-13'::timestamp, DATE '2019-03-13'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-03-13'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-03-22 18:12:14', '2019-03-23 19:44:54'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-03-22 18:12:14'
    - '2019-03-23 19:44:54'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-03-06 21:49:38', '2019-03-14 07:35:35'] AND f.altitude < 1420 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-03-06 21:49:38'
    - '2019-03-14 07:35:35'
  - ''
  - 1420
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-06-24 03:22:31', '2019-06-29 19:31:35'];
  params:
  - - '2019-06-24 03:22:31'
    - '2019-06-29 19:31:35'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-12-05 05:28:24', '2019-12-06 16:39:12'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-12-05 05:28:24'
    - '2019-12-06 16:39:12'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-04-17'::timestamp, DATE '2019-04-17'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-04-17'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-02-01 11:45:09', '2019-02-05 14:50:11'] AND f.altitude < 760 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-02-01 11:45:09'
    - '2019-02-05 14:50:11'
  - ''
  - 760
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-11-07 00:49:07' GROUP BY b.name;
  params:
  - '2019-11-07 00:49:07'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-09-04 21:54:42' GROUP BY b.name;
  params:
  - '2019-09-04 21:54:42'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-06-20 00:10:19', '2019-06-28 19:32:50'] AND f.altitude < 1230 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-06-20 00:10:19'
    - '2019-06-28 19:32:50'
  - ''
  - 1230
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-12-07 20:58:37', '2019-12-13 00:42:16'] AND f.altitude < 600 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-12-07 20:58:37'
    - '2019-12-13 00:42:16'
  - ''
  - 600
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-09-11 16:08:53', '2019-09-25 16:52:10'] AND f.altitude < 970 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-09-11 16:08:53'
    - '2019-09-25 16:52:10'
  - ''
  - 970
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-08-04 20:47:30' GROUP BY b.name;
  params:
  - '2019-08-04 20:47:30'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-12-28 09:48:36', '2019-12-31 23:59:59'];
  params:
  - - '2019-12-28 09:48:36'
    - '2019-12-31 23:59:59'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-12-18 22:57:12', '2019-12-27 14:46:16'] AND f.altitude < 660 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-12-18 22:57:12'
    - '2019-12-27 14:46:16'
  - ''
  - 660
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-01-05 16:14:45' GROUP BY b.name;
  params:
  - '2019-01-05 16:14:45'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.2245968821211826e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-07-14 18:40:37', '2019-07-18 02:12:44'];
  params:
  - - '2019-07-14 18:40:37'
    - '2019-07-18 02:12:44'
  - ''
  - 1.2245968821211826e-05
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-08-10'::timestamp, DATE '2019-08-10'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-08-10'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-07-22 09:07:38', '2019-08-02 04:06:27'];
  params:
  - - '2019-07-22 09:07:38'
    - '2019-08-02 04:06:27'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.558546265091599e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-11-24 13:23:47', '2019-12-04 14:39:14'];
  params:
  - - '2019-11-24 13:23:47'
    - '2019-12-04 14:39:14'
  - ''
  - 7.558546265091599e-06
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 5.438520128420086e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-04-06 18:37:47', '2019-04-19 01:16:09'];
  params:
  - - '2019-04-06 18:37:47'
    - '2019-04-19 01:16:09'
  - ''
  - 5.438520128420086e-06
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-08-03 01:48:45', '2019-08-13 01:13:06'];
  params:
  - - '2019-08-03 01:48:45'
    - '2019-08-13 01:13:06'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-04-13 06:17:23', '2019-04-18 09:35:03'] AND f.altitude < 1130 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-04-13 06:17:23'
    - '2019-04-18 09:35:03'
  - ''
  - 1130
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-10-16 01:44:53', '2019-10-28 10:13:24'] AND f.altitude < 700 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-10-16 01:44:53'
    - '2019-10-28 10:13:24'
  - ''
  - 700
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-02-03'::timestamp, DATE '2019-02-03'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-02-03'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-09-26 14:04:34' GROUP BY b.name;
  params:
  - '2019-09-26 14:04:34'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-02-23 07:10:03', '2019-03-09 17:32:45'] AND f.altitude < 1010 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-02-23 07:10:03'
    - '2019-03-09 17:32:45'
  - ''
  - 1010
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-04-21 20:52:46', '2019-04-22 13:53:14'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-04-21 20:52:46'
    - '2019-04-22 13:53:14'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-09-05 20:40:50', '2019-09-16 12:55:24'] AND f.altitude < 1310 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-09-05 20:40:50'
    - '2019-09-16 12:55:24'
  - ''
  - 1310
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-11-15 23:45:59', '2019-11-19 07:25:04'];
  params:
  - - '2019-11-15 23:45:59'
    - '2019-11-19 07:25:04'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-11-01 19:06:50', '2019-11-04 04:46:19'];
  params:
  - - '2019-11-01 19:06:50'
    - '2019-11-04 04:46:19'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-03-02 22:06:00' GROUP BY b.name;
  params:
  - '2019-03-02 22:06:00'
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-08-18'::timestamp, DATE '2019-08-18'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-08-18'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-03-09'::timestamp, DATE '2019-03-09'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-03-09'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-02-23 13:51:41', '2019-02-24 07:35:14'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-02-23 13:51:41'
    - '2019-02-24 07:35:14'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-01-07 09:25:49', '2019-01-14 03:17:19'] AND f.altitude < 970 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-01-07 09:25:49'
    - '2019-01-14 03:17:19'
  - ''
  - 970
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 4.230319847036102e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-08-31 01:22:47', '2019-09-04 12:11:54'];
  params:
  - - '2019-08-31 01:22:47'
    - '2019-09-04 12:11:54'
  - ''
  - 4.230319847036102e-06
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.241532702489959e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-01-31 03:23:15', '2019-02-13 00:27:17'];
  params:
  - - '2019-01-31 03:23:15'
    - '2019-02-13 00:27:17'
  - ''
  - 1.241532702489959e-05
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-10-05 20:06:14', '2019-10-11 08:12:44'] AND f.altitude < 590 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-10-05 20:06:14'
    - '2019-10-11 08:12:44'
  - ''
  - 590
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-05-31 23:44:34' GROUP BY b.name;
  params:
  - '2019-05-31 23:44:34'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-01-01 00:00:01', '2019-01-07 00:22:31'];
  params:
  - - '2019-01-01 00:00:01'
    - '2019-01-07 00:22:31'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 6.498262949766522e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-09-11 12:09:37', '2019-09-16 15:15:19'];
  params:
  - - '2019-09-11 12:09:37'
    - '2019-09-16 15:15:19'
  - ''
  - 6.498262949766522e-06
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-08-08'::timestamp, DATE '2019-08-08'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-08-08'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-06-26 18:31:31', '2019-07-02 07:06:14'] AND f.altitude < 1080 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-06-26 18:31:31'
    - '2019-07-02 07:06:14'
  - ''
  - 1080
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-01-04 10:16:12', '2019-01-07 09:56:35'] AND f.altitude < 570 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-01-04 10:16:12'
    - '2019-01-07 09:56:35'
  - ''
  - 570
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-09-08 19:59:57', '2019-09-20 21:27:14'];
  params:
  - - '2019-09-08 19:59:57'
    - '2019-09-20 21:27:14'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-01-03 21:51:37', '2019-01-05 18:57:56'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-01-03 21:51:37'
    - '2019-01-05 18:57:56'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-01-28'::timestamp, DATE '2019-01-28'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-01-28'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-08-04 13:53:32', '2019-08-16 15:17:15'] AND f.altitude < 740 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-08-04 13:53:32'
    - '2019-08-16 15:17:15'
  - ''
  - 740
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-01-07 20:49:30' GROUP BY b.name;
  params:
  - '2019-01-07 20:49:30'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.051660213693029e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-08-11 01:16:42', '2019-08-25 05:04:39'];
  params:
  - - '2019-08-11 01:16:42'
    - '2019-08-25 05:04:39'
  - ''
  - 1.051660213693029e-05
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-08-04 04:14:42', '2019-08-04 16:38:54'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-08-04 04:14:42'
    - '2019-08-04 16:38:54'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-09-30 18:16:48' GROUP BY b.name;
  params:
  - '2019-09-30 18:16:48'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.2564108712414273e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-11-03 21:45:17', '2019-11-07 03:41:14'];
  params:
  - - '2019-11-03 21:45:17'
    - '2019-11-07 03:41:14'
  - ''
  - 1.2564108712414273e-05
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-01-17'::timestamp, DATE '2019-01-17'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-01-17'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-12-21 12:22:17', '2019-12-21 18:14:51'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-12-21 12:22:17'
    - '2019-12-21 18:14:51'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-02-26 00:06:43', '2019-03-05 02:43:11'];
  params:
  - - '2019-02-26 00:06:43'
    - '2019-03-05 02:43:11'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-01-05 14:57:00', '2019-01-07 21:30:03'] AND f.altitude < 1170 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-01-05 14:57:00'
    - '2019-01-07 21:30:03'
  - ''
  - 1170
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.4801963459888668e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-01-07 16:01:21', '2019-01-12 01:11:45'];
  params:
  - - '2019-01-07 16:01:21'
    - '2019-01-12 01:11:45'
  - ''
  - 1.4801963459888668e-05
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-08-04 07:11:15' GROUP BY b.name;
  params:
  - '2019-08-04 07:11:15'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-12-25 20:12:38', '2019-12-31 23:59:59'];
  params:
  - - '2019-12-25 20:12:38'
    - '2019-12-31 23:59:59'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-08-12 02:12:00', '2019-08-21 18:42:37'] AND f.altitude < 1330 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-08-12 02:12:00'
    - '2019-08-21 18:42:37'
  - ''
  - 1330
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-11-06 04:04:31', '2019-11-06 13:54:39'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-11-06 04:04:31'
    - '2019-11-06 13:54:39'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.0758040398187473e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-03-17 11:24:47', '2019-03-30 20:57:26'];
  params:
  - - '2019-03-17 11:24:47'
    - '2019-03-30 20:57:26'
  - ''
  - 1.0758040398187473e-05
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-01-03 04:17:36' GROUP BY b.name;
  params:
  - '2019-01-03 04:17:36'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-01-30 10:23:38' GROUP BY b.name;
  params:
  - '2019-01-30 10:23:38'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-05-01 06:44:03', '2019-05-02 03:17:18'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-05-01 06:44:03'
    - '2019-05-02 03:17:18'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-04-18 23:51:20', '2019-04-21 02:34:50'];
  params:
  - - '2019-04-18 23:51:20'
    - '2019-04-21 02:34:50'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-02-05'::timestamp, DATE '2019-02-05'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-02-05'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-12-25 11:12:55', '2019-12-31 17:22:24'];
  params:
  - - '2019-12-25 11:12:55'
    - '2019-12-31 17:22:24'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-09-19 04:14:30', '2019-09-20 17:24:51'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-09-19 04:14:30'
    - '2019-09-20 17:24:51'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-03-09 18:14:28', '2019-03-13 06:14:31'] AND f.altitude < 560 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-03-09 18:14:28'
    - '2019-03-13 06:14:31'
  - ''
  - 560
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-04-01 22:13:50', '2019-04-09 01:35:47'] AND f.altitude < 1400 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-04-01 22:13:50'
    - '2019-04-09 01:35:47'
  - ''
  - 1400
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-02-23 01:38:06' GROUP BY b.name;
  params:
  - '2019-02-23 01:38:06'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.283582177791062e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-07-11 13:36:23', '2019-07-20 23:57:41'];
  params:
  - - '2019-07-11 13:36:23'
    - '2019-07-20 23:57:41'
  - ''
  - 1.283582177791062e-05
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-07-10 10:30:45', '2019-07-19 06:12:28'];
  params:
  - - '2019-07-10 10:30:45'
    - '2019-07-19 06:12:28'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-01-07'::timestamp, DATE '2019-01-07'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-01-07'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-05-13 04:49:36' GROUP BY b.name;
  params:
  - '2019-05-13 04:49:36'
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-02-25'::timestamp, DATE '2019-02-25'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-02-25'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.55105007474259e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-09-20 06:54:29', '2019-10-04 15:11:43'];
  params:
  - - '2019-09-20 06:54:29'
    - '2019-10-04 15:11:43'
  - ''
  - 7.55105007474259e-06
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-06-05'::timestamp, DATE '2019-06-05'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-06-05'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-06-02 02:51:09', '2019-06-13 21:03:12'];
  params:
  - - '2019-06-02 02:51:09'
    - '2019-06-13 21:03:12'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-12-20 22:30:25', '2019-12-22 09:50:45'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-12-20 22:30:25'
    - '2019-12-22 09:50:45'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-06-20 10:38:14', '2019-07-02 08:51:29'] AND f.altitude < 1360 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-06-20 10:38:14'
    - '2019-07-02 08:51:29'
  - ''
  - 1360
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-08-09 23:31:25', '2019-08-23 06:08:13'];
  params:
  - - '2019-08-09 23:31:25'
    - '2019-08-23 06:08:13'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-06-21'::timestamp, DATE '2019-06-21'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-06-21'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-03-27 00:49:22', '2019-03-31 17:18:10'];
  params:
  - - '2019-03-27 00:49:22'
    - '2019-03-31 17:18:10'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-06-18 16:03:33' GROUP BY b.name;
  params:
  - '2019-06-18 16:03:33'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-08-04 20:30:42' GROUP BY b.name;
  params:
  - '2019-08-04 20:30:42'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-05-10 00:15:51' GROUP BY b.name;
  params:
  - '2019-05-10 00:15:51'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.2010771289117986e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-09-09 16:52:21', '2019-09-14 22:17:41'];
  params:
  - - '2019-09-09 16:52:21'
    - '2019-09-14 22:17:41'
  - ''
  - 1.2010771289117986e-05
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-01-18 05:04:36', '2019-01-23 23:29:10'] AND f.altitude < 1260 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-01-18 05:04:36'
    - '2019-01-23 23:29:10'
  - ''
  - 1260
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-11-11 02:14:05' GROUP BY b.name;
  params:
  - '2019-11-11 02:14:05'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-10-20 03:22:24', '2019-10-21 01:03:38'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-10-20 03:22:24'
    - '2019-10-21 01:03:38'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.0803181545053789e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-09-21 06:07:43', '2019-09-26 09:54:52'];
  params:
  - - '2019-09-21 06:07:43'
    - '2019-09-26 09:54:52'
  - ''
  - 1.0803181545053789e-05
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-09-01 15:13:42', '2019-09-01 20:11:25'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-09-01 15:13:42'
    - '2019-09-01 20:11:25'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-06-24 21:52:34', '2019-07-03 15:08:41'] AND f.altitude < 1460 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-06-24 21:52:34'
    - '2019-07-03 15:08:41'
  - ''
  - 1460
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-06-16 07:17:18', '2019-06-24 22:01:36'];
  params:
  - - '2019-06-16 07:17:18'
    - '2019-06-24 22:01:36'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-10-24 05:25:45', '2019-10-25 11:32:57'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-10-24 05:25:45'
    - '2019-10-25 11:32:57'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-06-14 22:06:25', '2019-06-26 20:58:51'] AND f.altitude < 1360 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-06-14 22:06:25'
    - '2019-06-26 20:58:51'
  - ''
  - 1360
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-08-25 22:46:28', '2019-09-07 00:07:23'];
  params:
  - - '2019-08-25 22:46:28'
    - '2019-09-07 00:07:23'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-06-19 08:58:34' GROUP BY b.name;
  params:
  - '2019-06-19 08:58:34'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-06-20 20:54:35', '2019-06-21 14:00:26'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-06-20 20:54:35'
    - '2019-06-21 14:00:26'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-12-13 03:33:34', '2019-12-27 01:43:42'] AND f.altitude < 1070 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-12-13 03:33:34'
    - '2019-12-27 01:43:42'
  - ''
  - 1070
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 5.567794570712217e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-05-05 10:11:29', '2019-05-11 13:55:53'];
  params:
  - - '2019-05-05 10:11:29'
    - '2019-05-11 13:55:53'
  - ''
  - 5.567794570712217e-06
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-07-17 08:03:39', '2019-07-23 17:31:12'];
  params:
  - - '2019-07-17 08:03:39'
    - '2019-07-23 17:31:12'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-07-12'::timestamp, DATE '2019-07-12'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-07-12'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-07-14 11:33:36', '2019-07-15 04:10:01'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-07-14 11:33:36'
    - '2019-07-15 04:10:01'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.4431798305669092e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-08-30 13:21:57', '2019-09-12 05:06:13'];
  params:
  - - '2019-08-30 13:21:57'
    - '2019-09-12 05:06:13'
  - ''
  - 1.4431798305669092e-05
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-12-02 04:49:15', '2019-12-10 21:18:24'];
  params:
  - - '2019-12-02 04:49:15'
    - '2019-12-10 21:18:24'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-09-29 01:14:53' GROUP BY b.name;
  params:
  - '2019-09-29 01:14:53'
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-04-25'::timestamp, DATE '2019-04-25'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-04-25'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-02-05 07:34:00', '2019-02-07 05:46:32'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-02-05 07:34:00'
    - '2019-02-07 05:46:32'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3.966860079519669e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-10-09 06:51:37', '2019-10-18 13:53:29'];
  params:
  - - '2019-10-09 06:51:37'
    - '2019-10-18 13:53:29'
  - ''
  - 3.966860079519669e-06
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-11-11 02:31:28', '2019-11-16 03:33:13'] AND f.altitude < 1060 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-11-11 02:31:28'
    - '2019-11-16 03:33:13'
  - ''
  - 1060
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-06-04'::timestamp, DATE '2019-06-04'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-06-04'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-07-21 20:06:00', '2019-08-03 20:34:05'] AND f.altitude < 920 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-07-21 20:06:00'
    - '2019-08-03 20:34:05'
  - ''
  - 920
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-01-17 00:02:29', '2019-01-22 21:29:27'];
  params:
  - - '2019-01-17 00:02:29'
    - '2019-01-22 21:29:27'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-11-25 16:21:39', '2019-12-02 13:41:48'];
  params:
  - - '2019-11-25 16:21:39'
    - '2019-12-02 13:41:48'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 6.738726635423436e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-12-14 17:18:46', '2019-12-27 20:52:55'];
  params:
  - - '2019-12-14 17:18:46'
    - '2019-12-27 20:52:55'
  - ''
  - 6.738726635423436e-06
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-05-07 10:02:31', '2019-05-09 06:50:47'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-05-07 10:02:31'
    - '2019-05-09 06:50:47'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-07-31 20:36:34', '2019-08-10 07:32:10'] AND f.altitude < 1350 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-07-31 20:36:34'
    - '2019-08-10 07:32:10'
  - ''
  - 1350
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-05-09 18:27:25', '2019-05-20 09:36:33'];
  params:
  - - '2019-05-09 18:27:25'
    - '2019-05-20 09:36:33'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-01-21 06:17:34', '2019-01-25 08:22:32'];
  params:
  - - '2019-01-21 06:17:34'
    - '2019-01-25 08:22:32'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-11-09 04:55:20', '2019-11-10 16:24:49'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-11-09 04:55:20'
    - '2019-11-10 16:24:49'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-07-20 20:39:01', '2019-08-03 19:28:20'];
  params:
  - - '2019-07-20 20:39:01'
    - '2019-08-03 19:28:20'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.2012747499146488e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-05-01 11:11:22', '2019-05-11 19:25:59'];
  params:
  - - '2019-05-01 11:11:22'
    - '2019-05-11 19:25:59'
  - ''
  - 1.2012747499146488e-05
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-01-30'::timestamp, DATE '2019-01-30'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-01-30'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-06-20 07:12:45', '2019-06-26 19:31:44'] AND f.altitude < 730 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-06-20 07:12:45'
    - '2019-06-26 19:31:44'
  - ''
  - 730
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-01-25'::timestamp, DATE '2019-01-25'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-01-25'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-05-28 04:52:45', '2019-05-28 12:41:30'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-05-28 04:52:45'
    - '2019-05-28 12:41:30'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-06-15'::timestamp, DATE '2019-06-15'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-06-15'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-04-07 06:26:38', '2019-04-20 07:14:43'] AND f.altitude < 1500 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-04-07 06:26:38'
    - '2019-04-20 07:14:43'
  - ''
  - 1500
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-12-10'::timestamp, DATE '2019-12-10'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-12-10'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-07-02 13:36:33' GROUP BY b.name;
  params:
  - '2019-07-02 13:36:33'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-02-17 22:51:58', '2019-03-02 17:40:11'];
  params:
  - - '2019-02-17 22:51:58'
    - '2019-03-02 17:40:11'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.316331934204946e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-07-27 02:13:07', '2019-08-08 07:17:46'];
  params:
  - - '2019-07-27 02:13:07'
    - '2019-08-08 07:17:46'
  - ''
  - 7.316331934204946e-06
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-07-15'::timestamp, DATE '2019-07-15'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-07-15'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-11-19 19:20:43', '2019-11-20 20:18:06'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-11-19 19:20:43'
    - '2019-11-20 20:18:06'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-05-02'::timestamp, DATE '2019-05-02'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-05-02'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-10-10 01:46:13', '2019-10-11 22:07:55'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-10-10 01:46:13'
    - '2019-10-11 22:07:55'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-07-30 04:47:08', '2019-08-10 17:24:53'];
  params:
  - - '2019-07-30 04:47:08'
    - '2019-08-10 17:24:53'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-03-31 04:11:40', '2019-04-10 08:36:16'] AND f.altitude < 790 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-03-31 04:11:40'
    - '2019-04-10 08:36:16'
  - ''
  - 790
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-11-02 15:21:42', '2019-11-16 11:08:52'];
  params:
  - - '2019-11-02 15:21:42'
    - '2019-11-16 11:08:52'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-08-29 12:31:21' GROUP BY b.name;
  params:
  - '2019-08-29 12:31:21'
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-03-08'::timestamp, DATE '2019-03-08'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-03-08'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-09-23 07:26:59', '2019-09-25 01:39:43'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-09-23 07:26:59'
    - '2019-09-25 01:39:43'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-04-25'::timestamp, DATE '2019-04-25'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-04-25'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-03-22'::timestamp, DATE '2019-03-22'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-03-22'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-07-28 15:07:06', '2019-07-28 15:35:57'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-07-28 15:07:06'
    - '2019-07-28 15:35:57'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 8.840047161086722e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-09-07 04:54:27', '2019-09-16 04:19:39'];
  params:
  - - '2019-09-07 04:54:27'
    - '2019-09-16 04:19:39'
  - ''
  - 8.840047161086722e-06
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-09-14 16:48:41' GROUP BY b.name;
  params:
  - '2019-09-14 16:48:41'
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-12-30'::timestamp, DATE '2019-12-30'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-12-30'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-01-08 13:34:59', '2019-01-23 09:24:56'];
  params:
  - - '2019-01-08 13:34:59'
    - '2019-01-23 09:24:56'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.4060706068038195e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-08-24 03:31:49', '2019-08-31 02:56:52'];
  params:
  - - '2019-08-24 03:31:49'
    - '2019-08-31 02:56:52'
  - ''
  - 1.4060706068038195e-05
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.3622493123200701e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-02-18 12:07:07', '2019-02-20 20:33:42'];
  params:
  - - '2019-02-18 12:07:07'
    - '2019-02-20 20:33:42'
  - ''
  - 1.3622493123200701e-05
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-11-03 09:33:41', '2019-11-05 13:23:38'];
  params:
  - - '2019-11-03 09:33:41'
    - '2019-11-05 13:23:38'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-05-27 00:44:55', '2019-06-03 05:46:12'];
  params:
  - - '2019-05-27 00:44:55'
    - '2019-06-03 05:46:12'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-08-24 12:05:47', '2019-08-24 16:32:02'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-08-24 12:05:47'
    - '2019-08-24 16:32:02'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-07-13 04:35:35' GROUP BY b.name;
  params:
  - '2019-07-13 04:35:35'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-12-12 16:50:05', '2019-12-26 03:03:12'] AND f.altitude < 710 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-12-12 16:50:05'
    - '2019-12-26 03:03:12'
  - ''
  - 710
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-06-27'::timestamp, DATE '2019-06-27'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-06-27'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-07-19 08:26:25' GROUP BY b.name;
  params:
  - '2019-07-19 08:26:25'
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-05-19'::timestamp, DATE '2019-05-19'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-05-19'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-10-12 22:20:31' GROUP BY b.name;
  params:
  - '2019-10-12 22:20:31'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-11-16 21:28:39', '2019-11-19 03:45:25'] AND f.altitude < 1420 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-11-16 21:28:39'
    - '2019-11-19 03:45:25'
  - ''
  - 1420
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-08-03 18:11:50', '2019-08-12 11:39:49'] AND f.altitude < 630 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-08-03 18:11:50'
    - '2019-08-12 11:39:49'
  - ''
  - 630
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-06-09'::timestamp, DATE '2019-06-09'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-06-09'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-11-02 15:32:34' GROUP BY b.name;
  params:
  - '2019-11-02 15:32:34'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.4277384681867405e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-08-20 10:39:27', '2019-09-03 22:46:31'];
  params:
  - - '2019-08-20 10:39:27'
    - '2019-09-03 22:46:31'
  - ''
  - 1.4277384681867405e-05
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-03-01 01:08:58', '2019-03-02 18:07:55'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-03-01 01:08:58'
    - '2019-03-02 18:07:55'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-07-28 13:31:24' GROUP BY b.name;
  params:
  - '2019-07-28 13:31:24'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-06-19 04:31:30', '2019-06-19 22:55:27'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-06-19 04:31:30'
    - '2019-06-19 22:55:27'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-07-04 10:55:54' GROUP BY b.name;
  params:
  - '2019-07-04 10:55:54'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-04-14 13:47:03', '2019-04-23 15:04:32'];
  params:
  - - '2019-04-14 13:47:03'
    - '2019-04-23 15:04:32'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-12-05 16:49:12', '2019-12-05 17:18:24'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-12-05 16:49:12'
    - '2019-12-05 17:18:24'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-02-22'::timestamp, DATE '2019-02-22'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-02-22'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-04-08 03:58:30', '2019-04-16 17:10:13'] AND f.altitude < 1240 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-04-08 03:58:30'
    - '2019-04-16 17:10:13'
  - ''
  - 1240
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-03-02 16:14:23' GROUP BY b.name;
  params:
  - '2019-03-02 16:14:23'
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-12-06'::timestamp, DATE '2019-12-06'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-12-06'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-12-18 09:01:00', '2019-12-31 23:59:59'];
  params:
  - - '2019-12-18 09:01:00'
    - '2019-12-31 23:59:59'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-11-17 22:46:48', '2019-11-21 01:36:36'];
  params:
  - - '2019-11-17 22:46:48'
    - '2019-11-21 01:36:36'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-12-08'::timestamp, DATE '2019-12-08'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-12-08'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-10-15 05:59:08', '2019-10-21 00:28:56'] AND f.altitude < 610 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-10-15 05:59:08'
    - '2019-10-21 00:28:56'
  - ''
  - 610
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-03-28 17:46:43', '2019-03-29 03:28:00'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-03-28 17:46:43'
    - '2019-03-29 03:28:00'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-11-29'::timestamp, DATE '2019-11-29'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-11-29'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-09-27 21:05:00' GROUP BY b.name;
  params:
  - '2019-09-27 21:05:00'
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-02-10'::timestamp, DATE '2019-02-10'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-02-10'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-11-01 00:11:11' GROUP BY b.name;
  params:
  - '2019-11-01 00:11:11'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-03-21 23:50:58', '2019-03-25 18:40:07'] AND f.altitude < 1390 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-03-21 23:50:58'
    - '2019-03-25 18:40:07'
  - ''
  - 1390
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-07-25'::timestamp, DATE '2019-07-25'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-07-25'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-09-12 16:32:18', '2019-09-19 10:32:41'];
  params:
  - - '2019-09-12 16:32:18'
    - '2019-09-19 10:32:41'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-06-19 07:57:41', '2019-07-03 11:46:52'];
  params:
  - - '2019-06-19 07:57:41'
    - '2019-07-03 11:46:52'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-10-01 15:10:18' GROUP BY b.name;
  params:
  - '2019-10-01 15:10:18'
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-07-04'::timestamp, DATE '2019-07-04'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-07-04'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-06-14 07:04:09', '2019-06-16 06:20:44'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-06-14 07:04:09'
    - '2019-06-16 06:20:44'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-08-15'::timestamp, DATE '2019-08-15'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-08-15'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-08-13 16:44:29', '2019-08-28 05:31:43'] AND f.altitude < 900 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-08-13 16:44:29'
    - '2019-08-28 05:31:43'
  - ''
  - 900
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-01-03'::timestamp, DATE '2019-01-03'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-01-03'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-07-20 16:07:06', '2019-08-01 03:37:32'] AND f.altitude < 1410 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-07-20 16:07:06'
    - '2019-08-01 03:37:32'
  - ''
  - 1410
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-09-20 05:57:34' GROUP BY b.name;
  params:
  - '2019-09-20 05:57:34'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-04-01 13:07:13' GROUP BY b.name;
  params:
  - '2019-04-01 13:07:13'
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-01-31'::timestamp, DATE '2019-01-31'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-01-31'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-12-17 02:36:38', '2019-12-27 05:12:21'];
  params:
  - - '2019-12-17 02:36:38'
    - '2019-12-27 05:12:21'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.3101228309881961e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-07-10 06:53:40', '2019-07-14 09:16:23'];
  params:
  - - '2019-07-10 06:53:40'
    - '2019-07-14 09:16:23'
  - ''
  - 1.3101228309881961e-05
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-07-17 04:05:48' GROUP BY b.name;
  params:
  - '2019-07-17 04:05:48'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-06-20 18:43:58' GROUP BY b.name;
  params:
  - '2019-06-20 18:43:58'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-11-28 06:52:55' GROUP BY b.name;
  params:
  - '2019-11-28 06:52:55'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-08-13 17:00:24', '2019-08-19 08:46:07'] AND f.altitude < 1330 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-08-13 17:00:24'
    - '2019-08-19 08:46:07'
  - ''
  - 1330
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-12-18 00:30:46', '2019-12-25 14:29:16'];
  params:
  - - '2019-12-18 00:30:46'
    - '2019-12-25 14:29:16'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-07-12 06:48:52', '2019-07-12 10:34:42'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-07-12 06:48:52'
    - '2019-07-12 10:34:42'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-05-08 18:02:30' GROUP BY b.name;
  params:
  - '2019-05-08 18:02:30'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-01-02 12:44:25', '2019-01-11 15:02:19'] AND f.altitude < 740 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-01-02 12:44:25'
    - '2019-01-11 15:02:19'
  - ''
  - 740
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.5002618680729517e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-04-07 20:12:53', '2019-04-13 17:06:26'];
  params:
  - - '2019-04-07 20:12:53'
    - '2019-04-13 17:06:26'
  - ''
  - 1.5002618680729517e-05
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-09-24 18:48:18', '2019-09-28 02:33:05'];
  params:
  - - '2019-09-24 18:48:18'
    - '2019-09-28 02:33:05'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-03-15'::timestamp, DATE '2019-03-15'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-03-15'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-05-18 18:24:31', '2019-05-19 14:08:00'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-05-18 18:24:31'
    - '2019-05-19 14:08:00'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-01-27 18:39:39', '2019-01-29 17:17:06'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-01-27 18:39:39'
    - '2019-01-29 17:17:06'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.1551141331112246e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-05-11 05:13:17', '2019-05-16 20:10:59'];
  params:
  - - '2019-05-11 05:13:17'
    - '2019-05-16 20:10:59'
  - ''
  - 7.1551141331112246e-06
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-12-14 16:48:09', '2019-12-25 13:43:35'];
  params:
  - - '2019-12-14 16:48:09'
    - '2019-12-25 13:43:35'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-05-20 08:26:32' GROUP BY b.name;
  params:
  - '2019-05-20 08:26:32'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-04-20 03:47:31' GROUP BY b.name;
  params:
  - '2019-04-20 03:47:31'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-10-25 20:09:19', '2019-11-04 13:28:30'] AND f.altitude < 1050 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-10-25 20:09:19'
    - '2019-11-04 13:28:30'
  - ''
  - 1050
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 9.573584864939251e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-06-08 13:32:14', '2019-06-17 10:38:18'];
  params:
  - - '2019-06-08 13:32:14'
    - '2019-06-17 10:38:18'
  - ''
  - 9.573584864939251e-06
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-01-25 07:57:02' GROUP BY b.name;
  params:
  - '2019-01-25 07:57:02'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-06-02 17:10:00', '2019-06-08 16:48:29'];
  params:
  - - '2019-06-02 17:10:00'
    - '2019-06-08 16:48:29'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-04-11'::timestamp, DATE '2019-04-11'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-04-11'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-09-16 00:53:21', '2019-09-29 02:09:26'] AND f.altitude < 1370 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-09-16 00:53:21'
    - '2019-09-29 02:09:26'
  - ''
  - 1370
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-10-28 15:13:51' GROUP BY b.name;
  params:
  - '2019-10-28 15:13:51'
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-08-18'::timestamp, DATE '2019-08-18'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-08-18'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-01-22 09:11:52', '2019-01-22 23:06:27'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-01-22 09:11:52'
    - '2019-01-22 23:06:27'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-02-25 16:12:12', '2019-03-07 09:46:59'];
  params:
  - - '2019-02-25 16:12:12'
    - '2019-03-07 09:46:59'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-05-01'::timestamp, DATE '2019-05-01'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-05-01'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-07-11 02:16:41', '2019-07-13 22:23:32'] AND f.altitude < 860 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-07-11 02:16:41'
    - '2019-07-13 22:23:32'
  - ''
  - 860
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-01-20 07:46:17', '2019-01-28 01:49:46'] AND f.altitude < 1330 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-01-20 07:46:17'
    - '2019-01-28 01:49:46'
  - ''
  - 1330
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-04-30'::timestamp, DATE '2019-04-30'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-04-30'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-12-20 22:31:38', '2019-12-31 23:59:59'];
  params:
  - - '2019-12-20 22:31:38'
    - '2019-12-31 23:59:59'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-03-22 13:22:50', '2019-03-29 03:12:20'];
  params:
  - - '2019-03-22 13:22:50'
    - '2019-03-29 03:12:20'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 6.238652555981807e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-12-15 21:28:18', '2019-12-21 16:50:24'];
  params:
  - - '2019-12-15 21:28:18'
    - '2019-12-21 16:50:24'
  - ''
  - 6.238652555981807e-06
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-02-02 17:04:05', '2019-02-02 20:32:26'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-02-02 17:04:05'
    - '2019-02-02 20:32:26'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-10-20 07:20:31' GROUP BY b.name;
  params:
  - '2019-10-20 07:20:31'
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-11-27'::timestamp, DATE '2019-11-27'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-11-27'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-08-07 23:16:01', '2019-08-08 03:49:06'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-08-07 23:16:01'
    - '2019-08-08 03:49:06'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-05-11 23:36:43', '2019-05-21 14:32:15'] AND f.altitude < 830 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-05-11 23:36:43'
    - '2019-05-21 14:32:15'
  - ''
  - 830
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-01-14'::timestamp, DATE '2019-01-14'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-01-14'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-11-12 13:43:43', '2019-11-18 09:44:59'];
  params:
  - - '2019-11-12 13:43:43'
    - '2019-11-18 09:44:59'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-05-20'::timestamp, DATE '2019-05-20'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-05-20'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-09-23 08:27:00', '2019-10-02 05:53:33'] AND f.altitude < 700 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-09-23 08:27:00'
    - '2019-10-02 05:53:33'
  - ''
  - 700
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-08-07'::timestamp, DATE '2019-08-07'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-08-07'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 5.75398923446083e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-08-26 17:24:41', '2019-09-06 18:13:57'];
  params:
  - - '2019-08-26 17:24:41'
    - '2019-09-06 18:13:57'
  - ''
  - 5.75398923446083e-06
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-09-19 16:41:44' GROUP BY b.name;
  params:
  - '2019-09-19 16:41:44'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-05-26 09:40:12' GROUP BY b.name;
  params:
  - '2019-05-26 09:40:12'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 6.062923828600126e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-01-11 16:07:50', '2019-01-19 20:23:39'];
  params:
  - - '2019-01-11 16:07:50'
    - '2019-01-19 20:23:39'
  - ''
  - 6.062923828600126e-06
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-11-12 20:34:07', '2019-11-17 13:46:47'] AND f.altitude < 510 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-11-12 20:34:07'
    - '2019-11-17 13:46:47'
  - ''
  - 510
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-04-14 22:36:02', '2019-04-22 04:05:31'] AND f.altitude < 1130 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-04-14 22:36:02'
    - '2019-04-22 04:05:31'
  - ''
  - 1130
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-05-26 16:16:18', '2019-06-08 23:29:14'];
  params:
  - - '2019-05-26 16:16:18'
    - '2019-06-08 23:29:14'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.919330555753203e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-08-20 05:35:13', '2019-08-29 13:01:05'];
  params:
  - - '2019-08-20 05:35:13'
    - '2019-08-29 13:01:05'
  - ''
  - 7.919330555753203e-06
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.729531949512671e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-08-31 10:07:29', '2019-09-11 16:48:14'];
  params:
  - - '2019-08-31 10:07:29'
    - '2019-09-11 16:48:14'
  - ''
  - 7.729531949512671e-06
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-02-05 16:15:45', '2019-02-06 16:24:57'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-02-05 16:15:45'
    - '2019-02-06 16:24:57'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.1677025463624428e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-12-07 06:12:07', '2019-12-12 12:25:03'];
  params:
  - - '2019-12-07 06:12:07'
    - '2019-12-12 12:25:03'
  - ''
  - 1.1677025463624428e-05
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-01-01 00:00:01', '2019-01-07 07:07:12'] AND f.altitude < 920 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-01-01 00:00:01'
    - '2019-01-07 07:07:12'
  - ''
  - 920
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-05-17 04:31:46', '2019-05-18 18:15:39'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-05-17 04:31:46'
    - '2019-05-18 18:15:39'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-12-30 01:52:08', '2019-12-30 19:55:59'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-12-30 01:52:08'
    - '2019-12-30 19:55:59'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-07-15'::timestamp, DATE '2019-07-15'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-07-15'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-07-27 23:38:27' GROUP BY b.name;
  params:
  - '2019-07-27 23:38:27'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-03-27 22:56:34' GROUP BY b.name;
  params:
  - '2019-03-27 22:56:34'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-03-07 20:39:02', '2019-03-22 17:11:15'] AND f.altitude < 680 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-03-07 20:39:02'
    - '2019-03-22 17:11:15'
  - ''
  - 680
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-12-29 20:25:41' GROUP BY b.name;
  params:
  - '2019-12-29 20:25:41'
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-06-19'::timestamp, DATE '2019-06-19'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-06-19'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-07-01 02:54:51', '2019-07-02 07:23:03'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-07-01 02:54:51'
    - '2019-07-02 07:23:03'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-02-10 16:06:40', '2019-02-18 03:24:53'] AND f.altitude < 1040 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-02-10 16:06:40'
    - '2019-02-18 03:24:53'
  - ''
  - 1040
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.1493785101246587e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-02-05 14:46:18', '2019-02-18 19:08:01'];
  params:
  - - '2019-02-05 14:46:18'
    - '2019-02-18 19:08:01'
  - ''
  - 1.1493785101246587e-05
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-06-25 20:52:38', '2019-07-06 05:56:05'];
  params:
  - - '2019-06-25 20:52:38'
    - '2019-07-06 05:56:05'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-03-01 12:53:41', '2019-03-01 16:12:51'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-03-01 12:53:41'
    - '2019-03-01 16:12:51'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-06-04 19:27:06', '2019-06-07 22:05:18'];
  params:
  - - '2019-06-04 19:27:06'
    - '2019-06-07 22:05:18'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-06-25 10:51:30', '2019-06-30 23:12:47'];
  params:
  - - '2019-06-25 10:51:30'
    - '2019-06-30 23:12:47'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-03-07 10:59:19', '2019-03-22 06:46:33'];
  params:
  - - '2019-03-07 10:59:19'
    - '2019-03-22 06:46:33'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-09-04'::timestamp, DATE '2019-09-04'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-09-04'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-01-06'::timestamp, DATE '2019-01-06'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-01-06'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-08-31 07:49:25', '2019-09-04 15:56:01'] AND f.altitude < 1460 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-08-31 07:49:25'
    - '2019-09-04 15:56:01'
  - ''
  - 1460
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-01-03 18:37:15', '2019-01-15 05:04:55'] AND f.altitude < 1070 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-01-03 18:37:15'
    - '2019-01-15 05:04:55'
  - ''
  - 1070
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-03-28 03:44:46', '2019-04-10 07:32:10'] AND f.altitude < 1340 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-03-28 03:44:46'
    - '2019-04-10 07:32:10'
  - ''
  - 1340
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-05-14 22:19:47' GROUP BY b.name;
  params:
  - '2019-05-14 22:19:47'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.0633472720044161e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-03-21 11:46:49', '2019-04-03 04:45:44'];
  params:
  - - '2019-03-21 11:46:49'
    - '2019-04-03 04:45:44'
  - ''
  - 1.0633472720044161e-05
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-01-25 07:22:44', '2019-01-26 14:02:25'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-01-25 07:22:44'
    - '2019-01-26 14:02:25'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-03-08 08:05:48', '2019-03-19 04:47:57'] AND f.altitude < 960 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-03-08 08:05:48'
    - '2019-03-19 04:47:57'
  - ''
  - 960
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-05-13 23:25:29', '2019-05-17 14:26:40'];
  params:
  - - '2019-05-13 23:25:29'
    - '2019-05-17 14:26:40'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.3214629620771561e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-09-20 09:42:49', '2019-09-23 08:52:52'];
  params:
  - - '2019-09-20 09:42:49'
    - '2019-09-23 08:52:52'
  - ''
  - 1.3214629620771561e-05
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 5.791384095942991e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-01-24 11:47:49', '2019-01-30 23:22:01'];
  params:
  - - '2019-01-24 11:47:49'
    - '2019-01-30 23:22:01'
  - ''
  - 5.791384095942991e-06
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-09-06 12:11:36', '2019-09-19 00:54:36'];
  params:
  - - '2019-09-06 12:11:36'
    - '2019-09-19 00:54:36'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-05-23 18:41:49', '2019-05-24 15:29:25'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-05-23 18:41:49'
    - '2019-05-24 15:29:25'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-06-20'::timestamp, DATE '2019-06-20'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-06-20'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 9.58333164385365e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-07-07 19:53:05', '2019-07-10 00:40:50'];
  params:
  - - '2019-07-07 19:53:05'
    - '2019-07-10 00:40:50'
  - ''
  - 9.58333164385365e-06
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-03-17'::timestamp, DATE '2019-03-17'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-03-17'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-03-23'::timestamp, DATE '2019-03-23'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-03-23'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 8.32163093848226e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-03-03 11:13:17', '2019-03-15 00:19:59'];
  params:
  - - '2019-03-03 11:13:17'
    - '2019-03-15 00:19:59'
  - ''
  - 8.32163093848226e-06
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-02-05'::timestamp, DATE '2019-02-05'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-02-05'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-09-03'::timestamp, DATE '2019-09-03'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-09-03'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-10-16 19:31:34', '2019-10-18 05:31:13'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-10-16 19:31:34'
    - '2019-10-18 05:31:13'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-03-10 12:44:36' GROUP BY b.name;
  params:
  - '2019-03-10 12:44:36'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.0495608490463793e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-09-16 10:53:34', '2019-09-27 15:07:13'];
  params:
  - - '2019-09-16 10:53:34'
    - '2019-09-27 15:07:13'
  - ''
  - 1.0495608490463793e-05
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-11-18 03:44:03', '2019-11-22 21:35:51'];
  params:
  - - '2019-11-18 03:44:03'
    - '2019-11-22 21:35:51'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-01-03 02:04:19', '2019-01-03 18:02:43'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-01-03 02:04:19'
    - '2019-01-03 18:02:43'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-02-23'::timestamp, DATE '2019-02-23'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-02-23'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-06-09 14:01:55', '2019-06-15 08:31:14'];
  params:
  - - '2019-06-09 14:01:55'
    - '2019-06-15 08:31:14'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-01-29 17:35:30', '2019-02-12 14:38:25'];
  params:
  - - '2019-01-29 17:35:30'
    - '2019-02-12 14:38:25'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-09-09 18:36:42' GROUP BY b.name;
  params:
  - '2019-09-09 18:36:42'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-05-08 13:47:26', '2019-05-13 16:47:19'];
  params:
  - - '2019-05-08 13:47:26'
    - '2019-05-13 16:47:19'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-09-01 17:14:39', '2019-09-15 02:09:42'] AND f.altitude < 1300 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-09-01 17:14:39'
    - '2019-09-15 02:09:42'
  - ''
  - 1300
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-03-01 13:13:30', '2019-03-01 21:54:43'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-03-01 13:13:30'
    - '2019-03-01 21:54:43'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3.30939072165336e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-09-20 03:49:12', '2019-10-03 07:41:22'];
  params:
  - - '2019-09-20 03:49:12'
    - '2019-10-03 07:41:22'
  - ''
  - 3.30939072165336e-06
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-09-04 13:59:53', '2019-09-05 00:07:16'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-09-04 13:59:53'
    - '2019-09-05 00:07:16'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-11-05 14:21:38', '2019-11-18 12:57:35'];
  params:
  - - '2019-11-05 14:21:38'
    - '2019-11-18 12:57:35'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-09-20 00:24:13', '2019-09-22 18:26:46'];
  params:
  - - '2019-09-20 00:24:13'
    - '2019-09-22 18:26:46'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-10-18 05:40:50', '2019-10-22 19:30:36'];
  params:
  - - '2019-10-18 05:40:50'
    - '2019-10-22 19:30:36'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-10-12 11:49:43' GROUP BY b.name;
  params:
  - '2019-10-12 11:49:43'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-07-11 17:21:08', '2019-07-21 10:59:08'] AND f.altitude < 570 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-07-11 17:21:08'
    - '2019-07-21 10:59:08'
  - ''
  - 570
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-03-25 02:39:45', '2019-04-01 10:07:42'];
  params:
  - - '2019-03-25 02:39:45'
    - '2019-04-01 10:07:42'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-06-09 02:29:05', '2019-06-23 12:20:55'] AND f.altitude < 860 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-06-09 02:29:05'
    - '2019-06-23 12:20:55'
  - ''
  - 860
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-10-05 16:44:23', '2019-10-06 00:17:13'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-10-05 16:44:23'
    - '2019-10-06 00:17:13'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-01-12 11:09:34' GROUP BY b.name;
  params:
  - '2019-01-12 11:09:34'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-12-12 09:49:53' GROUP BY b.name;
  params:
  - '2019-12-12 09:49:53'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-10-26 01:55:12' GROUP BY b.name;
  params:
  - '2019-10-26 01:55:12'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.0777794804733027e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-08-11 17:14:07', '2019-08-19 12:20:55'];
  params:
  - - '2019-08-11 17:14:07'
    - '2019-08-19 12:20:55'
  - ''
  - 1.0777794804733027e-05
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-07-04 16:20:57', '2019-07-07 20:34:07'] AND f.altitude < 930 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-07-04 16:20:57'
    - '2019-07-07 20:34:07'
  - ''
  - 930
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 6.130643147724754e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-11-28 20:31:02', '2019-12-09 12:21:57'];
  params:
  - - '2019-11-28 20:31:02'
    - '2019-12-09 12:21:57'
  - ''
  - 6.130643147724754e-06
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-02-13 10:37:05', '2019-02-16 20:10:05'] AND f.altitude < 1500 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-02-13 10:37:05'
    - '2019-02-16 20:10:05'
  - ''
  - 1500
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 9.443704831374403e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-06-24 10:46:26', '2019-07-05 07:47:38'];
  params:
  - - '2019-06-24 10:46:26'
    - '2019-07-05 07:47:38'
  - ''
  - 9.443704831374403e-06
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-08-04 07:03:07', '2019-08-09 02:49:52'];
  params:
  - - '2019-08-04 07:03:07'
    - '2019-08-09 02:49:52'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-02-25 12:59:48', '2019-03-06 16:35:56'] AND f.altitude < 1100 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-02-25 12:59:48'
    - '2019-03-06 16:35:56'
  - ''
  - 1100
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-12-13 12:12:21' GROUP BY b.name;
  params:
  - '2019-12-13 12:12:21'
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-07-18'::timestamp, DATE '2019-07-18'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-07-18'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-10-07 20:15:54', '2019-10-13 18:03:22'];
  params:
  - - '2019-10-07 20:15:54'
    - '2019-10-13 18:03:22'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-10-30 08:22:43', '2019-11-13 15:27:07'] AND f.altitude < 730 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-10-30 08:22:43'
    - '2019-11-13 15:27:07'
  - ''
  - 730
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-09-09 00:46:23' GROUP BY b.name;
  params:
  - '2019-09-09 00:46:23'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-01-04 18:50:38', '2019-01-11 23:33:34'];
  params:
  - - '2019-01-04 18:50:38'
    - '2019-01-11 23:33:34'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-10-29'::timestamp, DATE '2019-10-29'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-10-29'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.4314911329255063e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-01-26 06:41:19', '2019-02-06 01:29:53'];
  params:
  - - '2019-01-26 06:41:19'
    - '2019-02-06 01:29:53'
  - ''
  - 1.4314911329255063e-05
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-02-02 23:50:51', '2019-02-06 01:07:54'];
  params:
  - - '2019-02-02 23:50:51'
    - '2019-02-06 01:07:54'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.808857170654243e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-06-27 01:52:42', '2019-06-29 20:14:27'];
  params:
  - - '2019-06-27 01:52:42'
    - '2019-06-29 20:14:27'
  - ''
  - 7.808857170654243e-06
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-08-31 23:32:01' GROUP BY b.name;
  params:
  - '2019-08-31 23:32:01'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-02-22 13:25:56', '2019-02-24 03:53:25'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-02-22 13:25:56'
    - '2019-02-24 03:53:25'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-04-24 06:48:24' GROUP BY b.name;
  params:
  - '2019-04-24 06:48:24'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-06-06 16:26:30', '2019-06-10 19:31:57'];
  params:
  - - '2019-06-06 16:26:30'
    - '2019-06-10 19:31:57'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-08-03 19:24:21' GROUP BY b.name;
  params:
  - '2019-08-03 19:24:21'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 9.362057641619589e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-08-21 03:04:50', '2019-08-27 09:23:07'];
  params:
  - - '2019-08-21 03:04:50'
    - '2019-08-27 09:23:07'
  - ''
  - 9.362057641619589e-06
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.2999057335187993e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-09-14 06:33:21', '2019-09-24 11:18:42'];
  params:
  - - '2019-09-14 06:33:21'
    - '2019-09-24 11:18:42'
  - ''
  - 1.2999057335187993e-05
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-08-15 11:09:01', '2019-08-16 22:19:19'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-08-15 11:09:01'
    - '2019-08-16 22:19:19'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.4120990939881882e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-09-20 02:08:08', '2019-09-27 21:57:51'];
  params:
  - - '2019-09-20 02:08:08'
    - '2019-09-27 21:57:51'
  - ''
  - 1.4120990939881882e-05
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-06-08 01:58:42', '2019-06-09 23:45:56'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-06-08 01:58:42'
    - '2019-06-09 23:45:56'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.1934812978430398e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-06-20 19:31:34', '2019-06-30 21:29:48'];
  params:
  - - '2019-06-20 19:31:34'
    - '2019-06-30 21:29:48'
  - ''
  - 1.1934812978430398e-05
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-02-17'::timestamp, DATE '2019-02-17'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-02-17'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-04-17 10:04:29', '2019-04-29 09:45:45'];
  params:
  - - '2019-04-17 10:04:29'
    - '2019-04-29 09:45:45'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-03-14'::timestamp, DATE '2019-03-14'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-03-14'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-01-26 03:44:07', '2019-02-01 20:25:15'] AND f.altitude < 900 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-01-26 03:44:07'
    - '2019-02-01 20:25:15'
  - ''
  - 900
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-06-21'::timestamp, DATE '2019-06-21'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-06-21'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.3524721197483745e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-01-01 00:00:01', '2019-01-08 07:24:59'];
  params:
  - - '2019-01-01 00:00:01'
    - '2019-01-08 07:24:59'
  - ''
  - 1.3524721197483745e-05
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3.469384705538767e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-02-01 03:28:35', '2019-02-12 14:00:08'];
  params:
  - - '2019-02-01 03:28:35'
    - '2019-02-12 14:00:08'
  - ''
  - 3.469384705538767e-06
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 6.289543976050743e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-02-19 13:41:30', '2019-03-05 07:19:35'];
  params:
  - - '2019-02-19 13:41:30'
    - '2019-03-05 07:19:35'
  - ''
  - 6.289543976050743e-06
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-04-15 02:32:55', '2019-04-23 01:22:05'] AND f.altitude < 840 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-04-15 02:32:55'
    - '2019-04-23 01:22:05'
  - ''
  - 840
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-12-10 21:58:39' GROUP BY b.name;
  params:
  - '2019-12-10 21:58:39'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-03-04 20:43:47' GROUP BY b.name;
  params:
  - '2019-03-04 20:43:47'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-08-16 02:17:17', '2019-08-18 01:26:47'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-08-16 02:17:17'
    - '2019-08-18 01:26:47'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 9.700914942032958e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-02-20 01:19:13', '2019-02-27 01:20:45'];
  params:
  - - '2019-02-20 01:19:13'
    - '2019-02-27 01:20:45'
  - ''
  - 9.700914942032958e-06
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-09-28 10:18:28', '2019-09-28 21:03:22'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-09-28 10:18:28'
    - '2019-09-28 21:03:22'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 5.046268351309992e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-03-29 16:42:36', '2019-04-01 00:47:59'];
  params:
  - - '2019-03-29 16:42:36'
    - '2019-04-01 00:47:59'
  - ''
  - 5.046268351309992e-06
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-07-29 13:42:31', '2019-08-09 04:34:26'] AND f.altitude < 1070 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-07-29 13:42:31'
    - '2019-08-09 04:34:26'
  - ''
  - 1070
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-06-28 06:31:50', '2019-07-03 04:40:03'];
  params:
  - - '2019-06-28 06:31:50'
    - '2019-07-03 04:40:03'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-05-12 06:48:38' GROUP BY b.name;
  params:
  - '2019-05-12 06:48:38'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-11-21 05:25:32', '2019-12-03 16:02:54'] AND f.altitude < 880 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-11-21 05:25:32'
    - '2019-12-03 16:02:54'
  - ''
  - 880
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-12-04'::timestamp, DATE '2019-12-04'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-12-04'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-04-21 03:23:06' GROUP BY b.name;
  params:
  - '2019-04-21 03:23:06'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-05-07 01:14:03', '2019-05-07 14:04:55'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-05-07 01:14:03'
    - '2019-05-07 14:04:55'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-04-09 03:01:39', '2019-04-11 01:47:35'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-04-09 03:01:39'
    - '2019-04-11 01:47:35'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-06-29 00:06:48', '2019-07-03 11:41:23'];
  params:
  - - '2019-06-29 00:06:48'
    - '2019-07-03 11:41:23'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-03-05 11:09:32', '2019-03-09 15:43:09'];
  params:
  - - '2019-03-05 11:09:32'
    - '2019-03-09 15:43:09'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 6.522101138159519e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-12-01 04:30:08', '2019-12-03 12:54:57'];
  params:
  - - '2019-12-01 04:30:08'
    - '2019-12-03 12:54:57'
  - ''
  - 6.522101138159519e-06
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-07-12 22:46:57', '2019-07-20 14:18:59'];
  params:
  - - '2019-07-12 22:46:57'
    - '2019-07-20 14:18:59'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 9.65211753201466e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-04-09 13:59:58', '2019-04-20 16:53:10'];
  params:
  - - '2019-04-09 13:59:58'
    - '2019-04-20 16:53:10'
  - ''
  - 9.65211753201466e-06
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-12-10 10:40:03' GROUP BY b.name;
  params:
  - '2019-12-10 10:40:03'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-10-27 17:17:44', '2019-10-28 00:03:56'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-10-27 17:17:44'
    - '2019-10-28 00:03:56'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-01-26 14:07:18', '2019-01-28 22:24:09'] AND f.altitude < 1130 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-01-26 14:07:18'
    - '2019-01-28 22:24:09'
  - ''
  - 1130
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-04-04 15:43:48', '2019-04-04 20:36:42'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-04-04 15:43:48'
    - '2019-04-04 20:36:42'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-08-22 02:12:07' GROUP BY b.name;
  params:
  - '2019-08-22 02:12:07'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-04-03 02:13:52', '2019-04-16 12:35:22'] AND f.altitude < 830 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-04-03 02:13:52'
    - '2019-04-16 12:35:22'
  - ''
  - 830
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-07-25 11:40:23', '2019-08-04 07:50:40'];
  params:
  - - '2019-07-25 11:40:23'
    - '2019-08-04 07:50:40'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-02-12 11:09:19' GROUP BY b.name;
  params:
  - '2019-02-12 11:09:19'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-08-06 14:09:00' GROUP BY b.name;
  params:
  - '2019-08-06 14:09:00'
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-07-02'::timestamp, DATE '2019-07-02'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-07-02'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-11-02'::timestamp, DATE '2019-11-02'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-11-02'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-07-20 19:53:51' GROUP BY b.name;
  params:
  - '2019-07-20 19:53:51'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-12-09 19:26:29', '2019-12-19 22:12:52'] AND f.altitude < 800 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-12-09 19:26:29'
    - '2019-12-19 22:12:52'
  - ''
  - 800
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-10-06 06:58:11', '2019-10-07 10:21:27'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-10-06 06:58:11'
    - '2019-10-07 10:21:27'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-02-16'::timestamp, DATE '2019-02-16'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-02-16'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 4.573925462370186e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-08-01 14:24:30', '2019-08-06 02:32:25'];
  params:
  - - '2019-08-01 14:24:30'
    - '2019-08-06 02:32:25'
  - ''
  - 4.573925462370186e-06
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-05-04'::timestamp, DATE '2019-05-04'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-05-04'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-10-02 17:19:50', '2019-10-04 04:31:27'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-10-02 17:19:50'
    - '2019-10-04 04:31:27'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 7.61503550827862e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-06-05 11:06:07', '2019-06-14 15:06:44'];
  params:
  - - '2019-06-05 11:06:07'
    - '2019-06-14 15:06:44'
  - ''
  - 7.61503550827862e-06
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-12-10'::timestamp, DATE '2019-12-10'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-12-10'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-07-07 18:42:52', '2019-07-13 02:52:05'];
  params:
  - - '2019-07-07 18:42:52'
    - '2019-07-13 02:52:05'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-09-30 03:18:29', '2019-10-01 00:32:28'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-09-30 03:18:29'
    - '2019-10-01 00:32:28'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 5.777473369778723e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-07-25 12:46:19', '2019-08-01 06:01:22'];
  params:
  - - '2019-07-25 12:46:19'
    - '2019-08-01 06:01:22'
  - ''
  - 5.777473369778723e-06
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-07-28'::timestamp, DATE '2019-07-28'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-07-28'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-03-29 07:41:02', '2019-04-03 05:19:47'] AND f.altitude < 1040 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-03-29 07:41:02'
    - '2019-04-03 05:19:47'
  - ''
  - 1040
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-01-21'::timestamp, DATE '2019-01-21'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-01-21'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-11-20 15:00:09', '2019-11-26 20:28:30'];
  params:
  - - '2019-11-20 15:00:09'
    - '2019-11-26 20:28:30'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-07-14 06:51:34', '2019-07-15 15:05:55'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-07-14 06:51:34'
    - '2019-07-15 15:05:55'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-11-07 10:17:32', '2019-11-17 13:38:37'];
  params:
  - - '2019-11-07 10:17:32'
    - '2019-11-17 13:38:37'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-09-05 02:09:19', '2019-09-05 04:29:57'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-09-05 02:09:19'
    - '2019-09-05 04:29:57'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-02-11 18:48:58' GROUP BY b.name;
  params:
  - '2019-02-11 18:48:58'
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-08-04'::timestamp, DATE '2019-08-04'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-08-04'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.1032681750993196e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-06-29 18:49:29', '2019-07-04 17:36:49'];
  params:
  - - '2019-06-29 18:49:29'
    - '2019-07-04 17:36:49'
  - ''
  - 1.1032681750993196e-05
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-10-18'::timestamp, DATE '2019-10-18'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-10-18'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 6.692093868103338e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-01-26 17:02:33', '2019-02-06 02:32:59'];
  params:
  - - '2019-01-26 17:02:33'
    - '2019-02-06 02:32:59'
  - ''
  - 6.692093868103338e-06
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-09-06 13:19:34', '2019-09-17 16:07:05'] AND f.altitude < 1110 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-09-06 13:19:34'
    - '2019-09-17 16:07:05'
  - ''
  - 1110
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.2108351169257307e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-10-28 13:24:13', '2019-11-07 07:16:17'];
  params:
  - - '2019-10-28 13:24:13'
    - '2019-11-07 07:16:17'
  - ''
  - 1.2108351169257307e-05
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.3205078093293257e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-06-27 09:44:05', '2019-07-11 19:34:24'];
  params:
  - - '2019-06-27 09:44:05'
    - '2019-07-11 19:34:24'
  - ''
  - 1.3205078093293257e-05
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 8.115259982962345e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-08-08 11:05:41', '2019-08-20 06:10:27'];
  params:
  - - '2019-08-08 11:05:41'
    - '2019-08-20 06:10:27'
  - ''
  - 8.115259982962345e-06
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-11-25 07:42:30' GROUP BY b.name;
  params:
  - '2019-11-25 07:42:30'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-07-06 03:55:55', '2019-07-11 19:23:52'];
  params:
  - - '2019-07-06 03:55:55'
    - '2019-07-11 19:23:52'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-09-12'::timestamp, DATE '2019-09-12'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-09-12'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.201987659669315e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-10-29 05:18:37', '2019-11-08 10:02:39'];
  params:
  - - '2019-10-29 05:18:37'
    - '2019-11-08 10:02:39'
  - ''
  - 1.201987659669315e-05
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-10-28 17:36:06' GROUP BY b.name;
  params:
  - '2019-10-28 17:36:06'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-12-01 00:26:51' GROUP BY b.name;
  params:
  - '2019-12-01 00:26:51'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-09-13 00:47:00', '2019-09-20 14:40:36'];
  params:
  - - '2019-09-13 00:47:00'
    - '2019-09-20 14:40:36'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-03-23 12:25:22', '2019-04-04 17:16:02'];
  params:
  - - '2019-03-23 12:25:22'
    - '2019-04-04 17:16:02'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-11-27 16:52:23', '2019-11-30 13:41:01'];
  params:
  - - '2019-11-27 16:52:23'
    - '2019-11-30 13:41:01'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-06-06 01:36:44', '2019-06-07 14:07:51'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-06-06 01:36:44'
    - '2019-06-07 14:07:51'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 9.77975209955175e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-09-18 17:26:18', '2019-09-28 07:59:56'];
  params:
  - - '2019-09-18 17:26:18'
    - '2019-09-28 07:59:56'
  - ''
  - 9.77975209955175e-06
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-12-01 23:25:14', '2019-12-02 19:28:56'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-12-01 23:25:14'
    - '2019-12-02 19:28:56'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-12-03 13:44:40', '2019-12-12 13:07:55'] AND f.altitude < 500 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-12-03 13:44:40'
    - '2019-12-12 13:07:55'
  - ''
  - 500
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-06-23'::timestamp, DATE '2019-06-23'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-06-23'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-09-19 23:59:14', '2019-09-25 10:34:23'] AND f.altitude < 1230 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-09-19 23:59:14'
    - '2019-09-25 10:34:23'
  - ''
  - 1230
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-12-17'::timestamp, DATE '2019-12-17'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-12-17'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-12-16 20:02:52', '2019-12-16 23:12:57'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-12-16 20:02:52'
    - '2019-12-16 23:12:57'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-03-27 04:33:10', '2019-04-07 02:21:41'] AND f.altitude < 530 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-03-27 04:33:10'
    - '2019-04-07 02:21:41'
  - ''
  - 530
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-09-19 10:33:21' GROUP BY b.name;
  params:
  - '2019-09-19 10:33:21'
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-07-31'::timestamp, DATE '2019-07-31'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-07-31'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-04-03'::timestamp, DATE '2019-04-03'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-04-03'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.0647079645401973e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-06-15 18:48:02', '2019-06-28 09:32:03'];
  params:
  - - '2019-06-15 18:48:02'
    - '2019-06-28 09:32:03'
  - ''
  - 1.0647079645401973e-05
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-01-20 04:53:25', '2019-01-30 05:00:20'] AND f.altitude < 750 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-01-20 04:53:25'
    - '2019-01-30 05:00:20'
  - ''
  - 750
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-11-11 11:40:41' GROUP BY b.name;
  params:
  - '2019-11-11 11:40:41'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-06-09 11:50:29', '2019-06-22 16:13:52'] AND f.altitude < 1280 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-06-09 11:50:29'
    - '2019-06-22 16:13:52'
  - ''
  - 1280
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-11-26 13:55:09', '2019-11-28 02:26:33'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-11-26 13:55:09'
    - '2019-11-28 02:26:33'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-12-31 22:28:06', '2019-12-31 23:59:59'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-12-31 22:28:06'
    - '2019-12-31 23:59:59'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-11-15'::timestamp, DATE '2019-11-15'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-11-15'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-04-05 21:07:28' GROUP BY b.name;
  params:
  - '2019-04-05 21:07:28'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-11-08 14:30:01', '2019-11-19 11:19:55'] AND f.altitude < 1080 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-11-08 14:30:01'
    - '2019-11-19 11:19:55'
  - ''
  - 1080
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-08-23 01:23:29', '2019-09-04 00:27:36'] AND f.altitude < 1140 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-08-23 01:23:29'
    - '2019-09-04 00:27:36'
  - ''
  - 1140
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-04-11 16:23:14', '2019-04-12 10:50:03'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-04-11 16:23:14'
    - '2019-04-12 10:50:03'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-03-07'::timestamp, DATE '2019-03-07'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-03-07'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-12-13 11:44:31', '2019-12-27 01:29:37'];
  params:
  - - '2019-12-13 11:44:31'
    - '2019-12-27 01:29:37'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-07-04 09:45:00', '2019-07-13 07:58:34'];
  params:
  - - '2019-07-04 09:45:00'
    - '2019-07-13 07:58:34'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-07-26 10:32:52', '2019-08-01 21:26:02'] AND f.altitude < 970 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-07-26 10:32:52'
    - '2019-08-01 21:26:02'
  - ''
  - 970
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-08-10 19:57:45', '2019-08-12 16:36:04'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-08-10 19:57:45'
    - '2019-08-12 16:36:04'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-12-16 20:29:05', '2019-12-27 22:05:37'];
  params:
  - - '2019-12-16 20:29:05'
    - '2019-12-27 22:05:37'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-07-09 06:45:29' GROUP BY b.name;
  params:
  - '2019-07-09 06:45:29'
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-10-19'::timestamp, DATE '2019-10-19'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-10-19'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-01-16 23:15:20', '2019-01-21 04:54:43'] AND f.altitude < 1320 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-01-16 23:15:20'
    - '2019-01-21 04:54:43'
  - ''
  - 1320
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-12-11 04:15:15' GROUP BY b.name;
  params:
  - '2019-12-11 04:15:15'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-09-02 19:47:34', '2019-09-02 21:00:10'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-09-02 19:47:34'
    - '2019-09-02 21:00:10'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-09-28 00:20:55', '2019-10-03 10:30:40'] AND f.altitude < 540 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-09-28 00:20:55'
    - '2019-10-03 10:30:40'
  - ''
  - 540
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-05-17'::timestamp, DATE '2019-05-17'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-05-17'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-04-18 23:32:01', '2019-04-28 06:38:13'];
  params:
  - - '2019-04-18 23:32:01'
    - '2019-04-28 06:38:13'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-05-18 16:55:46', '2019-05-18 22:25:51'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-05-18 16:55:46'
    - '2019-05-18 22:25:51'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.0449145892501494e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-07-10 21:50:36', '2019-07-14 15:45:35'];
  params:
  - - '2019-07-10 21:50:36'
    - '2019-07-14 15:45:35'
  - ''
  - 1.0449145892501494e-05
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-06-17 18:59:27', '2019-06-18 12:50:44'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-06-17 18:59:27'
    - '2019-06-18 12:50:44'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.077754727913623e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-06-13 21:14:33', '2019-06-24 17:34:52'];
  params:
  - - '2019-06-13 21:14:33'
    - '2019-06-24 17:34:52'
  - ''
  - 1.077754727913623e-05
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-05-17 21:33:11', '2019-05-31 13:54:00'] AND f.altitude < 1290 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-05-17 21:33:11'
    - '2019-05-31 13:54:00'
  - ''
  - 1290
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-11-18'::timestamp, DATE '2019-11-18'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-11-18'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.2291402820349559e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-08-20 21:31:33', '2019-08-28 06:07:23'];
  params:
  - - '2019-08-20 21:31:33'
    - '2019-08-28 06:07:23'
  - ''
  - 1.2291402820349559e-05
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-05-29 23:46:39', '2019-05-30 18:13:52'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-05-29 23:46:39'
    - '2019-05-30 18:13:52'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-04-03 12:51:49', '2019-04-16 02:38:38'] AND f.altitude < 1330 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-04-03 12:51:49'
    - '2019-04-16 02:38:38'
  - ''
  - 1330
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-03-11'::timestamp, DATE '2019-03-11'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-03-11'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-01-06 14:50:53', '2019-01-19 22:06:19'];
  params:
  - - '2019-01-06 14:50:53'
    - '2019-01-19 22:06:19'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-04-15 09:07:40' GROUP BY b.name;
  params:
  - '2019-04-15 09:07:40'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.2680032898293199e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-06-01 22:01:14', '2019-06-08 07:06:37'];
  params:
  - - '2019-06-01 22:01:14'
    - '2019-06-08 07:06:37'
  - ''
  - 1.2680032898293199e-05
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-01-03 21:50:48', '2019-01-04 16:01:12'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-01-03 21:50:48'
    - '2019-01-04 16:01:12'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-04-30 00:18:28', '2019-05-04 21:37:15'] AND f.altitude < 680 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-04-30 00:18:28'
    - '2019-05-04 21:37:15'
  - ''
  - 680
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-06-27 07:22:41', '2019-07-07 08:20:56'] AND f.altitude < 1160 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-06-27 07:22:41'
    - '2019-07-07 08:20:56'
  - ''
  - 1160
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.0962666051294763e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-03-24 18:55:13', '2019-03-27 09:02:40'];
  params:
  - - '2019-03-24 18:55:13'
    - '2019-03-27 09:02:40'
  - ''
  - 1.0962666051294763e-05
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-10-24 14:50:14', '2019-10-29 08:55:42'];
  params:
  - - '2019-10-24 14:50:14'
    - '2019-10-29 08:55:42'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-07-21'::timestamp, DATE '2019-07-21'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-07-21'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-04-08'::timestamp, DATE '2019-04-08'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-04-08'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-03-06'::timestamp, DATE '2019-03-06'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-03-06'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-05-19 09:40:02' GROUP BY b.name;
  params:
  - '2019-05-19 09:40:02'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-04-12 08:30:09' GROUP BY b.name;
  params:
  - '2019-04-12 08:30:09'
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-08-01'::timestamp, DATE '2019-08-01'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-08-01'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-08-14 04:11:09' GROUP BY b.name;
  params:
  - '2019-08-14 04:11:09'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-01-10 10:56:30', '2019-01-10 12:55:09'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-01-10 10:56:30'
    - '2019-01-10 12:55:09'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-09-08 00:02:17', '2019-09-08 04:46:33'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-09-08 00:02:17'
    - '2019-09-08 04:46:33'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-11-12 09:40:39', '2019-11-14 17:24:29'] AND f.altitude < 880 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-11-12 09:40:39'
    - '2019-11-14 17:24:29'
  - ''
  - 880
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-12-07'::timestamp, DATE '2019-12-07'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-12-07'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-01-15 05:26:07', '2019-01-15 07:16:22'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-01-15 05:26:07'
    - '2019-01-15 07:16:22'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.2150489764135904e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-02-15 04:46:25', '2019-02-17 11:21:12'];
  params:
  - - '2019-02-15 04:46:25'
    - '2019-02-17 11:21:12'
  - ''
  - 1.2150489764135904e-05
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 4.984595386655179e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-01-04 02:24:37', '2019-01-10 17:30:57'];
  params:
  - - '2019-01-04 02:24:37'
    - '2019-01-10 17:30:57'
  - ''
  - 4.984595386655179e-06
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.039936159409014e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-01-29 23:39:07', '2019-02-06 22:35:54'];
  params:
  - - '2019-01-29 23:39:07'
    - '2019-02-06 22:35:54'
  - ''
  - 1.039936159409014e-05
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-02-03 01:34:51', '2019-02-04 02:49:26'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-02-03 01:34:51'
    - '2019-02-04 02:49:26'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-06-04 08:29:40', '2019-06-15 06:18:50'];
  params:
  - - '2019-06-04 08:29:40'
    - '2019-06-15 06:18:50'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 8.458747956303936e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-01-05 17:40:53', '2019-01-19 20:41:27'];
  params:
  - - '2019-01-05 17:40:53'
    - '2019-01-19 20:41:27'
  - ''
  - 8.458747956303936e-06
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-03-19 19:27:58', '2019-03-29 18:01:53'];
  params:
  - - '2019-03-19 19:27:58'
    - '2019-03-29 18:01:53'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-10-01 05:35:06', '2019-10-01 15:59:53'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-10-01 05:35:06'
    - '2019-10-01 15:59:53'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-06-16 03:59:18', '2019-06-16 08:01:53'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-06-16 03:59:18'
    - '2019-06-16 08:01:53'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-07-19 08:27:50' GROUP BY b.name;
  params:
  - '2019-07-19 08:27:50'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-07-11 00:41:56', '2019-07-14 21:12:25'];
  params:
  - - '2019-07-11 00:41:56'
    - '2019-07-14 21:12:25'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-05-23 17:14:59', '2019-05-25 10:13:17'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-05-23 17:14:59'
    - '2019-05-25 10:13:17'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-02-10 20:16:27', '2019-02-17 11:30:31'] AND f.altitude < 560 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-02-10 20:16:27'
    - '2019-02-17 11:30:31'
  - ''
  - 560
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.3726812195812455e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-06-15 03:10:37', '2019-06-29 02:58:13'];
  params:
  - - '2019-06-15 03:10:37'
    - '2019-06-29 02:58:13'
  - ''
  - 1.3726812195812455e-05
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-09-19 00:24:12' GROUP BY b.name;
  params:
  - '2019-09-19 00:24:12'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-01-06 06:02:42' GROUP BY b.name;
  params:
  - '2019-01-06 06:02:42'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-12-12 19:33:21', '2019-12-22 05:55:27'] AND f.altitude < 1040 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-12-12 19:33:21'
    - '2019-12-22 05:55:27'
  - ''
  - 1040
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-12-27 15:24:01' GROUP BY b.name;
  params:
  - '2019-12-27 15:24:01'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 8.414213452936337e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-09-27 18:57:35', '2019-10-11 05:21:19'];
  params:
  - - '2019-09-27 18:57:35'
    - '2019-10-11 05:21:19'
  - ''
  - 8.414213452936337e-06
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-07-30 19:14:48' GROUP BY b.name;
  params:
  - '2019-07-30 19:14:48'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.3392803835894472e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-02-17 16:20:02', '2019-03-02 19:49:26'];
  params:
  - - '2019-02-17 16:20:02'
    - '2019-03-02 19:49:26'
  - ''
  - 1.3392803835894472e-05
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-08-11 16:17:13' GROUP BY b.name;
  params:
  - '2019-08-11 16:17:13'
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-04-04 22:39:37' GROUP BY b.name;
  params:
  - '2019-04-04 22:39:37'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 9.71889401092014e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-04-03 03:13:57', '2019-04-05 06:45:52'];
  params:
  - - '2019-04-03 03:13:57'
    - '2019-04-05 06:45:52'
  - ''
  - 9.71889401092014e-06
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-08-13 22:05:28', '2019-08-14 21:25:23'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-08-13 22:05:28'
    - '2019-08-14 21:25:23'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-05-28 13:33:14' GROUP BY b.name;
  params:
  - '2019-05-28 13:33:14'
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-04-08 03:21:53', '2019-04-08 21:05:34'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-04-08 03:21:53'
    - '2019-04-08 21:05:34'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-12-24 18:05:52', '2019-12-26 07:32:37'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-12-24 18:05:52'
    - '2019-12-26 07:32:37'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 5.192048442879161e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-10-15 16:52:22', '2019-10-27 08:18:45'];
  params:
  - - '2019-10-15 16:52:22'
    - '2019-10-27 08:18:45'
  - ''
  - 5.192048442879161e-06
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-01-05 05:00:54', '2019-01-05 19:39:49'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-01-05 05:00:54'
    - '2019-01-05 19:39:49'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-04-02 15:14:54' GROUP BY b.name;
  params:
  - '2019-04-02 15:14:54'
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-03-16 22:20:47', '2019-03-19 17:16:39'] AND f.altitude < 930 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-03-16 22:20:47'
    - '2019-03-19 17:16:39'
  - ''
  - 930
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-09-22 09:57:56', '2019-09-23 22:45:12'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-09-22 09:57:56'
    - '2019-09-23 22:45:12'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-04-08 17:34:26' GROUP BY b.name;
  params:
  - '2019-04-08 17:34:26'
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-09-18'::timestamp, DATE '2019-09-18'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-09-18'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-05-07 03:57:24', '2019-05-07 18:29:56'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-05-07 03:57:24'
    - '2019-05-07 18:29:56'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-06-20 17:07:39', '2019-06-21 04:59:54'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-06-20 17:07:39'
    - '2019-06-21 04:59:54'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-09-04 01:39:20', '2019-09-10 00:19:50'] AND f.altitude < 1170 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-09-04 01:39:20'
    - '2019-09-10 00:19:50'
  - ''
  - 1170
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-01-25 15:29:30', '2019-02-06 12:34:28'];
  params:
  - - '2019-01-25 15:29:30'
    - '2019-02-06 12:34:28'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3.3571549349724447e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-12-07 08:39:20', '2019-12-11 04:41:16'];
  params:
  - - '2019-12-07 08:39:20'
    - '2019-12-11 04:41:16'
  - ''
  - 3.3571549349724447e-06
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-06-19 06:32:07', '2019-06-20 02:57:18'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-06-19 06:32:07'
    - '2019-06-20 02:57:18'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-08-09 02:37:44', '2019-08-12 14:42:49'];
  params:
  - - '2019-08-09 02:37:44'
    - '2019-08-12 14:42:49'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-08-13 14:11:07', '2019-08-15 01:02:45'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-08-13 14:11:07'
    - '2019-08-15 01:02:45'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-08-26 10:43:36', '2019-09-08 15:16:50'];
  params:
  - - '2019-08-26 10:43:36'
    - '2019-09-08 15:16:50'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-01-13 16:29:13', '2019-01-26 19:56:40'] AND f.altitude < 590 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-01-13 16:29:13'
    - '2019-01-26 19:56:40'
  - ''
  - 590
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-09-07'::timestamp, DATE '2019-09-07'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-09-07'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3.328917484938498e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-08-29 02:21:12', '2019-09-09 00:29:23'];
  params:
  - - '2019-08-29 02:21:12'
    - '2019-09-09 00:29:23'
  - ''
  - 3.328917484938498e-06
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.5071824987870656e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-04-24 06:04:34', '2019-05-08 12:12:09'];
  params:
  - - '2019-04-24 06:04:34'
    - '2019-05-08 12:12:09'
  - ''
  - 1.5071824987870656e-05
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-04-19 00:36:18', '2019-04-26 13:48:27'];
  params:
  - - '2019-04-19 00:36:18'
    - '2019-04-26 13:48:27'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.5203746742846562e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-03-21 23:21:52', '2019-04-05 02:55:02'];
  params:
  - - '2019-03-21 23:21:52'
    - '2019-04-05 02:55:02'
  - ''
  - 1.5203746742846562e-05
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-08-02 01:34:09', '2019-08-14 15:13:06'];
  params:
  - - '2019-08-02 01:34:09'
    - '2019-08-14 15:13:06'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.388737197305354e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-05-03 08:38:40', '2019-05-17 13:05:34'];
  params:
  - - '2019-05-03 08:38:40'
    - '2019-05-17 13:05:34'
  - ''
  - 1.388737197305354e-05
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 8.28332210920544e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-10-21 20:56:47', '2019-10-27 22:47:10'];
  params:
  - - '2019-10-21 20:56:47'
    - '2019-10-27 22:47:10'
  - ''
  - 8.28332210920544e-06
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-05-10'::timestamp, DATE '2019-05-10'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-05-10'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-09-05 23:09:38', '2019-09-07 00:45:44'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-09-05 23:09:38'
    - '2019-09-07 00:45:44'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3.5310441981727055e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-03-21 09:10:58', '2019-03-24 19:07:30'];
  params:
  - - '2019-03-21 09:10:58'
    - '2019-03-24 19:07:30'
  - ''
  - 3.5310441981727055e-06
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-03-09 00:03:44', '2019-03-10 23:34:42'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-03-09 00:03:44'
    - '2019-03-10 23:34:42'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-04-10 18:50:45', '2019-04-14 10:56:26'] AND f.altitude < 790 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-04-10 18:50:45'
    - '2019-04-14 10:56:26'
  - ''
  - 790
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-10-18 17:35:07', '2019-10-28 16:11:38'] AND f.altitude < 1150 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-10-18 17:35:07'
    - '2019-10-28 16:11:38'
  - ''
  - 1150
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 4.9805876910523404e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-06-06 11:08:33', '2019-06-10 21:31:06'];
  params:
  - - '2019-06-06 11:08:33'
    - '2019-06-10 21:31:06'
  - ''
  - 4.9805876910523404e-06
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-12-21'::timestamp, DATE '2019-12-21'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-12-21'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-06-23'::timestamp, DATE '2019-06-23'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-06-23'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-02-08'::timestamp, DATE '2019-02-08'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-02-08'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 4.087696111320589e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-12-31 17:51:16', '2019-12-31 23:59:59'];
  params:
  - - '2019-12-31 17:51:16'
    - '2019-12-31 23:59:59'
  - ''
  - 4.087696111320589e-06
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-11-19 12:44:29', '2019-11-27 11:47:10'];
  params:
  - - '2019-11-19 12:44:29'
    - '2019-11-27 11:47:10'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-01-10 18:14:38', '2019-01-16 17:49:49'];
  params:
  - - '2019-01-10 18:14:38'
    - '2019-01-16 17:49:49'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-11-09 14:36:05', '2019-11-10 02:23:25'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-11-09 14:36:05'
    - '2019-11-10 02:23:25'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-07-16 10:00:54', '2019-07-24 10:24:25'];
  params:
  - - '2019-07-16 10:00:54'
    - '2019-07-24 10:24:25'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.0074020532350055e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-11-29 15:35:50', '2019-12-11 22:54:55'];
  params:
  - - '2019-11-29 15:35:50'
    - '2019-12-11 22:54:55'
  - ''
  - 1.0074020532350055e-05
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-10-09 07:37:54', '2019-10-13 11:11:54'] AND f.altitude < 700 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-10-09 07:37:54'
    - '2019-10-13 11:11:54'
  - ''
  - 700
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-05-16 11:09:24' GROUP BY b.name;
  params:
  - '2019-05-16 11:09:24'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.1721777023022471e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-12-14 01:29:21', '2019-12-22 20:28:49'];
  params:
  - - '2019-12-14 01:29:21'
    - '2019-12-22 20:28:49'
  - ''
  - 1.1721777023022471e-05
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-02-23 09:43:40', '2019-03-01 17:51:25'] AND f.altitude < 960 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-02-23 09:43:40'
    - '2019-03-01 17:51:25'
  - ''
  - 960
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-03-15 19:53:02', '2019-03-16 11:54:21'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-03-15 19:53:02'
    - '2019-03-16 11:54:21'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-07-17 18:22:29', '2019-07-31 11:13:27'];
  params:
  - - '2019-07-17 18:22:29'
    - '2019-07-31 11:13:27'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-04-07 01:00:24', '2019-04-07 17:34:28'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-04-07 01:00:24'
    - '2019-04-07 17:34:28'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-01-06 00:57:03', '2019-01-09 20:42:28'];
  params:
  - - '2019-01-06 00:57:03'
    - '2019-01-09 20:42:28'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.4759904178140505e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-01-17 22:35:30', '2019-01-25 18:29:46'];
  params:
  - - '2019-01-17 22:35:30'
    - '2019-01-25 18:29:46'
  - ''
  - 1.4759904178140505e-05
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-11-02 19:06:43', '2019-11-04 01:47:30'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-11-02 19:06:43'
    - '2019-11-04 01:47:30'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-01-01 21:00:22', '2019-01-11 16:11:40'];
  params:
  - - '2019-01-01 21:00:22'
    - '2019-01-11 16:11:40'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3.4152261718004293e-06) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-04-16 13:22:22', '2019-04-23 05:45:39'];
  params:
  - - '2019-04-16 13:22:22'
    - '2019-04-23 05:45:39'
  - ''
  - 3.4152261718004293e-06
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND f.timestamp BETWEEN ['2019-10-27 00:03:40', '2019-11-09 16:08:44'];
  params:
  - - '2019-10-27 00:03:40'
    - '2019-11-09 16:08:44'
  - ''
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-06-17'::timestamp, DATE '2019-06-17'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-06-17'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.1264031858586703e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-02-17 15:15:49', '2019-03-03 01:36:54'];
  params:
  - - '2019-02-17 15:15:49'
    - '2019-03-03 01:36:54'
  - ''
  - 1.1264031858586703e-05
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-06-30 12:57:13' GROUP BY b.name;
  params:
  - '2019-06-30 12:57:13'
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-09-18'::timestamp, DATE '2019-09-18'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-09-18'
  - ''
- name: flightDurationInMunicipalityLowAltitudeInPeriod
  type: spatiotemporal
  sql: |
    SELECT g.name, f.flightid, MIN(f.timestamp) AS entry_time, MAX(f.timestamp) AS exit_time, COUNT(*) * INTERVAL '1 second' AS total_time_below_altitude FROM municipalities g JOIN flight_points f ON ST_Intersects(f.geom, g.geom) WHERE g.name = '' AND f.timestamp BETWEEN ['2019-11-09 01:44:30', '2019-11-15 01:52:55'] AND f.altitude < 530 GROUP BY g.name, f.flightid;

    '
  params:
  - - '2019-11-09 01:44:30'
    - '2019-11-15 01:52:55'
  - ''
  - 530
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-07-17 19:53:35', '2019-07-18 17:40:23'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-07-17 19:53:35'
    - '2019-07-18 17:40:23'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-09-05 13:09:06', '2019-09-05 20:38:13'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-09-05 13:09:06'
    - '2019-09-05 20:38:13'
  - ''
- name: flightsWithLocalOriginDestinationInPeriodInCounty
  type: spatiotemporal
  sql: |
    WITH relevant_airports AS ( SELECT a.icao as icao FROM airports a JOIN cities c ON a.city = c.name ), qualifying_flight_points AS ( SELECT DISTINCT f.flightid FROM flight_points f JOIN counties k ON  ST_Intersects(f.geom, k.geom) AND k.name = '' WHERE f.timestamp BETWEEN ['2019-11-23 22:34:22', '2019-11-24 23:29:13'] ) SELECT  f.flightid,  f.airplanetype,  f.origin AS origin_airport,  a1.city AS origin_city,  f.destination AS destination_airport, a2.city AS destination_city FROM  flight_points f JOIN  qualifying_flight_points qf ON f.flightid = qf.flightid LEFT JOIN  airports a1 ON f.origin = a1.icao LEFT JOIN  airports a2 ON f.destination = a2.icao WHERE (f.origin IN (SELECT icao FROM relevant_airports) OR f.destination IN (SELECT icao FROM relevant_airports));
  params:
  - - '2019-11-23 22:34:22'
    - '2019-11-24 23:29:13'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT f.flightId, f.airplanetype, f.origin, f.destination FROM cities AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1.0348442149104108e-05) WHERE c.name = '' AND f.timestamp BETWEEN ['2019-02-13 10:22:44', '2019-02-18 10:31:08'];
  params:
  - - '2019-02-13 10:22:44'
    - '2019-02-18 10:31:08'
  - ''
  - 1.0348442149104108e-05
- name: averageHourlyFlightsDuringDayInMunicipality
  type: spatiotemporal
  sql: |
    WITH hours AS ( SELECT generate_series( DATE '2019-09-27'::timestamp, DATE '2019-09-27'::timestamp + INTERVAL '1 day' - INTERVAL '1 second', INTERVAL '1 hour' ) AS start_time ) SELECT  h.start_time, COUNT(DISTINCT f.flightid) AS active_flights FROM  hours h JOIN  municipalities g ON g.name = '' LEFT JOIN  flight_points fp ON  fp.timestamp >= h.start_time AND fp.timestamp < h.start_time + INTERVAL '1 hour' AND ST_Intersects(fp.geom, g.geom) LEFT JOIN flight_points f ON f.flightid = fp.flightid GROUP BY  h.start_time ORDER BY  h.start_time;
  params:
  - '2019-09-27'
  - ''
- name: countFlightsAtInstantInDistricts
  type: spatiotemporal
  sql: |-
    SELECT b.name, COUNT(DISTINCT f.flightid) FROM flight_points f, districts b WHERE f.geom && b.geom AND f.timestamp = '2019-02-16 04:18:30' GROUP BY b.name;
  params:
  - '2019-02-16 04:18:30'
