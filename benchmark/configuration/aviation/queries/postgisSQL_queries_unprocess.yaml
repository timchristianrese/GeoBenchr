- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1857) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-01-14 21:36:42', '2019-01-19 00:55:07'] AND ['2019-01-14 21:36:42', '2019-01-19 00:55:07'] @> f.timestamp;
  params:
  - - '2019-01-14 21:36:42'
    - '2019-01-19 00:55:07'
  - ''
  - 1857
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-10-11 20:08:37', '2019-10-23 01:51:27'] @> f.timestamp;
  params:
  - - '2019-10-11 20:08:37'
    - '2019-10-23 01:51:27'
  - ''
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-01-28 10:54:30', '2019-02-08 20:35:20'] @> f.timestamp;
  params:
  - - '2019-01-28 10:54:30'
    - '2019-02-08 20:35:20'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1773) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-01-24 19:31:53', '2019-02-06 09:02:57'] AND ['2019-01-24 19:31:53', '2019-02-06 09:02:57'] @> f.timestamp;
  params:
  - - '2019-01-24 19:31:53'
    - '2019-02-06 09:02:57'
  - ''
  - 1773
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3898) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-03-02 08:18:15', '2019-03-14 02:06:33'] AND ['2019-03-02 08:18:15', '2019-03-14 02:06:33'] @> f.timestamp;
  params:
  - - '2019-03-02 08:18:15'
    - '2019-03-14 02:06:33'
  - ''
  - 3898
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-04-01 13:10:48', '2019-04-04 13:31:06'] @> f.timestamp;
  params:
  - - '2019-04-01 13:10:48'
    - '2019-04-04 13:31:06'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 4755) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-05-21 08:38:08', '2019-06-02 14:47:45'] AND ['2019-05-21 08:38:08', '2019-06-02 14:47:45'] @> f.timestamp;
  params:
  - - '2019-05-21 08:38:08'
    - '2019-06-02 14:47:45'
  - ''
  - 4755
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2588495.713612869, 4507101.412313064), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2588495.713612869, 4507101.412313064), 3857), 2733) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2588495.713612869, 4507101.412313064), 3857)
  - 2733
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-09-21 23:21:07', '2019-09-25 09:46:32'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-09-21 23:21:07'
    - '2019-09-25 09:46:32'
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-01-17 16:20:17', '2019-01-22 18:13:48'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-01-17 16:20:17'
    - '2019-01-22 18:13:48'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 2845) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-09-09 10:13:50', '2019-09-14 17:30:11'] AND ['2019-09-09 10:13:50', '2019-09-14 17:30:11'] @> f.timestamp;
  params:
  - - '2019-09-09 10:13:50'
    - '2019-09-14 17:30:11'
  - ''
  - 2845
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-08-24 06:04:03', '2019-08-29 23:41:21'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-08-24 06:04:03'
    - '2019-08-29 23:41:21'
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-03-28 12:02:01', '2019-03-28 13:08:02'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-03-28 12:02:01', '2019-03-28 13:08:02'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-03-28 12:02:01'
    - '2019-03-28 13:08:02'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3790) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-10-12 14:50:01', '2019-10-16 13:41:57'] AND ['2019-10-12 14:50:01', '2019-10-16 13:41:57'] @> f.timestamp;
  params:
  - - '2019-10-12 14:50:01'
    - '2019-10-16 13:41:57'
  - ''
  - 3790
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-02-25 19:14:51', '2019-03-11 04:37:05'] @> f.timestamp;
  params:
  - - '2019-02-25 19:14:51'
    - '2019-03-11 04:37:05'
  - ''
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2592224.3588634823, 4543362.493911913), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2592224.3588634823, 4543362.493911913), 3857), 2361) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2592224.3588634823, 4543362.493911913), 3857)
  - 2361
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2668602.5391765507, 4580775.057668077), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2668602.5391765507, 4580775.057668077), 3857), 4176) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2668602.5391765507, 4580775.057668077), 3857)
  - 4176
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 2924) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-10-22 01:17:47', '2019-11-02 17:36:21'] AND ['2019-10-22 01:17:47', '2019-11-02 17:36:21'] @> f.timestamp;
  params:
  - - '2019-10-22 01:17:47'
    - '2019-11-02 17:36:21'
  - ''
  - 2924
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2571353.480053358, 4580411.83237736), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2571353.480053358, 4580411.83237736), 3857), 3877) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2571353.480053358, 4580411.83237736), 3857)
  - 3877
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-06-24 23:11:53', '2019-07-06 01:22:03'] @> f.timestamp;
  params:
  - - '2019-06-24 23:11:53'
    - '2019-07-06 01:22:03'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 4354) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-07-01 00:01:14', '2019-07-10 01:23:58'] AND ['2019-07-01 00:01:14', '2019-07-10 01:23:58'] @> f.timestamp;
  params:
  - - '2019-07-01 00:01:14'
    - '2019-07-10 01:23:58'
  - ''
  - 4354
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-01-10 16:27:16', '2019-01-25 14:37:00'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-01-10 16:27:16'
    - '2019-01-25 14:37:00'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 2340) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-10-30 04:01:28', '2019-11-01 08:28:08'] AND ['2019-10-30 04:01:28', '2019-11-01 08:28:08'] @> f.timestamp;
  params:
  - - '2019-10-30 04:01:28'
    - '2019-11-01 08:28:08'
  - ''
  - 2340
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-06-12 21:20:41', '2019-06-14 13:40:25'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-06-12 21:20:41', '2019-06-14 13:40:25'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-06-12 21:20:41'
    - '2019-06-14 13:40:25'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-05-03 01:14:13', '2019-05-11 10:16:01'] @> f.timestamp;
  params:
  - - '2019-05-03 01:14:13'
    - '2019-05-11 10:16:01'
  - ''
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-02-04 01:35:41', '2019-02-04 20:38:06'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-02-04 01:35:41', '2019-02-04 20:38:06'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-02-04 01:35:41'
    - '2019-02-04 20:38:06'
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-04-05 20:49:33', '2019-04-06 06:50:49'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-04-05 20:49:33', '2019-04-06 06:50:49'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-04-05 20:49:33'
    - '2019-04-06 06:50:49'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1494) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-11-28 08:46:56', '2019-12-04 07:16:27'] AND ['2019-11-28 08:46:56', '2019-12-04 07:16:27'] @> f.timestamp;
  params:
  - - '2019-11-28 08:46:56'
    - '2019-12-04 07:16:27'
  - ''
  - 1494
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-09-23 02:56:22', '2019-10-03 14:26:33'] @> f.timestamp;
  params:
  - - '2019-09-23 02:56:22'
    - '2019-10-03 14:26:33'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1347) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-05-05 00:41:17', '2019-05-07 19:40:54'] AND ['2019-05-05 00:41:17', '2019-05-07 19:40:54'] @> f.timestamp;
  params:
  - - '2019-05-05 00:41:17'
    - '2019-05-07 19:40:54'
  - ''
  - 1347
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-03-14 22:29:18', '2019-03-27 19:52:26'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-03-14 22:29:18'
    - '2019-03-27 19:52:26'
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2562243.601661703, 4526901.754382868), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2562243.601661703, 4526901.754382868), 3857), 3393) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2562243.601661703, 4526901.754382868), 3857)
  - 3393
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-03-24 07:05:49', '2019-03-27 19:59:21'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-03-24 07:05:49'
    - '2019-03-27 19:59:21'
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2602881.079784368, 4553604.682906462), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2602881.079784368, 4553604.682906462), 3857), 2086) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2602881.079784368, 4553604.682906462), 3857)
  - 2086
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-09-13 20:10:33', '2019-09-15 04:18:11'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-09-13 20:10:33', '2019-09-15 04:18:11'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-09-13 20:10:33'
    - '2019-09-15 04:18:11'
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-04-05 06:18:29', '2019-04-19 01:49:29'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-04-05 06:18:29'
    - '2019-04-19 01:49:29'
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-11-25 12:38:50', '2019-12-07 00:48:36'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-11-25 12:38:50'
    - '2019-12-07 00:48:36'
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-07-06 03:37:48', '2019-07-07 04:14:15'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-07-06 03:37:48', '2019-07-07 04:14:15'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-07-06 03:37:48'
    - '2019-07-07 04:14:15'
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-04-02 09:34:41', '2019-04-12 08:10:27'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-04-02 09:34:41'
    - '2019-04-12 08:10:27'
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-03-09 07:08:20', '2019-03-09 15:04:38'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-03-09 07:08:20', '2019-03-09 15:04:38'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-03-09 07:08:20'
    - '2019-03-09 15:04:38'
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-06-22 01:23:41', '2019-06-30 07:18:52'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-06-22 01:23:41'
    - '2019-06-30 07:18:52'
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2608540.4504962726, 4515424.804214809), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2608540.4504962726, 4515424.804214809), 3857), 1377) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2608540.4504962726, 4515424.804214809), 3857)
  - 1377
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-04-22 15:39:25', '2019-05-05 04:50:38'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-04-22 15:39:25'
    - '2019-05-05 04:50:38'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-04-12 03:04:35', '2019-04-26 09:44:38'] @> f.timestamp;
  params:
  - - '2019-04-12 03:04:35'
    - '2019-04-26 09:44:38'
  - ''
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2565381.2030658545, 4540947.320111624), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2565381.2030658545, 4540947.320111624), 3857), 1467) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2565381.2030658545, 4540947.320111624), 3857)
  - 1467
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2571915.238760338, 4544135.90343123), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2571915.238760338, 4544135.90343123), 3857), 3155) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2571915.238760338, 4544135.90343123), 3857)
  - 3155
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 2268) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-07-16 17:54:09', '2019-07-26 20:56:25'] AND ['2019-07-16 17:54:09', '2019-07-26 20:56:25'] @> f.timestamp;
  params:
  - - '2019-07-16 17:54:09'
    - '2019-07-26 20:56:25'
  - ''
  - 2268
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-04-24 03:21:41', '2019-04-24 17:58:36'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-04-24 03:21:41', '2019-04-24 17:58:36'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-04-24 03:21:41'
    - '2019-04-24 17:58:36'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 4850) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-10-07 18:34:23', '2019-10-10 04:33:51'] AND ['2019-10-07 18:34:23', '2019-10-10 04:33:51'] @> f.timestamp;
  params:
  - - '2019-10-07 18:34:23'
    - '2019-10-10 04:33:51'
  - ''
  - 4850
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-07-29 22:52:08', '2019-07-30 01:41:23'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-07-29 22:52:08', '2019-07-30 01:41:23'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-07-29 22:52:08'
    - '2019-07-30 01:41:23'
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-12-10 20:08:17', '2019-12-18 01:03:48'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-12-10 20:08:17'
    - '2019-12-18 01:03:48'
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2572375.3608593224, 4545834.809584631), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2572375.3608593224, 4545834.809584631), 3857), 3324) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2572375.3608593224, 4545834.809584631), 3857)
  - 3324
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-04-26 21:26:01', '2019-04-27 00:37:50'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-04-26 21:26:01', '2019-04-27 00:37:50'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-04-26 21:26:01'
    - '2019-04-27 00:37:50'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-04-05 12:10:35', '2019-04-13 08:48:30'] @> f.timestamp;
  params:
  - - '2019-04-05 12:10:35'
    - '2019-04-13 08:48:30'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3286) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-08-22 23:28:31', '2019-09-06 18:44:32'] AND ['2019-08-22 23:28:31', '2019-09-06 18:44:32'] @> f.timestamp;
  params:
  - - '2019-08-22 23:28:31'
    - '2019-09-06 18:44:32'
  - ''
  - 3286
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3930) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-11-13 01:11:53', '2019-11-17 05:24:01'] AND ['2019-11-13 01:11:53', '2019-11-17 05:24:01'] @> f.timestamp;
  params:
  - - '2019-11-13 01:11:53'
    - '2019-11-17 05:24:01'
  - ''
  - 3930
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2649160.177705176, 4506752.657249684), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2649160.177705176, 4506752.657249684), 3857), 4066) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2649160.177705176, 4506752.657249684), 3857)
  - 4066
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-05-30 11:57:51', '2019-05-30 17:26:37'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-05-30 11:57:51', '2019-05-30 17:26:37'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-05-30 11:57:51'
    - '2019-05-30 17:26:37'
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-12-04 00:49:39', '2019-12-12 19:10:19'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-12-04 00:49:39'
    - '2019-12-12 19:10:19'
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-04-24 19:27:48', '2019-05-02 13:07:44'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-04-24 19:27:48'
    - '2019-05-02 13:07:44'
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-06-17 19:58:57', '2019-06-24 05:54:06'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-06-17 19:58:57'
    - '2019-06-24 05:54:06'
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-12-22 02:46:50', '2019-12-26 03:20:25'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-12-22 02:46:50'
    - '2019-12-26 03:20:25'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-03-04 00:26:29', '2019-03-08 10:45:34'] @> f.timestamp;
  params:
  - - '2019-03-04 00:26:29'
    - '2019-03-08 10:45:34'
  - ''
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-01-25 22:03:25', '2019-02-03 22:00:02'] @> f.timestamp;
  params:
  - - '2019-01-25 22:03:25'
    - '2019-02-03 22:00:02'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-04-22 17:02:34', '2019-05-06 20:03:01'] @> f.timestamp;
  params:
  - - '2019-04-22 17:02:34'
    - '2019-05-06 20:03:01'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1921) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-08-06 12:29:02', '2019-08-16 21:20:16'] AND ['2019-08-06 12:29:02', '2019-08-16 21:20:16'] @> f.timestamp;
  params:
  - - '2019-08-06 12:29:02'
    - '2019-08-16 21:20:16'
  - ''
  - 1921
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-11-22 10:06:00', '2019-12-04 18:43:38'] @> f.timestamp;
  params:
  - - '2019-11-22 10:06:00'
    - '2019-12-04 18:43:38'
  - ''
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-03-26 12:23:54', '2019-03-26 18:57:07'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-03-26 12:23:54', '2019-03-26 18:57:07'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-03-26 12:23:54'
    - '2019-03-26 18:57:07'
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-01-03 19:38:55', '2019-01-10 10:32:07'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-01-03 19:38:55'
    - '2019-01-10 10:32:07'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 2989) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-09-09 14:00:39', '2019-09-22 17:35:18'] AND ['2019-09-09 14:00:39', '2019-09-22 17:35:18'] @> f.timestamp;
  params:
  - - '2019-09-09 14:00:39'
    - '2019-09-22 17:35:18'
  - ''
  - 2989
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-10-02 19:56:16', '2019-10-16 08:30:38'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-10-02 19:56:16'
    - '2019-10-16 08:30:38'
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1506) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-11-01 18:02:52', '2019-11-15 02:39:22'] AND ['2019-11-01 18:02:52', '2019-11-15 02:39:22'] @> f.timestamp;
  params:
  - - '2019-11-01 18:02:52'
    - '2019-11-15 02:39:22'
  - ''
  - 1506
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2617910.8185239397, 4515199.683362212), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2617910.8185239397, 4515199.683362212), 3857), 4699) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2617910.8185239397, 4515199.683362212), 3857)
  - 4699
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-08-16 06:52:39', '2019-08-17 13:26:39'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-08-16 06:52:39', '2019-08-17 13:26:39'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-08-16 06:52:39'
    - '2019-08-17 13:26:39'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-11-28 16:31:51', '2019-12-04 14:46:46'] @> f.timestamp;
  params:
  - - '2019-11-28 16:31:51'
    - '2019-12-04 14:46:46'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3626) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-11-25 16:41:37', '2019-12-02 13:33:10'] AND ['2019-11-25 16:41:37', '2019-12-02 13:33:10'] @> f.timestamp;
  params:
  - - '2019-11-25 16:41:37'
    - '2019-12-02 13:33:10'
  - ''
  - 3626
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 2371) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-01-05 08:25:51', '2019-01-14 02:34:07'] AND ['2019-01-05 08:25:51', '2019-01-14 02:34:07'] @> f.timestamp;
  params:
  - - '2019-01-05 08:25:51'
    - '2019-01-14 02:34:07'
  - ''
  - 2371
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-02-16 02:49:11', '2019-02-21 13:58:43'] @> f.timestamp;
  params:
  - - '2019-02-16 02:49:11'
    - '2019-02-21 13:58:43'
  - ''
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1994) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-02-09 18:22:02', '2019-02-16 11:42:23'] AND ['2019-02-09 18:22:02', '2019-02-16 11:42:23'] @> f.timestamp;
  params:
  - - '2019-02-09 18:22:02'
    - '2019-02-16 11:42:23'
  - ''
  - 1994
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-05-08 13:46:04', '2019-05-08 20:56:31'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-05-08 13:46:04', '2019-05-08 20:56:31'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-05-08 13:46:04'
    - '2019-05-08 20:56:31'
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-08-08 04:00:02', '2019-08-22 23:41:34'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-08-08 04:00:02'
    - '2019-08-22 23:41:34'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-05-20 19:42:28', '2019-05-29 13:15:31'] @> f.timestamp;
  params:
  - - '2019-05-20 19:42:28'
    - '2019-05-29 13:15:31'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-11-12 12:47:05', '2019-11-23 04:12:43'] @> f.timestamp;
  params:
  - - '2019-11-12 12:47:05'
    - '2019-11-23 04:12:43'
  - ''
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2566288.088125279, 4576239.742352111), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2566288.088125279, 4576239.742352111), 3857), 3117) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2566288.088125279, 4576239.742352111), 3857)
  - 3117
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-08-15 11:06:37', '2019-08-17 08:16:43'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-08-15 11:06:37', '2019-08-17 08:16:43'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-08-15 11:06:37'
    - '2019-08-17 08:16:43'
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-12-24 11:09:18', '2019-12-24 12:24:49'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-12-24 11:09:18', '2019-12-24 12:24:49'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-12-24 11:09:18'
    - '2019-12-24 12:24:49'
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2619805.1268980787, 4556840.069523791), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2619805.1268980787, 4556840.069523791), 3857), 1969) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2619805.1268980787, 4556840.069523791), 3857)
  - 1969
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2578829.6424540305, 4541959.829674971), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2578829.6424540305, 4541959.829674971), 3857), 1875) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2578829.6424540305, 4541959.829674971), 3857)
  - 1875
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-11-07 20:09:30', '2019-11-10 08:23:05'] @> f.timestamp;
  params:
  - - '2019-11-07 20:09:30'
    - '2019-11-10 08:23:05'
  - ''
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2648267.587846192, 4510860.185246041), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2648267.587846192, 4510860.185246041), 3857), 4465) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2648267.587846192, 4510860.185246041), 3857)
  - 4465
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-10-11 23:12:37', '2019-10-13 11:04:19'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-10-11 23:12:37', '2019-10-13 11:04:19'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-10-11 23:12:37'
    - '2019-10-13 11:04:19'
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-02-09 08:56:43', '2019-02-09 14:43:59'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-02-09 08:56:43', '2019-02-09 14:43:59'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-02-09 08:56:43'
    - '2019-02-09 14:43:59'
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2659566.3797435695, 4508189.764924455), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2659566.3797435695, 4508189.764924455), 3857), 3621) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2659566.3797435695, 4508189.764924455), 3857)
  - 3621
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-05-12 18:48:00', '2019-05-15 00:01:28'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-05-12 18:48:00'
    - '2019-05-15 00:01:28'
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-06-09 11:41:16', '2019-06-15 14:56:17'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-06-09 11:41:16'
    - '2019-06-15 14:56:17'
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-08-18 16:33:43', '2019-08-18 22:35:29'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-08-18 16:33:43', '2019-08-18 22:35:29'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-08-18 16:33:43'
    - '2019-08-18 22:35:29'
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-07-30 01:47:31', '2019-08-01 04:25:06'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-07-30 01:47:31'
    - '2019-08-01 04:25:06'
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2657258.6663406286, 4521992.372209334), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2657258.6663406286, 4521992.372209334), 3857), 4127) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2657258.6663406286, 4521992.372209334), 3857)
  - 4127
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 2811) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-03-31 07:54:06', '2019-04-09 10:04:08'] AND ['2019-03-31 07:54:06', '2019-04-09 10:04:08'] @> f.timestamp;
  params:
  - - '2019-03-31 07:54:06'
    - '2019-04-09 10:04:08'
  - ''
  - 2811
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-11-25 10:11:28', '2019-11-29 00:59:53'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-11-25 10:11:28'
    - '2019-11-29 00:59:53'
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2595012.7998355185, 4584141.4024170935), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2595012.7998355185, 4584141.4024170935), 3857), 1742) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2595012.7998355185, 4584141.4024170935), 3857)
  - 1742
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1750) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-10-10 07:56:03', '2019-10-23 19:20:04'] AND ['2019-10-10 07:56:03', '2019-10-23 19:20:04'] @> f.timestamp;
  params:
  - - '2019-10-10 07:56:03'
    - '2019-10-23 19:20:04'
  - ''
  - 1750
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-12-09 12:35:02', '2019-12-12 11:44:54'] @> f.timestamp;
  params:
  - - '2019-12-09 12:35:02'
    - '2019-12-12 11:44:54'
  - ''
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-02-21 13:47:46', '2019-02-22 11:58:25'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-02-21 13:47:46', '2019-02-22 11:58:25'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-02-21 13:47:46'
    - '2019-02-22 11:58:25'
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 2109) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-04-26 10:09:59', '2019-05-08 06:00:46'] AND ['2019-04-26 10:09:59', '2019-05-08 06:00:46'] @> f.timestamp;
  params:
  - - '2019-04-26 10:09:59'
    - '2019-05-08 06:00:46'
  - ''
  - 2109
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-07-21 05:50:26', '2019-07-28 12:06:30'] @> f.timestamp;
  params:
  - - '2019-07-21 05:50:26'
    - '2019-07-28 12:06:30'
  - ''
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-01-03 01:22:42', '2019-01-09 20:35:45'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-01-03 01:22:42'
    - '2019-01-09 20:35:45'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-11-10 17:20:14', '2019-11-22 14:21:56'] @> f.timestamp;
  params:
  - - '2019-11-10 17:20:14'
    - '2019-11-22 14:21:56'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-08-24 22:27:12', '2019-09-08 14:04:14'] @> f.timestamp;
  params:
  - - '2019-08-24 22:27:12'
    - '2019-09-08 14:04:14'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-10-20 01:09:29', '2019-10-26 06:10:37'] @> f.timestamp;
  params:
  - - '2019-10-20 01:09:29'
    - '2019-10-26 06:10:37'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1676) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-08-29 17:20:37', '2019-09-11 15:49:27'] AND ['2019-08-29 17:20:37', '2019-09-11 15:49:27'] @> f.timestamp;
  params:
  - - '2019-08-29 17:20:37'
    - '2019-09-11 15:49:27'
  - ''
  - 1676
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-06-10 16:49:34', '2019-06-16 20:23:54'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-06-10 16:49:34'
    - '2019-06-16 20:23:54'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-03-04 14:52:01', '2019-03-09 13:13:00'] @> f.timestamp;
  params:
  - - '2019-03-04 14:52:01'
    - '2019-03-09 13:13:00'
  - ''
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-03-02 09:24:42', '2019-03-16 16:42:23'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-03-02 09:24:42'
    - '2019-03-16 16:42:23'
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2669568.699394809, 4513601.530315986), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2669568.699394809, 4513601.530315986), 3857), 1853) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2669568.699394809, 4513601.530315986), 3857)
  - 1853
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-10-03 21:52:44', '2019-10-06 18:11:33'] @> f.timestamp;
  params:
  - - '2019-10-03 21:52:44'
    - '2019-10-06 18:11:33'
  - ''
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2589719.8178878264, 4525712.088744185), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2589719.8178878264, 4525712.088744185), 3857), 2993) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2589719.8178878264, 4525712.088744185), 3857)
  - 2993
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3026) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-07-15 04:09:07', '2019-07-17 20:20:49'] AND ['2019-07-15 04:09:07', '2019-07-17 20:20:49'] @> f.timestamp;
  params:
  - - '2019-07-15 04:09:07'
    - '2019-07-17 20:20:49'
  - ''
  - 3026
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-08-02 02:21:51', '2019-08-09 01:43:32'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-08-02 02:21:51'
    - '2019-08-09 01:43:32'
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2638539.1958387946, 4519647.196012186), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2638539.1958387946, 4519647.196012186), 3857), 2481) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2638539.1958387946, 4519647.196012186), 3857)
  - 2481
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2648186.809675498, 4584414.5877430905), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2648186.809675498, 4584414.5877430905), 3857), 2246) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2648186.809675498, 4584414.5877430905), 3857)
  - 2246
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-10-30 14:54:01', '2019-11-10 04:02:51'] @> f.timestamp;
  params:
  - - '2019-10-30 14:54:01'
    - '2019-11-10 04:02:51'
  - ''
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-10-05 15:40:42', '2019-10-19 18:42:24'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-10-05 15:40:42'
    - '2019-10-19 18:42:24'
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2650454.9663467905, 4512829.650520213), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2650454.9663467905, 4512829.650520213), 3857), 2240) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2650454.9663467905, 4512829.650520213), 3857)
  - 2240
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-04-17 20:47:35', '2019-04-19 01:24:46'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-04-17 20:47:35', '2019-04-19 01:24:46'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-04-17 20:47:35'
    - '2019-04-19 01:24:46'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-11-23 07:58:52', '2019-11-25 17:10:17'] @> f.timestamp;
  params:
  - - '2019-11-23 07:58:52'
    - '2019-11-25 17:10:17'
  - ''
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-07-21 20:14:41', '2019-07-21 20:57:04'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-07-21 20:14:41', '2019-07-21 20:57:04'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-07-21 20:14:41'
    - '2019-07-21 20:57:04'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-10-23 11:28:51', '2019-11-02 22:24:29'] @> f.timestamp;
  params:
  - - '2019-10-23 11:28:51'
    - '2019-11-02 22:24:29'
  - ''
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-09-13 21:37:39', '2019-09-24 08:21:38'] @> f.timestamp;
  params:
  - - '2019-09-13 21:37:39'
    - '2019-09-24 08:21:38'
  - ''
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2576083.278691011, 4582493.441286644), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2576083.278691011, 4582493.441286644), 3857), 3684) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2576083.278691011, 4582493.441286644), 3857)
  - 3684
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-04-04 06:02:13', '2019-04-04 07:46:23'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-04-04 06:02:13', '2019-04-04 07:46:23'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-04-04 06:02:13'
    - '2019-04-04 07:46:23'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3886) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-10-01 12:30:35', '2019-10-11 22:05:04'] AND ['2019-10-01 12:30:35', '2019-10-11 22:05:04'] @> f.timestamp;
  params:
  - - '2019-10-01 12:30:35'
    - '2019-10-11 22:05:04'
  - ''
  - 3886
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-10-09 12:31:45', '2019-10-21 02:46:00'] @> f.timestamp;
  params:
  - - '2019-10-09 12:31:45'
    - '2019-10-21 02:46:00'
  - ''
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2612363.5093427887, 4545917.15448903), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2612363.5093427887, 4545917.15448903), 3857), 1147) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2612363.5093427887, 4545917.15448903), 3857)
  - 1147
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-08-04 21:01:21', '2019-08-10 20:08:13'] @> f.timestamp;
  params:
  - - '2019-08-04 21:01:21'
    - '2019-08-10 20:08:13'
  - ''
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2572738.6534154564, 4583554.978061493), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2572738.6534154564, 4583554.978061493), 3857), 2925) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2572738.6534154564, 4583554.978061493), 3857)
  - 2925
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-05-01 03:02:11', '2019-05-15 22:34:37'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-05-01 03:02:11'
    - '2019-05-15 22:34:37'
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2570554.4633843075, 4578110.066298802), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2570554.4633843075, 4578110.066298802), 3857), 4955) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2570554.4633843075, 4578110.066298802), 3857)
  - 4955
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-04-05 20:59:09', '2019-04-06 13:39:02'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-04-05 20:59:09', '2019-04-06 13:39:02'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-04-05 20:59:09'
    - '2019-04-06 13:39:02'
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-03-21 22:20:14', '2019-04-02 12:00:36'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-03-21 22:20:14'
    - '2019-04-02 12:00:36'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 2344) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-02-18 22:25:26', '2019-02-27 20:35:33'] AND ['2019-02-18 22:25:26', '2019-02-27 20:35:33'] @> f.timestamp;
  params:
  - - '2019-02-18 22:25:26'
    - '2019-02-27 20:35:33'
  - ''
  - 2344
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2669098.1787111326, 4553982.341461828), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2669098.1787111326, 4553982.341461828), 3857), 4331) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2669098.1787111326, 4553982.341461828), 3857)
  - 4331
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-09-25 00:02:50', '2019-09-25 08:38:16'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-09-25 00:02:50', '2019-09-25 08:38:16'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-09-25 00:02:50'
    - '2019-09-25 08:38:16'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-03-28 14:26:01', '2019-03-31 20:46:29'] @> f.timestamp;
  params:
  - - '2019-03-28 14:26:01'
    - '2019-03-31 20:46:29'
  - ''
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2587452.670960757, 4522174.185344914), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2587452.670960757, 4522174.185344914), 3857), 2708) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2587452.670960757, 4522174.185344914), 3857)
  - 2708
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-04-12 19:24:41', '2019-04-14 21:20:27'] @> f.timestamp;
  params:
  - - '2019-04-12 19:24:41'
    - '2019-04-14 21:20:27'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-10-06 02:41:50', '2019-10-18 01:15:23'] @> f.timestamp;
  params:
  - - '2019-10-06 02:41:50'
    - '2019-10-18 01:15:23'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 4865) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-02-22 17:55:57', '2019-03-07 18:15:08'] AND ['2019-02-22 17:55:57', '2019-03-07 18:15:08'] @> f.timestamp;
  params:
  - - '2019-02-22 17:55:57'
    - '2019-03-07 18:15:08'
  - ''
  - 4865
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-10-27 09:49:48', '2019-10-27 15:50:14'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-10-27 09:49:48', '2019-10-27 15:50:14'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-10-27 09:49:48'
    - '2019-10-27 15:50:14'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3305) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-05-19 15:15:27', '2019-05-26 00:20:44'] AND ['2019-05-19 15:15:27', '2019-05-26 00:20:44'] @> f.timestamp;
  params:
  - - '2019-05-19 15:15:27'
    - '2019-05-26 00:20:44'
  - ''
  - 3305
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3749) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-04-03 23:38:01', '2019-04-16 03:20:53'] AND ['2019-04-03 23:38:01', '2019-04-16 03:20:53'] @> f.timestamp;
  params:
  - - '2019-04-03 23:38:01'
    - '2019-04-16 03:20:53'
  - ''
  - 3749
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2621440.5483557326, 4554049.0146954255), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2621440.5483557326, 4554049.0146954255), 3857), 3531) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2621440.5483557326, 4554049.0146954255), 3857)
  - 3531
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-11-04 08:57:42', '2019-11-11 22:05:31'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-11-04 08:57:42'
    - '2019-11-11 22:05:31'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-10-29 08:25:56', '2019-11-10 03:44:48'] @> f.timestamp;
  params:
  - - '2019-10-29 08:25:56'
    - '2019-11-10 03:44:48'
  - ''
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-06-11 13:16:53', '2019-06-13 01:50:37'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-06-11 13:16:53', '2019-06-13 01:50:37'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-06-11 13:16:53'
    - '2019-06-13 01:50:37'
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-07-30 21:48:06', '2019-08-12 07:07:20'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-07-30 21:48:06'
    - '2019-08-12 07:07:20'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-02-08 18:50:35', '2019-02-15 08:01:12'] @> f.timestamp;
  params:
  - - '2019-02-08 18:50:35'
    - '2019-02-15 08:01:12'
  - ''
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-01-27 07:34:10', '2019-01-28 10:43:13'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-01-27 07:34:10', '2019-01-28 10:43:13'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-01-27 07:34:10'
    - '2019-01-28 10:43:13'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3426) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-09-16 19:30:29', '2019-09-30 15:14:45'] AND ['2019-09-16 19:30:29', '2019-09-30 15:14:45'] @> f.timestamp;
  params:
  - - '2019-09-16 19:30:29'
    - '2019-09-30 15:14:45'
  - ''
  - 3426
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-04-09 10:35:59', '2019-04-11 10:29:33'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-04-09 10:35:59', '2019-04-11 10:29:33'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-04-09 10:35:59'
    - '2019-04-11 10:29:33'
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2665845.4571383507, 4575342.847929759), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2665845.4571383507, 4575342.847929759), 3857), 2054) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2665845.4571383507, 4575342.847929759), 3857)
  - 2054
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-11-10 07:45:37', '2019-11-17 21:40:39'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-11-10 07:45:37'
    - '2019-11-17 21:40:39'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 4554) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-10-19 23:06:21', '2019-10-28 11:54:41'] AND ['2019-10-19 23:06:21', '2019-10-28 11:54:41'] @> f.timestamp;
  params:
  - - '2019-10-19 23:06:21'
    - '2019-10-28 11:54:41'
  - ''
  - 4554
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-07-20 07:23:45', '2019-07-21 03:43:53'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-07-20 07:23:45', '2019-07-21 03:43:53'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-07-20 07:23:45'
    - '2019-07-21 03:43:53'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 2717) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-06-28 16:22:47', '2019-07-05 19:07:49'] AND ['2019-06-28 16:22:47', '2019-07-05 19:07:49'] @> f.timestamp;
  params:
  - - '2019-06-28 16:22:47'
    - '2019-07-05 19:07:49'
  - ''
  - 2717
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2606381.323383735, 4583783.751939068), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2606381.323383735, 4583783.751939068), 3857), 4316) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2606381.323383735, 4583783.751939068), 3857)
  - 4316
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-09-08 15:20:16', '2019-09-15 06:38:08'] @> f.timestamp;
  params:
  - - '2019-09-08 15:20:16'
    - '2019-09-15 06:38:08'
  - ''
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-10-08 14:08:31', '2019-10-10 08:42:39'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-10-08 14:08:31', '2019-10-10 08:42:39'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-10-08 14:08:31'
    - '2019-10-10 08:42:39'
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3736) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-09-13 02:51:59', '2019-09-24 07:12:03'] AND ['2019-09-13 02:51:59', '2019-09-24 07:12:03'] @> f.timestamp;
  params:
  - - '2019-09-13 02:51:59'
    - '2019-09-24 07:12:03'
  - ''
  - 3736
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 2971) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-08-13 21:06:03', '2019-08-28 11:03:04'] AND ['2019-08-13 21:06:03', '2019-08-28 11:03:04'] @> f.timestamp;
  params:
  - - '2019-08-13 21:06:03'
    - '2019-08-28 11:03:04'
  - ''
  - 2971
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-12-13 08:39:50', '2019-12-13 22:30:41'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-12-13 08:39:50', '2019-12-13 22:30:41'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-12-13 08:39:50'
    - '2019-12-13 22:30:41'
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-12-10 23:15:52', '2019-12-11 20:27:19'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-12-10 23:15:52', '2019-12-11 20:27:19'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-12-10 23:15:52'
    - '2019-12-11 20:27:19'
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-11-25 10:49:10', '2019-12-08 04:28:44'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-11-25 10:49:10'
    - '2019-12-08 04:28:44'
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-10-04 06:52:53', '2019-10-04 13:23:40'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-10-04 06:52:53', '2019-10-04 13:23:40'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-10-04 06:52:53'
    - '2019-10-04 13:23:40'
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2597991.9988026205, 4536999.028268662), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2597991.9988026205, 4536999.028268662), 3857), 2165) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2597991.9988026205, 4536999.028268662), 3857)
  - 2165
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-11-24 09:16:01', '2019-12-06 05:29:18'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-11-24 09:16:01'
    - '2019-12-06 05:29:18'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-06-16 07:56:33', '2019-06-28 04:56:00'] @> f.timestamp;
  params:
  - - '2019-06-16 07:56:33'
    - '2019-06-28 04:56:00'
  - ''
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1221) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-12-03 17:35:27', '2019-12-14 13:21:24'] AND ['2019-12-03 17:35:27', '2019-12-14 13:21:24'] @> f.timestamp;
  params:
  - - '2019-12-03 17:35:27'
    - '2019-12-14 13:21:24'
  - ''
  - 1221
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1001) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-11-18 03:59:55', '2019-11-24 07:43:31'] AND ['2019-11-18 03:59:55', '2019-11-24 07:43:31'] @> f.timestamp;
  params:
  - - '2019-11-18 03:59:55'
    - '2019-11-24 07:43:31'
  - ''
  - 1001
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2566056.6292391606, 4558838.15122864), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2566056.6292391606, 4558838.15122864), 3857), 2183) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2566056.6292391606, 4558838.15122864), 3857)
  - 2183
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 2260) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-07-16 16:29:01', '2019-07-25 07:31:10'] AND ['2019-07-16 16:29:01', '2019-07-25 07:31:10'] @> f.timestamp;
  params:
  - - '2019-07-16 16:29:01'
    - '2019-07-25 07:31:10'
  - ''
  - 2260
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2670800.1678677564, 4529449.901033741), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2670800.1678677564, 4529449.901033741), 3857), 1055) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2670800.1678677564, 4529449.901033741), 3857)
  - 1055
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-09-06 04:32:15', '2019-09-08 02:46:59'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-09-06 04:32:15', '2019-09-08 02:46:59'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-09-06 04:32:15'
    - '2019-09-08 02:46:59'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-10-19 07:40:53', '2019-10-30 05:59:32'] @> f.timestamp;
  params:
  - - '2019-10-19 07:40:53'
    - '2019-10-30 05:59:32'
  - ''
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2671229.0889503616, 4559592.432395864), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2671229.0889503616, 4559592.432395864), 3857), 1660) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2671229.0889503616, 4559592.432395864), 3857)
  - 1660
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3837) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-05-25 05:49:10', '2019-06-08 00:49:22'] AND ['2019-05-25 05:49:10', '2019-06-08 00:49:22'] @> f.timestamp;
  params:
  - - '2019-05-25 05:49:10'
    - '2019-06-08 00:49:22'
  - ''
  - 3837
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-12-20 00:57:58', '2019-12-24 12:43:59'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-12-20 00:57:58'
    - '2019-12-24 12:43:59'
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-08-18 15:49:33', '2019-08-31 11:55:57'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-08-18 15:49:33'
    - '2019-08-31 11:55:57'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-06-06 20:38:43', '2019-06-09 01:58:02'] @> f.timestamp;
  params:
  - - '2019-06-06 20:38:43'
    - '2019-06-09 01:58:02'
  - ''
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-12-06 21:22:13', '2019-12-18 13:51:50'] @> f.timestamp;
  params:
  - - '2019-12-06 21:22:13'
    - '2019-12-18 13:51:50'
  - ''
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 4153) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-07-19 08:22:01', '2019-07-30 04:48:36'] AND ['2019-07-19 08:22:01', '2019-07-30 04:48:36'] @> f.timestamp;
  params:
  - - '2019-07-19 08:22:01'
    - '2019-07-30 04:48:36'
  - ''
  - 4153
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 2073) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-05-29 16:30:38', '2019-06-12 10:30:45'] AND ['2019-05-29 16:30:38', '2019-06-12 10:30:45'] @> f.timestamp;
  params:
  - - '2019-05-29 16:30:38'
    - '2019-06-12 10:30:45'
  - ''
  - 2073
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2645862.513935988, 4552883.7545746025), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2645862.513935988, 4552883.7545746025), 3857), 1495) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2645862.513935988, 4552883.7545746025), 3857)
  - 1495
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2667723.7582264477, 4508736.374826804), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2667723.7582264477, 4508736.374826804), 3857), 4703) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2667723.7582264477, 4508736.374826804), 3857)
  - 4703
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-03-06 06:03:26', '2019-03-19 07:27:50'] @> f.timestamp;
  params:
  - - '2019-03-06 06:03:26'
    - '2019-03-19 07:27:50'
  - ''
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-04-01 18:47:38', '2019-04-03 15:39:29'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-04-01 18:47:38', '2019-04-03 15:39:29'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-04-01 18:47:38'
    - '2019-04-03 15:39:29'
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2655437.6280861264, 4540730.155429466), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2655437.6280861264, 4540730.155429466), 3857), 1442) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2655437.6280861264, 4540730.155429466), 3857)
  - 1442
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-01-18 14:56:29', '2019-01-22 05:19:20'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-01-18 14:56:29'
    - '2019-01-22 05:19:20'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3971) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-01-11 23:46:55', '2019-01-16 13:00:05'] AND ['2019-01-11 23:46:55', '2019-01-16 13:00:05'] @> f.timestamp;
  params:
  - - '2019-01-11 23:46:55'
    - '2019-01-16 13:00:05'
  - ''
  - 3971
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-06-05 01:23:33', '2019-06-05 16:58:30'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-06-05 01:23:33', '2019-06-05 16:58:30'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-06-05 01:23:33'
    - '2019-06-05 16:58:30'
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-11-05 23:38:01', '2019-11-07 00:08:17'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-11-05 23:38:01', '2019-11-07 00:08:17'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-11-05 23:38:01'
    - '2019-11-07 00:08:17'
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-07-28 05:36:12', '2019-07-28 09:38:19'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-07-28 05:36:12', '2019-07-28 09:38:19'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-07-28 05:36:12'
    - '2019-07-28 09:38:19'
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2585223.5044295145, 4565791.748232737), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2585223.5044295145, 4565791.748232737), 3857), 1459) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2585223.5044295145, 4565791.748232737), 3857)
  - 1459
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3314) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-07-28 04:51:02', '2019-08-06 08:06:34'] AND ['2019-07-28 04:51:02', '2019-08-06 08:06:34'] @> f.timestamp;
  params:
  - - '2019-07-28 04:51:02'
    - '2019-08-06 08:06:34'
  - ''
  - 3314
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2573261.331148348, 4530372.501502202), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2573261.331148348, 4530372.501502202), 3857), 1504) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2573261.331148348, 4530372.501502202), 3857)
  - 1504
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-05-09 07:32:15', '2019-05-09 10:40:21'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-05-09 07:32:15', '2019-05-09 10:40:21'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-05-09 07:32:15'
    - '2019-05-09 10:40:21'
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-05-23 16:23:29', '2019-05-28 10:41:50'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-05-23 16:23:29'
    - '2019-05-28 10:41:50'
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-01-28 11:53:17', '2019-02-05 21:22:18'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-01-28 11:53:17'
    - '2019-02-05 21:22:18'
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2663414.178839663, 4534966.2500259625), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2663414.178839663, 4534966.2500259625), 3857), 4793) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2663414.178839663, 4534966.2500259625), 3857)
  - 4793
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 4548) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-01-20 00:17:07', '2019-02-03 21:08:46'] AND ['2019-01-20 00:17:07', '2019-02-03 21:08:46'] @> f.timestamp;
  params:
  - - '2019-01-20 00:17:07'
    - '2019-02-03 21:08:46'
  - ''
  - 4548
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2604409.4694736563, 4559252.476370547), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2604409.4694736563, 4559252.476370547), 3857), 2001) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2604409.4694736563, 4559252.476370547), 3857)
  - 2001
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2623828.4307582458, 4546866.1851845095), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2623828.4307582458, 4546866.1851845095), 3857), 1934) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2623828.4307582458, 4546866.1851845095), 3857)
  - 1934
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-03-16 13:11:50', '2019-03-24 10:22:11'] @> f.timestamp;
  params:
  - - '2019-03-16 13:11:50'
    - '2019-03-24 10:22:11'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-09-07 22:17:39', '2019-09-12 10:23:06'] @> f.timestamp;
  params:
  - - '2019-09-07 22:17:39'
    - '2019-09-12 10:23:06'
  - ''
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-04-30 07:39:40', '2019-05-01 12:05:19'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-04-30 07:39:40', '2019-05-01 12:05:19'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-04-30 07:39:40'
    - '2019-05-01 12:05:19'
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2673486.4131234433, 4562009.814615793), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2673486.4131234433, 4562009.814615793), 3857), 4805) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2673486.4131234433, 4562009.814615793), 3857)
  - 4805
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 2203) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-11-13 20:34:24', '2019-11-16 10:10:27'] AND ['2019-11-13 20:34:24', '2019-11-16 10:10:27'] @> f.timestamp;
  params:
  - - '2019-11-13 20:34:24'
    - '2019-11-16 10:10:27'
  - ''
  - 2203
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3981) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-06-20 12:21:00', '2019-06-27 00:07:44'] AND ['2019-06-20 12:21:00', '2019-06-27 00:07:44'] @> f.timestamp;
  params:
  - - '2019-06-20 12:21:00'
    - '2019-06-27 00:07:44'
  - ''
  - 3981
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2628890.964120979, 4577188.61449356), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2628890.964120979, 4577188.61449356), 3857), 3141) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2628890.964120979, 4577188.61449356), 3857)
  - 3141
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-09-13 23:47:14', '2019-09-15 17:47:16'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-09-13 23:47:14', '2019-09-15 17:47:16'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-09-13 23:47:14'
    - '2019-09-15 17:47:16'
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-02-18 17:13:24', '2019-02-25 20:36:55'] @> f.timestamp;
  params:
  - - '2019-02-18 17:13:24'
    - '2019-02-25 20:36:55'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-11-23 19:19:31', '2019-11-29 17:32:26'] @> f.timestamp;
  params:
  - - '2019-11-23 19:19:31'
    - '2019-11-29 17:32:26'
  - ''
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-09-19 03:27:35', '2019-09-22 13:45:15'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-09-19 03:27:35'
    - '2019-09-22 13:45:15'
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-08-21 16:10:34', '2019-08-22 06:47:58'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-08-21 16:10:34', '2019-08-22 06:47:58'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-08-21 16:10:34'
    - '2019-08-22 06:47:58'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3444) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-05-30 19:59:32', '2019-06-06 16:49:44'] AND ['2019-05-30 19:59:32', '2019-06-06 16:49:44'] @> f.timestamp;
  params:
  - - '2019-05-30 19:59:32'
    - '2019-06-06 16:49:44'
  - ''
  - 3444
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-06-28 03:06:07', '2019-06-29 22:22:51'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-06-28 03:06:07', '2019-06-29 22:22:51'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-06-28 03:06:07'
    - '2019-06-29 22:22:51'
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-03-16 16:01:14', '2019-03-22 09:49:14'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-03-16 16:01:14'
    - '2019-03-22 09:49:14'
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-05-13 05:29:04', '2019-05-13 23:18:52'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-05-13 05:29:04', '2019-05-13 23:18:52'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-05-13 05:29:04'
    - '2019-05-13 23:18:52'
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2593031.5737145767, 4508943.717946934), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2593031.5737145767, 4508943.717946934), 3857), 1720) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2593031.5737145767, 4508943.717946934), 3857)
  - 1720
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2637806.7101102984, 4583134.7232121825), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2637806.7101102984, 4583134.7232121825), 3857), 2981) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2637806.7101102984, 4583134.7232121825), 3857)
  - 2981
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-08-31 22:40:45', '2019-09-01 14:30:26'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-08-31 22:40:45', '2019-09-01 14:30:26'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-08-31 22:40:45'
    - '2019-09-01 14:30:26'
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-05-06 09:20:03', '2019-05-14 07:09:27'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-05-06 09:20:03'
    - '2019-05-14 07:09:27'
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-01-31 21:53:27', '2019-02-07 16:33:46'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-01-31 21:53:27'
    - '2019-02-07 16:33:46'
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-09-01 13:44:15', '2019-09-02 10:01:08'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-09-01 13:44:15', '2019-09-02 10:01:08'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-09-01 13:44:15'
    - '2019-09-02 10:01:08'
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-08-02 16:10:49', '2019-08-10 16:59:11'] @> f.timestamp;
  params:
  - - '2019-08-02 16:10:49'
    - '2019-08-10 16:59:11'
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-08-03 00:47:10', '2019-08-07 20:30:13'] @> f.timestamp;
  params:
  - - '2019-08-03 00:47:10'
    - '2019-08-07 20:30:13'
  - ''
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-06-21 04:07:45', '2019-06-25 11:11:23'] @> f.timestamp;
  params:
  - - '2019-06-21 04:07:45'
    - '2019-06-25 11:11:23'
  - ''
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2572781.4521896606, 4547991.556768756), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2572781.4521896606, 4547991.556768756), 3857), 2375) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2572781.4521896606, 4547991.556768756), 3857)
  - 2375
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-08-13 03:22:57', '2019-08-14 14:42:33'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-08-13 03:22:57', '2019-08-14 14:42:33'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-08-13 03:22:57'
    - '2019-08-14 14:42:33'
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-10-28 11:01:11', '2019-11-11 03:16:27'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-10-28 11:01:11'
    - '2019-11-11 03:16:27'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-06-06 23:50:49', '2019-06-21 16:26:06'] @> f.timestamp;
  params:
  - - '2019-06-06 23:50:49'
    - '2019-06-21 16:26:06'
  - ''
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-03-17 12:44:14', '2019-03-18 11:21:23'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-03-17 12:44:14', '2019-03-18 11:21:23'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-03-17 12:44:14'
    - '2019-03-18 11:21:23'
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-03-10 13:14:34', '2019-03-12 02:31:28'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-03-10 13:14:34', '2019-03-12 02:31:28'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-03-10 13:14:34'
    - '2019-03-12 02:31:28'
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3026) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-05-15 05:43:06', '2019-05-17 07:46:46'] AND ['2019-05-15 05:43:06', '2019-05-17 07:46:46'] @> f.timestamp;
  params:
  - - '2019-05-15 05:43:06'
    - '2019-05-17 07:46:46'
  - ''
  - 3026
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 1244) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-02-26 13:12:43', '2019-03-06 02:02:48'] AND ['2019-02-26 13:12:43', '2019-03-06 02:02:48'] @> f.timestamp;
  params:
  - - '2019-02-26 13:12:43'
    - '2019-03-06 02:02:48'
  - ''
  - 1244
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 2285) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-01-21 07:14:29', '2019-01-28 05:03:22'] AND ['2019-01-21 07:14:29', '2019-01-28 05:03:22'] @> f.timestamp;
  params:
  - - '2019-01-21 07:14:29'
    - '2019-01-28 05:03:22'
  - ''
  - 2285
- name: inCityRadiusInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM (SELECT name, geom FROM cities WHERE name = '') AS c JOIN flight_points AS f ON ST_DWithin(f.geom, c.geom, 3444) JOIN flight_trajectories ft ON ft.flightid = f.flightid WHERE (ft.start_time, ft.end_time) OVERLAPS ['2019-09-17 22:44:22', '2019-09-20 06:43:42'] AND ['2019-09-17 22:44:22', '2019-09-20 06:43:42'] @> f.timestamp;
  params:
  - - '2019-09-17 22:44:22'
    - '2019-09-20 06:43:42'
  - ''
  - 3444
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-03-13 01:40:47', '2019-03-27 04:24:19'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-03-13 01:40:47'
    - '2019-03-27 04:24:19'
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-09-03 05:41:17', '2019-09-10 12:43:11'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-09-03 05:41:17'
    - '2019-09-10 12:43:11'
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-12-12 10:53:30', '2019-12-13 11:32:48'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-12-12 10:53:30', '2019-12-13 11:32:48'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-12-12 10:53:30'
    - '2019-12-13 11:32:48'
- name: countFlightsInCounties
  type: spatial
  sql: |
    SELECT k.name, COUNT(DISTINCT f.flightid) as flight_count FROM counties k JOIN flight_points f ON ST_Intersects(f.geom, k.geom) WHERE k.name = '' GROUP BY k.name;
  params:
  - ''
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-08-29 01:14:23', '2019-09-04 07:59:55'] @> f.timestamp;
  params:
  - - '2019-08-29 01:14:23'
    - '2019-09-04 07:59:55'
  - ''
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-03-21 05:22:51', '2019-03-29 21:02:38'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-03-21 05:22:51'
    - '2019-03-29 21:02:38'
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-11-12 17:02:06', '2019-11-19 14:51:57'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-11-12 17:02:06'
    - '2019-11-19 14:51:57'
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2585431.6564845573, 4572036.377849285), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2585431.6564845573, 4572036.377849285), 3857), 1495) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2585431.6564845573, 4572036.377849285), 3857)
  - 1495
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-02-10 04:21:48', '2019-02-22 14:03:34'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-02-10 04:21:48'
    - '2019-02-22 14:03:34'
- name: flightClosestToPoint
  type: spatial
  sql: |
    SELECT f.flightid, f.airplaneType, f.origin, f.destination, ST_Distance(f.geom, ST_SetSRID(ST_Point(2585615.217298465, 4582447.724034113), 3857)) AS min_distance FROM flight_points f WHERE ST_DWithin(f.geom, ST_SetSRID(ST_Point(2585615.217298465, 4582447.724034113), 3857), 3951) ORDER BY min_distance ASC LIMIT 1;
  params:
  - ST_SetSRID(ST_Point(2585615.217298465, 4582447.724034113), 3857)
  - 3951
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-07-01 22:57:07', '2019-07-11 20:53:45'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-07-01 22:57:07'
    - '2019-07-11 20:53:45'
- name: flightsInCountyInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT f.flightid FROM flight_points f, counties k WHERE k.name = '' AND f.geom && k.geom AND ['2019-02-26 17:23:15', '2019-03-12 11:07:28'] @> f.timestamp;
  params:
  - - '2019-02-26 17:23:15'
    - '2019-03-12 11:07:28'
  - ''
- name: FlightUpdatesInPeriod
  type: temporal
  sql: |
    SELECT f.flightid, COUNT(*) FROM flight_points f WHERE ['2019-03-19 04:23:58', '2019-03-30 20:16:10'] @> f.timestamp GROUP BY f.flightid;
  params:
  - - '2019-03-19 04:23:58'
    - '2019-03-30 20:16:10'
- name: airportUtilizationInPeriod
  type: temporal
  sql: |
    WITH departures AS ( SELECT f.origin AS airport, COUNT(DISTINCT f.flightid) AS departure_count FROM flight_trajectories f WHERE ['2019-01-12 22:22:13', '2019-01-13 18:54:12'] @> f.start_time::timestamp GROUP BY f.origin ), arrivals AS (SELECT f.destination AS airport, COUNT(DISTINCT f.flightid) AS arrival_count FROM flight_trajectories f WHERE ['2019-01-12 22:22:13', '2019-01-13 18:54:12'] @> f.end_time::timestamp GROUP BY f.destination) SELECT COALESCE(d.airport, a.airport) AS airport, COALESCE(d.departure_count, 0) AS departures, COALESCE(a.arrival_count, 0) AS arrivals,      COALESCE(d.departure_count, 0) + COALESCE(a.arrival_count, 0) AS traffic_count    FROM departures d FULL JOIN arrivals a ON d.airport = a.airport;
  params:
  - - '2019-01-12 22:22:13'
    - '2019-01-13 18:54:12'
