- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2022-09-23' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2022-09-23');
  params:
  - '2022-09-23'
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2020-11-03 19:52:25' AND TIMESTAMP '2020-11-16 08:47:03'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2020-11-03 19:52:25'
    - '2020-11-16 08:47:03'
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2021-04-22 12:12:33' AND TIMESTAMP '2021-05-04 04:04:45'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2021-04-22 12:12:33'
    - '2021-05-04 04:04:45'
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2021-03-16 14:10:18' AND TIMESTAMP '2021-03-25 05:50:05'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2021-03-16 14:10:18'
    - '2021-03-25 05:50:05'
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Reinickendorf' GROUP BY d.name;
  params:
  - Reinickendorf
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2024-09-09 14:44:35' AND TIMESTAMP '2024-09-13 05:33:00'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2024-09-09 14:44:35'
    - '2024-09-13 05:33:00'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2023-08-08' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2023-08-08');
  params:
  - '2023-08-08'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2021-01-18' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2021-01-18');
  params:
  - '2021-01-18'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2021-06-16' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2021-06-16');
  params:
  - '2021-06-16'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 615)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2020-12-24 23:26:50' AND TIMESTAMP '2021-01-01 05:57:10'
      AND u.name = 'Bard-College';
  params:
  - - '2020-12-24 23:26:50'
    - '2021-01-01 05:57:10'
  - Bard-College
  - 615
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2024-07-02 14:13:43' AND TIMESTAMP '2024-07-11 00:19:00'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2024-07-02 14:13:43'
    - '2024-07-11 00:19:00'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2025-01-17' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2025-01-17');
  params:
  - '2025-01-17'
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2020-06-28 09:03:38' AND TIMESTAMP '2020-07-06 18:32:38'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2020-06-28 09:03:38'
    - '2020-07-06 18:32:38'
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 229)
    WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - Technische-Universität-Berlin
  - 229
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 159)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2023-07-18 23:17:03' AND TIMESTAMP '2023-07-23 17:34:55'
      AND u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2023-07-18 23:17:03'
    - '2023-07-23 17:34:55'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
  - 159
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2021-12-17' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2021-12-17');
  params:
  - '2021-12-17'
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Reinickendorf' GROUP BY d.name;
  params:
  - Reinickendorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2020-12-04' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2020-12-04');
  params:
  - '2020-12-04'
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Pankow' GROUP BY d.name;
  params:
  - Pankow
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2022-12-27 21:13:40' AND TIMESTAMP '2023-01-06 00:29:12'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2022-12-27 21:13:40'
    - '2023-01-06 00:29:12'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 347)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2022-06-26 01:04:11' AND TIMESTAMP '2022-07-08 16:07:09'
      AND u.name = 'Bard-College';
  params:
  - - '2022-06-26 01:04:11'
    - '2022-07-08 16:07:09'
  - Bard-College
  - 347
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 762)
    WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - Charité-Campus-Klinik
  - 762
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2021-05-24' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2021-05-24');
  params:
  - '2021-05-24'
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 178)
    WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - Freie-Universität-Berlin
  - 178
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2020-12-31' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2020-12-31');
  params:
  - '2020-12-31'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2022-05-10' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2022-05-10');
  params:
  - '2022-05-10'
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2024-09-29 20:24:26' AND TIMESTAMP '2024-10-12 05:02:04'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2024-09-29 20:24:26'
    - '2024-10-12 05:02:04'
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2020-02-24 18:27:19' AND TIMESTAMP '2020-03-02 09:20:30'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2020-02-24 18:27:19'
    - '2020-03-02 09:20:30'
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2023-06-05 16:52:13' AND TIMESTAMP '2023-06-11 10:29:31'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2023-06-05 16:52:13'
    - '2023-06-11 10:29:31'
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2023-12-15 21:46:34' AND TIMESTAMP '2023-12-27 20:20:07'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2023-12-15 21:46:34'
    - '2023-12-27 20:20:07'
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2022-12-03 06:14:36' AND TIMESTAMP '2022-12-13 22:49:19'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2022-12-03 06:14:36'
    - '2022-12-13 22:49:19'
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2024-01-18 04:34:36' AND TIMESTAMP '2024-01-23 06:03:01'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2024-01-18 04:34:36'
    - '2024-01-23 06:03:01'
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2023-01-14 21:11:09' AND TIMESTAMP '2023-01-16 23:48:44'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2023-01-14 21:11:09'
    - '2023-01-16 23:48:44'
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2022-02-19 07:44:59' AND TIMESTAMP '2022-02-24 02:03:19'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2022-02-19 07:44:59'
    - '2022-02-24 02:03:19'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2023-11-27' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2023-11-27');
  params:
  - '2023-11-27'
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2021-09-07 05:48:09' AND TIMESTAMP '2021-09-14 23:28:05'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2021-09-07 05:48:09'
    - '2021-09-14 23:28:05'
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 160)
    WHERE u.name = 'Bard-College';
  params:
  - Bard-College
  - 160
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg' GROUP BY d.name;
  params:
  - Friedrichshain-Kreuzberg
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2021-01-13' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2021-01-13');
  params:
  - '2021-01-13'
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2024-06-11 05:29:05' AND TIMESTAMP '2024-06-18 18:36:53'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2024-06-11 05:29:05'
    - '2024-06-18 18:36:53'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 908)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2022-01-26 03:09:21' AND TIMESTAMP '2022-01-29 02:39:05'
      AND u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2022-01-26 03:09:21'
    - '2022-01-29 02:39:05'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
  - 908
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg' GROUP BY d.name;
  params:
  - Tempelhof-Schöneberg
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 886)
    WHERE u.name = 'Bard-College';
  params:
  - Bard-College
  - 886
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf' GROUP BY d.name;
  params:
  - Marzahn-Hellersdorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2023-08-26' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2023-08-26');
  params:
  - '2023-08-26'
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg' GROUP BY d.name;
  params:
  - Tempelhof-Schöneberg
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Mitte' GROUP BY d.name;
  params:
  - Mitte
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2024-04-17 15:59:58' AND TIMESTAMP '2024-04-28 05:08:48'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2024-04-17 15:59:58'
    - '2024-04-28 05:08:48'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2022-08-25' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2022-08-25');
  params:
  - '2022-08-25'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2021-12-26' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2021-12-26');
  params:
  - '2021-12-26'
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 537)
    WHERE u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - European-School-of-Management-and-Technology-Berlin
  - 537
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 411)
    WHERE u.name = 'Bard-College';
  params:
  - Bard-College
  - 411
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Neukölln' GROUP BY d.name;
  params:
  - Neukölln
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 150)
    WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - Technische-Universität-Berlin
  - 150
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2020-11-22 23:23:25' AND TIMESTAMP '2020-12-06 17:07:39'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2020-11-22 23:23:25'
    - '2020-12-06 17:07:39'
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 526)
    WHERE u.name = 'Bard-College';
  params:
  - Bard-College
  - 526
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 747)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2021-01-06 15:31:16' AND TIMESTAMP '2021-01-11 01:50:22'
      AND u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2021-01-06 15:31:16'
    - '2021-01-11 01:50:22'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
  - 747
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 265)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2025-01-24 12:29:27' AND TIMESTAMP '2025-01-27 21:00:47'
      AND u.name = 'Charité-Campus-Klinik';
  params:
  - - '2025-01-24 12:29:27'
    - '2025-01-27 21:00:47'
  - Charité-Campus-Klinik
  - 265
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 881)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2022-11-15 07:13:17' AND TIMESTAMP '2022-11-24 07:25:11'
      AND u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - - '2022-11-15 07:13:17'
    - '2022-11-24 07:25:11'
  - European-School-of-Management-and-Technology-Berlin
  - 881
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Pankow' GROUP BY d.name;
  params:
  - Pankow
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2020-03-30 10:40:05' AND TIMESTAMP '2020-04-14 08:49:49'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2020-03-30 10:40:05'
    - '2020-04-14 08:49:49'
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2021-04-01 02:24:44' AND TIMESTAMP '2021-04-04 15:18:15'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2021-04-01 02:24:44'
    - '2021-04-04 15:18:15'
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2024-10-20 23:21:00' AND TIMESTAMP '2024-11-02 07:33:15'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2024-10-20 23:21:00'
    - '2024-11-02 07:33:15'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 879)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2020-06-20 00:02:56' AND TIMESTAMP '2020-07-01 02:26:49'
      AND u.name = 'Freie-Universität-Berlin';
  params:
  - - '2020-06-20 00:02:56'
    - '2020-07-01 02:26:49'
  - Freie-Universität-Berlin
  - 879
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2020-02-19' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2020-02-19');
  params:
  - '2020-02-19'
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf' GROUP BY d.name;
  params:
  - Marzahn-Hellersdorf
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 739)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2023-05-16 22:17:33' AND TIMESTAMP '2023-05-31 13:54:35'
      AND u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2023-05-16 22:17:33'
    - '2023-05-31 13:54:35'
  - Universität-der-Künste-Berlin
  - 739
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 364)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2020-12-18 16:40:47' AND TIMESTAMP '2020-12-25 20:43:25'
      AND u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2020-12-18 16:40:47'
    - '2020-12-25 20:43:25'
  - Universität-der-Künste-Berlin
  - 364
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Neukölln' GROUP BY d.name;
  params:
  - Neukölln
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2021-01-31 22:36:42' AND TIMESTAMP '2021-02-09 21:20:41'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2021-01-31 22:36:42'
    - '2021-02-09 21:20:41'
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Spandau' GROUP BY d.name;
  params:
  - Spandau
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 983)
    WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - Freie-Universität-Berlin
  - 983
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 966)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2022-09-22 15:25:15' AND TIMESTAMP '2022-09-25 02:41:15'
      AND u.name = 'Charité-Campus-Klinik';
  params:
  - - '2022-09-22 15:25:15'
    - '2022-09-25 02:41:15'
  - Charité-Campus-Klinik
  - 966
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 466)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2024-04-07 23:32:00' AND TIMESTAMP '2024-04-16 00:34:47'
      AND u.name = 'Technische-Universität-Berlin';
  params:
  - - '2024-04-07 23:32:00'
    - '2024-04-16 00:34:47'
  - Technische-Universität-Berlin
  - 466
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Lichtenberg' GROUP BY d.name;
  params:
  - Lichtenberg
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 158)
    WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - Universität-der-Künste-Berlin
  - 158
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2021-01-11 13:01:53' AND TIMESTAMP '2021-01-24 22:24:07'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2021-01-11 13:01:53'
    - '2021-01-24 22:24:07'
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2020-07-15 15:08:46' AND TIMESTAMP '2020-07-22 09:49:05'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2020-07-15 15:08:46'
    - '2020-07-22 09:49:05'
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 134)
    WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - Freie-Universität-Berlin
  - 134
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2022-10-25' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2022-10-25');
  params:
  - '2022-10-25'
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2021-12-15 23:26:41' AND TIMESTAMP '2021-12-18 04:40:09'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2021-12-15 23:26:41'
    - '2021-12-18 04:40:09'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2022-09-13' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2022-09-13');
  params:
  - '2022-09-13'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2020-08-21' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2020-08-21');
  params:
  - '2020-08-21'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 437)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2020-04-28 04:52:50' AND TIMESTAMP '2020-05-11 18:33:41'
      AND u.name = 'Bard-College';
  params:
  - - '2020-04-28 04:52:50'
    - '2020-05-11 18:33:41'
  - Bard-College
  - 437
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 103)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2020-07-23 23:01:15' AND TIMESTAMP '2020-07-30 10:01:26'
      AND u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - - '2020-07-23 23:01:15'
    - '2020-07-30 10:01:26'
  - European-School-of-Management-and-Technology-Berlin
  - 103
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 419)
    WHERE u.name = 'Bard-College';
  params:
  - Bard-College
  - 419
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 842)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2021-08-10 12:27:43' AND TIMESTAMP '2021-08-22 06:17:49'
      AND u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2021-08-10 12:27:43'
    - '2021-08-22 06:17:49'
  - Humboldt-Universität-zu-Berlin
  - 842
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg' GROUP BY d.name;
  params:
  - Friedrichshain-Kreuzberg
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2021-06-01 18:21:46' AND TIMESTAMP '2021-06-09 14:59:41'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2021-06-01 18:21:46'
    - '2021-06-09 14:59:41'
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2023-12-13 14:08:05' AND TIMESTAMP '2023-12-27 17:09:46'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2023-12-13 14:08:05'
    - '2023-12-27 17:09:46'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 619)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2023-05-17 20:22:10' AND TIMESTAMP '2023-05-27 23:34:45'
      AND u.name = 'Freie-Universität-Berlin';
  params:
  - - '2023-05-17 20:22:10'
    - '2023-05-27 23:34:45'
  - Freie-Universität-Berlin
  - 619
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2022-06-09' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2022-06-09');
  params:
  - '2022-06-09'
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2023-10-07 20:56:13' AND TIMESTAMP '2023-10-14 23:38:40'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2023-10-07 20:56:13'
    - '2023-10-14 23:38:40'
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 697)
    WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - Technische-Universität-Berlin
  - 697
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2024-09-10 18:52:04' AND TIMESTAMP '2024-09-16 17:04:58'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2024-09-10 18:52:04'
    - '2024-09-16 17:04:58'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2022-12-01' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2022-12-01');
  params:
  - '2022-12-01'
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Mitte' GROUP BY d.name;
  params:
  - Mitte
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2022-10-25' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2022-10-25');
  params:
  - '2022-10-25'
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg' GROUP BY d.name;
  params:
  - Friedrichshain-Kreuzberg
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2022-06-24' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2022-06-24');
  params:
  - '2022-06-24'
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2021-03-16 19:58:55' AND TIMESTAMP '2021-03-22 13:46:55'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2021-03-16 19:58:55'
    - '2021-03-22 13:46:55'
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg' GROUP BY d.name;
  params:
  - Tempelhof-Schöneberg
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 126)
    WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - Freie-Universität-Berlin
  - 126
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 283)
    WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - Humboldt-Universität-zu-Berlin
  - 283
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 370)
    WHERE u.name = 'Bard-College';
  params:
  - Bard-College
  - 370
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Lichtenberg' GROUP BY d.name;
  params:
  - Lichtenberg
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 651)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2023-08-30 09:00:25' AND TIMESTAMP '2023-09-12 02:34:22'
      AND u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - - '2023-08-30 09:00:25'
    - '2023-09-12 02:34:22'
  - European-School-of-Management-and-Technology-Berlin
  - 651
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 385)
    WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - Universität-der-Künste-Berlin
  - 385
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2021-05-31 12:43:46' AND TIMESTAMP '2021-06-14 08:14:46'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2021-05-31 12:43:46'
    - '2021-06-14 08:14:46'
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 503)
    WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - Universität-der-Künste-Berlin
  - 503
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 336)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2022-09-04 22:53:08' AND TIMESTAMP '2022-09-07 09:06:13'
      AND u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - - '2022-09-04 22:53:08'
    - '2022-09-07 09:06:13'
  - European-School-of-Management-and-Technology-Berlin
  - 336
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 463)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2021-09-12 17:00:45' AND TIMESTAMP '2021-09-22 08:15:17'
      AND u.name = 'Bard-College';
  params:
  - - '2021-09-12 17:00:45'
    - '2021-09-22 08:15:17'
  - Bard-College
  - 463
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2023-06-06' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2023-06-06');
  params:
  - '2023-06-06'
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 443)
    WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - Universität-der-Künste-Berlin
  - 443
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2022-08-26 23:15:05' AND TIMESTAMP '2022-09-07 01:25:16'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2022-08-26 23:15:05'
    - '2022-09-07 01:25:16'
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2023-11-04 10:15:13' AND TIMESTAMP '2023-11-18 05:59:28'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2023-11-04 10:15:13'
    - '2023-11-18 05:59:28'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 132)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2021-07-14 14:39:41' AND TIMESTAMP '2021-07-25 05:54:17'
      AND u.name = 'Technische-Universität-Berlin';
  params:
  - - '2021-07-14 14:39:41'
    - '2021-07-25 05:54:17'
  - Technische-Universität-Berlin
  - 132
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2020-12-09 08:33:49' AND TIMESTAMP '2020-12-20 19:43:37'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2020-12-09 08:33:49'
    - '2020-12-20 19:43:37'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 951)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2022-12-22 17:47:46' AND TIMESTAMP '2022-12-30 07:04:12'
      AND u.name = 'Charité-Campus-Klinik';
  params:
  - - '2022-12-22 17:47:46'
    - '2022-12-30 07:04:12'
  - Charité-Campus-Klinik
  - 951
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg' GROUP BY d.name;
  params:
  - Friedrichshain-Kreuzberg
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2021-03-20 03:47:43' AND TIMESTAMP '2021-03-31 17:28:05'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2021-03-20 03:47:43'
    - '2021-03-31 17:28:05'
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 768)
    WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - Technische-Universität-Berlin
  - 768
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Neukölln' GROUP BY d.name;
  params:
  - Neukölln
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2025-01-07 17:57:37' AND TIMESTAMP '2025-01-11 18:31:13'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2025-01-07 17:57:37'
    - '2025-01-11 18:31:13'
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2023-10-05 02:37:52' AND TIMESTAMP '2023-10-08 12:55:31'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2023-10-05 02:37:52'
    - '2023-10-08 12:55:31'
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 568)
    WHERE u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - European-School-of-Management-and-Technology-Berlin
  - 568
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2023-05-26 01:33:00' AND TIMESTAMP '2023-06-08 15:04:48'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2023-05-26 01:33:00'
    - '2023-06-08 15:04:48'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 110)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2022-03-21 09:19:41' AND TIMESTAMP '2022-03-24 18:51:15'
      AND u.name = 'Bard-College';
  params:
  - - '2022-03-21 09:19:41'
    - '2022-03-24 18:51:15'
  - Bard-College
  - 110
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2022-10-10' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2022-10-10');
  params:
  - '2022-10-10'
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 912)
    WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - Freie-Universität-Berlin
  - 912
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2021-06-26 07:53:55' AND TIMESTAMP '2021-07-06 06:29:41'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2021-06-26 07:53:55'
    - '2021-07-06 06:29:41'
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Spandau' GROUP BY d.name;
  params:
  - Spandau
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 141)
    WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - Universität-der-Künste-Berlin
  - 141
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 968)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2024-10-27 18:12:31' AND TIMESTAMP '2024-10-30 19:45:09'
      AND u.name = 'Freie-Universität-Berlin';
  params:
  - - '2024-10-27 18:12:31'
    - '2024-10-30 19:45:09'
  - Freie-Universität-Berlin
  - 968
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2022-07-03 00:05:52' AND TIMESTAMP '2022-07-09 10:01:01'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2022-07-03 00:05:52'
    - '2022-07-09 10:01:01'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 270)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2024-10-10 11:26:41' AND TIMESTAMP '2024-10-22 13:23:41'
      AND u.name = 'Technische-Universität-Berlin';
  params:
  - - '2024-10-10 11:26:41'
    - '2024-10-22 13:23:41'
  - Technische-Universität-Berlin
  - 270
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2023-11-27' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2023-11-27');
  params:
  - '2023-11-27'
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 629)
    WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - Freie-Universität-Berlin
  - 629
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2021-12-19 09:25:18' AND TIMESTAMP '2021-12-21 11:28:58'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2021-12-19 09:25:18'
    - '2021-12-21 11:28:58'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2024-10-13' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2024-10-13');
  params:
  - '2024-10-13'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 798)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2025-01-06 16:19:02' AND TIMESTAMP '2025-01-15 11:55:22'
      AND u.name = 'Freie-Universität-Berlin';
  params:
  - - '2025-01-06 16:19:02'
    - '2025-01-15 11:55:22'
  - Freie-Universität-Berlin
  - 798
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2021-07-05 04:45:10' AND TIMESTAMP '2021-07-19 11:25:13'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2021-07-05 04:45:10'
    - '2021-07-19 11:25:13'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 150)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2023-07-15 13:35:03' AND TIMESTAMP '2023-07-19 15:52:57'
      AND u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2023-07-15 13:35:03'
    - '2023-07-19 15:52:57'
  - Humboldt-Universität-zu-Berlin
  - 150
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 771)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2023-07-03 05:59:56' AND TIMESTAMP '2023-07-09 00:09:32'
      AND u.name = 'Charité-Campus-Klinik';
  params:
  - - '2023-07-03 05:59:56'
    - '2023-07-09 00:09:32'
  - Charité-Campus-Klinik
  - 771
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2024-10-26' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2024-10-26');
  params:
  - '2024-10-26'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2023-02-25' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2023-02-25');
  params:
  - '2023-02-25'
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg' GROUP BY d.name;
  params:
  - Tempelhof-Schöneberg
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Treptow-Köpenick' GROUP BY d.name;
  params:
  - Treptow-Köpenick
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 507)
    WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - Katholische-Hochschule-für-Sozialwesen-Berlin
  - 507
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Reinickendorf' GROUP BY d.name;
  params:
  - Reinickendorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2022-08-09' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2022-08-09');
  params:
  - '2022-08-09'
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2024-06-10 17:03:12' AND TIMESTAMP '2024-06-18 06:58:14'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2024-06-10 17:03:12'
    - '2024-06-18 06:58:14'
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2021-10-16 03:33:14' AND TIMESTAMP '2021-10-19 11:07:26'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2021-10-16 03:33:14'
    - '2021-10-19 11:07:26'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 635)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2023-03-19 14:18:27' AND TIMESTAMP '2023-04-01 04:03:25'
      AND u.name = 'Bard-College';
  params:
  - - '2023-03-19 14:18:27'
    - '2023-04-01 04:03:25'
  - Bard-College
  - 635
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2022-04-25 21:21:29' AND TIMESTAMP '2022-05-02 00:36:30'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2022-04-25 21:21:29'
    - '2022-05-02 00:36:30'
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2025-01-15 10:50:03' AND TIMESTAMP '2025-01-19 22:36:04'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2025-01-15 10:50:03'
    - '2025-01-19 22:36:04'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 328)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2024-03-20 10:09:49' AND TIMESTAMP '2024-03-26 15:10:57'
      AND u.name = 'Charité-Campus-Klinik';
  params:
  - - '2024-03-20 10:09:49'
    - '2024-03-26 15:10:57'
  - Charité-Campus-Klinik
  - 328
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 766)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2023-06-29 09:13:19' AND TIMESTAMP '2023-07-07 01:20:59'
      AND u.name = 'Freie-Universität-Berlin';
  params:
  - - '2023-06-29 09:13:19'
    - '2023-07-07 01:20:59'
  - Freie-Universität-Berlin
  - 766
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 491)
    WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - Katholische-Hochschule-für-Sozialwesen-Berlin
  - 491
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Reinickendorf' GROUP BY d.name;
  params:
  - Reinickendorf
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 421)
    WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - Freie-Universität-Berlin
  - 421
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2023-02-26 01:11:45' AND TIMESTAMP '2023-03-06 02:00:07'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2023-02-26 01:11:45'
    - '2023-03-06 02:00:07'
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 115)
    WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - Humboldt-Universität-zu-Berlin
  - 115
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2021-06-22' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2021-06-22');
  params:
  - '2021-06-22'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2022-10-01' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2022-10-01');
  params:
  - '2022-10-01'
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 735)
    WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - Freie-Universität-Berlin
  - 735
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2024-02-20 14:26:14' AND TIMESTAMP '2024-03-02 12:44:52'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2024-02-20 14:26:14'
    - '2024-03-02 12:44:52'
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Lichtenberg' GROUP BY d.name;
  params:
  - Lichtenberg
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 160)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2024-01-23 13:54:18' AND TIMESTAMP '2024-02-04 15:57:00'
      AND u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2024-01-23 13:54:18'
    - '2024-02-04 15:57:00'
  - Universität-der-Künste-Berlin
  - 160
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 119)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2022-11-02 21:07:41' AND TIMESTAMP '2022-11-09 05:56:06'
      AND u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - - '2022-11-02 21:07:41'
    - '2022-11-09 05:56:06'
  - European-School-of-Management-and-Technology-Berlin
  - 119
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2020-08-13 08:25:29' AND TIMESTAMP '2020-08-24 18:06:20'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2020-08-13 08:25:29'
    - '2020-08-24 18:06:20'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 819)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2024-11-30 04:04:33' AND TIMESTAMP '2024-12-04 06:20:15'
      AND u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2024-11-30 04:04:33'
    - '2024-12-04 06:20:15'
  - Universität-der-Künste-Berlin
  - 819
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2021-04-12' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2021-04-12');
  params:
  - '2021-04-12'
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2024-05-29 04:05:01' AND TIMESTAMP '2024-05-31 16:18:36'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2024-05-29 04:05:01'
    - '2024-05-31 16:18:36'
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Neukölln' GROUP BY d.name;
  params:
  - Neukölln
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 684)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2021-08-31 14:07:31' AND TIMESTAMP '2021-09-08 00:38:42'
      AND u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - - '2021-08-31 14:07:31'
    - '2021-09-08 00:38:42'
  - European-School-of-Management-and-Technology-Berlin
  - 684
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2023-01-10 13:12:29' AND TIMESTAMP '2023-01-22 22:31:43'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2023-01-10 13:12:29'
    - '2023-01-22 22:31:43'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2022-04-07' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2022-04-07');
  params:
  - '2022-04-07'
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2020-05-24 02:22:25' AND TIMESTAMP '2020-05-27 16:45:16'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2020-05-24 02:22:25'
    - '2020-05-27 16:45:16'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 907)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2023-06-19 07:33:00' AND TIMESTAMP '2023-07-03 19:04:39'
      AND u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2023-06-19 07:33:00'
    - '2023-07-03 19:04:39'
  - Humboldt-Universität-zu-Berlin
  - 907
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 674)
    WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - Universität-der-Künste-Berlin
  - 674
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 328)
    WHERE u.name = 'Bard-College';
  params:
  - Bard-College
  - 328
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2024-03-27' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2024-03-27');
  params:
  - '2024-03-27'
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 679)
    WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - Universität-der-Künste-Berlin
  - 679
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2021-02-20 23:40:57' AND TIMESTAMP '2021-02-28 20:51:18'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2021-02-20 23:40:57'
    - '2021-02-28 20:51:18'
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 460)
    WHERE u.name = 'Bard-College';
  params:
  - Bard-College
  - 460
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2024-09-03 09:05:05' AND TIMESTAMP '2024-09-07 20:00:22'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2024-09-03 09:05:05'
    - '2024-09-07 20:00:22'
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2021-04-01 13:40:13' AND TIMESTAMP '2021-04-15 16:23:45'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2021-04-01 13:40:13'
    - '2021-04-15 16:23:45'
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2023-08-13 19:54:14' AND TIMESTAMP '2023-08-18 07:59:41'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2023-08-13 19:54:14'
    - '2023-08-18 07:59:41'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2020-03-27' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2020-03-27');
  params:
  - '2020-03-27'
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg' GROUP BY d.name;
  params:
  - Friedrichshain-Kreuzberg
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 212)
    WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - Technische-Universität-Berlin
  - 212
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 746)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2021-05-26 10:10:08' AND TIMESTAMP '2021-05-28 21:27:10'
      AND u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2021-05-26 10:10:08'
    - '2021-05-28 21:27:10'
  - Universität-der-Künste-Berlin
  - 746
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2020-03-19 11:10:14' AND TIMESTAMP '2020-03-26 06:23:17'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2020-03-19 11:10:14'
    - '2020-03-26 06:23:17'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 214)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2022-01-29 20:09:13' AND TIMESTAMP '2022-02-12 21:07:00'
      AND u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2022-01-29 20:09:13'
    - '2022-02-12 21:07:00'
  - Universität-der-Künste-Berlin
  - 214
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2021-11-04 16:57:17' AND TIMESTAMP '2021-11-12 14:46:41'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2021-11-04 16:57:17'
    - '2021-11-12 14:46:41'
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Treptow-Köpenick' GROUP BY d.name;
  params:
  - Treptow-Köpenick
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2020-10-20 16:07:20' AND TIMESTAMP '2020-11-02 01:49:06'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2020-10-20 16:07:20'
    - '2020-11-02 01:49:06'
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2021-02-21 20:54:01' AND TIMESTAMP '2021-03-06 22:18:25'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2021-02-21 20:54:01'
    - '2021-03-06 22:18:25'
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2024-10-08 10:38:48' AND TIMESTAMP '2024-10-17 04:59:28'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2024-10-08 10:38:48'
    - '2024-10-17 04:59:28'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2020-08-04' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2020-08-04');
  params:
  - '2020-08-04'
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Spandau' GROUP BY d.name;
  params:
  - Spandau
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2021-08-30 06:21:19' AND TIMESTAMP '2021-09-02 16:30:49'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2021-08-30 06:21:19'
    - '2021-09-02 16:30:49'
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg' GROUP BY d.name;
  params:
  - Friedrichshain-Kreuzberg
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg' GROUP BY d.name;
  params:
  - Friedrichshain-Kreuzberg
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2021-07-19 18:01:58' AND TIMESTAMP '2021-07-28 05:06:40'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2021-07-19 18:01:58'
    - '2021-07-28 05:06:40'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 805)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2020-09-30 09:54:42' AND TIMESTAMP '2020-10-05 21:04:14'
      AND u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2020-09-30 09:54:42'
    - '2020-10-05 21:04:14'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
  - 805
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 417)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2023-10-06 12:18:40' AND TIMESTAMP '2023-10-20 06:35:45'
      AND u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2023-10-06 12:18:40'
    - '2023-10-20 06:35:45'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
  - 417
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2021-04-22 20:13:38' AND TIMESTAMP '2021-04-26 02:34:05'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2021-04-22 20:13:38'
    - '2021-04-26 02:34:05'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 883)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2024-10-18 03:50:16' AND TIMESTAMP '2024-10-24 04:49:24'
      AND u.name = 'Charité-Campus-Klinik';
  params:
  - - '2024-10-18 03:50:16'
    - '2024-10-24 04:49:24'
  - Charité-Campus-Klinik
  - 883
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2022-07-11 06:51:02' AND TIMESTAMP '2022-07-15 13:54:39'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2022-07-11 06:51:02'
    - '2022-07-15 13:54:39'
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2022-09-26 12:02:52' AND TIMESTAMP '2022-10-06 09:59:30'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2022-09-26 12:02:52'
    - '2022-10-06 09:59:30'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2021-11-08' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2021-11-08');
  params:
  - '2021-11-08'
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2023-07-02 07:24:00' AND TIMESTAMP '2023-07-09 12:51:48'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2023-07-02 07:24:00'
    - '2023-07-09 12:51:48'
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2023-02-18 20:23:14' AND TIMESTAMP '2023-02-25 19:44:55'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2023-02-18 20:23:14'
    - '2023-02-25 19:44:55'
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2021-10-09 03:11:37' AND TIMESTAMP '2021-10-23 22:44:03'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2021-10-09 03:11:37'
    - '2021-10-23 22:44:03'
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2024-10-16 16:11:33' AND TIMESTAMP '2024-10-29 09:51:06'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2024-10-16 16:11:33'
    - '2024-10-29 09:51:06'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 832)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2020-04-03 20:39:01' AND TIMESTAMP '2020-04-14 01:37:59'
      AND u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - - '2020-04-03 20:39:01'
    - '2020-04-14 01:37:59'
  - European-School-of-Management-and-Technology-Berlin
  - 832
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg' GROUP BY d.name;
  params:
  - Friedrichshain-Kreuzberg
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2023-02-21 06:02:39' AND TIMESTAMP '2023-03-08 01:44:11'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2023-02-21 06:02:39'
    - '2023-03-08 01:44:11'
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2023-10-11 07:30:23' AND TIMESTAMP '2023-10-21 19:00:34'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2023-10-11 07:30:23'
    - '2023-10-21 19:00:34'
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2022-08-25 22:25:57' AND TIMESTAMP '2022-08-30 21:27:33'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2022-08-25 22:25:57'
    - '2022-08-30 21:27:33'
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 860)
    WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - Universität-der-Künste-Berlin
  - 860
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2021-07-21 04:07:54' AND TIMESTAMP '2021-08-01 08:03:18'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2021-07-21 04:07:54'
    - '2021-08-01 08:03:18'
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2023-07-02 21:33:02' AND TIMESTAMP '2023-07-10 04:34:57'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2023-07-02 21:33:02'
    - '2023-07-10 04:34:57'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2021-12-26' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2021-12-26');
  params:
  - '2021-12-26'
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2023-04-10 06:16:40' AND TIMESTAMP '2023-04-22 01:33:55'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2023-04-10 06:16:40'
    - '2023-04-22 01:33:55'
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Pankow' GROUP BY d.name;
  params:
  - Pankow
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2023-11-14' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2023-11-14');
  params:
  - '2023-11-14'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 190)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2023-04-18 15:55:52' AND TIMESTAMP '2023-05-01 07:44:19'
      AND u.name = 'Charité-Campus-Klinik';
  params:
  - - '2023-04-18 15:55:52'
    - '2023-05-01 07:44:19'
  - Charité-Campus-Klinik
  - 190
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2020-02-13 00:11:57' AND TIMESTAMP '2020-02-21 13:33:48'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2020-02-13 00:11:57'
    - '2020-02-21 13:33:48'
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2022-05-02 00:29:50' AND TIMESTAMP '2022-05-08 04:04:10'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2022-05-02 00:29:50'
    - '2022-05-08 04:04:10'
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 528)
    WHERE u.name = 'Bard-College';
  params:
  - Bard-College
  - 528
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 139)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2022-05-02 16:41:43' AND TIMESTAMP '2022-05-15 18:07:33'
      AND u.name = 'Freie-Universität-Berlin';
  params:
  - - '2022-05-02 16:41:43'
    - '2022-05-15 18:07:33'
  - Freie-Universität-Berlin
  - 139
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 412)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2021-03-04 15:47:40' AND TIMESTAMP '2021-03-16 21:39:27'
      AND u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2021-03-04 15:47:40'
    - '2021-03-16 21:39:27'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
  - 412
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2021-04-27 11:07:32' AND TIMESTAMP '2021-05-12 01:55:48'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2021-04-27 11:07:32'
    - '2021-05-12 01:55:48'
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 563)
    WHERE u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - European-School-of-Management-and-Technology-Berlin
  - 563
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 783)
    WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - Technische-Universität-Berlin
  - 783
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2023-01-21 20:37:16' AND TIMESTAMP '2023-01-29 19:16:31'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2023-01-21 20:37:16'
    - '2023-01-29 19:16:31'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 689)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2023-01-23 05:02:48' AND TIMESTAMP '2023-01-28 23:35:29'
      AND u.name = 'Charité-Campus-Klinik';
  params:
  - - '2023-01-23 05:02:48'
    - '2023-01-28 23:35:29'
  - Charité-Campus-Klinik
  - 689
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2021-03-04' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2021-03-04');
  params:
  - '2021-03-04'
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 186)
    WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - Freie-Universität-Berlin
  - 186
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 254)
    WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - Katholische-Hochschule-für-Sozialwesen-Berlin
  - 254
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2021-08-27 15:11:42' AND TIMESTAMP '2021-09-10 18:12:10'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2021-08-27 15:11:42'
    - '2021-09-10 18:12:10'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 190)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2023-03-24 13:13:02' AND TIMESTAMP '2023-04-04 14:42:05'
      AND u.name = 'Technische-Universität-Berlin';
  params:
  - - '2023-03-24 13:13:02'
    - '2023-04-04 14:42:05'
  - Technische-Universität-Berlin
  - 190
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Lichtenberg' GROUP BY d.name;
  params:
  - Lichtenberg
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2023-08-18' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2023-08-18');
  params:
  - '2023-08-18'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 717)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2021-02-17 01:18:24' AND TIMESTAMP '2021-02-19 03:08:24'
      AND u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2021-02-17 01:18:24'
    - '2021-02-19 03:08:24'
  - Universität-der-Künste-Berlin
  - 717
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2021-02-12 20:12:59' AND TIMESTAMP '2021-02-25 17:36:06'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2021-02-12 20:12:59'
    - '2021-02-25 17:36:06'
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Treptow-Köpenick' GROUP BY d.name;
  params:
  - Treptow-Köpenick
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2023-11-29 08:04:03' AND TIMESTAMP '2023-12-12 20:38:25'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2023-11-29 08:04:03'
    - '2023-12-12 20:38:25'
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2020-12-04 11:24:50' AND TIMESTAMP '2020-12-06 16:57:15'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2020-12-04 11:24:50'
    - '2020-12-06 16:57:15'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2021-11-30' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2021-11-30');
  params:
  - '2021-11-30'
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Lichtenberg' GROUP BY d.name;
  params:
  - Lichtenberg
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2022-07-31 18:22:52' AND TIMESTAMP '2022-08-09 00:18:03'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2022-07-31 18:22:52'
    - '2022-08-09 00:18:03'
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2024-12-10 23:35:48' AND TIMESTAMP '2024-12-18 04:31:19'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2024-12-10 23:35:48'
    - '2024-12-18 04:31:19'
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2021-08-27 08:11:51' AND TIMESTAMP '2021-09-08 21:23:05'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2021-08-27 08:11:51'
    - '2021-09-08 21:23:05'
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 398)
    WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - Universität-der-Künste-Berlin
  - 398
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 233)
    WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - Humboldt-Universität-zu-Berlin
  - 233
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 962)
    WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - Charité-Campus-Klinik
  - 962
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2023-09-01' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2023-09-01');
  params:
  - '2023-09-01'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 202)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2020-02-19 10:30:10' AND TIMESTAMP '2020-02-26 20:37:10'
      AND u.name = 'Technische-Universität-Berlin';
  params:
  - - '2020-02-19 10:30:10'
    - '2020-02-26 20:37:10'
  - Technische-Universität-Berlin
  - 202
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2023-06-06 17:07:46' AND TIMESTAMP '2023-06-12 23:53:18'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2023-06-06 17:07:46'
    - '2023-06-12 23:53:18'
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2024-10-07 16:20:39' AND TIMESTAMP '2024-10-19 12:33:56'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2024-10-07 16:20:39'
    - '2024-10-19 12:33:56'
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2020-12-11 11:52:55' AND TIMESTAMP '2020-12-25 19:10:36'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2020-12-11 11:52:55'
    - '2020-12-25 19:10:36'
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2022-07-17 12:54:09' AND TIMESTAMP '2022-07-29 09:53:36'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2022-07-17 12:54:09'
    - '2022-07-29 09:53:36'
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2020-08-06 05:04:55' AND TIMESTAMP '2020-08-16 10:39:58'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2020-08-06 05:04:55'
    - '2020-08-16 10:39:58'
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2020-05-25 08:02:34' AND TIMESTAMP '2020-05-30 09:56:06'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2020-05-25 08:02:34'
    - '2020-05-30 09:56:06'
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2023-06-06 05:24:05' AND TIMESTAMP '2023-06-19 01:30:29'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2023-06-06 05:24:05'
    - '2023-06-19 01:30:29'
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 221)
    WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - Technische-Universität-Berlin
  - 221
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Treptow-Köpenick' GROUP BY d.name;
  params:
  - Treptow-Köpenick
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf' GROUP BY d.name;
  params:
  - Steglitz-Zehlendorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2021-02-27' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2021-02-27');
  params:
  - '2021-02-27'
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2022-07-28 07:50:35' AND TIMESTAMP '2022-08-11 12:06:53'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2022-07-28 07:50:35'
    - '2022-08-11 12:06:53'
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 750)
    WHERE u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - European-School-of-Management-and-Technology-Berlin
  - 750
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2020-06-25' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2020-06-25');
  params:
  - '2020-06-25'
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Neukölln' GROUP BY d.name;
  params:
  - Neukölln
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 152)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2021-08-17 09:18:30' AND TIMESTAMP '2021-08-25 01:47:05'
      AND u.name = 'Freie-Universität-Berlin';
  params:
  - - '2021-08-17 09:18:30'
    - '2021-08-25 01:47:05'
  - Freie-Universität-Berlin
  - 152
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2024-03-18' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2024-03-18');
  params:
  - '2024-03-18'
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 692)
    WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - Technische-Universität-Berlin
  - 692
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2024-06-22 18:16:17' AND TIMESTAMP '2024-06-29 16:06:08'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2024-06-22 18:16:17'
    - '2024-06-29 16:06:08'
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Treptow-Köpenick' GROUP BY d.name;
  params:
  - Treptow-Köpenick
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 228)
    WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - Universität-der-Künste-Berlin
  - 228
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2020-05-27' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2020-05-27');
  params:
  - '2020-05-27'
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2020-06-15 08:50:03' AND TIMESTAMP '2020-06-24 08:46:40'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2020-06-15 08:50:03'
    - '2020-06-24 08:46:40'
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2023-10-05 12:11:58' AND TIMESTAMP '2023-10-08 22:37:22'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2023-10-05 12:11:58'
    - '2023-10-08 22:37:22'
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Mitte' GROUP BY d.name;
  params:
  - Mitte
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2024-06-15' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2024-06-15');
  params:
  - '2024-06-15'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 457)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2021-04-08 21:37:43' AND TIMESTAMP '2021-04-15 22:41:05'
      AND u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2021-04-08 21:37:43'
    - '2021-04-15 22:41:05'
  - Humboldt-Universität-zu-Berlin
  - 457
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Reinickendorf' GROUP BY d.name;
  params:
  - Reinickendorf
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Treptow-Köpenick' GROUP BY d.name;
  params:
  - Treptow-Köpenick
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 936)
    WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - Katholische-Hochschule-für-Sozialwesen-Berlin
  - 936
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 914)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2021-10-27 03:59:44' AND TIMESTAMP '2021-11-01 22:41:41'
      AND u.name = 'Bard-College';
  params:
  - - '2021-10-27 03:59:44'
    - '2021-11-01 22:41:41'
  - Bard-College
  - 914
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg' GROUP BY d.name;
  params:
  - Tempelhof-Schöneberg
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2024-08-28 10:32:08' AND TIMESTAMP '2024-09-02 17:56:34'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2024-08-28 10:32:08'
    - '2024-09-02 17:56:34'
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2024-09-11 10:47:33' AND TIMESTAMP '2024-09-17 09:02:28'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2024-09-11 10:47:33'
    - '2024-09-17 09:02:28'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    SELECT
      AVG(re.end_time - rs.start_time) AS avg_duration
    FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id
    JOIN universities u
      ON ST_DWithin(re.destination_geom, u.geom, 205)
    WHERE
      rs.start_time BETWEEN TIMESTAMP '2020-10-29 21:21:23' AND TIMESTAMP '2020-11-05 21:47:59'
      AND u.name = 'Charité-Campus-Klinik';
  params:
  - - '2020-10-29 21:21:23'
    - '2020-11-05 21:47:59'
  - Charité-Campus-Klinik
  - 205
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2024-10-12' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2024-10-12');
  params:
  - '2024-10-12'
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 237)
    WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - Freie-Universität-Berlin
  - 237
- name: countActiveRideInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf' GROUP BY d.name;
  params:
  - Marzahn-Hellersdorf
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2024-08-26 11:36:26' AND TIMESTAMP '2024-09-06 23:46:12'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2024-08-26 11:36:26'
    - '2024-09-06 23:46:12'
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 371)
    WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - Universität-der-Künste-Berlin
  - 371
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2023-07-10' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2023-07-10');
  params:
  - '2023-07-10'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(re.end_time - rs.start_time) AS avg_duration FROM ride_trajectories_start rs JOIN ride_trajectories_end re ON re.ride_id = rs.ride_id WHERE (rs.start_time <= TIMESTAMP '2020-09-30' + INTERVAL '1 day' AND re.end_time >= TIMESTAMP '2020-09-30');
  params:
  - '2020-09-30'
- name: SortRidesByHourInPeriod
  type: temporal
  sql: |
    SELECT EXTRACT(HOUR FROM r.timestamp) AS hour_of_day,
       COUNT(*) AS num_points
    FROM ride_points r
    WHERE r.timestamp BETWEEN TIMESTAMP '2024-04-06 18:01:14' AND TIMESTAMP '2024-04-20 10:16:29'
    GROUP BY hour_of_day
    ORDER BY hour_of_day;
  params:
  - - '2024-04-06 18:01:14'
    - '2024-04-20 10:16:29'
- name: rideCrossSeveralDistrictsInPeriod
  type: spatiotemporal
  sql: |
    SELECT DISTINCT r.ride_id
    FROM ride_points r
    JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom)
    WHERE r.timestamp BETWEEN TIMESTAMP '2022-11-14 18:36:40' AND TIMESTAMP '2022-11-21 00:45:21'
    GROUP BY r.ride_id
    HAVING COUNT(DISTINCT d.name) > 1;
  params:
  - - '2022-11-14 18:36:40'
    - '2022-11-21 00:45:21'
- name: RidesPastOrToUniversity
  type: spatial
  sql: |
    SELECT DISTINCT r.ride_id
    from ride_points r
    JOIN universities u
      ON ST_DWithin(r.geom, u.geom, 606)
    WHERE u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - European-School-of-Management-and-Technology-Berlin
  - 606
