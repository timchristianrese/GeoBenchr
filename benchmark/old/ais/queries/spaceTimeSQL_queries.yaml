- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-02-22' - tp '3d' AND epoch '2019-02-22' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-02-22' AND hour(t_start) = 1);
  params:
  - '2019-02-22'
  - 1
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Makronisos;MULTIPOLYGON(((23.4499771 37.8187979'
    );
  params:
  - Makronisos;MULTIPOLYGON(((23.4499771 37.8187979
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Revithousa;MULTIPOLYGON(((23.3970014 37.9622853'
    );
  params:
  - Revithousa;MULTIPOLYGON(((23.3970014 37.9622853
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-05-11 04:45:19, 2019-05-22 05:42:28]'
    );
  params:
  - - 2019-05-11 04:45:19
    - 2019-05-22 05:42:28
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-10-23 05:31:07, 2019-10-25 17:55:26]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-10-23 05:31:07
    - 2019-10-25 17:55:26
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-03-23 13:36:13, 2019-04-03 15:24:58]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-03-23 13:36:13
    - 2019-04-03 15:24:58
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'AGISTRI'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'AGISTRI'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - AGISTRI
  - AEGINA
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Phleva Island;MULTIPOLYGON(((23.7659544 37.7674259'
    );
  params:
  - Phleva Island;MULTIPOLYGON(((23.7659544 37.7674259
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-09-22' - tp '3d' AND epoch '2019-09-22' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-09-22' AND hour(t_start) = 22);
  params:
  - '2019-09-22'
  - 22
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FALIRO'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FALIRO'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - FALIRO
  - AGISTRI
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FALIRO'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FALIRO'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - FALIRO
  - GLYFADA
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-03-28 19:24:00, 2019-04-06 19:04:02]'
    );
  params:
  - - 2019-03-28 19:24:00
    - 2019-04-06 19:04:02
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Agios Thomas;MULTIPOLYGON(((23.2497482 37.8055013'
    );
  params:
  - Agios Thomas;MULTIPOLYGON(((23.2497482 37.8055013
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-09-24 20:45:50, 2019-10-05 21:09:16]'
    );
  params:
  - - 2019-09-24 20:45:50
    - 2019-10-05 21:09:16
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-03-24' - tp '3d' AND epoch '2019-03-24' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-03-24' AND hour(t_start) = 1);
  params:
  - '2019-03-24'
  - 1
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-11-19 18:59:05, 2019-11-30 16:05:13]'
    );
  params:
  - - 2019-11-19 18:59:05
    - 2019-11-30 16:05:13
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Nisis Atalanti;MULTIPOLYGON(((23.5716686 37.9346175'
    );
  params:
  - Nisis Atalanti;MULTIPOLYGON(((23.5716686 37.9346175
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-04-21 05:58:48, 2019-05-05 16:53:26]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'ERMIONI';
  params:
  - ERMIONI
  - - 2019-04-21 05:58:48
    - 2019-05-05 16:53:26
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-10-28' - tp '3d' AND epoch '2019-10-28' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-10-28' AND hour(t_start) = 2);
  params:
  - '2019-10-28'
  - 2
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'PIRAEUS'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'PIRAEUS'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - PIRAEUS
  - FALIRO
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-06-02 07:16:59, 2019-06-10 01:14:54]'
    );
  params:
  - - 2019-06-02 07:16:59
    - 2019-06-10 01:14:54
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-01-22' - tp '3d' AND epoch '2019-01-22' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-01-22' AND hour(t_start) = 14);
  params:
  - '2019-01-22'
  - 14
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-06-24 00:14:26, 2019-06-27 19:41:58]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-06-24 00:14:26
    - 2019-06-27 19:41:58
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-08-30 08:44:08, 2019-09-02 06:50:56]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'ERMIONI';
  params:
  - ERMIONI
  - - 2019-08-30 08:44:08
    - 2019-09-02 06:50:56
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-07-16 09:33:26, 2019-07-30 00:13:44]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'FALIRO';
  params:
  - FALIRO
  - - 2019-07-16 09:33:26
    - 2019-07-30 00:13:44
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-10-03 20:04:22, 2019-10-10 22:09:53]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'ELEFSIS';
  params:
  - ELEFSIS
  - - 2019-10-03 20:04:22
    - 2019-10-10 22:09:53
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-01-09 23:04:12, 2019-01-24 19:56:42]'
    );
  params:
  - - 2019-01-09 23:04:12
    - 2019-01-24 19:56:42
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Nisis Pachaki;MULTIPOLYGON(((23.3614704 37.9692519'
    );
  params:
  - Nisis Pachaki;MULTIPOLYGON(((23.3614704 37.9692519
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-07-07 09:46:40, 2019-07-17 10:12:23]'
    );
  params:
  - - 2019-07-07 09:46:40
    - 2019-07-17 10:12:23
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-12-08' - tp '3d' AND epoch '2019-12-08' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-12-08' AND hour(t_start) = 13);
  params:
  - '2019-12-08'
  - 13
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'ERMIONI'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'ERMIONI'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - ERMIONI
  - LAVRIO
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-10-04 13:10:17, 2019-10-15 00:33:02]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'CORINTH';
  params:
  - CORINTH
  - - 2019-10-04 13:10:17
    - 2019-10-15 00:33:02
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-08-19 21:11:39, 2019-09-03 15:26:58]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-08-19 21:11:39
    - 2019-09-03 15:26:58
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-12-15 02:08:03, 2019-12-28 22:55:24]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'ZEA';
  params:
  - ZEA
  - - 2019-12-15 02:08:03
    - 2019-12-28 22:55:24
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'RAFINA'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'RAFINA'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - RAFINA
  - AGIOI THEODORI
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'AGIOI THEODORI'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'AGIOI THEODORI'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - AGIOI THEODORI
  - ZEA
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'LAVRIO'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'LAVRIO'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - LAVRIO
  - AGISTRI
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-12-16 12:23:51, 2019-12-29 09:55:13]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-12-16 12:23:51
    - 2019-12-29 09:55:13
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-01-30 07:08:24, 2019-02-12 16:30:25]'
    );
  params:
  - - 2019-01-30 07:08:24
    - 2019-02-12 16:30:25
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Kasidis;MULTIPOLYGON(((23.7690617 37.7937917'
    );
  params:
  - Kasidis;MULTIPOLYGON(((23.7690617 37.7937917
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-08-03' - tp '3d' AND epoch '2019-08-03' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-08-03' AND hour(t_start) = 12);
  params:
  - '2019-08-03'
  - 12
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-05-22 01:06:59, 2019-05-26 21:59:54]'
    );
  params:
  - - 2019-05-22 01:06:59
    - 2019-05-26 21:59:54
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-09-04 13:42:43, 2019-09-12 15:14:41]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'AGIOI THEODORI';
  params:
  - AGIOI THEODORI
  - - 2019-09-04 13:42:43
    - 2019-09-12 15:14:41
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-08-06' - tp '3d' AND epoch '2019-08-06' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-08-06' AND hour(t_start) = 10);
  params:
  - '2019-08-06'
  - 10
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Poros;MULTIPOLYGON(((23.4581491 37.5061611'
    );
  params:
  - Poros;MULTIPOLYGON(((23.4581491 37.5061611
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-06-01 11:40:34, 2019-06-03 15:40:41]'
    );
  params:
  - - 2019-06-01 11:40:34
    - 2019-06-03 15:40:41
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-07-04 16:10:02, 2019-07-10 04:40:50]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-07-04 16:10:02
    - 2019-07-10 04:40:50
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-12-29 22:13:15, 2019-12-31 23:59:59]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'FANEROMENI';
  params:
  - FANEROMENI
  - - 2019-12-29 22:13:15
    - 2019-12-31 23:59:59
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-09-25' - tp '3d' AND epoch '2019-09-25' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-09-25' AND hour(t_start) = 17);
  params:
  - '2019-09-25'
  - 17
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Arsida;MULTIPOLYGON(((23.8940984 37.7083539'
    );
  params:
  - Arsida;MULTIPOLYGON(((23.8940984 37.7083539
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Trakhyli;MULTIPOLYGON(((23.1764033 37.7162605'
    );
  params:
  - Trakhyli;MULTIPOLYGON(((23.1764033 37.7162605
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-05-18 16:41:43, 2019-05-24 02:52:20]'
    );
  params:
  - - 2019-05-18 16:41:43
    - 2019-05-24 02:52:20
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Daskalio;MULTIPOLYGON(((23.4300353 37.5166044'
    );
  params:
  - Daskalio;MULTIPOLYGON(((23.4300353 37.5166044
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-11-25 23:37:27, 2019-12-05 18:59:28]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-11-25 23:37:27
    - 2019-12-05 18:59:28
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Aponissos;MULTIPOLYGON(((23.3228714 37.6837864'
    );
  params:
  - Aponissos;MULTIPOLYGON(((23.3228714 37.6837864
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-01-07' - tp '3d' AND epoch '2019-01-07' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-01-07' AND hour(t_start) = 3);
  params:
  - '2019-01-07'
  - 3
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-08-17 08:26:15, 2019-08-26 21:00:53]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-08-17 08:26:15
    - 2019-08-26 21:00:53
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'PIRAEUS'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'PIRAEUS'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - PIRAEUS
  - ASPROPYRGOS
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Nisis Pachaki;MULTIPOLYGON(((23.3614704 37.9692519'
    );
  params:
  - Nisis Pachaki;MULTIPOLYGON(((23.3614704 37.9692519
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-06-20 12:31:13, 2019-06-25 21:43:47]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'SOUSAKI';
  params:
  - SOUSAKI
  - - 2019-06-20 12:31:13
    - 2019-06-25 21:43:47
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FALIRO'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FALIRO'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - FALIRO
  - SIRI
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Kanakia;MULTIPOLYGON(((23.3941818 37.9040603'
    );
  params:
  - Kanakia;MULTIPOLYGON(((23.3941818 37.9040603
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Plateia;MULTIPOLYGON(((23.0879522 37.8663437'
    );
  params:
  - Plateia;MULTIPOLYGON(((23.0879522 37.8663437
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-01-17' - tp '3d' AND epoch '2019-01-17' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-01-17' AND hour(t_start) = 3);
  params:
  - '2019-01-17'
  - 3
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-07-06 05:17:59, 2019-07-17 21:28:13]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-07-06 05:17:59
    - 2019-07-17 21:28:13
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'CORINTH'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'CORINTH'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - CORINTH
  - ERMIONI
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-08-09 15:48:46, 2019-08-23 20:27:54]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-08-09 15:48:46
    - 2019-08-23 20:27:54
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-09-20' - tp '3d' AND epoch '2019-09-20' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-09-20' AND hour(t_start) = 9);
  params:
  - '2019-09-20'
  - 9
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Prasou;MULTIPOLYGON(((23.2622469 37.8097209'
    );
  params:
  - Prasou;MULTIPOLYGON(((23.2622469 37.8097209
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Ydrousa;MULTIPOLYGON(((23.7440149 37.8343154'
    );
  params:
  - Ydrousa;MULTIPOLYGON(((23.7440149 37.8343154
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-05-03 12:10:35, 2019-05-11 01:42:35]'
    );
  params:
  - - 2019-05-03 12:10:35
    - 2019-05-11 01:42:35
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-11-17' - tp '3d' AND epoch '2019-11-17' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-11-17' AND hour(t_start) = 16);
  params:
  - '2019-11-17'
  - 16
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Vrachonisis Tragonisi;MULTIPOLYGON(((23.2444035 37.8027381'
    );
  params:
  - Vrachonisis Tragonisi;MULTIPOLYGON(((23.2444035 37.8027381
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-06-26' - tp '3d' AND epoch '2019-06-26' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-06-26' AND hour(t_start) = 1);
  params:
  - '2019-06-26'
  - 1
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'AGIOS KOSMAS'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'AGIOS KOSMAS'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - AGIOS KOSMAS
  - AEGINA
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Kourmouloudes;MULTIPOLYGON(((23.3193627 37.8000988'
    );
  params:
  - Kourmouloudes;MULTIPOLYGON(((23.3193627 37.8000988
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-09-12 05:36:31, 2019-09-22 17:40:41]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'CORINTH CANAL';
  params:
  - CORINTH CANAL
  - - 2019-09-12 05:36:31
    - 2019-09-22 17:40:41
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-04-01' - tp '3d' AND epoch '2019-04-01' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-04-01' AND hour(t_start) = 2);
  params:
  - '2019-04-01'
  - 2
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-05-13' - tp '3d' AND epoch '2019-05-13' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-05-13' AND hour(t_start) = 5);
  params:
  - '2019-05-13'
  - 5
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Nisis Stakhtorroyi;MULTIPOLYGON(((23.3608955 37.8141731'
    );
  params:
  - Nisis Stakhtorroyi;MULTIPOLYGON(((23.3608955 37.8141731
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'LAVRIO'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'LAVRIO'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - LAVRIO
  - CORINTH
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-11-15' - tp '3d' AND epoch '2019-11-15' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-11-15' AND hour(t_start) = 20);
  params:
  - '2019-11-15'
  - 20
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Nisida Kyra;MULTIPOLYGON(((23.2522565 37.7048173'
    );
  params:
  - Nisida Kyra;MULTIPOLYGON(((23.2522565 37.7048173
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-06-01 18:55:54, 2019-06-14 10:21:31]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-06-01 18:55:54
    - 2019-06-14 10:21:31
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-11-09 14:48:53, 2019-11-23 12:04:40]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-11-09 14:48:53
    - 2019-11-23 12:04:40
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'ELEFSIS'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'ELEFSIS'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - ELEFSIS
  - PIRAEUS
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-06-16' - tp '3d' AND epoch '2019-06-16' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-06-16' AND hour(t_start) = 8);
  params:
  - '2019-06-16'
  - 8
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-04-03' - tp '3d' AND epoch '2019-04-03' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-04-03' AND hour(t_start) = 21);
  params:
  - '2019-04-03'
  - 21
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-09-14 18:58:11, 2019-09-20 18:59:39]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-09-14 18:58:11
    - 2019-09-20 18:59:39
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Prasou;MULTIPOLYGON(((23.2622469 37.8097209'
    );
  params:
  - Prasou;MULTIPOLYGON(((23.2622469 37.8097209
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-10-24 10:13:01, 2019-11-06 11:26:22]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-10-24 10:13:01
    - 2019-11-06 11:26:22
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Nisis Islet;MULTIPOLYGON(((23.3837032 37.8100009'
    );
  params:
  - Nisis Islet;MULTIPOLYGON(((23.3837032 37.8100009
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-02-22 17:42:46, 2019-02-26 18:52:13]'
    );
  params:
  - - 2019-02-22 17:42:46
    - 2019-02-26 18:52:13
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'ASPROPYRGOS'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'ASPROPYRGOS'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - ASPROPYRGOS
  - LAVRIO
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-03-11' - tp '3d' AND epoch '2019-03-11' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-03-11' AND hour(t_start) = 11);
  params:
  - '2019-03-11'
  - 11
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-11-16 00:10:50, 2019-11-23 03:58:53]'
    );
  params:
  - - 2019-11-16 00:10:50
    - 2019-11-23 03:58:53
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-09-20 21:35:47, 2019-09-26 09:47:51]'
    );
  params:
  - - 2019-09-20 21:35:47
    - 2019-09-26 09:47:51
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-05-10 23:55:04, 2019-05-20 18:07:11]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'RAFINA';
  params:
  - RAFINA
  - - 2019-05-10 23:55:04
    - 2019-05-20 18:07:11
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Nisis Atalanti;MULTIPOLYGON(((23.5716686 37.9346175'
    );
  params:
  - Nisis Atalanti;MULTIPOLYGON(((23.5716686 37.9346175
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'CORINTH'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'CORINTH'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - CORINTH
  - RAFINA
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'AEGINA'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'AEGINA'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - AEGINA
  - LAVRIO
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'PERAMA'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'PERAMA'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - PERAMA
  - ASPROPYRGOS
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-05-10 23:05:12, 2019-05-16 23:25:43]'
    );
  params:
  - - 2019-05-10 23:05:12
    - 2019-05-16 23:25:43
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Kasidis;MULTIPOLYGON(((23.7690617 37.7937917'
    );
  params:
  - Kasidis;MULTIPOLYGON(((23.7690617 37.7937917
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-07-16 16:44:27, 2019-07-20 22:51:42]'
    );
  params:
  - - 2019-07-16 16:44:27
    - 2019-07-20 22:51:42
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-12-09 17:26:08, 2019-12-13 17:58:33]'
    );
  params:
  - - 2019-12-09 17:26:08
    - 2019-12-13 17:58:33
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-10-23 15:38:14, 2019-10-31 20:13:05]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-10-23 15:38:14
    - 2019-10-31 20:13:05
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-11-01' - tp '3d' AND epoch '2019-11-01' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-11-01' AND hour(t_start) = 12);
  params:
  - '2019-11-01'
  - 12
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-03-10' - tp '3d' AND epoch '2019-03-10' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-03-10' AND hour(t_start) = 15);
  params:
  - '2019-03-10'
  - 15
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-01-06 20:33:05, 2019-01-11 02:24:48]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-01-06 20:33:05
    - 2019-01-11 02:24:48
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Phleva Island;MULTIPOLYGON(((23.7659544 37.7674259'
    );
  params:
  - Phleva Island;MULTIPOLYGON(((23.7659544 37.7674259
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-04-17' - tp '3d' AND epoch '2019-04-17' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-04-17' AND hour(t_start) = 10);
  params:
  - '2019-04-17'
  - 10
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-01-30 09:44:29, 2019-02-05 03:30:04]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'GLYFADA';
  params:
  - GLYFADA
  - - 2019-01-30 09:44:29
    - 2019-02-05 03:30:04
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'PERAMA'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'PERAMA'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - PERAMA
  - AEGINA
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FLISVOS'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FLISVOS'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - FLISVOS
  - ERMIONI
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Nisis Metopi;MULTIPOLYGON(((23.3772365 37.7192176'
    );
  params:
  - Nisis Metopi;MULTIPOLYGON(((23.3772365 37.7192176
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-05-11 17:27:03, 2019-05-25 11:13:51]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'AEGINA';
  params:
  - AEGINA
  - - 2019-05-11 17:27:03
    - 2019-05-25 11:13:51
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FLISVOS'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FLISVOS'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - FLISVOS
  - FANEROMENI
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-08-03 21:34:15, 2019-08-07 22:56:33]'
    );
  params:
  - - 2019-08-03 21:34:15
    - 2019-08-07 22:56:33
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-03-23' - tp '3d' AND epoch '2019-03-23' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-03-23' AND hour(t_start) = 9);
  params:
  - '2019-03-23'
  - 9
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-11-11 13:46:05, 2019-11-21 19:26:27]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'ERMIONI';
  params:
  - ERMIONI
  - - 2019-11-11 13:46:05
    - 2019-11-21 19:26:27
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-09-27 02:27:04, 2019-10-07 01:59:34]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-09-27 02:27:04
    - 2019-10-07 01:59:34
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-10-31 01:32:48, 2019-11-05 06:50:45]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'SOUSAKI';
  params:
  - SOUSAKI
  - - 2019-10-31 01:32:48
    - 2019-11-05 06:50:45
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-05-29' - tp '3d' AND epoch '2019-05-29' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-05-29' AND hour(t_start) = 7);
  params:
  - '2019-05-29'
  - 7
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-02-07 09:25:31, 2019-02-18 03:17:19]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-02-07 09:25:31
    - 2019-02-18 03:17:19
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'LAVRIO'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'LAVRIO'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - LAVRIO
  - CORINTH
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'CORINTH'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'CORINTH'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - CORINTH
  - PERAMA
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-05-24 10:00:14, 2019-05-29 15:45:56]'
    );
  params:
  - - 2019-05-24 10:00:14
    - 2019-05-29 15:45:56
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-02-23' - tp '3d' AND epoch '2019-02-23' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-02-23' AND hour(t_start) = 18);
  params:
  - '2019-02-23'
  - 18
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Makronisos;MULTIPOLYGON(((23.4499771 37.8187979'
    );
  params:
  - Makronisos;MULTIPOLYGON(((23.4499771 37.8187979
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-11-09 03:36:47, 2019-11-13 00:39:23]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'AGIOI THEODORI';
  params:
  - AGIOI THEODORI
  - - 2019-11-09 03:36:47
    - 2019-11-13 00:39:23
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-05-14 09:25:35, 2019-05-21 00:34:20]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-05-14 09:25:35
    - 2019-05-21 00:34:20
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-03-27 05:36:14, 2019-04-02 06:43:52]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-03-27 05:36:14
    - 2019-04-02 06:43:52
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-08-02 00:17:51, 2019-08-13 12:55:07]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-08-02 00:17:51
    - 2019-08-13 12:55:07
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'LAVRIO'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'LAVRIO'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - LAVRIO
  - AGIOS KOSMAS
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-05-06 19:01:02, 2019-05-13 09:13:08]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-05-06 19:01:02
    - 2019-05-13 09:13:08
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-06-02 04:07:39, 2019-06-14 12:45:55]'
    );
  params:
  - - 2019-06-02 04:07:39
    - 2019-06-14 12:45:55
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-03-07 08:14:14, 2019-03-09 23:30:42]'
    );
  params:
  - - 2019-03-07 08:14:14
    - 2019-03-09 23:30:42
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'ALIMOS'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'ALIMOS'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - ALIMOS
  - PIRAEUS
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-05-03 20:23:29, 2019-05-07 12:12:55]'
    );
  params:
  - - 2019-05-03 20:23:29
    - 2019-05-07 12:12:55
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-05-05 09:52:17, 2019-05-07 14:59:52]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-05-05 09:52:17
    - 2019-05-07 14:59:52
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-01-13 18:28:01, 2019-01-27 10:13:03]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'AGISTRI';
  params:
  - AGISTRI
  - - 2019-01-13 18:28:01
    - 2019-01-27 10:13:03
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-10-18 23:46:39, 2019-10-24 14:14:57]'
    );
  params:
  - - 2019-10-18 23:46:39
    - 2019-10-24 14:14:57
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-01-03' - tp '3d' AND epoch '2019-01-03' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-01-03' AND hour(t_start) = 4);
  params:
  - '2019-01-03'
  - 4
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'AEGINA'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'AEGINA'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - AEGINA
  - ZEA
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-08-22 23:35:09, 2019-09-06 22:53:49]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'LAVRIO';
  params:
  - LAVRIO
  - - 2019-08-22 23:35:09
    - 2019-09-06 22:53:49
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-08-20' - tp '3d' AND epoch '2019-08-20' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-08-20' AND hour(t_start) = 22);
  params:
  - '2019-08-20'
  - 22
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'PERAMA'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'PERAMA'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - PERAMA
  - ZEA
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-02-03' - tp '3d' AND epoch '2019-02-03' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-02-03' AND hour(t_start) = 0);
  params:
  - '2019-02-03'
  - 0
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-11-07 03:35:22, 2019-11-21 02:09:42]'
    );
  params:
  - - 2019-11-07 03:35:22
    - 2019-11-21 02:09:42
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-11-15 15:34:24, 2019-11-29 12:40:15]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'AGISTRI';
  params:
  - AGISTRI
  - - 2019-11-15 15:34:24
    - 2019-11-29 12:40:15
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-07-02' - tp '3d' AND epoch '2019-07-02' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-07-02' AND hour(t_start) = 10);
  params:
  - '2019-07-02'
  - 10
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-01-11 23:34:41, 2019-01-26 07:23:10]'
    );
  params:
  - - 2019-01-11 23:34:41
    - 2019-01-26 07:23:10
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-07-07 03:38:06, 2019-07-15 12:16:12]'
    );
  params:
  - - 2019-07-07 03:38:06
    - 2019-07-15 12:16:12
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-08-05 05:20:32, 2019-08-07 13:21:54]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'CORINTH CANAL';
  params:
  - CORINTH CANAL
  - - 2019-08-05 05:20:32
    - 2019-08-07 13:21:54
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-02-11' - tp '3d' AND epoch '2019-02-11' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-02-11' AND hour(t_start) = 3);
  params:
  - '2019-02-11'
  - 3
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-10-25 05:05:27, 2019-10-27 21:21:20]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-10-25 05:05:27
    - 2019-10-27 21:21:20
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-07-20 19:55:36, 2019-07-23 07:02:13]'
    );
  params:
  - - 2019-07-20 19:55:36
    - 2019-07-23 07:02:13
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-04-22 04:27:42, 2019-04-26 10:08:43]'
    );
  params:
  - - 2019-04-22 04:27:42
    - 2019-04-26 10:08:43
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-10-26 19:45:41, 2019-11-06 12:46:29]'
    );
  params:
  - - 2019-10-26 19:45:41
    - 2019-11-06 12:46:29
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-01-01 00:00:00, 2019-01-01 02:32:47]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-01-01 00:00:00
    - 2019-01-01 02:32:47
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-03-08 10:41:08, 2019-03-22 18:51:59]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'AGIOI THEODORI';
  params:
  - AGIOI THEODORI
  - - 2019-03-08 10:41:08
    - 2019-03-22 18:51:59
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-10-02 13:55:30, 2019-10-07 22:50:33]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'CORINTH CANAL';
  params:
  - CORINTH CANAL
  - - 2019-10-02 13:55:30
    - 2019-10-07 22:50:33
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-04-19' - tp '3d' AND epoch '2019-04-19' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-04-19' AND hour(t_start) = 11);
  params:
  - '2019-04-19'
  - 11
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'SOUSAKI'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'SOUSAKI'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - SOUSAKI
  - SIRI
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FANEROMENI'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FANEROMENI'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - FANEROMENI
  - FANEROMENI
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-12-18 00:51:35, 2019-12-29 03:03:00]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'CORINTH';
  params:
  - CORINTH
  - - 2019-12-18 00:51:35
    - 2019-12-29 03:03:00
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-11-12 01:54:34, 2019-11-26 06:41:04]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'AGIOI THEODORI';
  params:
  - AGIOI THEODORI
  - - 2019-11-12 01:54:34
    - 2019-11-26 06:41:04
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-07-08 01:26:54, 2019-07-17 23:03:08]'
    );
  params:
  - - 2019-07-08 01:26:54
    - 2019-07-17 23:03:08
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Vrachonisis Tragonisi;MULTIPOLYGON(((23.2444035 37.8027381'
    );
  params:
  - Vrachonisis Tragonisi;MULTIPOLYGON(((23.2444035 37.8027381
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'SIRI'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'SIRI'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - SIRI
  - FALIRO
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-06-05' - tp '3d' AND epoch '2019-06-05' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-06-05' AND hour(t_start) = 18);
  params:
  - '2019-06-05'
  - 18
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-08-29 05:20:49, 2019-09-08 23:07:02]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-08-29 05:20:49
    - 2019-09-08 23:07:02
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Arsida;MULTIPOLYGON(((23.8940984 37.7083539'
    );
  params:
  - Arsida;MULTIPOLYGON(((23.8940984 37.7083539
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-11-09' - tp '3d' AND epoch '2019-11-09' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-11-09' AND hour(t_start) = 23);
  params:
  - '2019-11-09'
  - 23
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'LAVRIO'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'LAVRIO'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - LAVRIO
  - ELEFSIS
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-06-14 18:20:57, 2019-06-21 21:21:57]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-06-14 18:20:57
    - 2019-06-21 21:21:57
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-07-01 22:39:22, 2019-07-13 00:48:14]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'CORINTH';
  params:
  - CORINTH
  - - 2019-07-01 22:39:22
    - 2019-07-13 00:48:14
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-04-28 05:15:39, 2019-05-02 21:02:18]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'RAFINA';
  params:
  - RAFINA
  - - 2019-04-28 05:15:39
    - 2019-05-02 21:02:18
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-09-04 11:07:38, 2019-09-13 16:01:02]'
    );
  params:
  - - 2019-09-04 11:07:38
    - 2019-09-13 16:01:02
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-03-14 20:41:15, 2019-03-18 07:27:10]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'AGIOI THEODORI';
  params:
  - AGIOI THEODORI
  - - 2019-03-14 20:41:15
    - 2019-03-18 07:27:10
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'AEGINA'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'AEGINA'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - AEGINA
  - CORINTH
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-09-28 16:40:49, 2019-10-07 07:52:45]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-09-28 16:40:49
    - 2019-10-07 07:52:45
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-08-17 12:02:28, 2019-08-21 00:21:15]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'ELEFSIS';
  params:
  - ELEFSIS
  - - 2019-08-17 12:02:28
    - 2019-08-21 00:21:15
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-05-10 00:36:31, 2019-05-15 19:59:39]'
    );
  params:
  - - 2019-05-10 00:36:31
    - 2019-05-15 19:59:39
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Nisida Kyra;MULTIPOLYGON(((23.2522565 37.7048173'
    );
  params:
  - Nisida Kyra;MULTIPOLYGON(((23.2522565 37.7048173
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-05-12' - tp '3d' AND epoch '2019-05-12' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-05-12' AND hour(t_start) = 3);
  params:
  - '2019-05-12'
  - 3
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-05-18' - tp '3d' AND epoch '2019-05-18' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-05-18' AND hour(t_start) = 22);
  params:
  - '2019-05-18'
  - 22
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Agios Ioannis;MULTIPOLYGON(((23.2585002 37.8163195'
    );
  params:
  - Agios Ioannis;MULTIPOLYGON(((23.2585002 37.8163195
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Nisis Ipsili;MULTIPOLYGON(((23.337696 37.7981419'
    );
  params:
  - Nisis Ipsili;MULTIPOLYGON(((23.337696 37.7981419
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Revithousa;MULTIPOLYGON(((23.3970014 37.9622853'
    );
  params:
  - Revithousa;MULTIPOLYGON(((23.3970014 37.9622853
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-08-14 15:31:03, 2019-08-26 17:22:06]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-08-14 15:31:03
    - 2019-08-26 17:22:06
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-07-26 08:33:07, 2019-07-31 00:40:04]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'ASPROPYRGOS';
  params:
  - ASPROPYRGOS
  - - 2019-07-26 08:33:07
    - 2019-07-31 00:40:04
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-08-20 18:15:50, 2019-09-03 16:59:41]'
    );
  params:
  - - 2019-08-20 18:15:50
    - 2019-09-03 16:59:41
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-05-27' - tp '3d' AND epoch '2019-05-27' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-05-27' AND hour(t_start) = 17);
  params:
  - '2019-05-27'
  - 17
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FLISVOS'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FLISVOS'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - FLISVOS
  - FALIRO
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-09-15 18:27:38, 2019-09-18 17:01:35]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'FLISVOS';
  params:
  - FLISVOS
  - - 2019-09-15 18:27:38
    - 2019-09-18 17:01:35
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-07-17 14:03:57, 2019-07-25 00:14:36]'
    );
  params:
  - - 2019-07-17 14:03:57
    - 2019-07-25 00:14:36
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-09-10' - tp '3d' AND epoch '2019-09-10' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-09-10' AND hour(t_start) = 4);
  params:
  - '2019-09-10'
  - 4
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-06-18' - tp '3d' AND epoch '2019-06-18' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-06-18' AND hour(t_start) = 13);
  params:
  - '2019-06-18'
  - 13
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-04-01 19:48:50, 2019-04-04 09:10:02]'
    );
  params:
  - - 2019-04-01 19:48:50
    - 2019-04-04 09:10:02
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'RAFINA'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'RAFINA'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - RAFINA
  - AEGINA
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'ASPROPYRGOS'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'ASPROPYRGOS'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - ASPROPYRGOS
  - LAVRIO
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Nisis Metopi;MULTIPOLYGON(((23.3772365 37.7192176'
    );
  params:
  - Nisis Metopi;MULTIPOLYGON(((23.3772365 37.7192176
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Vrachonisis Petronisi;MULTIPOLYGON(((23.174325 37.7596882'
    );
  params:
  - Vrachonisis Petronisi;MULTIPOLYGON(((23.174325 37.7596882
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-12-03' - tp '3d' AND epoch '2019-12-03' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-12-03' AND hour(t_start) = 20);
  params:
  - '2019-12-03'
  - 20
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-08-08 02:46:19, 2019-08-14 19:13:55]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-08-08 02:46:19
    - 2019-08-14 19:13:55
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Makronisos;MULTIPOLYGON(((23.4103812 37.967855'
    );
  params:
  - Makronisos;MULTIPOLYGON(((23.4103812 37.967855
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'ELEFSIS'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'ELEFSIS'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - ELEFSIS
  - LAVRIO
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-02-06 19:16:57, 2019-02-20 15:08:23]'
    );
  params:
  - - 2019-02-06 19:16:57
    - 2019-02-20 15:08:23
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-05-29 01:54:25, 2019-06-04 04:26:35]'
    );
  params:
  - - 2019-05-29 01:54:25
    - 2019-06-04 04:26:35
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-08-26' - tp '3d' AND epoch '2019-08-26' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-08-26' AND hour(t_start) = 11);
  params:
  - '2019-08-26'
  - 11
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-11-06' - tp '3d' AND epoch '2019-11-06' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-11-06' AND hour(t_start) = 12);
  params:
  - '2019-11-06'
  - 12
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Nisis Metopi;MULTIPOLYGON(((23.3772365 37.7192176'
    );
  params:
  - Nisis Metopi;MULTIPOLYGON(((23.3772365 37.7192176
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-01-02 04:07:36, 2019-01-07 08:17:57]'
    );
  params:
  - - 2019-01-02 04:07:36
    - 2019-01-07 08:17:57
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-01-19' - tp '3d' AND epoch '2019-01-19' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-01-19' AND hour(t_start) = 11);
  params:
  - '2019-01-19'
  - 11
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-02-26 19:37:23, 2019-03-09 04:51:34]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'ALIMOS';
  params:
  - ALIMOS
  - - 2019-02-26 19:37:23
    - 2019-03-09 04:51:34
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-03-03' - tp '3d' AND epoch '2019-03-03' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-03-03' AND hour(t_start) = 16);
  params:
  - '2019-03-03'
  - 16
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-06-30 22:28:32, 2019-07-03 02:00:05]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-06-30 22:28:32
    - 2019-07-03 02:00:05
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'SOUSAKI'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'SOUSAKI'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - SOUSAKI
  - PERAMA
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Salamina;MULTIPOLYGON(((23.4052092 37.9299097'
    );
  params:
  - Salamina;MULTIPOLYGON(((23.4052092 37.9299097
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-02-23' - tp '3d' AND epoch '2019-02-23' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-02-23' AND hour(t_start) = 17);
  params:
  - '2019-02-23'
  - 17
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Kordeliaris;MULTIPOLYGON(((23.4447276 37.8178127'
    );
  params:
  - Kordeliaris;MULTIPOLYGON(((23.4447276 37.8178127
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-03-27 11:54:38, 2019-04-03 06:34:32]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-03-27 11:54:38
    - 2019-04-03 06:34:32
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-08-20' - tp '3d' AND epoch '2019-08-20' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-08-20' AND hour(t_start) = 6);
  params:
  - '2019-08-20'
  - 6
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-04-10' - tp '3d' AND epoch '2019-04-10' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-04-10' AND hour(t_start) = 17);
  params:
  - '2019-04-10'
  - 17
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Kourmouloudes;MULTIPOLYGON(((23.3193627 37.8000988'
    );
  params:
  - Kourmouloudes;MULTIPOLYGON(((23.3193627 37.8000988
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'CORINTH CANAL'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'CORINTH CANAL'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - CORINTH CANAL
  - LAVRIO
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-03-08' - tp '3d' AND epoch '2019-03-08' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-03-08' AND hour(t_start) = 3);
  params:
  - '2019-03-08'
  - 3
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-02-12 20:21:51, 2019-02-25 20:32:46]'
    );
  params:
  - - 2019-02-12 20:21:51
    - 2019-02-25 20:32:46
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-12-08' - tp '3d' AND epoch '2019-12-08' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-12-08' AND hour(t_start) = 21);
  params:
  - '2019-12-08'
  - 21
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-01-08 18:51:08, 2019-01-11 16:08:01]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'AGISTRI';
  params:
  - AGISTRI
  - - 2019-01-08 18:51:08
    - 2019-01-11 16:08:01
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'PIRAEUS'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'PIRAEUS'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - PIRAEUS
  - ALIMOS
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-03-03 14:12:39, 2019-03-09 16:38:03]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'FLISVOS';
  params:
  - FLISVOS
  - - 2019-03-03 14:12:39
    - 2019-03-09 16:38:03
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-03-06' - tp '3d' AND epoch '2019-03-06' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-03-06' AND hour(t_start) = 18);
  params:
  - '2019-03-06'
  - 18
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-04-01 16:54:42, 2019-04-05 03:58:00]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'FANEROMENI';
  params:
  - FANEROMENI
  - - 2019-04-01 16:54:42
    - 2019-04-05 03:58:00
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'SIRI'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'SIRI'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - SIRI
  - ERMIONI
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-07-25 14:14:11, 2019-07-28 01:56:22]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'ERMIONI';
  params:
  - ERMIONI
  - - 2019-07-25 14:14:11
    - 2019-07-28 01:56:22
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FLISVOS'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FLISVOS'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - FLISVOS
  - CORINTH CANAL
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-09-15' - tp '3d' AND epoch '2019-09-15' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-09-15' AND hour(t_start) = 3);
  params:
  - '2019-09-15'
  - 3
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-06-19' - tp '3d' AND epoch '2019-06-19' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-06-19' AND hour(t_start) = 13);
  params:
  - '2019-06-19'
  - 13
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'ERMIONI'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'ERMIONI'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - ERMIONI
  - LAVRIO
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'ALIMOS'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'ALIMOS'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - ALIMOS
  - FANEROMENI
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-07-01 11:45:40, 2019-07-08 14:55:19]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'RAFINA';
  params:
  - RAFINA
  - - 2019-07-01 11:45:40
    - 2019-07-08 14:55:19
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-02-06' - tp '3d' AND epoch '2019-02-06' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-02-06' AND hour(t_start) = 0);
  params:
  - '2019-02-06'
  - 0
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-09-30 23:32:21, 2019-10-05 21:47:02]'
    );
  params:
  - - 2019-09-30 23:32:21
    - 2019-10-05 21:47:02
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-10-05 13:08:16, 2019-10-07 13:45:32]'
    );
  params:
  - - 2019-10-05 13:08:16
    - 2019-10-07 13:45:32
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Salamina;MULTIPOLYGON(((23.4052092 37.9299097'
    );
  params:
  - Salamina;MULTIPOLYGON(((23.4052092 37.9299097
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-12-18 00:30:38, 2019-12-31 08:28:16]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'GLYFADA';
  params:
  - GLYFADA
  - - 2019-12-18 00:30:38
    - 2019-12-31 08:28:16
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'GLYFADA'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'GLYFADA'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - GLYFADA
  - CORINTH CANAL
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-07-31 02:18:42, 2019-08-02 12:39:21]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'PERAMA';
  params:
  - PERAMA
  - - 2019-07-31 02:18:42
    - 2019-08-02 12:39:21
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-04-11 11:43:22, 2019-04-22 01:10:11]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'ZEA';
  params:
  - ZEA
  - - 2019-04-11 11:43:22
    - 2019-04-22 01:10:11
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Phleva Island;MULTIPOLYGON(((23.7659544 37.7674259'
    );
  params:
  - Phleva Island;MULTIPOLYGON(((23.7659544 37.7674259
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-09-22 15:52:23, 2019-10-04 13:03:25]'
    );
  params:
  - - 2019-09-22 15:52:23
    - 2019-10-04 13:03:25
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-09-27' - tp '3d' AND epoch '2019-09-27' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-09-27' AND hour(t_start) = 18);
  params:
  - '2019-09-27'
  - 18
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-08-13 00:19:14, 2019-08-27 15:50:56]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'RAFINA';
  params:
  - RAFINA
  - - 2019-08-13 00:19:14
    - 2019-08-27 15:50:56
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-05-26 21:59:11, 2019-06-09 09:26:17]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-05-26 21:59:11
    - 2019-06-09 09:26:17
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-09-29 09:39:57, 2019-10-07 06:57:32]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-09-29 09:39:57
    - 2019-10-07 06:57:32
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'PERAMA'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'PERAMA'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - PERAMA
  - AEGINA
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-04-29 17:09:18, 2019-05-11 11:21:38]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-04-29 17:09:18
    - 2019-05-11 11:21:38
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-10-06 13:27:24, 2019-10-10 18:04:57]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-10-06 13:27:24
    - 2019-10-10 18:04:57
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-03-19 12:09:33, 2019-03-31 02:53:21]'
    );
  params:
  - - 2019-03-19 12:09:33
    - 2019-03-31 02:53:21
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-06-27 23:16:32, 2019-07-05 06:47:01]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-06-27 23:16:32
    - 2019-07-05 06:47:01
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Aegina;MULTIPOLYGON(((23.429254 37.7433915'
    );
  params:
  - Aegina;MULTIPOLYGON(((23.429254 37.7433915
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-09-19 06:48:46, 2019-10-02 16:40:23]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-09-19 06:48:46
    - 2019-10-02 16:40:23
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-08-30 03:09:09, 2019-09-08 07:54:40]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'AGISTRI';
  params:
  - AGISTRI
  - - 2019-08-30 03:09:09
    - 2019-09-08 07:54:40
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-05-29 09:54:04, 2019-06-08 00:50:05]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-05-29 09:54:04
    - 2019-06-08 00:50:05
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-08-16 14:52:50, 2019-08-21 19:47:39]'
    );
  params:
  - - 2019-08-16 14:52:50
    - 2019-08-21 19:47:39
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-02-27 07:32:37, 2019-03-04 00:09:11]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-02-27 07:32:37
    - 2019-03-04 00:09:11
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Nisis Islet;MULTIPOLYGON(((23.3837032 37.8100009'
    );
  params:
  - Nisis Islet;MULTIPOLYGON(((23.3837032 37.8100009
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-06-05' - tp '3d' AND epoch '2019-06-05' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-06-05' AND hour(t_start) = 7);
  params:
  - '2019-06-05'
  - 7
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-12-07 16:52:34, 2019-12-18 20:52:49]'
    );
  params:
  - - 2019-12-07 16:52:34
    - 2019-12-18 20:52:49
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-10-29 15:06:51, 2019-11-05 23:55:01]'
    );
  params:
  - - 2019-10-29 15:06:51
    - 2019-11-05 23:55:01
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'SIRI'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'SIRI'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - SIRI
  - PERAMA
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FANEROMENI'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FANEROMENI'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - FANEROMENI
  - FLISVOS
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-08-30 15:24:42, 2019-09-03 03:41:48]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-08-30 15:24:42
    - 2019-09-03 03:41:48
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-02-18 14:28:18, 2019-02-22 05:22:20]'
    );
  params:
  - - 2019-02-18 14:28:18
    - 2019-02-22 05:22:20
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FALIRO'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FALIRO'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - FALIRO
  - SIRI
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-11-08 22:45:04, 2019-11-21 06:37:00]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-11-08 22:45:04
    - 2019-11-21 06:37:00
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-02-16 20:26:11, 2019-02-20 13:22:20]'
    );
  params:
  - - 2019-02-16 20:26:11
    - 2019-02-20 13:22:20
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'LAVRIO'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'LAVRIO'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - LAVRIO
  - GLYFADA
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-07-30 23:02:18, 2019-08-13 14:18:05]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-07-30 23:02:18
    - 2019-08-13 14:18:05
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-04-17 09:12:28, 2019-04-29 06:01:18]'
    );
  params:
  - - 2019-04-17 09:12:28
    - 2019-04-29 06:01:18
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Nisis Lagousa;MULTIPOLYGON(((23.4656702 37.8165137'
    );
  params:
  - Nisis Lagousa;MULTIPOLYGON(((23.4656702 37.8165137
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-05-06 01:15:02, 2019-05-16 14:12:10]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-05-06 01:15:02
    - 2019-05-16 14:12:10
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-05-18 08:12:06, 2019-05-28 23:14:26]'
    );
  params:
  - - 2019-05-18 08:12:06
    - 2019-05-28 23:14:26
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'ELEFSIS'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'ELEFSIS'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - ELEFSIS
  - AEGINA
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'CORINTH'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'CORINTH'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - CORINTH
  - ERMIONI
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-07-14 05:10:49, 2019-07-17 22:05:18]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-07-14 05:10:49
    - 2019-07-17 22:05:18
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-12-02' - tp '3d' AND epoch '2019-12-02' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-12-02' AND hour(t_start) = 16);
  params:
  - '2019-12-02'
  - 16
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FANEROMENI'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FANEROMENI'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - FANEROMENI
  - ALIMOS
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-01-25 13:34:39, 2019-02-03 01:22:04]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'SOUSAKI';
  params:
  - SOUSAKI
  - - 2019-01-25 13:34:39
    - 2019-02-03 01:22:04
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'AEGINA'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'AEGINA'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - AEGINA
  - FALIRO
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'ERMIONI'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'ERMIONI'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - ERMIONI
  - SOUSAKI
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-10-13 09:11:42, 2019-10-28 07:27:08]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'PERAMA';
  params:
  - PERAMA
  - - 2019-10-13 09:11:42
    - 2019-10-28 07:27:08
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-06-26 03:58:50, 2019-07-04 21:55:05]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'ERMIONI';
  params:
  - ERMIONI
  - - 2019-06-26 03:58:50
    - 2019-07-04 21:55:05
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-08-02' - tp '3d' AND epoch '2019-08-02' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-08-02' AND hour(t_start) = 20);
  params:
  - '2019-08-02'
  - 20
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-12-16' - tp '3d' AND epoch '2019-12-16' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-12-16' AND hour(t_start) = 10);
  params:
  - '2019-12-16'
  - 10
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-03-09 21:14:05, 2019-03-23 02:23:16]'
    );
  params:
  - - 2019-03-09 21:14:05
    - 2019-03-23 02:23:16
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'PIRAEUS'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'PIRAEUS'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - PIRAEUS
  - FLISVOS
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-05-20' - tp '3d' AND epoch '2019-05-20' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-05-20' AND hour(t_start) = 10);
  params:
  - '2019-05-20'
  - 10
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Kordeliaris;MULTIPOLYGON(((23.4447276 37.8178127'
    );
  params:
  - Kordeliaris;MULTIPOLYGON(((23.4447276 37.8178127
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-11-28 14:33:45, 2019-12-04 22:50:32]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-11-28 14:33:45
    - 2019-12-04 22:50:32
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-10-26 17:50:21, 2019-10-29 18:09:50]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-10-26 17:50:21
    - 2019-10-29 18:09:50
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-03-04' - tp '3d' AND epoch '2019-03-04' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-03-04' AND hour(t_start) = 1);
  params:
  - '2019-03-04'
  - 1
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'SOUSAKI'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'SOUSAKI'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - SOUSAKI
  - FANEROMENI
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-03-09 20:54:54, 2019-03-12 23:43:17]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'FLISVOS';
  params:
  - FLISVOS
  - - 2019-03-09 20:54:54
    - 2019-03-12 23:43:17
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Agistri;MULTIPOLYGON(((23.3404791 37.6728988'
    );
  params:
  - Agistri;MULTIPOLYGON(((23.3404791 37.6728988
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-05-04' - tp '3d' AND epoch '2019-05-04' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-05-04' AND hour(t_start) = 16);
  params:
  - '2019-05-04'
  - 16
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-10-19 11:37:04, 2019-10-23 04:20:16]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'ZEA';
  params:
  - ZEA
  - - 2019-10-19 11:37:04
    - 2019-10-23 04:20:16
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Ovrios;MULTIPOLYGON(((23.1410247 37.8584852'
    );
  params:
  - Ovrios;MULTIPOLYGON(((23.1410247 37.8584852
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-05-14 01:37:40, 2019-05-23 17:42:03]'
    );
  params:
  - - 2019-05-14 01:37:40
    - 2019-05-23 17:42:03
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'PERAMA'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'PERAMA'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - PERAMA
  - GLYFADA
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-04-17 13:25:20, 2019-04-20 03:49:36]'
    );
  params:
  - - 2019-04-17 13:25:20
    - 2019-04-20 03:49:36
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-12-16 05:04:27, 2019-12-22 01:39:29]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-12-16 05:04:27
    - 2019-12-22 01:39:29
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'AEGINA'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'AEGINA'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - AEGINA
  - ERMIONI
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Nisis Ledou;MULTIPOLYGON(((23.2590042 37.8010783'
    );
  params:
  - Nisis Ledou;MULTIPOLYGON(((23.2590042 37.8010783
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-01-03 14:03:18, 2019-01-15 07:14:17]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-01-03 14:03:18
    - 2019-01-15 07:14:17
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-06-01 03:15:53, 2019-06-12 03:01:48]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-06-01 03:15:53
    - 2019-06-12 03:01:48
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-04-29' - tp '3d' AND epoch '2019-04-29' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-04-29' AND hour(t_start) = 9);
  params:
  - '2019-04-29'
  - 9
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-07-18 17:46:08, 2019-07-28 14:21:03]'
    );
  params:
  - - 2019-07-18 17:46:08
    - 2019-07-28 14:21:03
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Ydrousa;MULTIPOLYGON(((23.7440149 37.8343154'
    );
  params:
  - Ydrousa;MULTIPOLYGON(((23.7440149 37.8343154
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-03-24 22:30:05, 2019-04-06 21:50:50]'
    );
  params:
  - - 2019-03-24 22:30:05
    - 2019-04-06 21:50:50
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-09-17' - tp '3d' AND epoch '2019-09-17' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-09-17' AND hour(t_start) = 11);
  params:
  - '2019-09-17'
  - 11
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-01-13 19:00:55, 2019-01-16 15:56:59]'
    );
  params:
  - - 2019-01-13 19:00:55
    - 2019-01-16 15:56:59
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-09-23 21:29:50, 2019-09-26 16:18:07]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-09-23 21:29:50
    - 2019-09-26 16:18:07
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Vrachonisis Tragonisi;MULTIPOLYGON(((23.2444035 37.8027381'
    );
  params:
  - Vrachonisis Tragonisi;MULTIPOLYGON(((23.2444035 37.8027381
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-07-06 23:56:52, 2019-07-17 03:53:28]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-07-06 23:56:52
    - 2019-07-17 03:53:28
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-09-20 00:25:47, 2019-10-03 07:16:03]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-09-20 00:25:47
    - 2019-10-03 07:16:03
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'AEGINA'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'AEGINA'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - AEGINA
  - PERAMA
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-06-04' - tp '3d' AND epoch '2019-06-04' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-06-04' AND hour(t_start) = 1);
  params:
  - '2019-06-04'
  - 1
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Nisis Pachaki;MULTIPOLYGON(((23.3614704 37.9692519'
    );
  params:
  - Nisis Pachaki;MULTIPOLYGON(((23.3614704 37.9692519
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-09-20' - tp '3d' AND epoch '2019-09-20' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-09-20' AND hour(t_start) = 3);
  params:
  - '2019-09-20'
  - 3
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-11-14 04:27:54, 2019-11-22 18:12:45]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'AGIOI THEODORI';
  params:
  - AGIOI THEODORI
  - - 2019-11-14 04:27:54
    - 2019-11-22 18:12:45
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-10-14' - tp '3d' AND epoch '2019-10-14' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-10-14' AND hour(t_start) = 17);
  params:
  - '2019-10-14'
  - 17
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'AGISTRI'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'AGISTRI'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - AGISTRI
  - GLYFADA
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-05-10' - tp '3d' AND epoch '2019-05-10' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-05-10' AND hour(t_start) = 7);
  params:
  - '2019-05-10'
  - 7
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-01-24 02:53:44, 2019-02-06 15:41:23]'
    );
  params:
  - - 2019-01-24 02:53:44
    - 2019-02-06 15:41:23
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-04-02 22:13:39, 2019-04-08 04:29:00]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'ELEFSIS';
  params:
  - ELEFSIS
  - - 2019-04-02 22:13:39
    - 2019-04-08 04:29:00
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-11-18 23:57:33, 2019-11-23 15:49:00]'
    );
  params:
  - - 2019-11-18 23:57:33
    - 2019-11-23 15:49:00
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-09-05' - tp '3d' AND epoch '2019-09-05' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-09-05' AND hour(t_start) = 7);
  params:
  - '2019-09-05'
  - 7
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Agios Ioannis;MULTIPOLYGON(((23.2585002 37.8163195'
    );
  params:
  - Agios Ioannis;MULTIPOLYGON(((23.2585002 37.8163195
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-06-21 10:50:49, 2019-06-30 23:25:16]'
    );
  params:
  - - 2019-06-21 10:50:49
    - 2019-06-30 23:25:16
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-06-03 10:38:40, 2019-06-11 08:34:33]'
    );
  params:
  - - 2019-06-03 10:38:40
    - 2019-06-11 08:34:33
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'ELEFSIS'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'ELEFSIS'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - ELEFSIS
  - AGIOS KOSMAS
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-10-20 05:59:54, 2019-11-01 14:25:19]'
    );
  params:
  - - 2019-10-20 05:59:54
    - 2019-11-01 14:25:19
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-08-19' - tp '3d' AND epoch '2019-08-19' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-08-19' AND hour(t_start) = 15);
  params:
  - '2019-08-19'
  - 15
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-07-08 10:32:53, 2019-07-14 09:23:03]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-07-08 10:32:53
    - 2019-07-14 09:23:03
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-07-19 13:05:02, 2019-07-22 13:04:18]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'AGIOI THEODORI';
  params:
  - AGIOI THEODORI
  - - 2019-07-19 13:05:02
    - 2019-07-22 13:04:18
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-11-29 13:18:50, 2019-12-04 00:15:31]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'FALIRO';
  params:
  - FALIRO
  - - 2019-11-29 13:18:50
    - 2019-12-04 00:15:31
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'CORINTH'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'CORINTH'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - CORINTH
  - PIRAEUS
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Daskalio;MULTIPOLYGON(((23.4300353 37.5166044'
    );
  params:
  - Daskalio;MULTIPOLYGON(((23.4300353 37.5166044
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-03-09' - tp '3d' AND epoch '2019-03-09' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-03-09' AND hour(t_start) = 17);
  params:
  - '2019-03-09'
  - 17
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Agios Thomas;MULTIPOLYGON(((23.2497482 37.8055013'
    );
  params:
  - Agios Thomas;MULTIPOLYGON(((23.2497482 37.8055013
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-07-14 14:21:07, 2019-07-27 18:50:34]'
    );
  params:
  - - 2019-07-14 14:21:07
    - 2019-07-27 18:50:34
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-10-22 00:01:07, 2019-10-27 17:49:05]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-10-22 00:01:07
    - 2019-10-27 17:49:05
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-06-08 19:49:53, 2019-06-16 14:24:34]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'AGIOI THEODORI';
  params:
  - AGIOI THEODORI
  - - 2019-06-08 19:49:53
    - 2019-06-16 14:24:34
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-09-16' - tp '3d' AND epoch '2019-09-16' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-09-16' AND hour(t_start) = 3);
  params:
  - '2019-09-16'
  - 3
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-10-21 10:44:05, 2019-10-25 19:26:36]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-10-21 10:44:05
    - 2019-10-25 19:26:36
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'ELEFSIS'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'ELEFSIS'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - ELEFSIS
  - FLISVOS
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FLISVOS'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FLISVOS'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - FLISVOS
  - LAVRIO
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-01-24 23:59:25, 2019-02-08 00:16:12]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'SOUSAKI';
  params:
  - SOUSAKI
  - - 2019-01-24 23:59:25
    - 2019-02-08 00:16:12
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Psittalia;MULTIPOLYGON(((23.5806238 37.9366858'
    );
  params:
  - Psittalia;MULTIPOLYGON(((23.5806238 37.9366858
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'ERMIONI'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'ERMIONI'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - ERMIONI
  - AGIOI THEODORI
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-03-11' - tp '3d' AND epoch '2019-03-11' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-03-11' AND hour(t_start) = 4);
  params:
  - '2019-03-11'
  - 4
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-05-28' - tp '3d' AND epoch '2019-05-28' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-05-28' AND hour(t_start) = 1);
  params:
  - '2019-05-28'
  - 1
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Kourmouloudes;MULTIPOLYGON(((23.3193627 37.8000988'
    );
  params:
  - Kourmouloudes;MULTIPOLYGON(((23.3193627 37.8000988
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-01-13 22:04:44, 2019-01-26 07:16:27]'
    );
  params:
  - - 2019-01-13 22:04:44
    - 2019-01-26 07:16:27
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-09-01' - tp '3d' AND epoch '2019-09-01' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-09-01' AND hour(t_start) = 1);
  params:
  - '2019-09-01'
  - 1
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-06-04' - tp '3d' AND epoch '2019-06-04' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-06-04' AND hour(t_start) = 8);
  params:
  - '2019-06-04'
  - 8
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-12-06 21:34:54, 2019-12-21 06:28:26]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-12-06 21:34:54
    - 2019-12-21 06:28:26
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-03-29 02:01:17, 2019-04-07 22:17:06]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'ELEFSIS';
  params:
  - ELEFSIS
  - - 2019-03-29 02:01:17
    - 2019-04-07 22:17:06
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'RAFINA'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'RAFINA'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - RAFINA
  - ALIMOS
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-02-17' - tp '3d' AND epoch '2019-02-17' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-02-17' AND hour(t_start) = 12);
  params:
  - '2019-02-17'
  - 12
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FALIRO'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FALIRO'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - FALIRO
  - PIRAEUS
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-10-18 09:19:18, 2019-10-29 06:16:10]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-10-18 09:19:18
    - 2019-10-29 06:16:10
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-11-02' - tp '3d' AND epoch '2019-11-02' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-11-02' AND hour(t_start) = 20);
  params:
  - '2019-11-02'
  - 20
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-11-23' - tp '3d' AND epoch '2019-11-23' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-11-23' AND hour(t_start) = 8);
  params:
  - '2019-11-23'
  - 8
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'AEGINA'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'AEGINA'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - AEGINA
  - ASPROPYRGOS
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'AEGINA'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'AEGINA'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - AEGINA
  - ZEA
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Nisis Metopi;MULTIPOLYGON(((23.3772365 37.7192176'
    );
  params:
  - Nisis Metopi;MULTIPOLYGON(((23.3772365 37.7192176
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'PERAMA'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'PERAMA'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - PERAMA
  - ALIMOS
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-12-30 18:35:10, 2019-12-31 23:59:59]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-12-30 18:35:10
    - 2019-12-31 23:59:59
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-03-24' - tp '3d' AND epoch '2019-03-24' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-03-24' AND hour(t_start) = 5);
  params:
  - '2019-03-24'
  - 5
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'AGIOI THEODORI'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'AGIOI THEODORI'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - AGIOI THEODORI
  - ERMIONI
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-06-04 01:19:05, 2019-06-13 06:49:26]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'AEGINA';
  params:
  - AEGINA
  - - 2019-06-04 01:19:05
    - 2019-06-13 06:49:26
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-01-11 11:54:09, 2019-01-20 00:02:24]'
    );
  params:
  - - 2019-01-11 11:54:09
    - 2019-01-20 00:02:24
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-01-11 14:20:18, 2019-01-21 09:58:57]'
    );
  params:
  - - 2019-01-11 14:20:18
    - 2019-01-21 09:58:57
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-03-23 12:41:32, 2019-03-28 00:27:34]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-03-23 12:41:32
    - 2019-03-28 00:27:34
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FLISVOS'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FLISVOS'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - FLISVOS
  - SIRI
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-03-16 09:28:24, 2019-03-20 14:06:49]'
    );
  params:
  - - 2019-03-16 09:28:24
    - 2019-03-20 14:06:49
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-03-23 06:57:45, 2019-03-26 20:37:27]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'ELEFSIS';
  params:
  - ELEFSIS
  - - 2019-03-23 06:57:45
    - 2019-03-26 20:37:27
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'CORINTH'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'CORINTH'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - CORINTH
  - ERMIONI
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Vrachonisis Moladi;MULTIPOLYGON(((23.2857762 37.8099715'
    );
  params:
  - Vrachonisis Moladi;MULTIPOLYGON(((23.2857762 37.8099715
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-05-23 01:22:21, 2019-05-29 13:47:39]'
    );
  params:
  - - 2019-05-23 01:22:21
    - 2019-05-29 13:47:39
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-09-06 05:14:26, 2019-09-15 22:33:10]'
    );
  params:
  - - 2019-09-06 05:14:26
    - 2019-09-15 22:33:10
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-05-05 19:34:10, 2019-05-08 19:20:14]'
    );
  params:
  - - 2019-05-05 19:34:10
    - 2019-05-08 19:20:14
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-09-14 17:30:09, 2019-09-27 00:35:06]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'GLYFADA';
  params:
  - GLYFADA
  - - 2019-09-14 17:30:09
    - 2019-09-27 00:35:06
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Aegina Moni;MULTIPOLYGON(((23.4230677 37.68617'
    );
  params:
  - Aegina Moni;MULTIPOLYGON(((23.4230677 37.68617
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-03-29 16:58:17, 2019-04-12 22:30:53]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'SIRI';
  params:
  - SIRI
  - - 2019-03-29 16:58:17
    - 2019-04-12 22:30:53
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-01-18 13:50:15, 2019-01-23 13:29:56]'
    );
  params:
  - - 2019-01-18 13:50:15
    - 2019-01-23 13:29:56
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-10-11 01:14:15, 2019-10-13 16:09:13]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'SOUSAKI';
  params:
  - SOUSAKI
  - - 2019-10-11 01:14:15
    - 2019-10-13 16:09:13
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-10-02 13:19:15, 2019-10-05 02:27:38]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-10-02 13:19:15
    - 2019-10-05 02:27:38
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-04-03' - tp '3d' AND epoch '2019-04-03' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-04-03' AND hour(t_start) = 2);
  params:
  - '2019-04-03'
  - 2
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-03-12 06:59:32, 2019-03-15 08:12:52]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'RAFINA';
  params:
  - RAFINA
  - - 2019-03-12 06:59:32
    - 2019-03-15 08:12:52
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'GLYFADA'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'GLYFADA'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - GLYFADA
  - LAVRIO
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-05-12 14:36:04, 2019-05-14 20:59:40]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'ASPROPYRGOS';
  params:
  - ASPROPYRGOS
  - - 2019-05-12 14:36:04
    - 2019-05-14 20:59:40
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-07-17 23:48:20, 2019-07-20 15:29:03]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'FANEROMENI';
  params:
  - FANEROMENI
  - - 2019-07-17 23:48:20
    - 2019-07-20 15:29:03
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-10-03 05:01:58, 2019-10-13 19:51:35]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-10-03 05:01:58
    - 2019-10-13 19:51:35
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-09-22' - tp '3d' AND epoch '2019-09-22' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-09-22' AND hour(t_start) = 10);
  params:
  - '2019-09-22'
  - 10
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-07-08 23:23:38, 2019-07-20 12:35:03]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'ALIMOS';
  params:
  - ALIMOS
  - - 2019-07-08 23:23:38
    - 2019-07-20 12:35:03
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Thorussa;MULTIPOLYGON(((23.3173612 37.6775666'
    );
  params:
  - Thorussa;MULTIPOLYGON(((23.3173612 37.6775666
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-11-25 19:35:42, 2019-12-09 19:17:46]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'FALIRO';
  params:
  - FALIRO
  - - 2019-11-25 19:35:42
    - 2019-12-09 19:17:46
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-09-28 00:51:29, 2019-10-10 19:54:50]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'AGIOS KOSMAS';
  params:
  - AGIOS KOSMAS
  - - 2019-09-28 00:51:29
    - 2019-10-10 19:54:50
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'SOUSAKI'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'SOUSAKI'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - SOUSAKI
  - ERMIONI
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-04-13 06:08:36, 2019-04-16 23:08:24]'
    );
  params:
  - - 2019-04-13 06:08:36
    - 2019-04-16 23:08:24
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-08-15 19:42:36, 2019-08-20 16:33:03]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'FANEROMENI';
  params:
  - FANEROMENI
  - - 2019-08-15 19:42:36
    - 2019-08-20 16:33:03
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-11-16 12:42:26, 2019-11-25 12:20:33]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-11-16 12:42:26
    - 2019-11-25 12:20:33
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-08-08 13:38:24, 2019-08-14 23:10:03]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'CORINTH CANAL';
  params:
  - CORINTH CANAL
  - - 2019-08-08 13:38:24
    - 2019-08-14 23:10:03
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-07-22 14:57:44, 2019-08-05 01:05:19]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-07-22 14:57:44
    - 2019-08-05 01:05:19
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-06-22 00:30:19, 2019-07-02 13:24:36]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-06-22 00:30:19
    - 2019-07-02 13:24:36
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Anagnostis;MULTIPOLYGON(((23.3243555 37.8063016'
    );
  params:
  - Anagnostis;MULTIPOLYGON(((23.3243555 37.8063016
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-03-23 03:50:06, 2019-03-28 07:00:34]'
    );
  params:
  - - 2019-03-23 03:50:06
    - 2019-03-28 07:00:34
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Aponissos;MULTIPOLYGON(((23.3228714 37.6837864'
    );
  params:
  - Aponissos;MULTIPOLYGON(((23.3228714 37.6837864
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-11-30 00:31:15, 2019-12-03 10:40:45]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-11-30 00:31:15
    - 2019-12-03 10:40:45
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-11-06 18:35:26, 2019-11-15 08:17:24]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'ZEA';
  params:
  - ZEA
  - - 2019-11-06 18:35:26
    - 2019-11-15 08:17:24
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-09-22 02:46:06, 2019-10-03 04:02:53]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'ZEA';
  params:
  - ZEA
  - - 2019-09-22 02:46:06
    - 2019-10-03 04:02:53
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-12-21 12:47:49, 2019-12-31 20:11:25]'
    );
  params:
  - - 2019-12-21 12:47:49
    - 2019-12-31 20:11:25
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-06-05 13:41:06, 2019-06-11 23:59:53]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'SIRI';
  params:
  - SIRI
  - - 2019-06-05 13:41:06
    - 2019-06-11 23:59:53
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Nisis Ledou;MULTIPOLYGON(((23.2590042 37.8010783'
    );
  params:
  - Nisis Ledou;MULTIPOLYGON(((23.2590042 37.8010783
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-06-13 16:46:16, 2019-06-23 10:41:03]'
    );
  params:
  - - 2019-06-13 16:46:16
    - 2019-06-23 10:41:03
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-04-17' - tp '3d' AND epoch '2019-04-17' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-04-17' AND hour(t_start) = 2);
  params:
  - '2019-04-17'
  - 2
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'RAFINA'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'RAFINA'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - RAFINA
  - ERMIONI
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Kanakia;MULTIPOLYGON(((23.3941818 37.9040603'
    );
  params:
  - Kanakia;MULTIPOLYGON(((23.3941818 37.9040603
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FANEROMENI'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FANEROMENI'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - FANEROMENI
  - FALIRO
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-10-30 07:46:40, 2019-11-13 12:55:48]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'ERMIONI';
  params:
  - ERMIONI
  - - 2019-10-30 07:46:40
    - 2019-11-13 12:55:48
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Agios Thomas;MULTIPOLYGON(((23.2497482 37.8055013'
    );
  params:
  - Agios Thomas;MULTIPOLYGON(((23.2497482 37.8055013
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-04-22 03:20:54, 2019-04-28 02:26:40]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-04-22 03:20:54
    - 2019-04-28 02:26:40
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'AEGINA'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'AEGINA'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - AEGINA
  - ZEA
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-06-22 15:34:02, 2019-06-26 08:40:12]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'AGISTRI';
  params:
  - AGISTRI
  - - 2019-06-22 15:34:02
    - 2019-06-26 08:40:12
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-02-16 12:50:34, 2019-02-27 16:17:00]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'ALIMOS';
  params:
  - ALIMOS
  - - 2019-02-16 12:50:34
    - 2019-02-27 16:17:00
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-01-31' - tp '3d' AND epoch '2019-01-31' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-01-31' AND hour(t_start) = 12);
  params:
  - '2019-01-31'
  - 12
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Ydrousa;MULTIPOLYGON(((23.7440149 37.8343154'
    );
  params:
  - Ydrousa;MULTIPOLYGON(((23.7440149 37.8343154
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-02-18 00:29:36, 2019-03-03 17:33:27]'
    );
  params:
  - - 2019-02-18 00:29:36
    - 2019-03-03 17:33:27
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FANEROMENI'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FANEROMENI'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - FANEROMENI
  - FANEROMENI
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-09-28 20:49:32, 2019-10-13 10:39:01]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'AGIOI THEODORI';
  params:
  - AGIOI THEODORI
  - - 2019-09-28 20:49:32
    - 2019-10-13 10:39:01
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'CORINTH'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'CORINTH'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - CORINTH
  - ERMIONI
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-05-16 13:07:32, 2019-05-23 21:25:12]'
    );
  params:
  - - 2019-05-16 13:07:32
    - 2019-05-23 21:25:12
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-12-17 00:25:14, 2019-12-30 14:19:53]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-12-17 00:25:14
    - 2019-12-30 14:19:53
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-02-26 18:11:23, 2019-03-10 14:51:57]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-02-26 18:11:23
    - 2019-03-10 14:51:57
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-11-20 22:48:04, 2019-12-03 04:49:40]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-11-20 22:48:04
    - 2019-12-03 04:49:40
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-06-24 08:45:20, 2019-06-27 03:27:58]'
    );
  params:
  - - 2019-06-24 08:45:20
    - 2019-06-27 03:27:58
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Agistri;MULTIPOLYGON(((23.3404791 37.6728988'
    );
  params:
  - Agistri;MULTIPOLYGON(((23.3404791 37.6728988
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-03-15 08:37:26, 2019-03-29 01:04:19]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-03-15 08:37:26
    - 2019-03-29 01:04:19
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-03-14 00:10:46, 2019-03-26 17:59:47]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-03-14 00:10:46
    - 2019-03-26 17:59:47
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-07-24 02:37:50, 2019-08-01 04:45:50]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-07-24 02:37:50
    - 2019-08-01 04:45:50
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-05-12 13:50:33, 2019-05-16 15:56:32]'
    );
  params:
  - - 2019-05-12 13:50:33
    - 2019-05-16 15:56:32
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-12-17 06:53:18, 2019-12-25 07:19:17]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-12-17 06:53:18
    - 2019-12-25 07:19:17
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-03-14 16:44:01, 2019-03-21 03:05:47]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-03-14 16:44:01
    - 2019-03-21 03:05:47
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-12-24 02:54:44, 2019-12-31 23:59:59]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-12-24 02:54:44
    - 2019-12-31 23:59:59
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'AGIOI THEODORI'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'AGIOI THEODORI'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - AGIOI THEODORI
  - PIRAEUS
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-09-19 10:29:43, 2019-09-29 23:01:34]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-09-19 10:29:43
    - 2019-09-29 23:01:34
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-06-13 05:31:31, 2019-06-22 18:45:46]'
    );
  params:
  - - 2019-06-13 05:31:31
    - 2019-06-22 18:45:46
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-02-08' - tp '3d' AND epoch '2019-02-08' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-02-08' AND hour(t_start) = 1);
  params:
  - '2019-02-08'
  - 1
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-06-19 10:47:09, 2019-06-21 19:25:13]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'PERAMA';
  params:
  - PERAMA
  - - 2019-06-19 10:47:09
    - 2019-06-21 19:25:13
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-10-08 12:53:51, 2019-10-22 03:08:54]'
    );
  params:
  - - 2019-10-08 12:53:51
    - 2019-10-22 03:08:54
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-07-02 09:02:54, 2019-07-06 23:44:15]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'AEGINA';
  params:
  - AEGINA
  - - 2019-07-02 09:02:54
    - 2019-07-06 23:44:15
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-12-25 02:48:15, 2019-12-30 10:53:53]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-12-25 02:48:15
    - 2019-12-30 10:53:53
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-03-24 22:18:30, 2019-04-06 00:56:19]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-03-24 22:18:30
    - 2019-04-06 00:56:19
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Nisis Atalanti;MULTIPOLYGON(((23.5716686 37.9346175'
    );
  params:
  - Nisis Atalanti;MULTIPOLYGON(((23.5716686 37.9346175
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-04-11 02:28:19, 2019-04-24 02:13:11]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-04-11 02:28:19
    - 2019-04-24 02:13:11
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-07-04 01:07:28, 2019-07-12 11:07:20]'
    );
  params:
  - - 2019-07-04 01:07:28
    - 2019-07-12 11:07:20
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-03-29 11:09:04, 2019-04-11 09:03:48]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'ERMIONI';
  params:
  - ERMIONI
  - - 2019-03-29 11:09:04
    - 2019-04-11 09:03:48
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-04-27 13:25:57, 2019-04-29 18:29:10]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-04-27 13:25:57
    - 2019-04-29 18:29:10
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-02-05 19:26:16, 2019-02-11 19:54:05]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-02-05 19:26:16
    - 2019-02-11 19:54:05
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Nisis Stakhtorroyi;MULTIPOLYGON(((23.3608955 37.8141731'
    );
  params:
  - Nisis Stakhtorroyi;MULTIPOLYGON(((23.3608955 37.8141731
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Vrachonisis Moladi;MULTIPOLYGON(((23.2857762 37.8099715'
    );
  params:
  - Vrachonisis Moladi;MULTIPOLYGON(((23.2857762 37.8099715
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-06-02' - tp '3d' AND epoch '2019-06-02' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-06-02' AND hour(t_start) = 20);
  params:
  - '2019-06-02'
  - 20
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Makronisos;MULTIPOLYGON(((23.4103812 37.967855'
    );
  params:
  - Makronisos;MULTIPOLYGON(((23.4103812 37.967855
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'AGIOI THEODORI'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'AGIOI THEODORI'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - AGIOI THEODORI
  - AGIOI THEODORI
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Nisis Ipsili;MULTIPOLYGON(((23.337696 37.7981419'
    );
  params:
  - Nisis Ipsili;MULTIPOLYGON(((23.337696 37.7981419
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-04-24 08:53:24, 2019-05-02 19:38:19]'
    );
  params:
  - - 2019-04-24 08:53:24
    - 2019-05-02 19:38:19
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-03-03 13:06:28, 2019-03-13 01:31:11]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'AGISTRI';
  params:
  - AGISTRI
  - - 2019-03-03 13:06:28
    - 2019-03-13 01:31:11
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'AGIOS KOSMAS'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'AGIOS KOSMAS'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - AGIOS KOSMAS
  - PIRAEUS
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-05-18 21:30:15, 2019-05-22 14:26:07]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-05-18 21:30:15
    - 2019-05-22 14:26:07
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-12-17 05:40:00, 2019-12-31 19:00:54]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'AGIOI THEODORI';
  params:
  - AGIOI THEODORI
  - - 2019-12-17 05:40:00
    - 2019-12-31 19:00:54
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-05-07 16:58:21, 2019-05-14 17:54:59]'
    );
  params:
  - - 2019-05-07 16:58:21
    - 2019-05-14 17:54:59
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Makronisos;MULTIPOLYGON(((23.4103812 37.967855'
    );
  params:
  - Makronisos;MULTIPOLYGON(((23.4103812 37.967855
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-11-16 10:38:56, 2019-11-26 22:31:35]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'GLYFADA';
  params:
  - GLYFADA
  - - 2019-11-16 10:38:56
    - 2019-11-26 22:31:35
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Agios Thomas;MULTIPOLYGON(((23.2497482 37.8055013'
    );
  params:
  - Agios Thomas;MULTIPOLYGON(((23.2497482 37.8055013
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Trakhyli;MULTIPOLYGON(((23.1764033 37.7162605'
    );
  params:
  - Trakhyli;MULTIPOLYGON(((23.1764033 37.7162605
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Gaidaros;MULTIPOLYGON(((23.4626953 37.8138297'
    );
  params:
  - Gaidaros;MULTIPOLYGON(((23.4626953 37.8138297
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Spalaphtronisi Islet;MULTIPOLYGON(((23.2363612 37.7013733'
    );
  params:
  - Spalaphtronisi Islet;MULTIPOLYGON(((23.2363612 37.7013733
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Anagnostis;MULTIPOLYGON(((23.3243555 37.8063016'
    );
  params:
  - Anagnostis;MULTIPOLYGON(((23.3243555 37.8063016
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-05-01 12:29:28, 2019-05-04 21:23:48]'
    );
  params:
  - - 2019-05-01 12:29:28
    - 2019-05-04 21:23:48
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FLISVOS'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FLISVOS'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - FLISVOS
  - ASPROPYRGOS
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-02-28 22:12:33, 2019-03-10 13:23:51]'
    );
  params:
  - - 2019-02-28 22:12:33
    - 2019-03-10 13:23:51
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-04-25 22:01:01, 2019-05-08 10:54:30]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'SIRI';
  params:
  - SIRI
  - - 2019-04-25 22:01:01
    - 2019-05-08 10:54:30
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-09-29 03:02:38, 2019-10-13 08:21:10]'
    );
  params:
  - - 2019-09-29 03:02:38
    - 2019-10-13 08:21:10
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-05-16 17:56:04, 2019-05-22 07:22:30]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'AGIOI THEODORI';
  params:
  - AGIOI THEODORI
  - - 2019-05-16 17:56:04
    - 2019-05-22 07:22:30
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Kanakia;MULTIPOLYGON(((23.3941818 37.9040603'
    );
  params:
  - Kanakia;MULTIPOLYGON(((23.3941818 37.9040603
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-07-21 16:05:47, 2019-08-02 03:20:46]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-07-21 16:05:47
    - 2019-08-02 03:20:46
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Vrachonisis Moladi;MULTIPOLYGON(((23.2857762 37.8099715'
    );
  params:
  - Vrachonisis Moladi;MULTIPOLYGON(((23.2857762 37.8099715
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'CORINTH CANAL'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'CORINTH CANAL'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - CORINTH CANAL
  - ELEFSIS
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-09-29 20:30:47, 2019-10-08 15:17:40]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'AGIOS KOSMAS';
  params:
  - AGIOS KOSMAS
  - - 2019-09-29 20:30:47
    - 2019-10-08 15:17:40
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FANEROMENI'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FANEROMENI'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - FANEROMENI
  - AGIOS KOSMAS
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-05-16 08:13:14, 2019-05-26 09:11:09]'
    );
  params:
  - - 2019-05-16 08:13:14
    - 2019-05-26 09:11:09
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-10-07 19:03:50, 2019-10-19 05:50:31]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-10-07 19:03:50
    - 2019-10-19 05:50:31
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-12-29' - tp '3d' AND epoch '2019-12-29' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-12-29' AND hour(t_start) = 0);
  params:
  - '2019-12-29'
  - 0
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-12-04 21:37:36, 2019-12-12 12:46:56]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-12-04 21:37:36
    - 2019-12-12 12:46:56
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-07-22 04:01:53, 2019-07-29 09:20:01]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-07-22 04:01:53
    - 2019-07-29 09:20:01
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Ydrousa;MULTIPOLYGON(((23.7440149 37.8343154'
    );
  params:
  - Ydrousa;MULTIPOLYGON(((23.7440149 37.8343154
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-02-12 03:39:58, 2019-02-22 05:59:07]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'FLISVOS';
  params:
  - FLISVOS
  - - 2019-02-12 03:39:58
    - 2019-02-22 05:59:07
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Salamina;MULTIPOLYGON(((23.4052092 37.9299097'
    );
  params:
  - Salamina;MULTIPOLYGON(((23.4052092 37.9299097
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-08-16 12:20:52, 2019-08-22 05:37:06]'
    );
  params:
  - - 2019-08-16 12:20:52
    - 2019-08-22 05:37:06
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-10-14 10:35:51, 2019-10-16 12:46:49]'
    );
  params:
  - - 2019-10-14 10:35:51
    - 2019-10-16 12:46:49
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Prasou;MULTIPOLYGON(((23.2622469 37.8097209'
    );
  params:
  - Prasou;MULTIPOLYGON(((23.2622469 37.8097209
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Nisis Pachaki;MULTIPOLYGON(((23.3614704 37.9692519'
    );
  params:
  - Nisis Pachaki;MULTIPOLYGON(((23.3614704 37.9692519
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Agios Thomas;MULTIPOLYGON(((23.2497482 37.8055013'
    );
  params:
  - Agios Thomas;MULTIPOLYGON(((23.2497482 37.8055013
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-07-07 18:58:16, 2019-07-15 09:49:40]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'CORINTH CANAL';
  params:
  - CORINTH CANAL
  - - 2019-07-07 18:58:16
    - 2019-07-15 09:49:40
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-04-07 20:46:20, 2019-04-15 10:45:46]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-04-07 20:46:20
    - 2019-04-15 10:45:46
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-12-30 09:18:13, 2019-12-31 23:59:59]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'FLISVOS';
  params:
  - FLISVOS
  - - 2019-12-30 09:18:13
    - 2019-12-31 23:59:59
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'RAFINA'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'RAFINA'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - RAFINA
  - ZEA
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-05-31' - tp '3d' AND epoch '2019-05-31' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-05-31' AND hour(t_start) = 8);
  params:
  - '2019-05-31'
  - 8
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-03-20 12:55:28, 2019-03-22 20:27:03]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'AGISTRI';
  params:
  - AGISTRI
  - - 2019-03-20 12:55:28
    - 2019-03-22 20:27:03
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-12-20' - tp '3d' AND epoch '2019-12-20' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-12-20' AND hour(t_start) = 18);
  params:
  - '2019-12-20'
  - 18
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'ZEA'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'ZEA'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - ZEA
  - ZEA
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-11-27 23:06:08, 2019-12-03 05:37:44]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-11-27 23:06:08
    - 2019-12-03 05:37:44
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'SIRI'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'SIRI'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - SIRI
  - ERMIONI
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-10-28' - tp '3d' AND epoch '2019-10-28' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-10-28' AND hour(t_start) = 1);
  params:
  - '2019-10-28'
  - 1
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-03-06' - tp '3d' AND epoch '2019-03-06' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-03-06' AND hour(t_start) = 13);
  params:
  - '2019-03-06'
  - 13
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-08-30 21:33:28, 2019-09-13 07:58:50]'
    );
  params:
  - - 2019-08-30 21:33:28
    - 2019-09-13 07:58:50
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-05-01 00:09:31, 2019-05-11 10:03:27]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'AGISTRI';
  params:
  - AGISTRI
  - - 2019-05-01 00:09:31
    - 2019-05-11 10:03:27
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'CORINTH'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'CORINTH'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - CORINTH
  - ERMIONI
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-02-01 12:49:19, 2019-02-10 00:37:18]'
    );
  params:
  - - 2019-02-01 12:49:19
    - 2019-02-10 00:37:18
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-06-20 13:37:22, 2019-07-03 15:58:31]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'AGIOI THEODORI';
  params:
  - AGIOI THEODORI
  - - 2019-06-20 13:37:22
    - 2019-07-03 15:58:31
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-05-02' - tp '3d' AND epoch '2019-05-02' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-05-02' AND hour(t_start) = 21);
  params:
  - '2019-05-02'
  - 21
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-02-02 05:30:41, 2019-02-06 22:36:54]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-02-02 05:30:41
    - 2019-02-06 22:36:54
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-02-26 20:38:53, 2019-03-11 04:40:01]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'FALIRO';
  params:
  - FALIRO
  - - 2019-02-26 20:38:53
    - 2019-03-11 04:40:01
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-03-07 12:18:35, 2019-03-18 11:05:20]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-03-07 12:18:35
    - 2019-03-18 11:05:20
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-12-27 22:21:16, 2019-12-31 23:59:59]'
    );
  params:
  - - 2019-12-27 22:21:16
    - 2019-12-31 23:59:59
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-03-03' - tp '3d' AND epoch '2019-03-03' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-03-03' AND hour(t_start) = 14);
  params:
  - '2019-03-03'
  - 14
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-02-03 14:10:17, 2019-02-10 12:33:01]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-02-03 14:10:17
    - 2019-02-10 12:33:01
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-10-27 15:20:35, 2019-11-10 23:05:39]'
    );
  params:
  - - 2019-10-27 15:20:35
    - 2019-11-10 23:05:39
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Nisis Islet;MULTIPOLYGON(((23.3837032 37.8100009'
    );
  params:
  - Nisis Islet;MULTIPOLYGON(((23.3837032 37.8100009
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-09-26' - tp '3d' AND epoch '2019-09-26' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-09-26' AND hour(t_start) = 12);
  params:
  - '2019-09-26'
  - 12
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-01-03 07:12:09, 2019-01-13 15:19:24]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'CORINTH CANAL';
  params:
  - CORINTH CANAL
  - - 2019-01-03 07:12:09
    - 2019-01-13 15:19:24
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Aegina Moni;MULTIPOLYGON(((23.4230677 37.68617'
    );
  params:
  - Aegina Moni;MULTIPOLYGON(((23.4230677 37.68617
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FALIRO'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FALIRO'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - FALIRO
  - FLISVOS
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'PIRAEUS'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'PIRAEUS'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - PIRAEUS
  - SOUSAKI
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-09-15 04:29:13, 2019-09-26 17:22:13]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'SIRI';
  params:
  - SIRI
  - - 2019-09-15 04:29:13
    - 2019-09-26 17:22:13
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-12-23 09:45:49, 2019-12-31 10:27:17]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-12-23 09:45:49
    - 2019-12-31 10:27:17
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'ERMIONI'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'ERMIONI'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - ERMIONI
  - SIRI
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-03-30 15:59:45, 2019-04-09 20:12:28]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'CORINTH CANAL';
  params:
  - CORINTH CANAL
  - - 2019-03-30 15:59:45
    - 2019-04-09 20:12:28
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'PIRAEUS'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'PIRAEUS'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - PIRAEUS
  - AGISTRI
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-04-16 05:08:22, 2019-04-18 14:23:50]'
    );
  params:
  - - 2019-04-16 05:08:22
    - 2019-04-18 14:23:50
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Anagnostis;MULTIPOLYGON(((23.3243555 37.8063016'
    );
  params:
  - Anagnostis;MULTIPOLYGON(((23.3243555 37.8063016
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-08-19 02:04:43, 2019-08-23 00:56:18]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'AGISTRI';
  params:
  - AGISTRI
  - - 2019-08-19 02:04:43
    - 2019-08-23 00:56:18
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-04-05 01:01:49, 2019-04-09 16:11:16]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'ERMIONI';
  params:
  - ERMIONI
  - - 2019-04-05 01:01:49
    - 2019-04-09 16:11:16
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-01-22 16:12:22, 2019-02-01 22:58:53]'
    );
  params:
  - - 2019-01-22 16:12:22
    - 2019-02-01 22:58:53
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-09-22' - tp '3d' AND epoch '2019-09-22' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-09-22' AND hour(t_start) = 13);
  params:
  - '2019-09-22'
  - 13
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-01-15 00:51:06, 2019-01-29 07:13:31]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-01-15 00:51:06
    - 2019-01-29 07:13:31
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-03-15 16:25:54, 2019-03-29 20:13:01]'
    );
  params:
  - - 2019-03-15 16:25:54
    - 2019-03-29 20:13:01
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-12-04 15:56:07, 2019-12-15 21:33:05]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'CORINTH';
  params:
  - CORINTH
  - - 2019-12-04 15:56:07
    - 2019-12-15 21:33:05
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Kourmouloudes;MULTIPOLYGON(((23.3193627 37.8000988'
    );
  params:
  - Kourmouloudes;MULTIPOLYGON(((23.3193627 37.8000988
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FLISVOS'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FLISVOS'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - FLISVOS
  - PERAMA
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-04-20 07:02:34, 2019-04-25 12:12:44]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'RAFINA';
  params:
  - RAFINA
  - - 2019-04-20 07:02:34
    - 2019-04-25 12:12:44
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'CORINTH'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'CORINTH'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - CORINTH
  - LAVRIO
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Kavouronisi;MULTIPOLYGON(((23.7531549 37.8136342'
    );
  params:
  - Kavouronisi;MULTIPOLYGON(((23.7531549 37.8136342
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Ovrios;MULTIPOLYGON(((23.1410247 37.8584852'
    );
  params:
  - Ovrios;MULTIPOLYGON(((23.1410247 37.8584852
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-01-01 00:00:00, 2019-01-13 16:58:48]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'ELEFSIS';
  params:
  - ELEFSIS
  - - 2019-01-01 00:00:00
    - 2019-01-13 16:58:48
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Makronisos;MULTIPOLYGON(((23.4499771 37.8187979'
    );
  params:
  - Makronisos;MULTIPOLYGON(((23.4499771 37.8187979
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Nisis Stakhtorroyi;MULTIPOLYGON(((23.3608955 37.8141731'
    );
  params:
  - Nisis Stakhtorroyi;MULTIPOLYGON(((23.3608955 37.8141731
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'ALIMOS'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'ALIMOS'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - ALIMOS
  - ASPROPYRGOS
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-10-11 09:49:59, 2019-10-17 04:30:00]'
    );
  params:
  - - 2019-10-11 09:49:59
    - 2019-10-17 04:30:00
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-02-01' - tp '3d' AND epoch '2019-02-01' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-02-01' AND hour(t_start) = 9);
  params:
  - '2019-02-01'
  - 9
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-06-13 00:14:54, 2019-06-19 22:15:10]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-06-13 00:14:54
    - 2019-06-19 22:15:10
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-08-29' - tp '3d' AND epoch '2019-08-29' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-08-29' AND hour(t_start) = 0);
  params:
  - '2019-08-29'
  - 0
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-03-30' - tp '3d' AND epoch '2019-03-30' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-03-30' AND hour(t_start) = 19);
  params:
  - '2019-03-30'
  - 19
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-06-25 20:12:06, 2019-07-03 09:19:11]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'SIRI';
  params:
  - SIRI
  - - 2019-06-25 20:12:06
    - 2019-07-03 09:19:11
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'AEGINA'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'AEGINA'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - AEGINA
  - CORINTH
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Nisis Stakhtorroyi;MULTIPOLYGON(((23.3608955 37.8141731'
    );
  params:
  - Nisis Stakhtorroyi;MULTIPOLYGON(((23.3608955 37.8141731
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'SIRI'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'SIRI'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - SIRI
  - FANEROMENI
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-12-13 03:44:30, 2019-12-23 23:21:34]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'PIRAEUS';
  params:
  - PIRAEUS
  - - 2019-12-13 03:44:30
    - 2019-12-23 23:21:34
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-05-11 07:18:40, 2019-05-15 05:38:45]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-05-11 07:18:40
    - 2019-05-15 05:38:45
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-04-24 03:33:15, 2019-05-03 05:16:00]'
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT t_max - t_min AS duration, ST_Point(x, y) AS pt
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    )
    SELECT AVG(duration)
    FROM harbours h
    JOIN crossing_starts ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    WHERE h.name = 'AGISTRI';
  params:
  - AGISTRI
  - - 2019-04-24 03:33:15
    - 2019-05-03 05:16:00
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-12-09 03:09:00, 2019-12-18 03:46:00]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-12-09 03:09:00
    - 2019-12-18 03:46:00
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-11-22' - tp '3d' AND epoch '2019-11-22' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-11-22' AND hour(t_start) = 20);
  params:
  - '2019-11-22'
  - 20
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-10-22' - tp '3d' AND epoch '2019-10-22' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-10-22' AND hour(t_start) = 3);
  params:
  - '2019-10-22'
  - 3
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Thorussa;MULTIPOLYGON(((23.3173612 37.6775666'
    );
  params:
  - Thorussa;MULTIPOLYGON(((23.3173612 37.6775666
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT DISTINCT crossing_id FROM (SELECT crossing_id, MIN(t) AS t_start FROM crossing_points WHERE t BETWEEN epoch '2019-08-10' - tp '3d' AND epoch '2019-08-10' + tp '3d' GROUP BY crossing_id HAVING ts_daystart(t_start) = epoch '2019-08-10' AND hour(t_start) = 0);
  params:
  - '2019-08-10'
  - 0
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-12-09 17:54:04, 2019-12-24 04:55:24]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-12-09 17:54:04
    - 2019-12-24 04:55:24
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-11-21 05:56:14, 2019-12-02 03:54:46]'
    );
  params:
  - - 2019-11-21 05:56:14
    - 2019-12-02 03:54:46
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-03-10 06:59:19, 2019-03-23 07:13:40]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-03-10 06:59:19
    - 2019-03-23 07:13:40
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Anagnostis;MULTIPOLYGON(((23.3243555 37.8063016'
    );
  params:
  - Anagnostis;MULTIPOLYGON(((23.3243555 37.8063016
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Pachi;MULTIPOLYGON(((23.3629071 37.9656804'
    );
  params:
  - Pachi;MULTIPOLYGON(((23.3629071 37.9656804
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    JOIN islands i ON ST_DWithin(ST_Point(c.x, c.y), ST_ToGeom(i.geom::gpolygon), 5000)
    WHERE i.name = 'Anagnostis;MULTIPOLYGON(((23.3243555 37.8063016'
    );
  params:
  - Anagnostis;MULTIPOLYGON(((23.3243555 37.8063016
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH crossing_start_end_times AS (
    SELECT crossing_id, min(t) as t_min, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE :period_medium
    GROUP BY crossing_id
    ),
    crossing_starts AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_min
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FLISVOS'_1
    ),
    crossing_ends AS (
    SELECT c.crossing_id, h.name
    FROM crossing_start_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    JOIN harbours h ON ST_DWithin(ST_Point(x, y), ST_ToGeom(h.geom::gpoint), 1000)
    WHERE h.name = 'FLISVOS'_2
    )
    SELECT cs.crossing_id
    FROM crossing_starts cs
    JOIN crossing_ends ce ON cs.crossing_id = ce.crossing_id;
  params:
  - FLISVOS
  - AEGINA
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*) FROM (
    SELECT DISTINCT crossing_id
    FROM crossing_points c
    WHERE c.t <@ EPOCHRANGE '[2019-07-11 07:23:37, 2019-07-22 18:12:25]'
    );
  params:
  - - 2019-07-11 07:23:37
    - 2019-07-22 18:12:25
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_end_times AS (
    SELECT crossing_id, max(t) AS t_max FROM crossing_points
    WHERE t <@ EPOCHRANGE '[2019-05-09 07:00:25, 2019-05-24 00:03:43]'
    GROUP BY crossing_id
    ),
    crossing_ends AS (
    SELECT ST_Point(x, y) AS pt
    FROM crossing_end_times e
    JOIN crossing_points c ON c.crossing_id = e.crossing_id AND c.t = e.t_max
    )
    SELECT h.name, COUNT(*) AS crossing_count
    FROM harbours h
    JOIN crossing_ends ON ST_DWithin(pt, ST_ToGeom(h.geom::gpoint), 500)
    GROUP BY h.name
    ORDER BY crossing_count DESC
    LIMIT 1;
  params:
  - - 2019-05-09 07:00:25
    - 2019-05-24 00:03:43
