- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-02-02 18:59:28' AND '2024-02-12 14:21:29' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2024-02-02 18:59:28'
    - '2024-02-12 14:21:29'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-01-30 10:45:48' AND '2024-02-01 19:29:52'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - - '2024-01-30 10:45:48'
    - '2024-02-01 19:29:52'
  - Charité-Campus-Klinik
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-11-28 00:10:52' AND '2023-11-30 13:19:15' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-11-28 00:10:52'
    - '2023-11-30 13:19:15'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-06-20 03:36:48' AND '2023-06-29 13:12:13'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - - '2023-06-20 03:36:48'
    - '2023-06-29 13:12:13'
  - Charité-Campus-Klinik
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Pankow';
  params:
  - Pankow
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Reinickendorf';
  params:
  - Reinickendorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-03-09':timestamp AND timestamp < ('2023-03-09'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-03-09'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Neukölln';
  params:
  - Neukölln
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf';
  params:
  - Steglitz-Zehlendorf
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Neukölln';
  params:
  - Neukölln
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-08-17 22:15:10' AND '2023-08-24 20:15:26' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-08-17 22:15:10'
    - '2023-08-24 20:15:26'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf';
  params:
  - Charlottenburg-Wilmersdorf
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-07-20 07:22:30' AND '2023-07-25 20:48:56'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - - '2023-07-20 07:22:30'
    - '2023-07-25 20:48:56'
  - European-School-of-Management-and-Technology-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Pankow' GROUP BY d.name;
  params:
  - Pankow
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-10-15 11:08:06' AND '2023-10-28 21:33:28';
  params:
  - - '2023-10-15 11:08:06'
    - '2023-10-28 21:33:28'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Pankow' GROUP BY d.name;
  params:
  - Pankow
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf' GROUP BY d.name;
  params:
  - Marzahn-Hellersdorf
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-11-15 19:08:51' AND '2023-11-26 04:32:53'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2023-11-15 19:08:51'
    - '2023-11-26 04:32:53'
  - Technische-Universität-Berlin
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2024-01-20':timestamp AND timestamp < ('2024-01-20'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-01-20'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf' GROUP BY d.name;
  params:
  - Marzahn-Hellersdorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-11-18':timestamp AND timestamp < ('2023-11-18'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-11-18'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-06-12 23:01:04' AND '2023-06-15 13:25:20';
  params:
  - - '2023-06-12 23:01:04'
    - '2023-06-15 13:25:20'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-05-08':timestamp AND timestamp < ('2023-05-08'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-05-08'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-02-18 17:56:16' AND '2024-02-24 22:21:16';
  params:
  - - '2024-02-18 17:56:16'
    - '2024-02-24 22:21:16'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-05-16 07:27:10' AND '2023-05-19 18:13:05'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2023-05-16 07:27:10'
    - '2023-05-19 18:13:05'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Neukölln' GROUP BY d.name;
  params:
  - Neukölln
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf';
  params:
  - Charlottenburg-Wilmersdorf
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-07-13 19:59:39' AND '2023-07-19 15:22:47';
  params:
  - - '2023-07-13 19:59:39'
    - '2023-07-19 15:22:47'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Mitte';
  params:
  - Mitte
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-05-14 00:08:46' AND '2023-05-17 06:14:05'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2023-05-14 00:08:46'
    - '2023-05-17 06:14:05'
  - Freie-Universität-Berlin
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-08-13 03:18:39' AND '2023-08-18 12:31:13'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2023-08-13 03:18:39'
    - '2023-08-18 12:31:13'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Neukölln';
  params:
  - Neukölln
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Spandau' GROUP BY d.name;
  params:
  - Spandau
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-04-14 21:30:49' AND '2023-04-26 18:11:23' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-04-14 21:30:49'
    - '2023-04-26 18:11:23'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-10-10 10:10:14' AND '2023-10-18 11:42:12' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-10-10 10:10:14'
    - '2023-10-18 11:42:12'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf';
  params:
  - Charlottenburg-Wilmersdorf
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Neukölln';
  params:
  - Neukölln
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-04-06 22:36:54' AND '2023-04-11 15:43:07' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-04-06 22:36:54'
    - '2023-04-11 15:43:07'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-08-02 04:26:35' AND '2023-08-08 06:58:45';
  params:
  - - '2023-08-02 04:26:35'
    - '2023-08-08 06:58:45'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf' GROUP BY d.name;
  params:
  - Marzahn-Hellersdorf
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-03-04 06:32:27' AND '2023-03-15 20:55:43'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2023-03-04 06:32:27'
    - '2023-03-15 20:55:43'
  - Humboldt-Universität-zu-Berlin
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-10-24':timestamp AND timestamp < ('2023-10-24'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-10-24'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-03-19':timestamp AND timestamp < ('2023-03-19'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-03-19'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-11-30 08:49:51' AND '2023-12-04 13:27:24' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-11-30 08:49:51'
    - '2023-12-04 13:27:24'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-01-31 05:37:44' AND '2024-02-05 12:09:20' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2024-01-31 05:37:44'
    - '2024-02-05 12:09:20'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-05-23 11:10:03' AND '2023-05-31 21:12:32'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2023-05-23 11:10:03'
    - '2023-05-31 21:12:32'
  - Universität-der-Künste-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-12-17 05:50:31' AND '2023-12-28 16:37:12' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-12-17 05:50:31'
    - '2023-12-28 16:37:12'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-12-03 19:38:24' AND '2023-12-05 23:58:26'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2023-12-03 19:38:24'
    - '2023-12-05 23:58:26'
  - Humboldt-Universität-zu-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Pankow';
  params:
  - Pankow
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Spandau' GROUP BY d.name;
  params:
  - Spandau
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-05-06':timestamp AND timestamp < ('2023-05-06'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-05-06'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-01-01 02:27:15' AND '2024-01-09 21:14:08' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2024-01-01 02:27:15'
    - '2024-01-09 21:14:08'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Spandau' GROUP BY d.name;
  params:
  - Spandau
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf';
  params:
  - Marzahn-Hellersdorf
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-04-02 03:42:15' AND '2023-04-14 06:42:14' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-04-02 03:42:15'
    - '2023-04-14 06:42:14'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-01-29 06:43:05' AND '2024-02-04 11:25:19' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2024-01-29 06:43:05'
    - '2024-02-04 11:25:19'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Spandau';
  params:
  - Spandau
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-05-04':timestamp AND timestamp < ('2023-05-04'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-05-04'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-12-13':timestamp AND timestamp < ('2023-12-13'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-12-13'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2024-01-20':timestamp AND timestamp < ('2024-01-20'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-01-20'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2024-01-18':timestamp AND timestamp < ('2024-01-18'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-01-18'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg';
  params:
  - Tempelhof-Schöneberg
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-02-08 10:08:20' AND '2024-02-12 13:21:12'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2024-02-08 10:08:20'
    - '2024-02-12 13:21:12'
  - Humboldt-Universität-zu-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Pankow';
  params:
  - Pankow
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-09-14 22:05:18' AND '2023-09-18 14:59:47' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-09-14 22:05:18'
    - '2023-09-18 14:59:47'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Lichtenberg' GROUP BY d.name;
  params:
  - Lichtenberg
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Pankow';
  params:
  - Pankow
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-01-24 12:52:19' AND '2024-02-04 16:52:34';
  params:
  - - '2024-01-24 12:52:19'
    - '2024-02-04 16:52:34'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-04-12 15:14:02' AND '2023-04-22 04:05:48' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-04-12 15:14:02'
    - '2023-04-22 04:05:48'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Treptow-Köpenick' GROUP BY d.name;
  params:
  - Treptow-Köpenick
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-08-30':timestamp AND timestamp < ('2023-08-30'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-08-30'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-11-24 01:17:40' AND '2023-11-28 23:32:21';
  params:
  - - '2023-11-24 01:17:40'
    - '2023-11-28 23:32:21'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-10-04 19:31:59' AND '2023-10-18 18:15:50';
  params:
  - - '2023-10-04 19:31:59'
    - '2023-10-18 18:15:50'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-04-28 05:00:36' AND '2023-05-06 18:05:56' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-04-28 05:00:36'
    - '2023-05-06 18:05:56'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Lichtenberg';
  params:
  - Lichtenberg
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Treptow-Köpenick';
  params:
  - Treptow-Köpenick
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-08-05 15:19:57' AND '2023-08-12 18:20:57' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-08-05 15:19:57'
    - '2023-08-12 18:20:57'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Reinickendorf' GROUP BY d.name;
  params:
  - Reinickendorf
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-05-17 19:43:58' AND '2023-05-26 19:24:00';
  params:
  - - '2023-05-17 19:43:58'
    - '2023-05-26 19:24:00'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-06-27 05:11:25' AND '2023-07-02 02:01:52' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-06-27 05:11:25'
    - '2023-07-02 02:01:52'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-05-11 01:31:11' AND '2023-05-20 13:55:54'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2023-05-11 01:31:11'
    - '2023-05-20 13:55:54'
  - Humboldt-Universität-zu-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-06-05 22:17:06' AND '2023-06-15 18:32:55' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-06-05 22:17:06'
    - '2023-06-15 18:32:55'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Neukölln';
  params:
  - Neukölln
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-03-02 21:53:28' AND '2023-03-13 23:10:15' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-03-02 21:53:28'
    - '2023-03-13 23:10:15'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-07-29':timestamp AND timestamp < ('2023-07-29'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-07-29'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-08-09 22:16:22' AND '2023-08-19 10:50:49';
  params:
  - - '2023-08-09 22:16:22'
    - '2023-08-19 10:50:49'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-03-13 16:09:42' AND '2023-03-28 09:38:10' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-03-13 16:09:42'
    - '2023-03-28 09:38:10'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-06-16 14:23:50' AND '2023-06-18 23:39:18';
  params:
  - - '2023-06-16 14:23:50'
    - '2023-06-18 23:39:18'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-10-16 11:34:36' AND '2023-10-27 05:20:49' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-10-16 11:34:36'
    - '2023-10-27 05:20:49'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-12-31':timestamp AND timestamp < ('2023-12-31'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-12-31'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Reinickendorf' GROUP BY d.name;
  params:
  - Reinickendorf
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-11-06 05:47:16' AND '2023-11-16 15:41:12'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2023-11-06 05:47:16'
    - '2023-11-16 15:41:12'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-05-13 08:12:52' AND '2023-05-16 09:26:12'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2023-05-13 08:12:52'
    - '2023-05-16 09:26:12'
  - Freie-Universität-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-05-18 17:14:44' AND '2023-05-25 11:54:38' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-05-18 17:14:44'
    - '2023-05-25 11:54:38'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-06-08':timestamp AND timestamp < ('2023-06-08'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-06-08'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg';
  params:
  - Friedrichshain-Kreuzberg
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Reinickendorf';
  params:
  - Reinickendorf
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-06-28 04:34:03' AND '2023-07-01 20:23:29';
  params:
  - - '2023-06-28 04:34:03'
    - '2023-07-01 20:23:29'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-07-02 22:44:41' AND '2023-07-08 23:05:12';
  params:
  - - '2023-07-02 22:44:41'
    - '2023-07-08 23:05:12'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-12-21 04:20:16' AND '2023-12-24 21:03:28'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Bard-College';
  params:
  - - '2023-12-21 04:20:16'
    - '2023-12-24 21:03:28'
  - Bard-College
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-05-17 05:42:54' AND '2023-05-26 10:27:00' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-05-17 05:42:54'
    - '2023-05-26 10:27:00'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-12-27 12:12:14' AND '2024-01-02 03:42:27'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - - '2023-12-27 12:12:14'
    - '2024-01-02 03:42:27'
  - European-School-of-Management-and-Technology-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-03-30':timestamp AND timestamp < ('2023-03-30'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-03-30'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg';
  params:
  - Tempelhof-Schöneberg
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-09-19 03:04:54' AND '2023-09-25 02:52:39'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2023-09-19 03:04:54'
    - '2023-09-25 02:52:39'
  - Freie-Universität-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Lichtenberg';
  params:
  - Lichtenberg
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Pankow' GROUP BY d.name;
  params:
  - Pankow
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-11-06 07:54:40' AND '2023-11-15 12:40:11'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2023-11-06 07:54:40'
    - '2023-11-15 12:40:11'
  - Humboldt-Universität-zu-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-04-29 12:38:47' AND '2023-05-13 16:25:54';
  params:
  - - '2023-04-29 12:38:47'
    - '2023-05-13 16:25:54'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf' GROUP BY d.name;
  params:
  - Marzahn-Hellersdorf
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Spandau' GROUP BY d.name;
  params:
  - Spandau
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-10-05 22:56:33' AND '2023-10-10 00:18:51';
  params:
  - - '2023-10-05 22:56:33'
    - '2023-10-10 00:18:51'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-09-14 08:50:44' AND '2023-09-20 13:50:13' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-09-14 08:50:44'
    - '2023-09-20 13:50:13'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-11-18 18:59:39' AND '2023-11-24 19:01:07' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-11-18 18:59:39'
    - '2023-11-24 19:01:07'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-03-03':timestamp AND timestamp < ('2023-03-03'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-03-03'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-07-07 04:49:52' AND '2023-07-14 13:07:32';
  params:
  - - '2023-07-07 04:49:52'
    - '2023-07-14 13:07:32'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-12-06 10:19:17' AND '2023-12-09 01:14:15'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Bard-College';
  params:
  - - '2023-12-06 10:19:17'
    - '2023-12-09 01:14:15'
  - Bard-College
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-11-20':timestamp AND timestamp < ('2023-11-20'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-11-20'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf';
  params:
  - Marzahn-Hellersdorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-06-29':timestamp AND timestamp < ('2023-06-29'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-06-29'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-05-29 22:16:33' AND '2023-06-09 11:43:22' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-05-29 22:16:33'
    - '2023-06-09 11:43:22'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-04-03':timestamp AND timestamp < ('2023-04-03'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-04-03'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-06-02 11:45:26' AND '2023-06-14 07:49:19'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2023-06-02 11:45:26'
    - '2023-06-14 07:49:19'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-04-06':timestamp AND timestamp < ('2023-04-06'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-04-06'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-07-14':timestamp AND timestamp < ('2023-07-14'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-07-14'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-12-22 14:14:57' AND '2023-12-28 04:43:15';
  params:
  - - '2023-12-22 14:14:57'
    - '2023-12-28 04:43:15'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-04-24 17:03:44' AND '2023-05-08 22:52:50'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Bard-College';
  params:
  - - '2023-04-24 17:03:44'
    - '2023-05-08 22:52:50'
  - Bard-College
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-03-08':timestamp AND timestamp < ('2023-03-08'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-03-08'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf';
  params:
  - Steglitz-Zehlendorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-05-04':timestamp AND timestamp < ('2023-05-04'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-05-04'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-12-08 22:09:53' AND '2023-12-16 00:15:24'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2023-12-08 22:09:53'
    - '2023-12-16 00:15:24'
  - Universität-der-Künste-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf';
  params:
  - Charlottenburg-Wilmersdorf
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-03-24 08:52:58' AND '2023-03-28 03:15:46' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-03-24 08:52:58'
    - '2023-03-28 03:15:46'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg' GROUP BY d.name;
  params:
  - Friedrichshain-Kreuzberg
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-12-22':timestamp AND timestamp < ('2023-12-22'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-12-22'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-08-25 09:20:57' AND '2023-09-04 09:46:40';
  params:
  - - '2023-08-25 09:20:57'
    - '2023-09-04 09:46:40'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-09-26 09:33:38' AND '2023-10-08 00:48:51' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-09-26 09:33:38'
    - '2023-10-08 00:48:51'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-04-14 23:34:16' AND '2023-04-18 14:28:18';
  params:
  - - '2023-04-14 23:34:16'
    - '2023-04-18 14:28:18'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-08-03':timestamp AND timestamp < ('2023-08-03'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-08-03'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-10-03 01:05:19' AND '2023-10-16 11:12:54' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-10-03 01:05:19'
    - '2023-10-16 11:12:54'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-01-24 22:31:35' AND '2024-02-04 10:24:14'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Bard-College';
  params:
  - - '2024-01-24 22:31:35'
    - '2024-02-04 10:24:14'
  - Bard-College
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-12-14 12:46:49' AND '2023-12-16 14:57:47';
  params:
  - - '2023-12-14 12:46:49'
    - '2023-12-16 14:57:47'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-04-30':timestamp AND timestamp < ('2023-04-30'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-04-30'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-07-06 21:49:09' AND '2023-07-18 18:32:16'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2023-07-06 21:49:09'
    - '2023-07-18 18:32:16'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Mitte' GROUP BY d.name;
  params:
  - Mitte
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-09-28':timestamp AND timestamp < ('2023-09-28'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-09-28'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-03-02 23:45:54' AND '2023-03-11 11:54:09';
  params:
  - - '2023-03-02 23:45:54'
    - '2023-03-11 11:54:09'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-03-24 01:01:20' AND '2023-04-01 12:49:19';
  params:
  - - '2023-03-24 01:01:20'
    - '2023-04-01 12:49:19'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-01-23 06:52:44' AND '2024-02-06 17:54:04' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2024-01-23 06:52:44'
    - '2024-02-06 17:54:04'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-07-09 12:49:21' AND '2023-07-14 21:32:51'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - - '2023-07-09 12:49:21'
    - '2023-07-14 21:32:51'
  - European-School-of-Management-and-Technology-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Neukölln' GROUP BY d.name;
  params:
  - Neukölln
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf' GROUP BY d.name;
  params:
  - Marzahn-Hellersdorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-10-30':timestamp AND timestamp < ('2023-10-30'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-10-30'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-01-04 11:26:22' AND '2024-01-17 12:39:43' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2024-01-04 11:26:22'
    - '2024-01-17 12:39:43'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Neukölln' GROUP BY d.name;
  params:
  - Neukölln
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-04-24 21:49:05' AND '2023-04-28 10:50:22' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-04-24 21:49:05'
    - '2023-04-28 10:50:22'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-08-12 12:45:55' AND '2023-08-24 21:24:11';
  params:
  - - '2023-08-12 12:45:55'
    - '2023-08-24 21:24:11'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Reinickendorf' GROUP BY d.name;
  params:
  - Reinickendorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-04-18':timestamp AND timestamp < ('2023-04-18'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-04-18'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Lichtenberg';
  params:
  - Lichtenberg
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-05-01 17:33:27' AND '2023-05-15 10:37:18';
  params:
  - - '2023-05-01 17:33:27'
    - '2023-05-15 10:37:18'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-08-26 19:00:00' AND '2023-09-04 03:38:06';
  params:
  - - '2023-08-26 19:00:00'
    - '2023-09-04 03:38:06'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-12-06':timestamp AND timestamp < ('2023-12-06'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-12-06'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-09-05 21:11:13' AND '2023-09-15 17:46:08';
  params:
  - - '2023-09-05 21:11:13'
    - '2023-09-15 17:46:08'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-02-21 20:29:22' AND '2024-02-26 22:13:15' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2024-02-21 20:29:22'
    - '2024-02-26 22:13:15'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-03-13 14:10:34' AND '2023-03-18 13:50:15';
  params:
  - - '2023-03-13 14:10:34'
    - '2023-03-18 13:50:15'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Neukölln';
  params:
  - Neukölln
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg' GROUP BY d.name;
  params:
  - Friedrichshain-Kreuzberg
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-01-06 21:52:57' AND '2024-01-17 18:59:05';
  params:
  - - '2024-01-06 21:52:57'
    - '2024-01-17 18:59:05'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-04-27 21:11:48' AND '2023-05-11 03:34:02'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2023-04-27 21:11:48'
    - '2023-05-11 03:34:02'
  - Technische-Universität-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf';
  params:
  - Charlottenburg-Wilmersdorf
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-07-09 01:42:35' AND '2023-07-16 15:14:35';
  params:
  - - '2023-07-09 01:42:35'
    - '2023-07-16 15:14:35'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Reinickendorf';
  params:
  - Reinickendorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-12-26':timestamp AND timestamp < ('2023-12-26'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-12-26'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg';
  params:
  - Friedrichshain-Kreuzberg
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-12-25 03:20:35' AND '2024-01-04 19:07:01' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-12-25 03:20:35'
    - '2024-01-04 19:07:01'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-05-09 04:40:01' AND '2023-05-21 12:41:09'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2023-05-09 04:40:01'
    - '2023-05-21 12:41:09'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-12-03 21:09:16' AND '2023-12-14 21:32:42';
  params:
  - - '2023-12-03 21:09:16'
    - '2023-12-14 21:32:42'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Treptow-Köpenick';
  params:
  - Treptow-Köpenick
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-07-25 12:00:09' AND '2023-07-31 21:31:48' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-07-25 12:00:09'
    - '2023-07-31 21:31:48'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-07-20 05:42:28' AND '2023-07-31 06:39:37';
  params:
  - - '2023-07-20 05:42:28'
    - '2023-07-31 06:39:37'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-11-08 18:41:21' AND '2023-11-20 15:52:23';
  params:
  - - '2023-11-08 18:41:21'
    - '2023-11-20 15:52:23'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-03-26':timestamp AND timestamp < ('2023-03-26'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-03-26'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-10-20 05:37:06' AND '2023-10-25 22:53:20';
  params:
  - - '2023-10-20 05:37:06'
    - '2023-10-25 22:53:20'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-08-20 20:47:25' AND '2023-09-03 12:00:38' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-08-20 20:47:25'
    - '2023-09-03 12:00:38'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Reinickendorf' GROUP BY d.name;
  params:
  - Reinickendorf
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Spandau';
  params:
  - Spandau
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-05-17 21:42:36' AND '2023-05-29 21:42:38' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-05-17 21:42:36'
    - '2023-05-29 21:42:38'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-12-26 21:08:04' AND '2024-01-10 01:54:34'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - - '2023-12-26 21:08:04'
    - '2024-01-10 01:54:34'
  - Charité-Campus-Klinik
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-02-08 05:24:13' AND '2024-02-18 12:47:49';
  params:
  - - '2024-02-08 05:24:13'
    - '2024-02-18 12:47:49'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-11-26 10:56:16' AND '2023-12-11 09:11:42'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2023-11-26 10:56:16'
    - '2023-12-11 09:11:42'
  - Technische-Universität-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-07-13 05:38:45' AND '2023-07-17 03:58:50' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-07-13 05:38:45'
    - '2023-07-17 03:58:50'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-05-26 07:00:34' AND '2023-05-31 10:11:02';
  params:
  - - '2023-05-26 07:00:34'
    - '2023-05-31 10:11:02'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-07-26 23:14:26' AND '2023-08-06 14:16:46';
  params:
  - - '2023-07-26 23:14:26'
    - '2023-08-06 14:16:46'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Neukölln';
  params:
  - Neukölln
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-01-12 14:52:39' AND '2024-01-15 02:04:18'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2024-01-12 14:52:39'
    - '2024-01-15 02:04:18'
  - Humboldt-Universität-zu-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg';
  params:
  - Friedrichshain-Kreuzberg
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Neukölln';
  params:
  - Neukölln
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-10-05 13:21:54' AND '2023-10-07 21:23:16'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2023-10-05 13:21:54'
    - '2023-10-07 21:23:16'
  - Technische-Universität-Berlin
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-09-19 21:03:28' AND '2023-09-26 16:59:22'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - - '2023-09-19 21:03:28'
    - '2023-09-26 16:59:22'
  - Charité-Campus-Klinik
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg' GROUP BY d.name;
  params:
  - Friedrichshain-Kreuzberg
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-12-03 02:05:49' AND '2023-12-13 10:13:04' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-12-03 02:05:49'
    - '2023-12-13 10:13:04'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Spandau' GROUP BY d.name;
  params:
  - Spandau
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Reinickendorf' GROUP BY d.name;
  params:
  - Reinickendorf
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Spandau' GROUP BY d.name;
  params:
  - Spandau
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Treptow-Köpenick';
  params:
  - Treptow-Köpenick
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Lichtenberg';
  params:
  - Lichtenberg
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-08-21 10:41:03' AND '2023-08-31 04:35:50';
  params:
  - - '2023-08-21 10:41:03'
    - '2023-08-31 04:35:50'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf';
  params:
  - Charlottenburg-Wilmersdorf
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-09-02 06:47:01' AND '2023-09-09 14:17:30' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-09-02 06:47:01'
    - '2023-09-09 14:17:30'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-10-09 09:58:01' AND '2023-10-14 14:52:50';
  params:
  - - '2023-10-09 09:58:01'
    - '2023-10-14 14:52:50'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-11-11 23:04:29' AND '2023-11-22 17:46:08' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-11-11 23:04:29'
    - '2023-11-22 17:46:08'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-09-12 01:44:37' AND '2023-09-24 20:42:59' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-09-12 01:44:37'
    - '2023-09-24 20:42:59'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-08-19 19:25:13' AND '2023-08-22 04:03:17' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-08-19 19:25:13'
    - '2023-08-22 04:03:17'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-04-26 18:52:13' AND '2023-04-30 20:01:40';
  params:
  - - '2023-04-26 18:52:13'
    - '2023-04-30 20:01:40'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-12-23 19:26:36' AND '2023-12-28 04:09:07' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-12-23 19:26:36'
    - '2023-12-28 04:09:07'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Lichtenberg';
  params:
  - Lichtenberg
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Mitte';
  params:
  - Mitte
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-05-28':timestamp AND timestamp < ('2023-05-28'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-05-28'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-01-30 09:09:46' AND '2024-02-06 20:30:51'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2024-01-30 09:09:46'
    - '2024-02-06 20:30:51'
  - Technische-Universität-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf';
  params:
  - Marzahn-Hellersdorf
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Spandau' GROUP BY d.name;
  params:
  - Spandau
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg' GROUP BY d.name;
  params:
  - Tempelhof-Schöneberg
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Treptow-Köpenick';
  params:
  - Treptow-Köpenick
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-07-24 21:59:54' AND '2023-07-29 18:52:49';
  params:
  - - '2023-07-24 21:59:54'
    - '2023-07-29 18:52:49'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-04-15':timestamp AND timestamp < ('2023-04-15'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-04-15'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-10-12 04:44:39' AND '2023-10-23 05:26:45' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-10-12 04:44:39'
    - '2023-10-23 05:26:45'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf';
  params:
  - Marzahn-Hellersdorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-10-17':timestamp AND timestamp < ('2023-10-17'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-10-17'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-10-19 00:21:15' AND '2023-10-22 12:40:02' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-10-19 00:21:15'
    - '2023-10-22 12:40:02'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-07-02 12:15:04' AND '2023-07-06 04:39:03'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2023-07-02 12:15:04'
    - '2023-07-06 04:39:03'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-02-03 07:45:44' AND '2024-02-12 14:41:33' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2024-02-03 07:45:44'
    - '2024-02-12 14:41:33'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-05-04':timestamp AND timestamp < ('2023-05-04'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-05-04'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2024-03-02':timestamp AND timestamp < ('2024-03-02'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-03-02'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-04-11 14:50:52' AND '2023-04-25 01:57:06'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2023-04-11 14:50:52'
    - '2023-04-25 01:57:06'
  - Universität-der-Künste-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Pankow';
  params:
  - Pankow
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-07-25':timestamp AND timestamp < ('2023-07-25'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-07-25'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-05-05 21:25:45' AND '2023-05-17 12:09:33';
  params:
  - - '2023-05-05 21:25:45'
    - '2023-05-17 12:09:33'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Lichtenberg';
  params:
  - Lichtenberg
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-07-27':timestamp AND timestamp < ('2023-07-27'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-07-27'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Pankow';
  params:
  - Pankow
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-04-23':timestamp AND timestamp < ('2023-04-23'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-04-23'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf' GROUP BY d.name;
  params:
  - Steglitz-Zehlendorf
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-04-29 06:21:45' AND '2023-05-12 00:10:46' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-04-29 06:21:45'
    - '2023-05-12 00:10:46'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-07-27 13:47:39' AND '2023-08-03 02:12:57';
  params:
  - - '2023-07-27 13:47:39'
    - '2023-08-03 02:12:57'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf';
  params:
  - Charlottenburg-Wilmersdorf
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Spandau';
  params:
  - Spandau
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg' GROUP BY d.name;
  params:
  - Tempelhof-Schöneberg
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Pankow';
  params:
  - Pankow
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-08-19 14:02:42' AND '2023-08-22 08:45:20';
  params:
  - - '2023-08-19 14:02:42'
    - '2023-08-22 08:45:20'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-10-21 16:52:34' AND '2023-11-01 20:19:00' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-10-21 16:52:34'
    - '2023-11-01 20:19:00'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Treptow-Köpenick';
  params:
  - Treptow-Köpenick
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-04-08 02:16:16' AND '2023-04-16 22:12:40' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-04-08 02:16:16'
    - '2023-04-16 22:12:40'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-07-06 11:44:34' AND '2023-07-10 13:50:33';
  params:
  - - '2023-07-06 11:44:34'
    - '2023-07-10 13:50:33'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Lichtenberg' GROUP BY d.name;
  params:
  - Lichtenberg
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-10-29 21:52:46' AND '2023-11-07 15:49:01' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-10-29 21:52:46'
    - '2023-11-07 15:49:01'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-08-20 18:45:46' AND '2023-08-30 08:00:01';
  params:
  - - '2023-08-20 18:45:46'
    - '2023-08-30 08:00:01'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-05-18 04:52:43' AND '2023-05-30 11:48:44'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - - '2023-05-18 04:52:43'
    - '2023-05-30 11:48:44'
  - European-School-of-Management-and-Technology-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-12-20 03:08:54' AND '2024-01-02 17:23:57';
  params:
  - - '2023-12-20 03:08:54'
    - '2024-01-02 17:23:57'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-07-19 13:16:52' AND '2023-07-30 01:21:02' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-07-19 13:16:52'
    - '2023-07-30 01:21:02'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-08-25 14:50:17' AND '2023-09-08 11:45:09' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-08-25 14:50:17'
    - '2023-09-08 11:45:09'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-04-07 15:22:15' AND '2023-04-12 02:31:19'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - - '2023-04-07 15:22:15'
    - '2023-04-12 02:31:19'
  - Charité-Campus-Klinik
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-08-05 11:16:13' AND '2023-08-18 13:37:22'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2023-08-05 11:16:13'
    - '2023-08-18 13:37:22'
  - Universität-der-Künste-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Treptow-Köpenick';
  params:
  - Treptow-Köpenick
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-06-15':timestamp AND timestamp < ('2023-06-15'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-06-15'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Mitte';
  params:
  - Mitte
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Lichtenberg' GROUP BY d.name;
  params:
  - Lichtenberg
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-06-13 22:08:29' AND '2023-06-22 08:53:24';
  params:
  - - '2023-06-13 22:08:29'
    - '2023-06-22 08:53:24'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-07-12 17:54:59' AND '2023-07-19 18:51:37';
  params:
  - - '2023-07-12 17:54:59'
    - '2023-07-19 18:51:37'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-11-13 05:48:08' AND '2023-11-26 00:51:29'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2023-11-13 05:48:08'
    - '2023-11-26 00:51:29'
  - Humboldt-Universität-zu-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Lichtenberg';
  params:
  - Lichtenberg
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-06-26 03:35:08' AND '2023-06-29 12:29:28';
  params:
  - - '2023-06-26 03:35:08'
    - '2023-06-29 12:29:28'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-04-29 20:09:22' AND '2023-05-11 00:07:50'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - - '2023-04-29 20:09:22'
    - '2023-05-11 00:07:50'
  - Charité-Campus-Klinik
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-12-11 08:21:10' AND '2023-12-25 13:39:42';
  params:
  - - '2023-12-11 08:21:10'
    - '2023-12-25 13:39:42'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-08-14 21:16:55' AND '2023-08-17 07:13:07'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2023-08-14 21:16:55'
    - '2023-08-17 07:13:07'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Mitte' GROUP BY d.name;
  params:
  - Mitte
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-10-21 04:07:33' AND '2023-10-23 07:58:25'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Bard-College';
  params:
  - - '2023-10-21 04:07:33'
    - '2023-10-23 07:58:25'
  - Bard-College
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-12-11 07:35:31' AND '2023-12-25 15:20:35';
  params:
  - - '2023-12-11 07:35:31'
    - '2023-12-25 15:20:35'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-06-11 20:15:25' AND '2023-06-18 03:57:03'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2023-06-11 20:15:25'
    - '2023-06-18 03:57:03'
  - Freie-Universität-Berlin
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-12-30':timestamp AND timestamp < ('2023-12-30'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-12-30'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Lichtenberg' GROUP BY d.name;
  params:
  - Lichtenberg
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-08-02':timestamp AND timestamp < ('2023-08-02'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-08-02'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-08-26 03:50:40' AND '2023-09-05 01:26:54';
  params:
  - - '2023-08-26 03:50:40'
    - '2023-09-05 01:26:54'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-12-15 04:30:00' AND '2023-12-20 23:10:01';
  params:
  - - '2023-12-15 04:30:00'
    - '2023-12-20 23:10:01'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-08-07':timestamp AND timestamp < ('2023-08-07'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-08-07'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-02-16 00:31:10' AND '2024-02-18 17:40:43'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2024-02-16 00:31:10'
    - '2024-02-18 17:40:43'
  - Freie-Universität-Berlin
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-07-18':timestamp AND timestamp < ('2023-07-18'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-07-18'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Pankow' GROUP BY d.name;
  params:
  - Pankow
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Pankow';
  params:
  - Pankow
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-01-21 10:19:09' AND '2024-02-01 15:56:07' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2024-01-21 10:19:09'
    - '2024-02-01 15:56:07'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-08-24':timestamp AND timestamp < ('2023-08-24'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-08-24'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-04-06 15:41:23' AND '2023-04-20 04:29:02';
  params:
  - - '2023-04-06 15:41:23'
    - '2023-04-20 04:29:02'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-07-05 14:59:52' AND '2023-07-07 20:07:27' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-07-05 14:59:52'
    - '2023-07-07 20:07:27'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf';
  params:
  - Steglitz-Zehlendorf
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Spandau';
  params:
  - Spandau
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg';
  params:
  - Friedrichshain-Kreuzberg
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-01-09 22:11:40' AND '2024-01-20 20:02:48' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2024-01-09 22:11:40'
    - '2024-01-20 20:02:48'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-01-20 18:12:45' AND '2024-01-29 07:57:36'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2024-01-20 18:12:45'
    - '2024-01-29 07:57:36'
  - Universität-der-Künste-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-04-26 06:25:27' AND '2023-05-06 07:16:50' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-04-26 06:25:27'
    - '2023-05-06 07:16:50'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-12-23 20:14:51' AND '2023-12-29 01:32:48'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - - '2023-12-23 20:14:51'
    - '2023-12-29 01:32:48'
  - European-School-of-Management-and-Technology-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Reinickendorf' GROUP BY d.name;
  params:
  - Reinickendorf
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-07-17 04:14:32' AND '2023-07-22 10:00:14';
  params:
  - - '2023-07-17 04:14:32'
    - '2023-07-22 10:00:14'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-01-21 03:58:53' AND '2024-01-28 07:46:56';
  params:
  - - '2024-01-21 03:58:53'
    - '2024-01-28 07:46:56'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg' GROUP BY d.name;
  params:
  - Tempelhof-Schöneberg
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2024-02-05':timestamp AND timestamp < ('2024-02-05'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-02-05'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-03-12 09:25:51' AND '2023-03-22 16:12:22';
  params:
  - - '2023-03-12 09:25:51'
    - '2023-03-22 16:12:22'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-10-21 04:42:10' AND '2023-10-25 02:08:44'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2023-10-21 04:42:10'
    - '2023-10-25 02:08:44'
  - Freie-Universität-Berlin
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-12-07 15:56:02' AND '2023-12-16 13:17:08'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2023-12-07 15:56:02'
    - '2023-12-16 13:17:08'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-05-03 21:25:22' AND '2023-05-18 02:48:58'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2023-05-03 21:25:22'
    - '2023-05-18 02:48:58'
  - Freie-Universität-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Pankow';
  params:
  - Pankow
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Pankow' GROUP BY d.name;
  params:
  - Pankow
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Lichtenberg';
  params:
  - Lichtenberg
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-03-26 07:23:10' AND '2023-04-09 15:11:39';
  params:
  - - '2023-03-26 07:23:10'
    - '2023-04-09 15:11:39'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-03-07 08:17:57' AND '2023-03-12 12:28:18';
  params:
  - - '2023-03-07 08:17:57'
    - '2023-03-12 12:28:18'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-04-08 00:16:12' AND '2023-04-22 00:32:59'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - - '2023-04-08 00:16:12'
    - '2023-04-22 00:32:59'
  - Charité-Campus-Klinik
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-02-23 02:11:42' AND '2023-03-09 23:04:12';
  params:
  - - '2023-02-23 02:11:42'
    - '2023-03-09 23:04:12'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-10-01':timestamp AND timestamp < ('2023-10-01'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-10-01'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-08-23 15:07:36' AND '2023-09-01 01:07:28';
  params:
  - - '2023-08-23 15:07:36'
    - '2023-09-01 01:07:28'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Neukölln';
  params:
  - Neukölln
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-07-26':timestamp AND timestamp < ('2023-07-26'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-07-26'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-12-20':timestamp AND timestamp < ('2023-12-20'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-12-20'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-03-01 02:32:47' AND '2023-03-12 18:24:14' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-03-01 02:32:47'
    - '2023-03-12 18:24:14'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf' GROUP BY d.name;
  params:
  - Steglitz-Zehlendorf
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Mitte' GROUP BY d.name;
  params:
  - Mitte
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-10-18 18:34:14' AND '2023-10-30 19:17:40'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Bard-College';
  params:
  - - '2023-10-18 18:34:14'
    - '2023-10-30 19:17:40'
  - Bard-College
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-12-03 19:38:24' AND '2023-12-16 04:28:43'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - - '2023-12-03 19:38:24'
    - '2023-12-16 04:28:43'
  - Charité-Campus-Klinik
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Pankow' GROUP BY d.name;
  params:
  - Pankow
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-07-31':timestamp AND timestamp < ('2023-07-31'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-07-31'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-07-21 17:42:03' AND '2023-07-31 09:46:26';
  params:
  - - '2023-07-21 17:42:03'
    - '2023-07-31 09:46:26'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-06-07 21:20:00' AND '2023-06-13 03:42:26' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-06-07 21:20:00'
    - '2023-06-13 03:42:26'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Neukölln';
  params:
  - Neukölln
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-06-14 06:18:54' AND '2023-06-20 16:47:51' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-06-14 06:18:54'
    - '2023-06-20 16:47:51'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-11-11 16:01:02' AND '2023-11-20 20:54:26';
  params:
  - - '2023-11-11 16:01:02'
    - '2023-11-20 20:54:26'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-06-12 05:33:55' AND '2023-06-20 22:11:17'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2023-06-12 05:33:55'
    - '2023-06-20 22:11:17'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-07-06 19:20:14' AND '2023-07-09 19:06:18';
  params:
  - - '2023-07-06 19:20:14'
    - '2023-07-09 19:06:18'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Pankow' GROUP BY d.name;
  params:
  - Pankow
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-09-27':timestamp AND timestamp < ('2023-09-27'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-09-27'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Spandau' GROUP BY d.name;
  params:
  - Spandau
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-05-16 07:35:02' AND '2023-05-24 05:08:17'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - - '2023-05-16 07:35:02'
    - '2023-05-24 05:08:17'
  - European-School-of-Management-and-Technology-Berlin
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-03-02 05:37:06' AND '2023-03-16 21:26:51'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2023-03-02 05:37:06'
    - '2023-03-16 21:26:51'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-08-14':timestamp AND timestamp < ('2023-08-14'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-08-14'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2024-01-21':timestamp AND timestamp < ('2024-01-21'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-01-21'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg' GROUP BY d.name;
  params:
  - Friedrichshain-Kreuzberg
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-02-13 03:04:39' AND '2024-02-23 10:00:56' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2024-02-13 03:04:39'
    - '2024-02-23 10:00:56'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Spandau' GROUP BY d.name;
  params:
  - Spandau
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-07-09':timestamp AND timestamp < ('2023-07-09'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-07-09'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-08-08':timestamp AND timestamp < ('2023-08-08'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-08-08'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-04-09':timestamp AND timestamp < ('2023-04-09'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-04-09'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-03-30 20:10:56' AND '2023-04-12 20:21:51';
  params:
  - - '2023-03-30 20:10:56'
    - '2023-04-12 20:21:51'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-03-10 22:04:51' AND '2023-03-13 19:00:55';
  params:
  - - '2023-03-10 22:04:51'
    - '2023-03-13 19:00:55'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-01-25 03:42:30' AND '2024-02-01 10:41:13'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2024-01-25 03:42:30'
    - '2024-02-01 10:41:13'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-03-03 06:45:59' AND '2023-03-15 07:16:16'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2023-03-03 06:45:59'
    - '2023-03-15 07:16:16'
  - Universität-der-Künste-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-09-17 22:51:42' AND '2023-09-22 04:58:57';
  params:
  - - '2023-09-17 22:51:42'
    - '2023-09-22 04:58:57'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-01-04 12:46:29' AND '2024-01-15 05:47:17';
  params:
  - - '2024-01-04 12:46:29'
    - '2024-01-15 05:47:17'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg' GROUP BY d.name;
  params:
  - Friedrichshain-Kreuzberg
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-01-31 14:52:29' AND '2024-02-13 12:23:51' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2024-01-31 14:52:29'
    - '2024-02-13 12:23:51'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-11-25 00:35:06' AND '2023-12-07 07:40:03'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - - '2023-11-25 00:35:06'
    - '2023-12-07 07:40:03'
  - European-School-of-Management-and-Technology-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Spandau' GROUP BY d.name;
  params:
  - Spandau
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-09-30':timestamp AND timestamp < ('2023-09-30'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-09-30'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-11-09':timestamp AND timestamp < ('2023-11-09'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-11-09'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Pankow' GROUP BY d.name;
  params:
  - Pankow
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Pankow' GROUP BY d.name;
  params:
  - Pankow
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Neukölln' GROUP BY d.name;
  params:
  - Neukölln
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg' GROUP BY d.name;
  params:
  - Tempelhof-Schöneberg
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-10-24 17:22:06' AND '2023-11-05 19:13:09' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-10-24 17:22:06'
    - '2023-11-05 19:13:09'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-03-21 09:58:57' AND '2023-03-31 05:37:36';
  params:
  - - '2023-03-21 09:58:57'
    - '2023-03-31 05:37:36'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-09-14':timestamp AND timestamp < ('2023-09-14'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-09-14'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-06-02 09:10:02' AND '2023-06-04 22:31:14';
  params:
  - - '2023-06-02 09:10:02'
    - '2023-06-04 22:31:14'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Treptow-Köpenick' GROUP BY d.name;
  params:
  - Treptow-Köpenick
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Reinickendorf';
  params:
  - Reinickendorf
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-06-23 12:17:54' AND '2023-07-04 01:15:02' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-06-23 12:17:54'
    - '2023-07-04 01:15:02'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Spandau';
  params:
  - Spandau
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-08-19':timestamp AND timestamp < ('2023-08-19'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-08-19'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-08-16 00:18:15' AND '2023-08-23 01:01:59'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - - '2023-08-16 00:18:15'
    - '2023-08-23 01:01:59'
  - European-School-of-Management-and-Technology-Berlin
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-10-18':timestamp AND timestamp < ('2023-10-18'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-10-18'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-07-11':timestamp AND timestamp < ('2023-07-11'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-07-11'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg';
  params:
  - Friedrichshain-Kreuzberg
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Lichtenberg';
  params:
  - Lichtenberg
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-09-18 16:26:10' AND '2023-09-23 08:33:07' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-09-18 16:26:10'
    - '2023-09-23 08:33:07'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-06-15 22:46:41' AND '2023-06-20 04:27:42';
  params:
  - - '2023-06-15 22:46:41'
    - '2023-06-20 04:27:42'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-03-27 15:47:33' AND '2023-04-03 14:10:17' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-03-27 15:47:33'
    - '2023-04-03 14:10:17'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg';
  params:
  - Tempelhof-Schöneberg
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Reinickendorf' GROUP BY d.name;
  params:
  - Reinickendorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2024-01-13':timestamp AND timestamp < ('2024-01-13'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-01-13'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2024-02-06':timestamp AND timestamp < ('2024-02-06'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-02-06'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg';
  params:
  - Friedrichshain-Kreuzberg
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-08-08 01:14:54' AND '2023-08-15 19:12:49';
  params:
  - - '2023-08-08 01:14:54'
    - '2023-08-15 19:12:49'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Treptow-Köpenick';
  params:
  - Treptow-Köpenick
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2024-01-12':timestamp AND timestamp < ('2024-01-12'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-01-12'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Spandau' GROUP BY d.name;
  params:
  - Spandau
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Spandau' GROUP BY d.name;
  params:
  - Spandau
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-06-01':timestamp AND timestamp < ('2023-06-01'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-06-01'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf';
  params:
  - Marzahn-Hellersdorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-08-29':timestamp AND timestamp < ('2023-08-29'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-08-29'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-12-19 20:31:40' AND '2024-01-03 01:40:48' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-12-19 20:31:40'
    - '2024-01-03 01:40:48'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Reinickendorf' GROUP BY d.name;
  params:
  - Reinickendorf
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-11-08 19:48:24' AND '2023-11-11 19:14:57' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-11-08 19:48:24'
    - '2023-11-11 19:14:57'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf' GROUP BY d.name;
  params:
  - Steglitz-Zehlendorf
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg' GROUP BY d.name;
  params:
  - Tempelhof-Schöneberg
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-09-10 00:48:14' AND '2023-09-21 02:57:06'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - - '2023-09-10 00:48:14'
    - '2023-09-21 02:57:06'
  - Charité-Campus-Klinik
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-06-04 21:50:50' AND '2023-06-17 21:11:35';
  params:
  - - '2023-06-04 21:50:50'
    - '2023-06-17 21:11:35'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Lichtenberg';
  params:
  - Lichtenberg
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Lichtenberg' GROUP BY d.name;
  params:
  - Lichtenberg
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-05-09':timestamp AND timestamp < ('2023-05-09'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-05-09'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-12-05 21:34:29' AND '2023-12-18 05:59:54';
  params:
  - - '2023-12-05 21:34:29'
    - '2023-12-18 05:59:54'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-01-21 15:49:00' AND '2024-01-26 07:40:27';
  params:
  - - '2024-01-21 15:49:00'
    - '2024-01-26 07:40:27'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf' GROUP BY d.name;
  params:
  - Steglitz-Zehlendorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2024-02-05':timestamp AND timestamp < ('2024-02-05'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-02-05'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Pankow';
  params:
  - Pankow
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-03-30 16:24:40' AND '2023-04-09 16:05:44'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2023-03-30 16:24:40'
    - '2023-04-09 16:05:44'
  - Technische-Universität-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Spandau';
  params:
  - Spandau
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-09-25 08:52:13' AND '2023-10-04 04:35:21'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2023-09-25 08:52:13'
    - '2023-10-04 04:35:21'
  - Universität-der-Künste-Berlin
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-01-29 03:16:51' AND '2024-01-31 11:34:44'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - - '2024-01-29 03:16:51'
    - '2024-01-31 11:34:44'
  - Charité-Campus-Klinik
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-02-25 22:55:24' AND '2024-03-10 19:42:45' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2024-02-25 22:55:24'
    - '2024-03-10 19:42:45'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-02-05 16:10:18' AND '2024-02-17 02:34:34' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2024-02-05 16:10:18'
    - '2024-02-17 02:34:34'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg' GROUP BY d.name;
  params:
  - Tempelhof-Schöneberg
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg' GROUP BY d.name;
  params:
  - Friedrichshain-Kreuzberg
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-11-18':timestamp AND timestamp < ('2023-11-18'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-11-18'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-09-30':timestamp AND timestamp < ('2023-09-30'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-09-30'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-09-30 12:39:21' AND '2023-10-02 23:00:00'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2023-09-30 12:39:21'
    - '2023-10-02 23:00:00'
  - Humboldt-Universität-zu-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg' GROUP BY d.name;
  params:
  - Friedrichshain-Kreuzberg
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-11-05 04:23:12' AND '2023-11-08 03:38:54'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2023-11-05 04:23:12'
    - '2023-11-08 03:38:54'
  - Universität-der-Künste-Berlin
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-04-22':timestamp AND timestamp < ('2023-04-22'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-04-22'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Mitte';
  params:
  - Mitte
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-07-18':timestamp AND timestamp < ('2023-07-18'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-07-18'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-05-07 04:51:34' AND '2023-05-17 14:05:45'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2023-05-07 04:51:34'
    - '2023-05-17 14:05:45'
  - Freie-Universität-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-08-09 08:34:33' AND '2023-08-17 06:30:26';
  params:
  - - '2023-08-09 08:34:33'
    - '2023-08-17 06:30:26'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-12-24':timestamp AND timestamp < ('2023-12-24'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-12-24'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-04-11 08:05:44' AND '2023-04-19 19:21:47'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - - '2023-04-11 08:05:44'
    - '2023-04-19 19:21:47'
  - European-School-of-Management-and-Technology-Berlin
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-03-05 21:34:15' AND '2023-03-08 18:51:08'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2023-03-05 21:34:15'
    - '2023-03-08 18:51:08'
  - Technische-Universität-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-02-04 15:18:39' AND '2024-02-18 07:47:39' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2024-02-04 15:18:39'
    - '2024-02-18 07:47:39'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-11-08':timestamp AND timestamp < ('2023-11-08'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-11-08'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-04-06 00:23:45' AND '2023-04-11 22:13:34'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2023-04-06 00:23:45'
    - '2023-04-11 22:13:34'
  - Freie-Universität-Berlin
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-06-29 05:42:57' AND '2023-07-08 23:55:04'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2023-06-29 05:42:57'
    - '2023-07-08 23:55:04'
  - Humboldt-Universität-zu-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Mitte' GROUP BY d.name;
  params:
  - Mitte
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf';
  params:
  - Charlottenburg-Wilmersdorf
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-04-01 01:56:09' AND '2023-04-14 13:01:05' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-04-01 01:56:09'
    - '2023-04-14 13:01:05'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-06-26 02:26:40' AND '2023-07-02 01:32:26' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-06-26 02:26:40'
    - '2023-07-02 01:32:26'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-06-26 20:04:05' AND '2023-07-10 17:47:37'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2023-06-26 20:04:05'
    - '2023-07-10 17:47:37'
  - Humboldt-Universität-zu-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-05-21 02:23:16' AND '2023-06-03 07:32:27';
  params:
  - - '2023-05-21 02:23:16'
    - '2023-06-03 07:32:27'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-11-15 02:54:34' AND '2023-11-25 02:27:04' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-11-15 02:54:34'
    - '2023-11-25 02:27:04'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-12-25 17:49:05' AND '2023-12-31 11:37:03' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-12-25 17:49:05'
    - '2023-12-31 11:37:03'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-06-22 13:57:07' AND '2023-07-07 07:00:25' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-06-22 13:57:07'
    - '2023-07-07 07:00:25'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-08-29 09:51:40' AND '2023-09-11 14:21:07';
  params:
  - - '2023-08-29 09:51:40'
    - '2023-09-11 14:21:07'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-05-08 13:23:51' AND '2023-05-18 04:35:09';
  params:
  - - '2023-05-08 13:23:51'
    - '2023-05-18 04:35:09'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2024-01-21':timestamp AND timestamp < ('2024-01-21'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-01-21'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-11-13 09:23:43' AND '2023-11-18 21:35:47';
  params:
  - - '2023-11-13 09:23:43'
    - '2023-11-18 21:35:47'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-09-07 03:53:18' AND '2023-09-14 14:03:57';
  params:
  - - '2023-09-07 03:53:18'
    - '2023-09-14 14:03:57'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Neukölln';
  params:
  - Neukölln
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-02-06 19:17:46' AND '2024-02-20 18:59:50'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Bard-College';
  params:
  - - '2024-02-06 19:17:46'
    - '2024-02-20 18:59:50'
  - Bard-College
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Reinickendorf';
  params:
  - Reinickendorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-12-15':timestamp AND timestamp < ('2023-12-15'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-12-15'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-09-20':timestamp AND timestamp < ('2023-09-20'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-09-20'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Treptow-Köpenick';
  params:
  - Treptow-Köpenick
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-03-02':timestamp AND timestamp < ('2023-03-02'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-03-02'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2024-01-23':timestamp AND timestamp < ('2024-01-23'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-01-23'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg' GROUP BY d.name;
  params:
  - Friedrichshain-Kreuzberg
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-03-13 16:58:48' AND '2023-03-26 15:57:38' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-03-13 16:58:48'
    - '2023-03-26 15:57:38'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Lichtenberg' GROUP BY d.name;
  params:
  - Lichtenberg
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf';
  params:
  - Charlottenburg-Wilmersdorf
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf';
  params:
  - Steglitz-Zehlendorf
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg' GROUP BY d.name;
  params:
  - Friedrichshain-Kreuzberg
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-08-14 20:35:18' AND '2023-08-23 01:13:52'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2023-08-14 20:35:18'
    - '2023-08-23 01:13:52'
  - Universität-der-Künste-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-09-15 08:48:59' AND '2023-09-17 19:55:36';
  params:
  - - '2023-09-15 08:48:59'
    - '2023-09-17 19:55:36'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-08-03 04:42:16' AND '2023-08-10 11:08:29'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - - '2023-08-03 04:42:16'
    - '2023-08-10 11:08:29'
  - European-School-of-Management-and-Technology-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Treptow-Köpenick';
  params:
  - Treptow-Köpenick
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Neukölln' GROUP BY d.name;
  params:
  - Neukölln
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Mitte' GROUP BY d.name;
  params:
  - Mitte
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-04-13':timestamp AND timestamp < ('2023-04-13'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-04-13'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-05-09':timestamp AND timestamp < ('2023-05-09'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-05-09'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf';
  params:
  - Charlottenburg-Wilmersdorf
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-04-13 08:56:13' AND '2023-04-28 00:27:55' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-04-13 08:56:13'
    - '2023-04-28 00:27:55'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Reinickendorf';
  params:
  - Reinickendorf
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-11-25 14:34:23' AND '2023-12-07 07:13:38' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-11-25 14:34:23'
    - '2023-12-07 07:13:38'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf' GROUP BY d.name;
  params:
  - Marzahn-Hellersdorf
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf';
  params:
  - Charlottenburg-Wilmersdorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2024-01-19':timestamp AND timestamp < ('2024-01-19'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-01-19'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg' GROUP BY d.name;
  params:
  - Tempelhof-Schöneberg
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-11-29 15:20:07' AND '2023-12-14 05:09:36' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-11-29 15:20:07'
    - '2023-12-14 05:09:36'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-11-04 22:53:49' AND '2023-11-19 22:12:29'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - - '2023-11-04 22:53:49'
    - '2023-11-19 22:12:29'
  - Charité-Campus-Klinik
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-05-09':timestamp AND timestamp < ('2023-05-09'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-05-09'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf' GROUP BY d.name;
  params:
  - Steglitz-Zehlendorf
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg';
  params:
  - Tempelhof-Schöneberg
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2024-03-28':timestamp AND timestamp < ('2024-03-28'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-03-28'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-09-16 06:34:08' AND '2023-09-23 19:11:03'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2023-09-16 06:34:08'
    - '2023-09-23 19:11:03'
  - Humboldt-Universität-zu-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-09-14 07:46:31' AND '2023-09-27 23:02:18' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-09-14 07:46:31'
    - '2023-09-27 23:02:18'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-06-14 07:19:39' AND '2023-06-28 12:21:04'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2023-06-14 07:19:39'
    - '2023-06-28 12:21:04'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-12-01 12:31:00' AND '2023-12-03 13:08:16';
  params:
  - - '2023-12-01 12:31:00'
    - '2023-12-03 13:08:16'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-06-15':timestamp AND timestamp < ('2023-06-15'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-06-15'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-01-03 23:55:01' AND '2024-01-11 08:43:11';
  params:
  - - '2024-01-03 23:55:01'
    - '2024-01-11 08:43:11'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-01-31 10:30:35' AND '2024-02-14 00:25:14' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2024-01-31 10:30:35'
    - '2024-02-14 00:25:14'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Mitte' GROUP BY d.name;
  params:
  - Mitte
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-02-20 01:54:54' AND '2024-02-27 09:18:13'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2024-02-20 01:54:54'
    - '2024-02-27 09:18:13'
  - Humboldt-Universität-zu-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Treptow-Köpenick' GROUP BY d.name;
  params:
  - Treptow-Köpenick
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-02-20 23:21:34' AND '2024-03-02 18:58:38'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2024-02-20 23:21:34'
    - '2024-03-02 18:58:38'
  - Universität-der-Künste-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-06-07 13:08:48' AND '2023-06-11 06:08:36';
  params:
  - - '2023-06-07 13:08:48'
    - '2023-06-11 06:08:36'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-05-31':timestamp AND timestamp < ('2023-05-31'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-05-31'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg' GROUP BY d.name;
  params:
  - Tempelhof-Schöneberg
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Treptow-Köpenick';
  params:
  - Treptow-Köpenick
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Lichtenberg' GROUP BY d.name;
  params:
  - Lichtenberg
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-10-10 06:21:54' AND '2023-10-19 11:52:15'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Bard-College';
  params:
  - - '2023-10-10 06:21:54'
    - '2023-10-19 11:52:15'
  - Bard-College
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-02-01 00:15:31' AND '2024-02-05 11:12:12'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2024-02-01 00:15:31'
    - '2024-02-05 11:12:12'
  - Technische-Universität-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-12-22 05:01:02' AND '2024-01-05 03:35:22';
  params:
  - - '2023-12-22 05:01:02'
    - '2024-01-05 03:35:22'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-09-12 20:07:27' AND '2023-09-16 18:59:02' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-09-12 20:07:27'
    - '2023-09-16 18:59:02'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Pankow';
  params:
  - Pankow
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-10-24 21:00:53' AND '2023-11-03 09:35:31' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-10-24 21:00:53'
    - '2023-11-03 09:35:31'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-04-20 13:22:20' AND '2023-04-24 06:18:29';
  params:
  - - '2023-04-20 13:22:20'
    - '2023-04-24 06:18:29'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-03-05 06:17:50' AND '2023-03-08 17:45:38'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - - '2023-03-05 06:17:50'
    - '2023-03-08 17:45:38'
  - European-School-of-Management-and-Technology-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Pankow';
  params:
  - Pankow
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-04-02 23:22:27' AND '2023-04-06 06:12:46'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2023-04-02 23:22:27'
    - '2023-04-06 06:12:46'
  - Universität-der-Künste-Berlin
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-07-21':timestamp AND timestamp < ('2023-07-21'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-07-21'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Lichtenberg';
  params:
  - Lichtenberg
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-03-31':timestamp AND timestamp < ('2023-03-31'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-03-31'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Spandau' GROUP BY d.name;
  params:
  - Spandau
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-02-10 17:58:33' AND '2024-02-14 18:30:58';
  params:
  - - '2024-02-10 17:58:33'
    - '2024-02-14 18:30:58'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-06-06 21:57:57' AND '2023-06-10 19:00:33'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2023-06-06 21:57:57'
    - '2023-06-10 19:00:33'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-06-16':timestamp AND timestamp < ('2023-06-16'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-06-16'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-10-25 03:07:36' AND '2023-10-28 15:24:42' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-10-25 03:07:36'
    - '2023-10-28 15:24:42'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-07-06 10:54:30' AND '2023-07-18 23:47:59'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2023-07-06 10:54:30'
    - '2023-07-18 23:47:59'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-06-21 06:17:13' AND '2023-07-05 19:15:16' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-06-21 06:17:13'
    - '2023-07-05 19:15:16'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-11-01 14:14:23' AND '2023-11-11 22:03:30'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2023-11-01 14:14:23'
    - '2023-11-11 22:03:30'
  - Humboldt-Universität-zu-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-05-27 01:04:19' AND '2023-06-09 17:31:12' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-05-27 01:04:19'
    - '2023-06-09 17:31:12'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-07-19 00:34:20' AND '2023-07-25 15:43:05' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-07-19 00:34:20'
    - '2023-07-25 15:43:05'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-10-08':timestamp AND timestamp < ('2023-10-08'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-10-08'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf' GROUP BY d.name;
  params:
  - Steglitz-Zehlendorf
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Spandau' GROUP BY d.name;
  params:
  - Spandau
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Spandau';
  params:
  - Spandau
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-09-30 07:40:25' AND '2023-10-06 11:20:29' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-09-30 07:40:25'
    - '2023-10-06 11:20:29'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-08-02':timestamp AND timestamp < ('2023-08-02'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-08-02'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-11-27 23:01:34' AND '2023-12-08 11:33:25' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-11-27 23:01:34'
    - '2023-12-08 11:33:25'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-07-28 07:40:27' AND '2023-07-30 11:40:34';
  params:
  - - '2023-07-28 07:40:27'
    - '2023-07-30 11:40:34'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-12-13 09:20:00' AND '2023-12-18 01:06:39'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2023-12-13 09:20:00'
    - '2023-12-18 01:06:39'
  - Humboldt-Universität-zu-Berlin
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-08-23':timestamp AND timestamp < ('2023-08-23'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-08-23'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-02-01 22:44:40' AND '2024-02-05 11:58:02'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2024-02-01 22:44:40'
    - '2024-02-05 11:58:02'
  - Humboldt-Universität-zu-Berlin
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-03-21':timestamp AND timestamp < ('2023-03-21'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-03-21'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-05-02 16:57:46' AND '2023-05-05 08:14:14';
  params:
  - - '2023-05-02 16:57:46'
    - '2023-05-05 08:14:14'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Pankow';
  params:
  - Pankow
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg' GROUP BY d.name;
  params:
  - Friedrichshain-Kreuzberg
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-12-05 07:52:45' AND '2023-12-13 23:04:41' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-12-05 07:52:45'
    - '2023-12-13 23:04:41'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Pankow';
  params:
  - Pankow
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Neukölln' GROUP BY d.name;
  params:
  - Neukölln
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-07-04 04:20:08' AND '2023-07-12 20:08:33'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2023-07-04 04:20:08'
    - '2023-07-12 20:08:33'
  - Humboldt-Universität-zu-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-12-05 22:50:33' AND '2023-12-11 07:45:36' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-12-05 22:50:33'
    - '2023-12-11 07:45:36'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-09-05 14:55:19' AND '2023-09-12 18:04:58'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - - '2023-09-05 14:55:19'
    - '2023-09-12 18:04:58'
  - Charité-Campus-Klinik
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-11-06 08:40:11' AND '2023-11-08 20:22:22' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-11-06 08:40:11'
    - '2023-11-08 20:22:22'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-08-31 19:01:02' AND '2023-09-12 16:41:36' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-08-31 19:01:02'
    - '2023-09-12 16:41:36'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-04-12 16:30:25' AND '2023-04-26 01:52:26';
  params:
  - - '2023-04-12 16:30:25'
    - '2023-04-26 01:52:26'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-10-28':timestamp AND timestamp < ('2023-10-28'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-10-28'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-02-21 13:59:09' AND '2023-03-02 03:41:07' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-02-21 13:59:09'
    - '2023-03-02 03:41:07'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-06-27 06:01:18' AND '2023-07-09 02:50:08';
  params:
  - - '2023-06-27 06:01:18'
    - '2023-07-09 02:50:08'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-06-07 20:12:28' AND '2023-06-18 00:25:11'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - - '2023-06-07 20:12:28'
    - '2023-06-18 00:25:11'
  - European-School-of-Management-and-Technology-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Lichtenberg';
  params:
  - Lichtenberg
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-07-04 07:15:19' AND '2023-07-14 08:13:14';
  params:
  - - '2023-07-04 07:15:19'
    - '2023-07-14 08:13:14'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-05-10 04:49:59' AND '2023-05-14 09:28:24';
  params:
  - - '2023-05-10 04:49:59'
    - '2023-05-14 09:28:24'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-12-02 01:38:34' AND '2023-12-08 04:03:58' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-12-02 01:38:34'
    - '2023-12-08 04:03:58'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-02-26 03:03:00' AND '2024-03-08 05:14:25'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2024-02-26 03:03:00'
    - '2024-03-08 05:14:25'
  - Universität-der-Künste-Berlin
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-05-16':timestamp AND timestamp < ('2023-05-16'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-05-16'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-07-22 02:52:20' AND '2023-07-27 13:02:57';
  params:
  - - '2023-07-22 02:52:20'
    - '2023-07-27 13:02:57'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg' GROUP BY d.name;
  params:
  - Tempelhof-Schöneberg
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-02-24 20:52:14' AND '2024-03-02 16:22:12'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2024-02-24 20:52:14'
    - '2024-03-02 16:22:12'
  - Universität-der-Künste-Berlin
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-08-31':timestamp AND timestamp < ('2023-08-31'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-08-31'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-03-01 12:53:01' AND '2023-03-13 22:04:44';
  params:
  - - '2023-03-01 12:53:01'
    - '2023-03-13 22:04:44'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf' GROUP BY d.name;
  params:
  - Steglitz-Zehlendorf
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-09-06 14:07:27' AND '2023-09-15 15:50:46' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-09-06 14:07:27'
    - '2023-09-15 15:50:46'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-09-17 19:18:51' AND '2023-09-26 05:23:47'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - - '2023-09-17 19:18:51'
    - '2023-09-26 05:23:47'
  - Charité-Campus-Klinik
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-06-23 23:07:21' AND '2023-07-07 15:32:11'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2023-06-23 23:07:21'
    - '2023-07-07 15:32:11'
  - Freie-Universität-Berlin
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-09-26 06:34:14' AND '2023-10-09 07:08:26'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2023-09-26 06:34:14'
    - '2023-10-09 07:08:26'
  - Freie-Universität-Berlin
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-08-17 12:27:22' AND '2023-08-22 14:35:49'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2023-08-17 12:27:22'
    - '2023-08-22 14:35:49'
  - Humboldt-Universität-zu-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Neukölln' GROUP BY d.name;
  params:
  - Neukölln
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-09-17 12:35:03' AND '2023-09-29 01:46:28'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - - '2023-09-17 12:35:03'
    - '2023-09-29 01:46:28'
  - European-School-of-Management-and-Technology-Berlin
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM tsdb_ride_points r WHERE timestamp >= '2023-04-22':timestamp AND timestamp < ('2023-04-22'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-04-22'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Reinickendorf';
  params:
  - Reinickendorf
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-03-23 23:25:31' AND '2023-04-06 19:16:57';
  params:
  - - '2023-03-23 23:25:31'
    - '2023-04-06 19:16:57'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2024-01-08 07:57:42' AND '2024-01-19 05:56:14';
  params:
  - - '2024-01-08 07:57:42'
    - '2024-01-19 05:56:14'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Reinickendorf';
  params:
  - Reinickendorf
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf';
  params:
  - Charlottenburg-Wilmersdorf
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg' GROUP BY d.name;
  params:
  - Tempelhof-Schöneberg
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Treptow-Köpenick' GROUP BY d.name;
  params:
  - Treptow-Köpenick
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-10-17 08:59:42' AND '2023-10-29 07:14:04' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-10-17 08:59:42'
    - '2023-10-29 07:14:04'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-11-22 01:47:32' AND '2023-12-02 13:10:17' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-11-22 01:47:32'
    - '2023-12-02 13:10:17'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-07-20 14:26:07' AND '2023-07-24 07:21:59' AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN tsdb_ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-07-20 14:26:07'
    - '2023-07-24 07:21:59'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-12-11 22:08:35' AND '2023-12-22 22:42:22'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2023-12-11 22:08:35'
    - '2023-12-22 22:42:22'
  - Technische-Universität-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN tsdb_ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-10-25 11:55:42' AND '2023-11-04 05:14:26';
  params:
  - - '2023-10-25 11:55:42'
    - '2023-11-04 05:14:26'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-12-08 03:05:13' AND '2023-12-11 16:44:55'), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM tsdb_ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN tsdb_ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2023-12-08 03:05:13'
    - '2023-12-11 16:44:55'
  - Technische-Universität-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Treptow-Köpenick';
  params:
  - Treptow-Köpenick
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM tsdb_ride_points r WHERE r.timestamp BETWEEN '2023-08-27 20:34:49' AND '2023-09-08 07:23:37';
  params:
  - - '2023-08-27 20:34:49'
    - '2023-09-08 07:23:37'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Mitte';
  params:
  - Mitte
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM tsdb_ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM tsdb_ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg';
  params:
  - Friedrichshain-Kreuzberg
