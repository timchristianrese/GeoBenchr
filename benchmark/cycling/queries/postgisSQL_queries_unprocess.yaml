- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-03-29 23:39:07', '2023-04-06 22:35:54']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2023-03-29 23:39:07'
    - '2023-04-06 22:35:54'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-05-29 06:44:26', '2023-06-02 21:39:56']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2023-05-29 06:44:26'
    - '2023-06-02 21:39:56'
  - Technische-Universität-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-09-21 07:21:35', '2023-10-04 16:17:37'];
  params:
  - - '2023-09-21 07:21:35'
    - '2023-10-04 16:17:37'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-07-23 16:31:17', '2023-08-06 04:42:46'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-07-23 16:31:17'
    - '2023-08-06 04:42:46'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-10-10 18:20:36', '2023-10-13 10:29:45']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - - '2023-10-10 18:20:36'
    - '2023-10-13 10:29:45'
  - Charité-Campus-Klinik
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-10-23':timestamp AND timestamp < ('2023-10-23'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-10-23'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Neukölln';
  params:
  - Neukölln
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2024-01-27 21:40:33', '2024-02-03 10:59:40'];
  params:
  - - '2024-01-27 21:40:33'
    - '2024-02-03 10:59:40'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2024-01-22 13:41:27', '2024-01-26 04:03:25'];
  params:
  - - '2024-01-22 13:41:27'
    - '2024-01-26 04:03:25'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Lichtenberg' GROUP BY d.name;
  params:
  - Lichtenberg
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Spandau';
  params:
  - Spandau
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-11-29':timestamp AND timestamp < ('2023-11-29'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-11-29'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf' GROUP BY d.name;
  params:
  - Steglitz-Zehlendorf
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-11-03 20:57:09', '2023-11-17 06:48:46'];
  params:
  - - '2023-11-03 20:57:09'
    - '2023-11-17 06:48:46'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-02-10 04:26:40', '2024-02-20 23:15:14'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2024-02-10 04:26:40'
    - '2024-02-20 23:15:14'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-07-06 18:02:30', '2023-07-21 07:17:06']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2023-07-06 18:02:30'
    - '2023-07-21 07:17:06'
  - Freie-Universität-Berlin
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-10-24 09:34:35', '2023-11-07 06:36:53']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2023-10-24 09:34:35'
    - '2023-11-07 06:36:53'
  - Technische-Universität-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf';
  params:
  - Steglitz-Zehlendorf
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-06-22 02:13:11', '2023-07-05 01:58:03'];
  params:
  - - '2023-06-22 02:13:11'
    - '2023-07-05 01:58:03'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf';
  params:
  - Marzahn-Hellersdorf
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2024-01-20 12:41:22', '2024-02-03 21:34:54'];
  params:
  - - '2024-01-20 12:41:22'
    - '2024-02-03 21:34:54'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2024-02-10':timestamp AND timestamp < ('2024-02-10'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-02-10'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-06-09 21:07:38', '2023-06-13 02:37:51'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-06-09 21:07:38'
    - '2023-06-13 02:37:51'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-10-13 06:03:24', '2023-10-22 22:34:01'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-10-13 06:03:24'
    - '2023-10-22 22:34:01'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-02-17 00:23:38', '2024-02-28 01:12:54']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2024-02-17 00:23:38'
    - '2024-02-28 01:12:54'
  - Freie-Universität-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Pankow' GROUP BY d.name;
  params:
  - Pankow
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Reinickendorf' GROUP BY d.name;
  params:
  - Reinickendorf
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf';
  params:
  - Charlottenburg-Wilmersdorf
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-04-19 01:23:05', '2023-04-27 02:51:37']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2023-04-19 01:23:05'
    - '2023-04-27 02:51:37'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-11-05 17:35:21', '2023-11-08 14:54:24'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-11-05 17:35:21'
    - '2023-11-08 14:54:24'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Lichtenberg' GROUP BY d.name;
  params:
  - Lichtenberg
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-05-05':timestamp AND timestamp < ('2023-05-05'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-05-05'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-03-12 08:59:28', '2023-03-21 06:09:27'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-03-12 08:59:28'
    - '2023-03-21 06:09:27'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Spandau' GROUP BY d.name;
  params:
  - Spandau
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg' GROUP BY d.name;
  params:
  - Friedrichshain-Kreuzberg
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Spandau';
  params:
  - Spandau
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-02-02 21:39:50', '2024-02-15 12:23:51'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2024-02-02 21:39:50'
    - '2024-02-15 12:23:51'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Mitte';
  params:
  - Mitte
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Spandau' GROUP BY d.name;
  params:
  - Spandau
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-06-20 19:29:31', '2023-06-23 00:13:22'];
  params:
  - - '2023-06-20 19:29:31'
    - '2023-06-23 00:13:22'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg';
  params:
  - Friedrichshain-Kreuzberg
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-12-15 02:15:20', '2023-12-27 19:40:40']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2023-12-15 02:15:20'
    - '2023-12-27 19:40:40'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-03-10':timestamp AND timestamp < ('2023-03-10'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-03-10'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-05-19 14:09:24', '2023-05-21 17:25:57'];
  params:
  - - '2023-05-19 14:09:24'
    - '2023-05-21 17:25:57'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Pankow';
  params:
  - Pankow
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-04-18 03:17:19', '2023-04-28 21:09:07'];
  params:
  - - '2023-04-18 03:17:19'
    - '2023-04-28 21:09:07'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-01-10 20:34:07', '2024-01-15 13:46:47'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2024-01-10 20:34:07'
    - '2024-01-15 13:46:47'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-07-07 05:49:46', '2023-07-09 10:28:48']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2023-07-07 05:49:46'
    - '2023-07-09 10:28:48'
  - Technische-Universität-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-11-01 14:54:40', '2023-11-04 20:50:37'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-11-01 14:54:40'
    - '2023-11-04 20:50:37'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-11-26 03:34:01', '2023-11-30 08:59:39'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-11-26 03:34:01'
    - '2023-11-30 08:59:39'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-01-24 11:09:42', '2024-02-04 03:00:37'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2024-01-24 11:09:42'
    - '2024-02-04 03:00:37'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-05-19':timestamp AND timestamp < ('2023-05-19'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-05-19'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-10-04':timestamp AND timestamp < ('2023-10-04'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-10-04'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Neukölln' GROUP BY d.name;
  params:
  - Neukölln
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-01-01 01:24:33', '2024-01-12 17:46:27'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2024-01-01 01:24:33'
    - '2024-01-12 17:46:27'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2024-01-15':timestamp AND timestamp < ('2024-01-15'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-01-15'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-12-04':timestamp AND timestamp < ('2023-12-04'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-12-04'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-05-03 14:34:59', '2023-05-17 08:18:37'];
  params:
  - - '2023-05-03 14:34:59'
    - '2023-05-17 08:18:37'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg';
  params:
  - Tempelhof-Schöneberg
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-11-22 08:22:40', '2023-11-24 09:12:33'];
  params:
  - - '2023-11-22 08:22:40'
    - '2023-11-24 09:12:33'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Treptow-Köpenick' GROUP BY d.name;
  params:
  - Treptow-Köpenick
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf';
  params:
  - Marzahn-Hellersdorf
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-02-22 07:04:55', '2023-03-03 04:17:36']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2023-02-22 07:04:55'
    - '2023-03-03 04:17:36'
  - Technische-Universität-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Spandau';
  params:
  - Spandau
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-06 00:27:18', '2023-08-16 16:03:33']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2023-08-06 00:27:18'
    - '2023-08-16 16:03:33'
  - Universität-der-Künste-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-09-23 11:09:38', '2023-10-07 15:48:46'];
  params:
  - - '2023-09-23 11:09:38'
    - '2023-10-07 15:48:46'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Neukölln' GROUP BY d.name;
  params:
  - Neukölln
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2024-01-23 12:20:33', '2024-02-01 11:58:40'];
  params:
  - - '2024-01-23 12:20:33'
    - '2024-02-01 11:58:40'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-11-14 22:17:26', '2023-11-29 11:47:17']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - - '2023-11-14 22:17:26'
    - '2023-11-29 11:47:17'
  - Charité-Campus-Klinik
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Reinickendorf' GROUP BY d.name;
  params:
  - Reinickendorf
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-10-17 01:53:38', '2023-10-21 12:42:45']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2023-10-17 01:53:38'
    - '2023-10-21 12:42:45'
  - Technische-Universität-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-07-19 03:29:58', '2023-07-30 03:15:53'];
  params:
  - - '2023-07-19 03:29:58'
    - '2023-07-30 03:15:53'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf' GROUP BY d.name;
  params:
  - Steglitz-Zehlendorf
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-05-13 19:30:28', '2023-05-20 08:02:10'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-05-13 19:30:28'
    - '2023-05-20 08:02:10'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-12-04':timestamp AND timestamp < ('2023-12-04'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-12-04'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-15 18:01:56', '2023-08-29 11:46:30']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2023-08-15 18:01:56'
    - '2023-08-29 11:46:30'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg' GROUP BY d.name;
  params:
  - Tempelhof-Schöneberg
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg';
  params:
  - Friedrichshain-Kreuzberg
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2024-02-16 18:42:37', '2024-02-22 02:48:15'];
  params:
  - - '2024-02-16 18:42:37'
    - '2024-02-22 02:48:15'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-10-22':timestamp AND timestamp < ('2023-10-22'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-10-22'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-07-17 02:26:20', '2023-07-24 23:16:41']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2023-07-17 02:26:20'
    - '2023-07-24 23:16:41'
  - Freie-Universität-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Pankow' GROUP BY d.name;
  params:
  - Pankow
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg';
  params:
  - Tempelhof-Schöneberg
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Neukölln' GROUP BY d.name;
  params:
  - Neukölln
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-11-20 04:36:18', '2023-11-25 01:38:25']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Bard-College';
  params:
  - - '2023-11-20 04:36:18'
    - '2023-11-25 01:38:25'
  - Bard-College
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-05 22:46:04', '2023-08-08 00:48:22'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-08-05 22:46:04'
    - '2023-08-08 00:48:22'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-17 08:58:34', '2023-08-30 01:08:48']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2023-08-17 08:58:34'
    - '2023-08-30 01:08:48'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-11-22 19:46:44', '2023-12-04 07:39:18'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-11-22 19:46:44'
    - '2023-12-04 07:39:18'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-04 23:11:14', '2023-08-19 07:42:43']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2023-08-04 23:11:14'
    - '2023-08-19 07:42:43'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Mitte' GROUP BY d.name;
  params:
  - Mitte
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf';
  params:
  - Marzahn-Hellersdorf
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-12-21 17:30:52', '2023-12-24 17:50:21'];
  params:
  - - '2023-12-21 17:30:52'
    - '2023-12-24 17:50:21'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf';
  params:
  - Marzahn-Hellersdorf
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-12-16 03:02:47', '2023-12-27 15:15:19'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-12-16 03:02:47'
    - '2023-12-27 15:15:19'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-21 03:50:39', '2023-08-30 10:52:31']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2023-08-21 03:50:39'
    - '2023-08-30 10:52:31'
  - Humboldt-Universität-zu-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg';
  params:
  - Tempelhof-Schöneberg
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2024-01-25':timestamp AND timestamp < ('2024-01-25'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-01-25'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Treptow-Köpenick';
  params:
  - Treptow-Köpenick
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Pankow' GROUP BY d.name;
  params:
  - Pankow
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-07-06':timestamp AND timestamp < ('2023-07-06'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-07-06'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2024-01-10':timestamp AND timestamp < ('2024-01-10'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-01-10'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Reinickendorf';
  params:
  - Reinickendorf
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-03-20 22:12:38', '2023-03-29 14:41:47']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2023-03-20 22:12:38'
    - '2023-03-29 14:41:47'
  - Freie-Universität-Berlin
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-03-13 20:55:48', '2023-03-23 23:05:17']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2023-03-13 20:55:48'
    - '2023-03-23 23:05:17'
  - Freie-Universität-Berlin
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-06-16 02:07:27', '2023-06-23 16:09:53']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2023-06-16 02:07:27'
    - '2023-06-23 16:09:53'
  - Freie-Universität-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg';
  params:
  - Tempelhof-Schöneberg
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-03-21 10:02:16', '2023-04-02 22:36:31'];
  params:
  - - '2023-03-21 10:02:16'
    - '2023-04-02 22:36:31'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-05-09':timestamp AND timestamp < ('2023-05-09'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-05-09'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-06-09':timestamp AND timestamp < ('2023-06-09'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-06-09'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg' GROUP BY d.name;
  params:
  - Friedrichshain-Kreuzberg
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Treptow-Köpenick' GROUP BY d.name;
  params:
  - Treptow-Köpenick
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-03-30 18:58:27', '2023-04-05 19:26:16'];
  params:
  - - '2023-03-30 18:58:27'
    - '2023-04-05 19:26:16'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-05-05':timestamp AND timestamp < ('2023-05-05'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-05-05'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-10-01 15:00:09', '2023-10-04 18:16:06'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-10-01 15:00:09'
    - '2023-10-04 18:16:06'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Neukölln' GROUP BY d.name;
  params:
  - Neukölln
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Neukölln' GROUP BY d.name;
  params:
  - Neukölln
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-07-12 09:26:42', '2023-07-21 05:34:32']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - - '2023-07-12 09:26:42'
    - '2023-07-21 05:34:32'
  - Charité-Campus-Klinik
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Spandau' GROUP BY d.name;
  params:
  - Spandau
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-02-09 05:47:47', '2024-02-11 11:04:44'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2024-02-09 05:47:47'
    - '2024-02-11 11:04:44'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2024-02-24':timestamp AND timestamp < ('2024-02-24'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-02-24'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2024-03-29':timestamp AND timestamp < ('2024-03-29'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-03-29'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Treptow-Köpenick';
  params:
  - Treptow-Köpenick
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-11-14 15:59:42', '2023-11-19 19:17:22'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-11-14 15:59:42'
    - '2023-11-19 19:17:22'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Neukölln' GROUP BY d.name;
  params:
  - Neukölln
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-09-07 06:53:40', '2023-09-11 09:16:23'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-09-07 06:53:40'
    - '2023-09-11 09:16:23'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf' GROUP BY d.name;
  params:
  - Steglitz-Zehlendorf
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-04-01 04:18:07', '2023-04-16 01:58:52'];
  params:
  - - '2023-04-01 04:18:07'
    - '2023-04-16 01:58:52'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-25 19:41:58', '2023-08-29 15:09:30'];
  params:
  - - '2023-08-25 19:41:58'
    - '2023-08-29 15:09:30'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf';
  params:
  - Marzahn-Hellersdorf
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-07-15 12:22:08', '2023-07-27 17:38:35'];
  params:
  - - '2023-07-15 12:22:08'
    - '2023-07-27 17:38:35'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-05-29':timestamp AND timestamp < ('2023-05-29'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-05-29'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-05-21 06:55:27', '2023-06-04 01:23:07']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - - '2023-05-21 06:55:27'
    - '2023-06-04 01:23:07'
  - European-School-of-Management-and-Technology-Berlin
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-06-26':timestamp AND timestamp < ('2023-06-26'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-06-26'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-12-20 12:49:34', '2023-12-23 05:05:27'];
  params:
  - - '2023-12-20 12:49:34'
    - '2023-12-23 05:05:27'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg' GROUP BY d.name;
  params:
  - Tempelhof-Schöneberg
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Neukölln' GROUP BY d.name;
  params:
  - Neukölln
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2024-01-20 06:16:58', '2024-01-26 14:33:45'];
  params:
  - - '2024-01-20 06:16:58'
    - '2024-01-26 14:33:45'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf';
  params:
  - Charlottenburg-Wilmersdorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-08-11':timestamp AND timestamp < ('2023-08-11'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-08-11'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Pankow';
  params:
  - Pankow
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-03-24':timestamp AND timestamp < ('2023-03-24'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-03-24'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-04-01':timestamp AND timestamp < ('2023-04-01'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-04-01'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-09-07 04:40:50', '2023-09-12 17:11:38'];
  params:
  - - '2023-09-07 04:40:50'
    - '2023-09-12 17:11:38'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Treptow-Köpenick';
  params:
  - Treptow-Köpenick
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-09-15 13:25:11', '2023-09-27 23:16:00'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-09-15 13:25:11'
    - '2023-09-27 23:16:00'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg' GROUP BY d.name;
  params:
  - Friedrichshain-Kreuzberg
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Lichtenberg' GROUP BY d.name;
  params:
  - Lichtenberg
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-05-29':timestamp AND timestamp < ('2023-05-29'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-05-29'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-04-21 15:28:38', '2023-04-24 06:58:15'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-04-21 15:28:38'
    - '2023-04-24 06:58:15'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Pankow';
  params:
  - Pankow
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-09-10 12:36:43', '2023-09-24 23:38:27']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - - '2023-09-10 12:36:43'
    - '2023-09-24 23:38:27'
  - Charité-Campus-Klinik
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-07-11 10:32:05', '2023-07-24 21:59:11'];
  params:
  - - '2023-07-11 10:32:05'
    - '2023-07-24 21:59:11'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg' GROUP BY d.name;
  params:
  - Tempelhof-Schöneberg
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-04-27 00:49:35', '2023-05-02 16:35:18'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-04-27 00:49:35'
    - '2023-05-02 16:35:18'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-06-12 09:26:33', '2023-06-20 13:19:02'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-06-12 09:26:33'
    - '2023-06-20 13:19:02'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-05-09 18:26:16', '2023-05-24 09:04:38'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-05-09 18:26:16'
    - '2023-05-24 09:04:38'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-09-14 21:28:13', '2023-09-26 13:38:27'];
  params:
  - - '2023-09-14 21:28:13'
    - '2023-09-26 13:38:27'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-01-05 05:22:43', '2024-01-08 16:57:58'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2024-01-05 05:22:43'
    - '2024-01-08 16:57:58'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-04-20 07:20:39', '2023-04-30 16:14:23']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Bard-College';
  params:
  - - '2023-04-20 07:20:39'
    - '2023-04-30 16:14:23'
  - Bard-College
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-05-13 11:20:25', '2023-05-17 00:18:30']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2023-05-13 11:20:25'
    - '2023-05-17 00:18:30'
  - Freie-Universität-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-12-24 17:33:06', '2024-01-07 14:48:53'];
  params:
  - - '2023-12-24 17:33:06'
    - '2024-01-07 14:48:53'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Neukölln' GROUP BY d.name;
  params:
  - Neukölln
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-09-12 20:06:40', '2023-09-23 13:18:48'];
  params:
  - - '2023-09-12 20:06:40'
    - '2023-09-23 13:18:48'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-07-17 19:28:55', '2023-07-20 13:50:21']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2023-07-17 19:28:55'
    - '2023-07-20 13:50:21'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2024-02-12 09:04:21', '2024-02-20 09:45:49'];
  params:
  - - '2024-02-12 09:04:21'
    - '2024-02-20 09:45:49'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2024-01-18':timestamp AND timestamp < ('2024-01-18'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-01-18'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-30 19:54:52', '2023-09-04 18:09:28'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-08-30 19:54:52'
    - '2023-09-04 18:09:28'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg';
  params:
  - Friedrichshain-Kreuzberg
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-12-09':timestamp AND timestamp < ('2023-12-09'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-12-09'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-10-07 07:06:59', '2023-10-20 22:55:05'];
  params:
  - - '2023-10-07 07:06:59'
    - '2023-10-20 22:55:05'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Spandau' GROUP BY d.name;
  params:
  - Spandau
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-31 13:52:09', '2023-09-02 22:50:20']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2023-08-31 13:52:09'
    - '2023-09-02 22:50:20'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf' GROUP BY d.name;
  params:
  - Marzahn-Hellersdorf
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-01-26 06:52:55', '2024-02-03 14:54:48']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Bard-College';
  params:
  - - '2024-01-26 06:52:55'
    - '2024-02-03 14:54:48'
  - Bard-College
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2024-02-24':timestamp AND timestamp < ('2024-02-24'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-02-24'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-12-26 08:00:46', '2024-01-04 16:52:51']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - - '2023-12-26 08:00:46'
    - '2024-01-04 16:52:51'
  - European-School-of-Management-and-Technology-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-04-25 06:44:58', '2023-05-08 06:59:19'];
  params:
  - - '2023-04-25 06:44:58'
    - '2023-05-08 06:59:19'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-09-07 04:50:48', '2023-09-18 16:05:47'];
  params:
  - - '2023-09-07 04:50:48'
    - '2023-09-18 16:05:47'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-11-01 06:19:39', '2023-11-12 16:48:41']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2023-11-01 06:19:39'
    - '2023-11-12 16:48:41'
  - Humboldt-Universität-zu-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-02-11 17:18:46', '2024-02-24 20:52:55'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2024-02-11 17:18:46'
    - '2024-02-24 20:52:55'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg' GROUP BY d.name;
  params:
  - Tempelhof-Schöneberg
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-10-24':timestamp AND timestamp < ('2023-10-24'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-10-24'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-05-23 05:17:30', '2023-05-28 12:27:47'];
  params:
  - - '2023-05-23 05:17:30'
    - '2023-05-28 12:27:47'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg';
  params:
  - Friedrichshain-Kreuzberg
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-07-29 09:12:17', '2023-07-31 17:47:24'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-07-29 09:12:17'
    - '2023-07-31 17:47:24'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-05-17 23:21:04', '2023-05-20 09:37:57'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-05-17 23:21:04'
    - '2023-05-20 09:37:57'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf';
  params:
  - Marzahn-Hellersdorf
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2024-01-24 14:21:45', '2024-01-28 00:31:15'];
  params:
  - - '2024-01-24 14:21:45'
    - '2024-01-28 00:31:15'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-12 02:38:09', '2023-08-26 12:38:28'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-08-12 02:38:09'
    - '2023-08-26 12:38:28'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf';
  params:
  - Steglitz-Zehlendorf
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-12-04 06:27:44', '2023-12-14 01:00:20'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-12-04 06:27:44'
    - '2023-12-14 01:00:20'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-03-10 08:51:21', '2023-03-24 11:25:26'];
  params:
  - - '2023-03-10 08:51:21'
    - '2023-03-24 11:25:26'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-03-15 07:14:17', '2023-03-27 00:25:16'];
  params:
  - - '2023-03-15 07:14:17'
    - '2023-03-27 00:25:16'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-11-22 18:48:18', '2023-11-26 02:33:05']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - - '2023-11-22 18:48:18'
    - '2023-11-26 02:33:05'
  - European-School-of-Management-and-Technology-Berlin
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-12-04':timestamp AND timestamp < ('2023-12-04'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-12-04'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-12-30 17:00:16', '2024-01-09 15:34:11']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - - '2023-12-30 17:00:16'
    - '2024-01-09 15:34:11'
  - Charité-Campus-Klinik
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf';
  params:
  - Steglitz-Zehlendorf
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Pankow' GROUP BY d.name;
  params:
  - Pankow
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Pankow';
  params:
  - Pankow
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-08-24':timestamp AND timestamp < ('2023-08-24'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-08-24'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-10-04 14:43:03', '2023-10-18 18:04:32'];
  params:
  - - '2023-10-04 14:43:03'
    - '2023-10-18 18:04:32'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-05-29 06:46:54', '2023-06-05 20:46:20'];
  params:
  - - '2023-05-29 06:46:54'
    - '2023-06-05 20:46:20'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg';
  params:
  - Friedrichshain-Kreuzberg
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-04-28 03:19:48', '2023-05-08 17:26:48'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-04-28 03:19:48'
    - '2023-05-08 17:26:48'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Treptow-Köpenick' GROUP BY d.name;
  params:
  - Treptow-Köpenick
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf' GROUP BY d.name;
  params:
  - Steglitz-Zehlendorf
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg' GROUP BY d.name;
  params:
  - Tempelhof-Schöneberg
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-09-16':timestamp AND timestamp < ('2023-09-16'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-09-16'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Spandau' GROUP BY d.name;
  params:
  - Spandau
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-03-20 04:53:25', '2023-03-30 05:00:20'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-03-20 04:53:25'
    - '2023-03-30 05:00:20'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg' GROUP BY d.name;
  params:
  - Tempelhof-Schöneberg
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-11-14 10:53:34', '2023-11-25 15:07:13']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2023-11-14 10:53:34'
    - '2023-11-25 15:07:13'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-11-15':timestamp AND timestamp < ('2023-11-15'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-11-15'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Neukölln' GROUP BY d.name;
  params:
  - Neukölln
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Pankow' GROUP BY d.name;
  params:
  - Pankow
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2024-02-09 12:46:56', '2024-02-17 03:56:16'];
  params:
  - - '2024-02-09 12:46:56'
    - '2024-02-17 03:56:16'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-09-18 16:36:44', '2023-09-25 16:38:16']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Bard-College';
  params:
  - - '2023-09-18 16:36:44'
    - '2023-09-25 16:38:16'
  - Bard-College
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-24 23:52:57', '2023-09-08 07:53:10']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Bard-College';
  params:
  - - '2023-08-24 23:52:57'
    - '2023-09-08 07:53:10'
  - Bard-College
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-10-20 16:50:24', '2023-10-31 12:06:57'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-10-20 16:50:24'
    - '2023-10-31 12:06:57'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf' GROUP BY d.name;
  params:
  - Steglitz-Zehlendorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2024-03-02':timestamp AND timestamp < ('2024-03-02'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-03-02'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-11-25 21:05:00', '2023-12-10 08:06:39']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2023-11-25 21:05:00'
    - '2023-12-10 08:06:39'
  - Universität-der-Künste-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-12-27 06:16:10', '2024-01-07 03:13:02'];
  params:
  - - '2023-12-27 06:16:10'
    - '2024-01-07 03:13:02'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-04-21 07:12:11', '2023-04-26 17:47:20'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-04-21 07:12:11'
    - '2023-04-26 17:47:20'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2024-01-19 06:37:00', '2024-01-31 14:28:56'];
  params:
  - - '2024-01-19 06:37:00'
    - '2024-01-31 14:28:56'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-05-27 07:41:02', '2023-06-01 05:19:47'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-05-27 07:41:02'
    - '2023-06-01 05:19:47'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg';
  params:
  - Friedrichshain-Kreuzberg
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-07-01 06:42:01', '2023-07-07 12:20:25'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-07-01 06:42:01'
    - '2023-07-07 12:20:25'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-09-18 03:02:37', '2023-09-23 09:15:33']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2023-09-18 03:02:37'
    - '2023-09-23 09:15:33'
  - Humboldt-Universität-zu-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-09-11 09:23:03', '2023-09-17 08:13:13'];
  params:
  - - '2023-09-11 09:23:03'
    - '2023-09-17 08:13:13'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-11-01 15:26:58', '2023-11-16 09:42:17'];
  params:
  - - '2023-11-01 15:26:58'
    - '2023-11-16 09:42:17'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-09-16 22:04:14', '2023-09-24 21:44:05'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-09-16 22:04:14'
    - '2023-09-24 21:44:05'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-07-22 17:41:00', '2023-07-25 01:24:50'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-07-22 17:41:00'
    - '2023-07-25 01:24:50'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-07-17 01:36:30', '2023-07-27 13:22:11'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-07-17 01:36:30'
    - '2023-07-27 13:22:11'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Pankow';
  params:
  - Pankow
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Neukölln';
  params:
  - Neukölln
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-11-29':timestamp AND timestamp < ('2023-11-29'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-11-29'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Lichtenberg' GROUP BY d.name;
  params:
  - Lichtenberg
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-09-13 00:29:50', '2023-09-21 02:37:50'];
  params:
  - - '2023-09-13 00:29:50'
    - '2023-09-21 02:37:50'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-08-12':timestamp AND timestamp < ('2023-08-12'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-08-12'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg' GROUP BY d.name;
  params:
  - Tempelhof-Schöneberg
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-10-04':timestamp AND timestamp < ('2023-10-04'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-10-04'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-07-17 18:58:03', '2023-07-27 09:54:04'];
  params:
  - - '2023-07-17 18:58:03'
    - '2023-07-27 09:54:04'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-09-27 22:19:04', '2023-10-10 23:37:44'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-09-27 22:19:04'
    - '2023-10-10 23:37:44'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-11-07 16:52:21', '2023-11-12 22:17:41'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-11-07 16:52:21'
    - '2023-11-12 22:17:41'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf';
  params:
  - Charlottenburg-Wilmersdorf
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-09 14:01:48', '2023-08-15 20:49:35']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2023-08-09 14:01:48'
    - '2023-08-15 20:49:35'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-06-04 00:56:19', '2023-06-16 03:34:08'];
  params:
  - - '2023-06-04 00:56:19'
    - '2023-06-16 03:34:08'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-20 02:13:56', '2023-08-27 01:13:43'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-08-20 02:13:56'
    - '2023-08-27 01:13:43'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Reinickendorf';
  params:
  - Reinickendorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2024-03-17':timestamp AND timestamp < ('2024-03-17'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-03-17'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2024-02-20':timestamp AND timestamp < ('2024-02-20'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-02-20'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-01-11 04:06:36', '2024-01-13 12:11:59']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2024-01-11 04:06:36'
    - '2024-01-13 12:11:59'
  - Technische-Universität-Berlin
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-09-20 19:51:08', '2023-09-30 13:43:12']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2023-09-20 19:51:08'
    - '2023-09-30 13:43:12'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-14 04:52:25', '2023-08-29 03:34:07'];
  params:
  - - '2023-08-14 04:52:25'
    - '2023-08-29 03:34:07'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Pankow' GROUP BY d.name;
  params:
  - Pankow
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Neukölln';
  params:
  - Neukölln
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Reinickendorf';
  params:
  - Reinickendorf
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-06-06 23:46:13', '2023-06-17 23:32:55'];
  params:
  - - '2023-06-06 23:46:13'
    - '2023-06-17 23:32:55'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg' GROUP BY d.name;
  params:
  - Tempelhof-Schöneberg
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-05-06 19:10:46', '2023-05-10 22:44:46'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-05-06 19:10:46'
    - '2023-05-10 22:44:46'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf';
  params:
  - Charlottenburg-Wilmersdorf
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf';
  params:
  - Steglitz-Zehlendorf
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-05-07 10:46:17', '2023-05-21 17:50:41'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-05-07 10:46:17'
    - '2023-05-21 17:50:41'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Pankow' GROUP BY d.name;
  params:
  - Pankow
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg';
  params:
  - Friedrichshain-Kreuzberg
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-03-31 00:33:19', '2023-04-14 12:40:23']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2023-03-31 00:33:19'
    - '2023-04-14 12:40:23'
  - Freie-Universität-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg' GROUP BY d.name;
  params:
  - Tempelhof-Schöneberg
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-06-10 05:46:47', '2023-06-13 20:20:41'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-06-10 05:46:47'
    - '2023-06-13 20:20:41'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-07-28 12:05:52', '2023-08-07 14:19:09'];
  params:
  - - '2023-07-28 12:05:52'
    - '2023-08-07 14:19:09'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-05-05 10:59:19', '2023-05-20 06:46:33']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2023-05-05 10:59:19'
    - '2023-05-20 06:46:33'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-03-10 09:59:15', '2023-03-25 01:10:58']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2023-03-10 09:59:15'
    - '2023-03-25 01:10:58'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-12-13 11:03:23', '2023-12-21 15:38:14'];
  params:
  - - '2023-12-13 11:03:23'
    - '2023-12-21 15:38:14'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg';
  params:
  - Tempelhof-Schöneberg
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-07-11 23:25:29', '2023-07-15 14:26:40']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Bard-College';
  params:
  - - '2023-07-11 23:25:29'
    - '2023-07-15 14:26:40'
  - Bard-College
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Mitte' GROUP BY d.name;
  params:
  - Mitte
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-03-19':timestamp AND timestamp < ('2023-03-19'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-03-19'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-23 11:31:38', '2023-09-03 14:24:26'];
  params:
  - - '2023-08-23 11:31:38'
    - '2023-09-03 14:24:26'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-05-25 10:43:16', '2023-06-01 17:49:00']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2023-05-25 10:43:16'
    - '2023-06-01 17:49:00'
  - Technische-Universität-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Lichtenberg' GROUP BY d.name;
  params:
  - Lichtenberg
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-12-17 15:11:30', '2024-01-01 02:58:51'];
  params:
  - - '2023-12-17 15:11:30'
    - '2024-01-01 02:58:51'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-05-19 23:50:58', '2023-05-23 18:40:07'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-05-19 23:50:58'
    - '2023-05-23 18:40:07'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-03-18 04:37:39', '2023-03-27 20:14:07'];
  params:
  - - '2023-03-18 04:37:39'
    - '2023-03-27 20:14:07'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-07-14 11:09:24', '2023-07-16 21:27:29']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2023-07-14 11:09:24'
    - '2023-07-16 21:27:29'
  - Freie-Universität-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-09-28 05:07:19', '2023-10-04 07:23:45'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-09-28 05:07:19'
    - '2023-10-04 07:23:45'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-27 18:27:38', '2023-09-04 12:39:45']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2023-08-27 18:27:38'
    - '2023-09-04 12:39:45'
  - Freie-Universität-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-05-15 15:00:58', '2023-05-28 06:28:00'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-05-15 15:00:58'
    - '2023-05-28 06:28:00'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-12-21 03:00:24', '2023-12-26 21:30:12'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-12-21 03:00:24'
    - '2023-12-26 21:30:12'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Treptow-Köpenick';
  params:
  - Treptow-Köpenick
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2024-02-19 01:39:29', '2024-02-24 22:14:31'];
  params:
  - - '2024-02-19 01:39:29'
    - '2024-02-24 22:14:31'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf';
  params:
  - Charlottenburg-Wilmersdorf
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-05-30 15:08:03', '2023-06-05 02:29:05']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2023-05-30 15:08:03'
    - '2023-06-05 02:29:05'
  - Freie-Universität-Berlin
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-04-01':timestamp AND timestamp < ('2023-04-01'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-04-01'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Spandau';
  params:
  - Spandau
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-12-06 15:40:45', '2023-12-10 11:49:43']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2023-12-06 15:40:45'
    - '2023-12-10 11:49:43'
  - Freie-Universität-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg' GROUP BY d.name;
  params:
  - Friedrichshain-Kreuzberg
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Mitte';
  params:
  - Mitte
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Neukölln';
  params:
  - Neukölln
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-11-10':timestamp AND timestamp < ('2023-11-10'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-11-10'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-04-18':timestamp AND timestamp < ('2023-04-18'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-04-18'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-01-07 00:59:58', '2024-01-16 05:11:50']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2024-01-07 00:59:58'
    - '2024-01-16 05:11:50'
  - Humboldt-Universität-zu-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-09-28 17:57:01', '2023-10-09 22:16:56'];
  params:
  - - '2023-09-28 17:57:01'
    - '2023-10-09 22:16:56'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf' GROUP BY d.name;
  params:
  - Steglitz-Zehlendorf
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf' GROUP BY d.name;
  params:
  - Marzahn-Hellersdorf
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-01-10 05:41:27', '2024-01-16 06:15:43']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2024-01-10 05:41:27'
    - '2024-01-16 06:15:43'
  - Universität-der-Künste-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Reinickendorf' GROUP BY d.name;
  params:
  - Reinickendorf
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Pankow';
  params:
  - Pankow
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf' GROUP BY d.name;
  params:
  - Steglitz-Zehlendorf
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-11-18 02:08:08', '2023-11-25 21:57:51'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-11-18 02:08:08'
    - '2023-11-25 21:57:51'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf';
  params:
  - Marzahn-Hellersdorf
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-05-10 11:47:28', '2023-05-21 13:36:13'];
  params:
  - - '2023-05-10 11:47:28'
    - '2023-05-21 13:36:13'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Mitte' GROUP BY d.name;
  params:
  - Mitte
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-02-28 18:28:41', '2023-03-15 00:51:06'];
  params:
  - - '2023-02-28 18:28:41'
    - '2023-03-15 00:51:06'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-20 15:37:54', '2023-08-26 07:50:29'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-08-20 15:37:54'
    - '2023-08-26 07:50:29'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-05-24':timestamp AND timestamp < ('2023-05-24'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-05-24'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-09-25':timestamp AND timestamp < ('2023-09-25'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-09-25'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-01-17 02:18:35', '2024-01-23 20:55:43'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2024-01-17 02:18:35'
    - '2024-01-23 20:55:43'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-06-27 18:29:10', '2023-06-29 23:32:23'];
  params:
  - - '2023-06-27 18:29:10'
    - '2023-06-29 23:32:23'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Spandau';
  params:
  - Spandau
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2024-02-08':timestamp AND timestamp < ('2024-02-08'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-02-08'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-06-19 05:00:44', '2023-06-26 23:09:06'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-06-19 05:00:44'
    - '2023-06-26 23:09:06'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2024-01-11':timestamp AND timestamp < ('2024-01-11'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-01-11'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-05-29 02:17:57', '2023-06-05 01:43:00']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Bard-College';
  params:
  - - '2023-05-29 02:17:57'
    - '2023-06-05 01:43:00'
  - Bard-College
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Neukölln';
  params:
  - Neukölln
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-03-03 12:06:41', '2023-03-11 03:26:36'];
  params:
  - - '2023-03-03 12:06:41'
    - '2023-03-11 03:26:36'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-06-01 17:27:21', '2023-06-10 14:48:00'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-06-01 17:27:21'
    - '2023-06-10 14:48:00'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-05-03 15:59:41', '2023-05-12 17:52:28'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-05-03 15:59:41'
    - '2023-05-12 17:52:28'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-27 18:49:29', '2023-09-01 17:36:49'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-08-27 18:49:29'
    - '2023-09-01 17:36:49'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Lichtenberg';
  params:
  - Lichtenberg
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg' GROUP BY d.name;
  params:
  - Tempelhof-Schöneberg
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Lichtenberg' GROUP BY d.name;
  params:
  - Lichtenberg
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf';
  params:
  - Steglitz-Zehlendorf
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-12-06 20:33:28', '2023-12-17 22:06:19'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-12-06 20:33:28'
    - '2023-12-17 22:06:19'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-06-15 22:56:58', '2023-06-27 17:09:18'];
  params:
  - - '2023-06-15 22:56:58'
    - '2023-06-27 17:09:18'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-08 07:05:01', '2023-08-17 13:18:56'];
  params:
  - - '2023-08-08 07:05:01'
    - '2023-08-17 13:18:56'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg';
  params:
  - Friedrichshain-Kreuzberg
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-12-08 00:07:42', '2023-12-17 07:33:34']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - - '2023-12-08 00:07:42'
    - '2023-12-17 07:33:34'
  - Charité-Campus-Klinik
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-12-16':timestamp AND timestamp < ('2023-12-16'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-12-16'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Reinickendorf' GROUP BY d.name;
  params:
  - Reinickendorf
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf';
  params:
  - Steglitz-Zehlendorf
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-05-17 00:55:30', '2023-05-21 12:41:32'];
  params:
  - - '2023-05-17 00:55:30'
    - '2023-05-21 12:41:32'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-04-24':timestamp AND timestamp < ('2023-04-24'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-04-24'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Reinickendorf';
  params:
  - Reinickendorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2024-01-14':timestamp AND timestamp < ('2024-01-14'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-01-14'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-03-01':timestamp AND timestamp < ('2023-03-01'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-03-01'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-12-05 06:57:32', '2023-12-13 04:15:07'];
  params:
  - - '2023-12-05 06:57:32'
    - '2023-12-13 04:15:07'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-10-31 21:02:38', '2023-11-08 10:48:21'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-10-31 21:02:38'
    - '2023-11-08 10:48:21'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-10-18 12:49:18', '2023-11-01 16:38:29'];
  params:
  - - '2023-10-18 12:49:18'
    - '2023-11-01 16:38:29'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-04-23 01:38:06', '2023-04-30 22:33:04']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Bard-College';
  params:
  - - '2023-04-23 01:38:06'
    - '2023-04-30 22:33:04'
  - Bard-College
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-26 15:05:41', '2023-08-28 23:30:30'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-08-26 15:05:41'
    - '2023-08-28 23:30:30'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Spandau';
  params:
  - Spandau
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Spandau';
  params:
  - Spandau
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-20 13:13:31', '2023-08-26 19:31:36'];
  params:
  - - '2023-08-20 13:13:31'
    - '2023-08-26 19:31:36'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-22 09:37:20', '2023-08-30 22:11:54'];
  params:
  - - '2023-08-22 09:37:20'
    - '2023-08-30 22:11:54'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-04-15':timestamp AND timestamp < ('2023-04-15'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-04-15'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2024-01-18':timestamp AND timestamp < ('2024-01-18'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-01-18'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-04-08 14:52:43', '2023-04-20 09:34:30']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2023-04-08 14:52:43'
    - '2023-04-20 09:34:30'
  - Technische-Universität-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-11-21 00:55:05', '2023-12-02 23:02:01'];
  params:
  - - '2023-11-21 00:55:05'
    - '2023-12-02 23:02:01'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-05-18 13:21:10', '2023-05-29 05:35:44'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-05-18 13:21:10'
    - '2023-05-29 05:35:44'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-05-16 11:05:20', '2023-05-27 09:52:05'];
  params:
  - - '2023-05-16 11:05:20'
    - '2023-05-27 09:52:05'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-09-11 22:43:45', '2023-09-19 04:01:53'];
  params:
  - - '2023-09-11 22:43:45'
    - '2023-09-19 04:01:53'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf';
  params:
  - Marzahn-Hellersdorf
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-06-28 04:48:56', '2023-07-04 19:01:02'];
  params:
  - - '2023-06-28 04:48:56'
    - '2023-07-04 19:01:02'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2024-02-24':timestamp AND timestamp < ('2024-02-24'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-02-24'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-07-29 03:04:36', '2023-08-05 07:16:19']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2023-07-29 03:04:36'
    - '2023-08-05 07:16:19'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf';
  params:
  - Marzahn-Hellersdorf
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Reinickendorf';
  params:
  - Reinickendorf
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Neukölln' GROUP BY d.name;
  params:
  - Neukölln
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg';
  params:
  - Tempelhof-Schöneberg
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2024-03-18':timestamp AND timestamp < ('2024-03-18'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-03-18'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-12-19 16:07:00', '2023-12-31 21:56:39']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2023-12-19 16:07:00'
    - '2023-12-31 21:56:39'
  - Freie-Universität-Berlin
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-05-10':timestamp AND timestamp < ('2023-05-10'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-05-10'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-02-15 22:57:12', '2024-02-24 14:46:16'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2024-02-15 22:57:12'
    - '2024-02-24 14:46:16'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-07-24 09:40:12', '2023-08-07 11:27:25']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Bard-College';
  params:
  - - '2023-07-24 09:40:12'
    - '2023-08-07 11:27:25'
  - Bard-College
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-04-22 14:56:03', '2023-04-27 07:32:37'];
  params:
  - - '2023-04-22 14:56:03'
    - '2023-04-27 07:32:37'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-20 04:46:15', '2023-08-26 06:08:06'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-08-20 04:46:15'
    - '2023-08-26 06:08:06'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2024-02-16':timestamp AND timestamp < ('2024-02-16'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-02-16'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf';
  params:
  - Steglitz-Zehlendorf
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-12-12 23:01:22', '2023-12-23 09:35:16'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-12-12 23:01:22'
    - '2023-12-23 09:35:16'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf' GROUP BY d.name;
  params:
  - Marzahn-Hellersdorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-08-23':timestamp AND timestamp < ('2023-08-23'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-08-23'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-04-14 15:51:31', '2023-04-18 17:28:30'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-04-14 15:51:31'
    - '2023-04-18 17:28:30'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-02-22 20:35:11', '2024-03-06 11:23:58']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - - '2024-02-22 20:35:11'
    - '2024-03-06 11:23:58'
  - European-School-of-Management-and-Technology-Berlin
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-08-11':timestamp AND timestamp < ('2023-08-11'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-08-11'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-02-16 07:39:00', '2024-02-26 20:28:05']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - - '2024-02-16 07:39:00'
    - '2024-02-26 20:28:05'
  - European-School-of-Management-and-Technology-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-26 01:05:41', '2023-08-30 08:42:38'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-08-26 01:05:41'
    - '2023-08-30 08:42:38'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Mitte' GROUP BY d.name;
  params:
  - Mitte
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf';
  params:
  - Marzahn-Hellersdorf
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Spandau' GROUP BY d.name;
  params:
  - Spandau
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-04-23 16:11:14', '2023-04-26 09:15:30'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-04-23 16:11:14'
    - '2023-04-26 09:15:30'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-10-18':timestamp AND timestamp < ('2023-10-18'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-10-18'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf';
  params:
  - Charlottenburg-Wilmersdorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-08-13':timestamp AND timestamp < ('2023-08-13'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-08-13'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Treptow-Köpenick';
  params:
  - Treptow-Köpenick
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-05-21 16:17:11', '2023-05-31 04:45:52'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-05-21 16:17:11'
    - '2023-05-31 04:45:52'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-26 18:56:59', '2023-08-28 22:28:32'];
  params:
  - - '2023-08-26 18:56:59'
    - '2023-08-28 22:28:32'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-01-01 02:45:15', '2024-01-12 07:11:54'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2024-01-01 02:45:15'
    - '2024-01-12 07:11:54'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-12-23 17:55:26', '2023-12-26 06:19:45'];
  params:
  - - '2023-12-23 17:55:26'
    - '2023-12-26 06:19:45'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-03-21':timestamp AND timestamp < ('2023-03-21'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-03-21'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-01-21 03:33:49', '2024-01-27 05:24:12']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - - '2024-01-21 03:33:49'
    - '2024-01-27 05:24:12'
  - European-School-of-Management-and-Technology-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Neukölln';
  params:
  - Neukölln
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf';
  params:
  - Steglitz-Zehlendorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2024-02-16':timestamp AND timestamp < ('2024-02-16'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-02-16'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Treptow-Köpenick';
  params:
  - Treptow-Köpenick
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Spandau';
  params:
  - Spandau
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Lichtenberg' GROUP BY d.name;
  params:
  - Lichtenberg
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-09-18':timestamp AND timestamp < ('2023-09-18'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-09-18'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Spandau' GROUP BY d.name;
  params:
  - Spandau
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2024-02-29':timestamp AND timestamp < ('2024-02-29'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-02-29'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-07-15':timestamp AND timestamp < ('2023-07-15'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-07-15'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2024-01-26':timestamp AND timestamp < ('2024-01-26'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-01-26'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-10-09':timestamp AND timestamp < ('2023-10-09'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-10-09'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf';
  params:
  - Charlottenburg-Wilmersdorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-12-06':timestamp AND timestamp < ('2023-12-06'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-12-06'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Spandau' GROUP BY d.name;
  params:
  - Spandau
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-24 20:00:16', '2023-09-03 23:56:52'];
  params:
  - - '2023-08-24 20:00:16'
    - '2023-09-03 23:56:52'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-09-29 10:18:43', '2023-10-06 02:46:19'];
  params:
  - - '2023-09-29 10:18:43'
    - '2023-10-06 02:46:19'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf' GROUP BY d.name;
  params:
  - Steglitz-Zehlendorf
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg';
  params:
  - Tempelhof-Schöneberg
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-12-03':timestamp AND timestamp < ('2023-12-03'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-12-03'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Lichtenberg';
  params:
  - Lichtenberg
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-10-01 19:44:37', '2023-10-10 02:56:59']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2023-10-01 19:44:37'
    - '2023-10-10 02:56:59'
  - Humboldt-Universität-zu-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-06-05 20:12:53', '2023-06-11 17:06:26'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-06-05 20:12:53'
    - '2023-06-11 17:06:26'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Treptow-Köpenick';
  params:
  - Treptow-Köpenick
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-04-16 21:15:08', '2023-04-26 15:53:21']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Bard-College';
  params:
  - - '2023-04-16 21:15:08'
    - '2023-04-26 15:53:21'
  - Bard-College
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-11-26':timestamp AND timestamp < ('2023-11-26'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-11-26'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-01-03 13:14:02', '2024-01-08 10:35:00'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2024-01-03 13:14:02'
    - '2024-01-08 10:35:00'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2024-03-17':timestamp AND timestamp < ('2024-03-17'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-03-17'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2024-02-06 06:27:19', '2024-02-14 06:53:18'];
  params:
  - - '2024-02-06 06:27:19'
    - '2024-02-14 06:53:18'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-04-08 02:46:34', '2023-04-10 09:51:17']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Bard-College';
  params:
  - - '2023-04-08 02:46:34'
    - '2023-04-10 09:51:17'
  - Bard-College
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-11-18 03:49:12', '2023-12-01 07:41:22']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2023-11-18 03:49:12'
    - '2023-12-01 07:41:22'
  - Humboldt-Universität-zu-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Spandau';
  params:
  - Spandau
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-09-22 12:46:19', '2023-09-29 06:01:22']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2023-09-22 12:46:19'
    - '2023-09-29 06:01:22'
  - Freie-Universität-Berlin
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-03-18':timestamp AND timestamp < ('2023-03-18'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-03-18'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf';
  params:
  - Charlottenburg-Wilmersdorf
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-12-23 06:02:50', '2023-12-29 06:54:46'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-12-23 06:02:50'
    - '2023-12-29 06:54:46'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-11-30 02:51:41', '2023-12-13 07:32:49'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-11-30 02:51:41'
    - '2023-12-13 07:32:49'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-05-31 15:14:54', '2023-06-14 19:13:59']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Bard-College';
  params:
  - - '2023-05-31 15:14:54'
    - '2023-06-14 19:13:59'
  - Bard-College
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-05-19':timestamp AND timestamp < ('2023-05-19'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-05-19'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-09 11:36:02', '2023-08-20 00:30:19'];
  params:
  - - '2023-08-09 11:36:02'
    - '2023-08-20 00:30:19'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-03-02 14:41:22', '2023-03-06 20:33:05'];
  params:
  - - '2023-03-02 14:41:22'
    - '2023-03-06 20:33:05'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-06-06 03:58:30', '2023-06-14 17:10:13'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-06-06 03:58:30'
    - '2023-06-14 17:10:13'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-11-19 02:41:33', '2023-11-21 21:29:50'];
  params:
  - - '2023-11-19 02:41:33'
    - '2023-11-21 21:29:50'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-04-12 02:47:27', '2023-04-27 01:25:46']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2023-04-12 02:47:27'
    - '2023-04-27 01:25:46'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2024-02-13 02:04:49', '2024-02-21 02:54:44'];
  params:
  - - '2024-02-13 02:04:49'
    - '2024-02-21 02:54:44'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-18 11:50:02', '2023-08-23 10:48:36'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-08-18 11:50:02'
    - '2023-08-23 10:48:36'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-03-20 11:00:28', '2023-03-27 06:25:37']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - - '2023-03-20 11:00:28'
    - '2023-03-27 06:25:37'
  - Charité-Campus-Klinik
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf';
  params:
  - Marzahn-Hellersdorf
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Reinickendorf';
  params:
  - Reinickendorf
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2024-01-14 10:01:07', '2024-01-21 04:21:12'];
  params:
  - - '2024-01-14 10:01:07'
    - '2024-01-21 04:21:12'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-06-20 02:26:32', '2023-06-30 16:12:54'];
  params:
  - - '2023-06-20 02:26:32'
    - '2023-06-30 16:12:54'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-11-23 08:55:58', '2023-12-06 06:00:00'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-11-23 08:55:58'
    - '2023-12-06 06:00:00'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2024-01-26':timestamp AND timestamp < ('2024-01-26'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-01-26'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-30 21:37:27', '2023-09-03 20:57:41']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2023-08-30 21:37:27'
    - '2023-09-03 20:57:41'
  - Technische-Universität-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf';
  params:
  - Marzahn-Hellersdorf
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-04-14 14:26:47', '2023-04-28 19:24:23']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Bard-College';
  params:
  - - '2023-04-14 14:26:47'
    - '2023-04-28 19:24:23'
  - Bard-College
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-04-10 18:57:03', '2023-04-17 11:54:04']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2023-04-10 18:57:03'
    - '2023-04-17 11:54:04'
  - Freie-Universität-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Spandau' GROUP BY d.name;
  params:
  - Spandau
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2024-02-13 16:29:08', '2024-02-21 05:58:31'];
  params:
  - - '2024-02-13 16:29:08'
    - '2024-02-21 05:58:31'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-01-27 13:24:17', '2024-01-29 19:59:04']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - - '2024-01-27 13:24:17'
    - '2024-01-29 19:59:04'
  - Charité-Campus-Klinik
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-02-13 20:29:05', '2024-02-24 22:05:37']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2024-02-13 20:29:05'
    - '2024-02-24 22:05:37'
  - Freie-Universität-Berlin
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-09-11 12:47:23', '2023-09-20 23:14:02']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2023-09-11 12:47:23'
    - '2023-09-20 23:14:02'
  - Technische-Universität-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-11-20 14:12:21', '2023-12-01 05:01:58'];
  params:
  - - '2023-11-20 14:12:21'
    - '2023-12-01 05:01:58'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-02-04 05:41:09', '2024-02-09 03:49:22']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2024-02-04 05:41:09'
    - '2024-02-09 03:49:22'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-09-16 21:21:10', '2023-09-26 09:23:40'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-09-16 21:21:10'
    - '2023-09-26 09:23:40'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf' GROUP BY d.name;
  params:
  - Marzahn-Hellersdorf
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Neukölln' GROUP BY d.name;
  params:
  - Neukölln
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-04-18 06:25:06', '2023-04-27 05:50:18']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - - '2023-04-18 06:25:06'
    - '2023-04-27 05:50:18'
  - European-School-of-Management-and-Technology-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Treptow-Köpenick' GROUP BY d.name;
  params:
  - Treptow-Köpenick
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-04-16 07:01:33', '2023-04-22 22:40:46'];
  params:
  - - '2023-04-16 07:01:33'
    - '2023-04-22 22:40:46'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-01-16 04:03:57', '2024-01-26 03:28:18']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Bard-College';
  params:
  - - '2024-01-16 04:03:57'
    - '2024-01-26 03:28:18'
  - Bard-College
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-10-31 05:16:40', '2023-11-13 03:38:42'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-10-31 05:16:40'
    - '2023-11-13 03:38:42'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Pankow';
  params:
  - Pankow
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2024-02-05 13:22:42', '2024-02-10 04:43:06'];
  params:
  - - '2024-02-05 13:22:42'
    - '2024-02-10 04:43:06'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-05-19 03:05:47', '2023-05-25 13:27:33'];
  params:
  - - '2023-05-19 03:05:47'
    - '2023-05-25 13:27:33'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2024-02-16 16:04:12', '2024-02-25 19:45:23'];
  params:
  - - '2024-02-16 16:04:12'
    - '2024-02-25 19:45:23'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-10-01 13:43:40', '2023-10-07 10:41:11'];
  params:
  - - '2023-10-01 13:43:40'
    - '2023-10-07 10:41:11'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-10-11 12:55:07', '2023-10-23 01:32:23'];
  params:
  - - '2023-10-11 12:55:07'
    - '2023-10-23 01:32:23'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Pankow' GROUP BY d.name;
  params:
  - Pankow
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Treptow-Köpenick' GROUP BY d.name;
  params:
  - Treptow-Köpenick
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-12-02':timestamp AND timestamp < ('2023-12-02'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-12-02'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-12-30':timestamp AND timestamp < ('2023-12-30'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-12-30'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf';
  params:
  - Charlottenburg-Wilmersdorf
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-09-08 17:21:08', '2023-09-18 10:59:08'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-09-08 17:21:08'
    - '2023-09-18 10:59:08'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-11-05':timestamp AND timestamp < ('2023-11-05'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-11-05'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Spandau';
  params:
  - Spandau
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-11-18 06:54:29', '2023-12-02 15:11:43']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - - '2023-11-18 06:54:29'
    - '2023-12-02 15:11:43'
  - Charité-Campus-Klinik
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-05-24':timestamp AND timestamp < ('2023-05-24'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-05-24'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-13 18:50:45', '2023-08-28 07:37:59'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-08-13 18:50:45'
    - '2023-08-28 07:37:59'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-11-02':timestamp AND timestamp < ('2023-11-02'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-11-02'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-08-16':timestamp AND timestamp < ('2023-08-16'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-08-16'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Pankow' GROUP BY d.name;
  params:
  - Pankow
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Mitte';
  params:
  - Mitte
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Lichtenberg' GROUP BY d.name;
  params:
  - Lichtenberg
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Lichtenberg';
  params:
  - Lichtenberg
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-31 22:55:02', '2023-09-11 00:09:13']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2023-08-31 22:55:02'
    - '2023-09-11 00:09:13'
  - Universität-der-Künste-Berlin
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-11-13 12:04:13', '2023-11-21 04:26:43']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2023-11-13 12:04:13'
    - '2023-11-21 04:26:43'
  - Freie-Universität-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Neukölln';
  params:
  - Neukölln
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg';
  params:
  - Tempelhof-Schöneberg
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Mitte' GROUP BY d.name;
  params:
  - Mitte
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-09-10 02:39:04', '2023-09-24 05:33:02'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-09-10 02:39:04'
    - '2023-09-24 05:33:02'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-07-18 03:30:17', '2023-07-30 18:55:54'];
  params:
  - - '2023-07-18 03:30:17'
    - '2023-07-30 18:55:54'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-06-26':timestamp AND timestamp < ('2023-06-26'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-06-26'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-05 01:18:42', '2023-08-08 16:12:47'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-08-05 01:18:42'
    - '2023-08-08 16:12:47'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-01-06 09:46:45', '2024-01-12 23:36:15']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - - '2024-01-06 09:46:45'
    - '2024-01-12 23:36:15'
  - Charité-Campus-Klinik
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-11-30 22:39:55', '2023-12-03 11:36:18']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - - '2023-11-30 22:39:55'
    - '2023-12-03 11:36:18'
  - European-School-of-Management-and-Technology-Berlin
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-05-10':timestamp AND timestamp < ('2023-05-10'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-05-10'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg';
  params:
  - Tempelhof-Schöneberg
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-02-28 10:27:18', '2023-03-12 22:31:35'];
  params:
  - - '2023-02-28 10:27:18'
    - '2023-03-12 22:31:35'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-05-11 17:07:19', '2023-05-22 14:01:35']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2023-05-11 17:07:19'
    - '2023-05-22 14:01:35'
  - Humboldt-Universität-zu-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-02-11 19:28:27', '2024-02-15 21:35:32'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2024-02-11 19:28:27'
    - '2024-02-15 21:35:32'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-04-16':timestamp AND timestamp < ('2023-04-16'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-04-16'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf';
  params:
  - Steglitz-Zehlendorf
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-10-25 11:23:17', '2023-10-29 05:17:17'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-10-25 11:23:17'
    - '2023-10-29 05:17:17'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-12-01 07:16:03', '2023-12-14 14:06:19'];
  params:
  - - '2023-12-01 07:16:03'
    - '2023-12-14 14:06:19'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-05-14 22:12:34', '2023-05-17 04:14:41']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2023-05-14 22:12:34'
    - '2023-05-17 04:14:41'
  - Freie-Universität-Berlin
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2024-01-17':timestamp AND timestamp < ('2024-01-17'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-01-17'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-12-15 12:48:49', '2023-12-28 20:46:58'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-12-15 12:48:49'
    - '2023-12-28 20:46:58'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Lichtenberg' GROUP BY d.name;
  params:
  - Lichtenberg
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Reinickendorf';
  params:
  - Reinickendorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-11-24':timestamp AND timestamp < ('2023-11-24'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-11-24'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2024-01-06 16:46:28', '2024-01-18 22:48:04'];
  params:
  - - '2024-01-06 16:46:28'
    - '2024-01-18 22:48:04'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Spandau';
  params:
  - Spandau
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-05-07':timestamp AND timestamp < ('2023-05-07'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-05-07'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-12-30 14:56:18', '2024-01-08 14:18:02'];
  params:
  - - '2023-12-30 14:56:18'
    - '2024-01-08 14:18:02'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-02-09 01:37:02', '2024-02-11 19:58:47'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2024-02-09 01:37:02'
    - '2024-02-11 19:58:47'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-11-02':timestamp AND timestamp < ('2023-11-02'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-11-02'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Reinickendorf';
  params:
  - Reinickendorf
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Mitte';
  params:
  - Mitte
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-11-03 03:40:06', '2023-11-16 08:01:49']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2023-11-03 03:40:06'
    - '2023-11-16 08:01:49'
  - Universität-der-Künste-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Mitte' GROUP BY d.name;
  params:
  - Mitte
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-11-01':timestamp AND timestamp < ('2023-11-01'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-11-01'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-05-13':timestamp AND timestamp < ('2023-05-13'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-05-13'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Mitte';
  params:
  - Mitte
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-01-28 22:24:21', '2024-02-10 03:06:39'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2024-01-28 22:24:21'
    - '2024-02-10 03:06:39'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-11-09 16:08:53', '2023-11-23 16:52:10'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-11-09 16:08:53'
    - '2023-11-23 16:52:10'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg' GROUP BY d.name;
  params:
  - Friedrichshain-Kreuzberg
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-04-05':timestamp AND timestamp < ('2023-04-05'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-04-05'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-07 11:50:29', '2023-08-20 16:13:52'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-08-07 11:50:29'
    - '2023-08-20 16:13:52'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Mitte' GROUP BY d.name;
  params:
  - Mitte
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-04-22':timestamp AND timestamp < ('2023-04-22'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-04-22'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-07-26 22:57:04', '2023-08-10 00:07:09']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2023-07-26 22:57:04'
    - '2023-08-10 00:07:09'
  - Technische-Universität-Berlin
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-06 13:32:14', '2023-08-15 10:38:18']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Bard-College';
  params:
  - - '2023-08-06 13:32:14'
    - '2023-08-15 10:38:18'
  - Bard-College
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-03-02':timestamp AND timestamp < ('2023-03-02'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-03-02'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Lichtenberg';
  params:
  - Lichtenberg
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Pankow' GROUP BY d.name;
  params:
  - Pankow
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-11-08 08:35:40', '2023-11-15 05:55:49']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2023-11-08 08:35:40'
    - '2023-11-15 05:55:49'
  - Freie-Universität-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg';
  params:
  - Friedrichshain-Kreuzberg
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-09-03 00:57:08', '2023-09-06 17:06:53'];
  params:
  - - '2023-09-03 00:57:08'
    - '2023-09-06 17:06:53'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-11-09 12:09:37', '2023-11-14 15:15:19'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-11-09 12:09:37'
    - '2023-11-14 15:15:19'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-03-09':timestamp AND timestamp < ('2023-03-09'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-03-09'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-05-31 06:43:52', '2023-06-06 07:51:30'];
  params:
  - - '2023-05-31 06:43:52'
    - '2023-06-06 07:51:30'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-09-02 17:02:41', '2023-09-16 17:55:53'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-09-02 17:02:41'
    - '2023-09-16 17:55:53'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-10-19 13:34:43', '2023-10-31 05:01:06'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-10-19 13:34:43'
    - '2023-10-31 05:01:06'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-11-07 09:59:12', '2023-11-17 15:40:27']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2023-11-07 09:59:12'
    - '2023-11-17 15:40:27'
  - Universität-der-Künste-Berlin
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2024-03-19':timestamp AND timestamp < ('2024-03-19'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-03-19'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-05-08 04:23:03', '2023-05-22 15:49:44']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2023-05-08 04:23:03'
    - '2023-05-22 15:49:44'
  - Technische-Universität-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Lichtenberg' GROUP BY d.name;
  params:
  - Lichtenberg
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg';
  params:
  - Friedrichshain-Kreuzberg
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2024-01-28 02:32:00', '2024-02-06 03:09:00'];
  params:
  - - '2024-01-28 02:32:00'
    - '2024-02-06 03:09:00'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-01-13 12:00:06', '2024-01-25 07:04:52']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - - '2024-01-13 12:00:06'
    - '2024-01-25 07:04:52'
  - European-School-of-Management-and-Technology-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-10-30 06:04:46', '2023-11-04 17:23:30'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-10-30 06:04:46'
    - '2023-11-04 17:23:30'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Lichtenberg';
  params:
  - Lichtenberg
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-05-31 02:53:53', '2023-06-06 13:50:40'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-05-31 02:53:53'
    - '2023-06-06 13:50:40'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-09-06 10:41:18', '2023-09-13 19:17:08']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2023-09-06 10:41:18'
    - '2023-09-13 19:17:08'
  - Universität-der-Künste-Berlin
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-10-24':timestamp AND timestamp < ('2023-10-24'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-10-24'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-12-23 14:02:04', '2023-12-28 14:29:26'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-12-23 14:02:04'
    - '2023-12-28 14:29:26'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2024-02-25':timestamp AND timestamp < ('2024-02-25'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-02-25'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-04-09':timestamp AND timestamp < ('2023-04-09'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-04-09'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-03-06 15:05:32', '2023-03-09 21:06:00']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2023-03-06 15:05:32'
    - '2023-03-09 21:06:00'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Neukölln' GROUP BY d.name;
  params:
  - Neukölln
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Reinickendorf' GROUP BY d.name;
  params:
  - Reinickendorf
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-02-24 13:21:47', '2024-03-05 03:55:25']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Bard-College';
  params:
  - - '2024-02-24 13:21:47'
    - '2024-03-05 03:55:25'
  - Bard-College
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Spandau';
  params:
  - Spandau
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf' GROUP BY d.name;
  params:
  - Marzahn-Hellersdorf
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-11-26 20:12:29', '2023-11-30 18:55:31'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-11-26 20:12:29'
    - '2023-11-30 18:55:31'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-11-29 17:14:14', '2023-12-09 14:47:13'];
  params:
  - - '2023-11-29 17:14:14'
    - '2023-12-09 14:47:13'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2024-02-17 23:08:38', '2024-02-27 18:35:10'];
  params:
  - - '2024-02-17 23:08:38'
    - '2024-02-27 18:35:10'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-10-10 16:51:16', '2023-10-23 14:31:40']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Bard-College';
  params:
  - - '2023-10-10 16:51:16'
    - '2023-10-23 14:31:40'
  - Bard-College
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-12-17':timestamp AND timestamp < ('2023-12-17'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-12-17'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-01-25 20:59:05', '2024-02-05 11:48:18'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2024-01-25 20:59:05'
    - '2024-02-05 11:48:18'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-02-23 19:41:04', '2024-02-27 08:50:25'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2024-02-23 19:41:04'
    - '2024-02-27 08:50:25'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-07-08':timestamp AND timestamp < ('2023-07-08'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-07-08'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Neukölln' GROUP BY d.name;
  params:
  - Neukölln
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Reinickendorf' GROUP BY d.name;
  params:
  - Reinickendorf
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-11-09 12:43:20', '2023-11-14 21:33:32'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-11-09 12:43:20'
    - '2023-11-14 21:33:32'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-09-02 01:57:04', '2023-09-04 17:57:33']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2023-09-02 01:57:04'
    - '2023-09-04 17:57:33'
  - Technische-Universität-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Treptow-Köpenick' GROUP BY d.name;
  params:
  - Treptow-Köpenick
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-11 05:30:52', '2023-08-14 22:04:37']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2023-08-11 05:30:52'
    - '2023-08-14 22:04:37'
  - Universität-der-Künste-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf' GROUP BY d.name;
  params:
  - Steglitz-Zehlendorf
