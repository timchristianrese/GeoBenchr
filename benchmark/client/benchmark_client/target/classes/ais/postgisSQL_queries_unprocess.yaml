- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-08-27 02:21:07.399878', '2019-09-08 02:21:18.108432'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-08-27 02:21:07.399878
    - 2019-09-08 02:21:18.108432
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-03-05 01:51:00.867233', '2019-03-18 23:46:17.149008'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-03-05 01:51:00.867233
    - 2019-03-18 23:46:17.149008
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'PERAMA'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'ZEA'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - PERAMA
  - ZEA
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-11-04 08:57:38.884714', '2019-11-11 22:05:27.804691'];
  params:
  - - 2019-11-04 08:57:38.884714
    - 2019-11-11 22:05:27.804691
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-07-15 22:37:47.488286', '2019-07-24 05:02:53.530490'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-07-15 22:37:47.488286
    - 2019-07-24 05:02:53.530490
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'FALIRO'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'FANEROMENI'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - FALIRO
  - FANEROMENI
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-03-14 22:40:52.300951', '2019-03-27 20:03:59.980903'];
  params:
  - - 2019-03-14 22:40:52.300951
    - 2019-03-27 20:03:59.980903
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-01-28 12:07:02.369450', '2019-02-05 21:36:02.753542'];
  params:
  - - 2019-01-28 12:07:02.369450
    - 2019-02-05 21:36:02.753542
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-02-15 10:36:28.784262', '2019-03-01 01:23:59.534099'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-02-15 10:36:28.784262
    - 2019-03-01 01:23:59.534099
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'SIRI' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-05-31 02:23:17.566942', '2019-06-04 11:19:39.949401'];
  params:
  - SIRI
  - - 2019-05-31 02:23:17.566942
    - 2019-06-04 11:19:39.949401
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'ASPROPYRGOS'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'FLISVOS'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - ASPROPYRGOS
  - FLISVOS
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'ZEA'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'RAFINA'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - ZEA
  - RAFINA
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-08-02 02:26:21.663732', '2019-08-09 01:48:02.282996'];
  params:
  - - 2019-08-02 02:26:21.663732
    - 2019-08-09 01:48:02.282996
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-10-24 07:00:14.950257', '2019-11-04 06:42:54.411150'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-10-24 07:00:14.950257
    - 2019-11-04 06:42:54.411150
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Poros;MULTIPOLYGON(((23.4581491 37.5061611' GROUP BY i.name;
  params:
  - Poros;MULTIPOLYGON(((23.4581491 37.5061611
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-11-14 05:51:09.755200', '2019-11-28 23:35:03.589185'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-11-14 05:51:09.755200
    - 2019-11-28 23:35:03.589185
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 9 AND DATE(st.start_ts) = DATE 7;
  params:
  - 7
  - 9
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 20 AND DATE(st.start_ts) = DATE 1;
  params:
  - 1
  - 20
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 17 AND DATE(st.start_ts) = DATE 24;
  params:
  - 24
  - 17
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'AGIOS KOSMAS'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'ZEA'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - AGIOS KOSMAS
  - ZEA
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-11-14 00:47:46.315094', '2019-11-24 06:06:24.684177'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-11-14 00:47:46.315094
    - 2019-11-24 06:06:24.684177
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Kanakia;MULTIPOLYGON(((23.3941818 37.9040603' GROUP BY i.name;
  params:
  - Kanakia;MULTIPOLYGON(((23.3941818 37.9040603
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'ELEFSIS'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'AGIOS KOSMAS'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - ELEFSIS
  - AGIOS KOSMAS
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-06-16 11:10:17.803197', '2019-06-29 20:28:57.098601'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-06-16 11:10:17.803197
    - 2019-06-29 20:28:57.098601
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-05-18 12:10:59.847136', '2019-05-24 14:09:34.471691'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-05-18 12:10:59.847136
    - 2019-05-24 14:09:34.471691
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-06-20 03:34:33.532299', '2019-06-28 03:25:57.044173'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-06-20 03:34:33.532299
    - 2019-06-28 03:25:57.044173
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-11-22 16:37:48.435361', '2019-11-27 22:11:59.306014'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-11-22 16:37:48.435361
    - 2019-11-27 22:11:59.306014
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 14 AND DATE(st.start_ts) = DATE 2;
  params:
  - 2
  - 14
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-02-05 18:37:00.676843', '2019-02-09 20:24:14.231967'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-02-05 18:37:00.676843
    - 2019-02-09 20:24:14.231967
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 13 AND DATE(st.start_ts) = DATE 17;
  params:
  - 17
  - 13
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 10 AND DATE(st.start_ts) = DATE 15;
  params:
  - 15
  - 10
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'GLYFADA' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-06-14 13:45:52.922177', '2019-06-18 03:08:59.528470'];
  params:
  - GLYFADA
  - - 2019-06-14 13:45:52.922177
    - 2019-06-18 03:08:59.528470
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-07-28 12:41:15.189127', '2019-08-02 02:06:54.969149'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-07-28 12:41:15.189127
    - 2019-08-02 02:06:54.969149
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'AGISTRI' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-12-11 13:14:37.095246', '2019-12-22 16:43:19.498752'];
  params:
  - AGISTRI
  - - 2019-12-11 13:14:37.095246
    - 2019-12-22 16:43:19.498752
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'ERMIONI'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'LAVRIO'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - ERMIONI
  - LAVRIO
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'AGIOI THEODORI' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-03-03 13:05:58.187179', '2019-03-13 12:43:58.387023'];
  params:
  - AGIOI THEODORI
  - - 2019-03-03 13:05:58.187179
    - 2019-03-13 12:43:58.387023
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Kasidis;MULTIPOLYGON(((23.7690617 37.7937917' GROUP BY i.name;
  params:
  - Kasidis;MULTIPOLYGON(((23.7690617 37.7937917
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-08-03 02:45:11.279113', '2019-08-17 08:20:49.690954'];
  params:
  - - 2019-08-03 02:45:11.279113
    - 2019-08-17 08:20:49.690954
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Agistri;MULTIPOLYGON(((23.3404791 37.6728988' GROUP BY i.name;
  params:
  - Agistri;MULTIPOLYGON(((23.3404791 37.6728988
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'ALIMOS'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'ELEFSIS'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - ALIMOS
  - ELEFSIS
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Nisis Metopi;MULTIPOLYGON(((23.3772365 37.7192176' GROUP BY i.name;
  params:
  - Nisis Metopi;MULTIPOLYGON(((23.3772365 37.7192176
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'AGIOI THEODORI' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-08-20 16:14:03.689865', '2019-08-27 09:59:36.531206'];
  params:
  - AGIOI THEODORI
  - - 2019-08-20 16:14:03.689865
    - 2019-08-27 09:59:36.531206
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'CORINTH'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'RAFINA'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - CORINTH
  - RAFINA
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 21 AND DATE(st.start_ts) = DATE 2;
  params:
  - 2
  - 21
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-04-05 06:29:01.753709', '2019-04-19 02:00:01.963195'];
  params:
  - - 2019-04-05 06:29:01.753709
    - 2019-04-19 02:00:01.963195
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Phleva Island;MULTIPOLYGON(((23.7659544 37.7674259' GROUP BY i.name;
  params:
  - Phleva Island;MULTIPOLYGON(((23.7659544 37.7674259
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'FANEROMENI'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'AEGINA'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - FANEROMENI
  - AEGINA
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 17 AND DATE(st.start_ts) = DATE 13;
  params:
  - 13
  - 17
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Nisis Pachaki;MULTIPOLYGON(((23.3614704 37.9692519' GROUP BY i.name;
  params:
  - Nisis Pachaki;MULTIPOLYGON(((23.3614704 37.9692519
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 9 AND DATE(st.start_ts) = DATE 31;
  params:
  - 31
  - 9
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'AEGINA' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-06-19 20:36:40.356318', '2019-06-23 06:11:11.592833'];
  params:
  - AEGINA
  - - 2019-06-19 20:36:40.356318
    - 2019-06-23 06:11:11.592833
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 12 AND DATE(st.start_ts) = DATE 16;
  params:
  - 16
  - 12
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'AGIOI THEODORI' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-10-29 20:38:53.248030', '2019-11-02 10:19:15.020734'];
  params:
  - AGIOI THEODORI
  - - 2019-10-29 20:38:53.248030
    - 2019-11-02 10:19:15.020734
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-05-13 05:37:47.628478', '2019-05-20 01:31:30.579608'];
  params:
  - - 2019-05-13 05:37:47.628478
    - 2019-05-20 01:31:30.579608
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-10-17 16:21:30.620911', '2019-10-26 01:08:26.589138'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-10-17 16:21:30.620911
    - 2019-10-26 01:08:26.589138
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'ERMIONI'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'GLYFADA'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - ERMIONI
  - GLYFADA
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 1 AND DATE(st.start_ts) = DATE 23;
  params:
  - 23
  - 1
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-10-08 14:10:06.694827', '2019-10-22 02:51:59.558757'];
  params:
  - - 2019-10-08 14:10:06.694827
    - 2019-10-22 02:51:59.558757
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'ELEFSIS' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-08-03 23:37:46.967233', '2019-08-08 06:20:35.133685'];
  params:
  - ELEFSIS
  - - 2019-08-03 23:37:46.967233
    - 2019-08-08 06:20:35.133685
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Nisis Ledou;MULTIPOLYGON(((23.2590042 37.8010783' GROUP BY i.name;
  params:
  - Nisis Ledou;MULTIPOLYGON(((23.2590042 37.8010783
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Aegina Moni;MULTIPOLYGON(((23.4230677 37.68617' GROUP BY i.name;
  params:
  - Aegina Moni;MULTIPOLYGON(((23.4230677 37.68617
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 12 AND DATE(st.start_ts) = DATE 5;
  params:
  - 5
  - 12
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-03-21 05:34:07.287527', '2019-03-29 21:13:54.456489'];
  params:
  - - 2019-03-21 05:34:07.287527
    - 2019-03-29 21:13:54.456489
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Psittalia;MULTIPOLYGON(((23.5806238 37.9366858' GROUP BY i.name;
  params:
  - Psittalia;MULTIPOLYGON(((23.5806238 37.9366858
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'ZEA' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-10-01 12:32:31.055730', '2019-10-11 22:06:59.871994'];
  params:
  - ZEA
  - - 2019-10-01 12:32:31.055730
    - 2019-10-11 22:06:59.871994
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'FALIRO'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'AGIOS KOSMAS'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - FALIRO
  - AGIOS KOSMAS
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-04-21 19:27:54.063222', '2019-05-01 12:14:35.912785'];
  params:
  - - 2019-04-21 19:27:54.063222
    - 2019-05-01 12:14:35.912785
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Agios Thomas;MULTIPOLYGON(((23.2497482 37.8055013' GROUP BY i.name;
  params:
  - Agios Thomas;MULTIPOLYGON(((23.2497482 37.8055013
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'ELEFSIS' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-04-17 23:54:38.661878', '2019-04-20 06:56:53.539214'];
  params:
  - ELEFSIS
  - - 2019-04-17 23:54:38.661878
    - 2019-04-20 06:56:53.539214
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-06-17 16:45:30.154160', '2019-07-02 12:18:53.857655'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-06-17 16:45:30.154160
    - 2019-07-02 12:18:53.857655
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Phleva Island;MULTIPOLYGON(((23.7659544 37.7674259' GROUP BY i.name;
  params:
  - Phleva Island;MULTIPOLYGON(((23.7659544 37.7674259
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-12-22 02:44:51.093746', '2019-12-26 03:18:26.309626'];
  params:
  - - 2019-12-22 02:44:51.093746
    - 2019-12-26 03:18:26.309626
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 0 AND DATE(st.start_ts) = DATE 9;
  params:
  - 9
  - 0
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-07-01 20:08:51.705766', '2019-07-09 21:46:17.054635'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-07-01 20:08:51.705766
    - 2019-07-09 21:46:17.054635
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-12-10 23:14:25.306256', '2019-12-18 16:58:50.250876'];
  params:
  - - 2019-12-10 23:14:25.306256
    - 2019-12-18 16:58:50.250876
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Nisis Metopi;MULTIPOLYGON(((23.3772365 37.7192176' GROUP BY i.name;
  params:
  - Nisis Metopi;MULTIPOLYGON(((23.3772365 37.7192176
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'ERMIONI'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'ASPROPYRGOS'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - ERMIONI
  - ASPROPYRGOS
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-03-24 07:16:56.141388', '2019-03-27 20:10:27.910950'];
  params:
  - - 2019-03-24 07:16:56.141388
    - 2019-03-27 20:10:27.910950
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'SIRI'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'AGISTRI'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - SIRI
  - AGISTRI
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'RAFINA' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-02-09 18:34:52.522099', '2019-02-16 11:55:13.232862'];
  params:
  - RAFINA
  - - 2019-02-09 18:34:52.522099
    - 2019-02-16 11:55:13.232862
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-02-28 00:23:20.565749', '2019-03-12 02:43:10.300409'];
  params:
  - - 2019-02-28 00:23:20.565749
    - 2019-03-12 02:43:10.300409
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-01-19 02:28:07.172031', '2019-01-28 10:56:58.593161'];
  params:
  - - 2019-01-19 02:28:07.172031
    - 2019-01-28 10:56:58.593161
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-06-09 11:48:40.779227', '2019-06-15 15:03:41.554066'];
  params:
  - - 2019-06-09 11:48:40.779227
    - 2019-06-15 15:03:41.554066
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Nisis Bisti;MULTIPOLYGON(((23.4866746 37.5525434' GROUP BY i.name;
  params:
  - Nisis Bisti;MULTIPOLYGON(((23.4866746 37.5525434
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'PIRAEUS' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-11-12 22:16:45.322054', '2019-11-15 12:52:10.667264'];
  params:
  - PIRAEUS
  - - 2019-11-12 22:16:45.322054
    - 2019-11-15 12:52:10.667264
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'AGIOI THEODORI'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'ASPROPYRGOS'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - AGIOI THEODORI
  - ASPROPYRGOS
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'GLYFADA' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-10-22 01:18:10.929891', '2019-11-02 17:36:44.302547'];
  params:
  - GLYFADA
  - - 2019-10-22 01:18:10.929891
    - 2019-11-02 17:36:44.302547
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'CORINTH'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'FALIRO'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - CORINTH
  - FALIRO
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Arsida;MULTIPOLYGON(((23.8940984 37.7083539' GROUP BY i.name;
  params:
  - Arsida;MULTIPOLYGON(((23.8940984 37.7083539
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'ALIMOS'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'PERAMA'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - ALIMOS
  - PERAMA
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'SIRI'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'FALIRO'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - SIRI
  - FALIRO
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'ALIMOS'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'FANEROMENI'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - ALIMOS
  - FANEROMENI
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 6 AND DATE(st.start_ts) = DATE 24;
  params:
  - 24
  - 6
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-03-17 16:58:33.636318', '2019-03-24 02:23:09.706985'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-03-17 16:58:33.636318
    - 2019-03-24 02:23:09.706985
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'CORINTH CANAL'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'SIRI'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - CORINTH CANAL
  - SIRI
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'LAVRIO'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'RAFINA'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - LAVRIO
  - RAFINA
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Nisis Atalanti;MULTIPOLYGON(((23.5716686 37.9346175' GROUP BY i.name;
  params:
  - Nisis Atalanti;MULTIPOLYGON(((23.5716686 37.9346175
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-09-02 16:48:25.460421', '2019-09-16 21:03:16.003947'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-09-02 16:48:25.460421
    - 2019-09-16 21:03:16.003947
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'AGIOS KOSMAS' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-10-21 14:26:09.632997', '2019-10-29 07:23:16.377689'];
  params:
  - AGIOS KOSMAS
  - - 2019-10-21 14:26:09.632997
    - 2019-10-29 07:23:16.377689
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'SIRI' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-11-05 15:10:53.344930', '2019-11-17 12:47:46.794647'];
  params:
  - SIRI
  - - 2019-11-05 15:10:53.344930
    - 2019-11-17 12:47:46.794647
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-09-13 23:50:00.984683', '2019-09-27 08:50:10.665830'];
  params:
  - - 2019-09-13 23:50:00.984683
    - 2019-09-27 08:50:10.665830
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'AEGINA' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-08-08 12:47:01.058352', '2019-08-14 00:27:31.519573'];
  params:
  - AEGINA
  - - 2019-08-08 12:47:01.058352
    - 2019-08-14 00:27:31.519573
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Nisis Stakhtorroyi;MULTIPOLYGON(((23.3608955 37.8141731' GROUP BY i.name;
  params:
  - Nisis Stakhtorroyi;MULTIPOLYGON(((23.3608955 37.8141731
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-06-09 13:54:43.213534', '2019-06-24 00:37:41.852616'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-06-09 13:54:43.213534
    - 2019-06-24 00:37:41.852616
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'AGIOI THEODORI'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'AGIOS KOSMAS'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - AGIOI THEODORI
  - AGIOS KOSMAS
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'GLYFADA' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-09-06 14:05:05.521850', '2019-09-15 13:49:49.835052'];
  params:
  - GLYFADA
  - - 2019-09-06 14:05:05.521850
    - 2019-09-15 13:49:49.835052
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-10-29 08:51:42.875650', '2019-11-07 00:08:28.427597'];
  params:
  - - 2019-10-29 08:51:42.875650
    - 2019-11-07 00:08:28.427597
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Agios Ioannis;MULTIPOLYGON(((23.2585002 37.8163195' GROUP BY i.name;
  params:
  - Agios Ioannis;MULTIPOLYGON(((23.2585002 37.8163195
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-09-04 11:31:16.310086', '2019-09-15 04:20:54.572154'];
  params:
  - - 2019-09-04 11:31:16.310086
    - 2019-09-15 04:20:54.572154
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-04-29 04:42:51.623871', '2019-05-02 20:52:55.904106'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-04-29 04:42:51.623871
    - 2019-05-02 20:52:55.904106
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-06-17 20:05:39.079609', '2019-06-24 06:00:48.739531'];
  params:
  - - 2019-06-17 20:05:39.079609
    - 2019-06-24 06:00:48.739531
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-09-03 05:44:34.324426', '2019-09-10 12:46:28.907588'];
  params:
  - - 2019-09-03 05:44:34.324426
    - 2019-09-10 12:46:28.907588
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Patroklos;MULTIPOLYGON(((23.9580264 37.6565078' GROUP BY i.name;
  params:
  - Patroklos;MULTIPOLYGON(((23.9580264 37.6565078
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'SOUSAKI'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'FALIRO'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - SOUSAKI
  - FALIRO
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-09-21 00:50:09.976183', '2019-09-25 08:40:29.734902'];
  params:
  - - 2019-09-21 00:50:09.976183
    - 2019-09-25 08:40:29.734902
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 1 AND DATE(st.start_ts) = DATE 6;
  params:
  - 6
  - 1
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 4 AND DATE(st.start_ts) = DATE 5;
  params:
  - 5
  - 4
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-05-06 14:26:33.776046', '2019-05-09 10:49:15.709559'];
  params:
  - - 2019-05-06 14:26:33.776046
    - 2019-05-09 10:49:15.709559
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'RAFINA' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-08-27 13:41:02.117702', '2019-09-07 08:30:43.427145'];
  params:
  - RAFINA
  - - 2019-08-27 13:41:02.117702
    - 2019-09-07 08:30:43.427145
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Arsida;MULTIPOLYGON(((23.8940984 37.7083539' GROUP BY i.name;
  params:
  - Arsida;MULTIPOLYGON(((23.8940984 37.7083539
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'ELEFSIS' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-09-20 03:55:19.740279', '2019-09-24 21:18:45.416550'];
  params:
  - ELEFSIS
  - - 2019-09-20 03:55:19.740279
    - 2019-09-24 21:18:45.416550
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'ELEFSIS'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'AEGINA'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - ELEFSIS
  - AEGINA
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Nisis Pachaki;MULTIPOLYGON(((23.3614704 37.9692519' GROUP BY i.name;
  params:
  - Nisis Pachaki;MULTIPOLYGON(((23.3614704 37.9692519
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 15 AND DATE(st.start_ts) = DATE 11;
  params:
  - 11
  - 15
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 20 AND DATE(st.start_ts) = DATE 2;
  params:
  - 2
  - 20
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-01-03 19:53:51.453298', '2019-01-10 10:47:03.408747'];
  params:
  - - 2019-01-03 19:53:51.453298
    - 2019-01-10 10:47:03.408747
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Trakhyli;MULTIPOLYGON(((23.1764033 37.7162605' GROUP BY i.name;
  params:
  - Trakhyli;MULTIPOLYGON(((23.1764033 37.7162605
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Psittalia;MULTIPOLYGON(((23.5806238 37.9366858' GROUP BY i.name;
  params:
  - Psittalia;MULTIPOLYGON(((23.5806238 37.9366858
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Kavouronisi;MULTIPOLYGON(((23.7531549 37.8136342' GROUP BY i.name;
  params:
  - Kavouronisi;MULTIPOLYGON(((23.7531549 37.8136342
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-11-13 11:45:29.753276', '2019-11-28 10:00:35.048369'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-11-13 11:45:29.753276
    - 2019-11-28 10:00:35.048369
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'PIRAEUS'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'PERAMA'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - PIRAEUS
  - PERAMA
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'ASPROPYRGOS' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-02-20 03:24:16.775200', '2019-03-06 02:41:19.819460'];
  params:
  - ASPROPYRGOS
  - - 2019-02-20 03:24:16.775200
    - 2019-03-06 02:41:19.819460
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-11-24 09:14:48.066955', '2019-12-06 05:28:04.553694'];
  params:
  - - 2019-11-24 09:14:48.066955
    - 2019-12-06 05:28:04.553694
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-02-09 09:09:53.485599', '2019-02-12 22:47:12.816297'];
  params:
  - - 2019-02-09 09:09:53.485599
    - 2019-02-12 22:47:12.816297
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Psittalia;MULTIPOLYGON(((23.5806238 37.9366858' GROUP BY i.name;
  params:
  - Psittalia;MULTIPOLYGON(((23.5806238 37.9366858
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-01-31 22:07:02.442883', '2019-02-07 16:47:20.960914'];
  params:
  - - 2019-01-31 22:07:02.442883
    - 2019-02-07 16:47:20.960914
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'ASPROPYRGOS'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'AEGINA'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - ASPROPYRGOS
  - AEGINA
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Spalaphtronisi Islet;MULTIPOLYGON(((23.2363612 37.7013733' GROUP BY i.name;
  params:
  - Spalaphtronisi Islet;MULTIPOLYGON(((23.2363612 37.7013733
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-11-23 07:57:04.439235', '2019-11-29 11:32:30.005381'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-11-23 07:57:04.439235
    - 2019-11-29 11:32:30.005381
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'GLYFADA' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-06-16 16:30:44.204533', '2019-06-29 11:03:41.409950'];
  params:
  - GLYFADA
  - - 2019-06-16 16:30:44.204533
    - 2019-06-29 11:03:41.409950
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'GLYFADA'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'ERMIONI'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - GLYFADA
  - ERMIONI
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'AGIOS KOSMAS' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-08-14 08:52:49.265671', '2019-08-20 21:00:51.023442'];
  params:
  - AGIOS KOSMAS
  - - 2019-08-14 08:52:49.265671
    - 2019-08-20 21:00:51.023442
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-10-28 11:39:36.628970', '2019-11-08 20:38:53.396217'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-10-28 11:39:36.628970
    - 2019-11-08 20:38:53.396217
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'PERAMA' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-08-16 11:29:58.977999', '2019-08-18 23:20:36.024577'];
  params:
  - PERAMA
  - - 2019-08-16 11:29:58.977999
    - 2019-08-18 23:20:36.024577
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-08-26 07:40:53.711866', '2019-09-01 14:33:48.411639'];
  params:
  - - 2019-08-26 07:40:53.711866
    - 2019-09-01 14:33:48.411639
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 3 AND DATE(st.start_ts) = DATE 10;
  params:
  - 10
  - 3
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-08-07 06:49:46.914054', '2019-08-17 13:30:44.790850'];
  params:
  - - 2019-08-07 06:49:46.914054
    - 2019-08-17 13:30:44.790850
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-09-24 07:35:46.196110', '2019-09-26 13:40:28.128369'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-09-24 07:35:46.196110
    - 2019-09-26 13:40:28.128369
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'SOUSAKI'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'ERMIONI'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - SOUSAKI
  - ERMIONI
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 7 AND DATE(st.start_ts) = DATE 20;
  params:
  - 20
  - 7
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-06-28 03:12:38.333466', '2019-07-11 20:31:22.220718'];
  params:
  - - 2019-06-28 03:12:38.333466
    - 2019-07-11 20:31:22.220718
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'FANEROMENI' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-11-29 15:48:44.904274', '2019-12-03 07:18:06.867791'];
  params:
  - FANEROMENI
  - - 2019-11-29 15:48:44.904274
    - 2019-12-03 07:18:06.867791
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'AGIOS KOSMAS' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-01-31 08:55:27.915456', '2019-02-13 08:08:40.459123'];
  params:
  - AGIOS KOSMAS
  - - 2019-01-31 08:55:27.915456
    - 2019-02-13 08:08:40.459123
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Phleva Island;MULTIPOLYGON(((23.7659544 37.7674259' GROUP BY i.name;
  params:
  - Phleva Island;MULTIPOLYGON(((23.7659544 37.7674259
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'LAVRIO'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'PERAMA'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - LAVRIO
  - PERAMA
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-03-02 09:36:51.936198', '2019-03-16 16:54:33.085822'];
  params:
  - - 2019-03-02 09:36:51.936198
    - 2019-03-16 16:54:33.085822
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'RAFINA' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-04-12 06:06:43.869253', '2019-04-26 06:51:32.991784'];
  params:
  - RAFINA
  - - 2019-04-12 06:06:43.869253
    - 2019-04-26 06:51:32.991784
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'SOUSAKI' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-12-19 05:43:36.422061', '2019-12-25 16:54:29.593939'];
  params:
  - SOUSAKI
  - - 2019-12-19 05:43:36.422061
    - 2019-12-25 16:54:29.593939
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Nisis Bisti;MULTIPOLYGON(((23.4866746 37.5525434' GROUP BY i.name;
  params:
  - Nisis Bisti;MULTIPOLYGON(((23.4866746 37.5525434
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-01-18 01:15:25.867744', '2019-01-29 19:54:57.665142'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-01-18 01:15:25.867744
    - 2019-01-29 19:54:57.665142
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-07-29 22:57:07.311389', '2019-08-01 17:17:13.739656'];
  params:
  - - 2019-07-29 22:57:07.311389
    - 2019-08-01 17:17:13.739656
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-01-03 01:37:20.555872', '2019-01-09 20:50:23.669872'];
  params:
  - - 2019-01-03 01:37:20.555872
    - 2019-01-09 20:50:23.669872
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Kourmouloudes;MULTIPOLYGON(((23.3193627 37.8000988' GROUP BY i.name;
  params:
  - Kourmouloudes;MULTIPOLYGON(((23.3193627 37.8000988
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'SIRI'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'ELEFSIS'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - SIRI
  - ELEFSIS
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'GLYFADA' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-01-13 03:43:05.686123', '2019-01-22 15:02:24.872345'];
  params:
  - GLYFADA
  - - 2019-01-13 03:43:05.686123
    - 2019-01-22 15:02:24.872345
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 2 AND DATE(st.start_ts) = DATE 31;
  params:
  - 31
  - 2
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2018-12-31 23:15:05', '2019-01-03 21:24:02.469161'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2018-12-31 23:15:05
    - 2019-01-03 21:24:02.469161
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Spalaphtronisi Islet;MULTIPOLYGON(((23.2363612 37.7013733' GROUP BY i.name;
  params:
  - Spalaphtronisi Islet;MULTIPOLYGON(((23.2363612 37.7013733
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-12-09 02:54:22.482541', '2019-12-12 21:50:06.886710'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-12-09 02:54:22.482541
    - 2019-12-12 21:50:06.886710
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-04-24 03:31:19.162331', '2019-04-30 02:31:18.620684'];
  params:
  - - 2019-04-24 03:31:19.162331
    - 2019-04-30 02:31:18.620684
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-09-21 23:23:31.059237', '2019-09-25 09:48:55.429349'];
  params:
  - - 2019-09-21 23:23:31.059237
    - 2019-09-25 09:48:55.429349
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-06-20 00:22:52.715067', '2019-06-28 12:40:31.027723'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-06-20 00:22:52.715067
    - 2019-06-28 12:40:31.027723
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-07-28 20:14:59.407887', '2019-08-06 03:30:02.321161'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-07-28 20:14:59.407887
    - 2019-08-06 03:30:02.321161
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'FANEROMENI'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'CORINTH'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - FANEROMENI
  - CORINTH
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'ELEFSIS' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-01-03 22:44:02.170668', '2019-01-10 12:46:05.001049'];
  params:
  - ELEFSIS
  - - 2019-01-03 22:44:02.170668
    - 2019-01-10 12:46:05.001049
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 6 AND DATE(st.start_ts) = DATE 15;
  params:
  - 15
  - 6
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 8 AND DATE(st.start_ts) = DATE 15;
  params:
  - 15
  - 8
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Vrachonisis Moladi;MULTIPOLYGON(((23.2857762 37.8099715' GROUP BY i.name;
  params:
  - Vrachonisis Moladi;MULTIPOLYGON(((23.2857762 37.8099715
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'ERMIONI' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-02-25 16:10:20.424336', '2019-03-02 01:15:46.275412'];
  params:
  - ERMIONI
  - - 2019-02-25 16:10:20.424336
    - 2019-03-02 01:15:46.275412
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Makronisos;MULTIPOLYGON(((23.4103812 37.967855' GROUP BY i.name;
  params:
  - Makronisos;MULTIPOLYGON(((23.4103812 37.967855
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'CORINTH' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-11-01 10:34:05.014744', '2019-11-09 21:26:12.830769'];
  params:
  - CORINTH
  - - 2019-11-01 10:34:05.014744
    - 2019-11-09 21:26:12.830769
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 21 AND DATE(st.start_ts) = DATE 1;
  params:
  - 1
  - 21
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'AGISTRI'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'CORINTH'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - AGISTRI
  - CORINTH
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 21 AND DATE(st.start_ts) = DATE 25;
  params:
  - 25
  - 21
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-05-30 12:05:44.706038', '2019-06-02 23:42:43.128541'];
  params:
  - - 2019-05-30 12:05:44.706038
    - 2019-06-02 23:42:43.128541
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-01-10 19:18:34.603810', '2019-01-16 21:38:49.296504'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-01-10 19:18:34.603810
    - 2019-01-16 21:38:49.296504
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-05-28 21:17:53.446388', '2019-06-09 21:03:43.655938'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-05-28 21:17:53.446388
    - 2019-06-09 21:03:43.655938
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 15 AND DATE(st.start_ts) = DATE 22;
  params:
  - 22
  - 15
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'SOUSAKI' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-03-02 08:30:25.775289', '2019-03-14 02:18:43.379973'];
  params:
  - SOUSAKI
  - - 2019-03-02 08:30:25.775289
    - 2019-03-14 02:18:43.379973
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'AGISTRI'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'RAFINA'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - AGISTRI
  - RAFINA
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'FANEROMENI' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-05-22 15:55:35.757059', '2019-06-06 14:24:44.213170'];
  params:
  - FANEROMENI
  - - 2019-05-22 15:55:35.757059
    - 2019-06-06 14:24:44.213170
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-07-01 23:02:58.948020', '2019-07-11 20:59:36.790656'];
  params:
  - - 2019-07-01 23:02:58.948020
    - 2019-07-11 20:59:36.790656
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-11-12 17:02:00.990235', '2019-11-19 14:51:51.651563'];
  params:
  - - 2019-11-12 17:02:00.990235
    - 2019-11-19 14:51:51.651563
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'RAFINA' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-01-31 00:46:38.005175', '2019-02-06 12:19:44.059807'];
  params:
  - RAFINA
  - - 2019-01-31 00:46:38.005175
    - 2019-02-06 12:19:44.059807
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Psittalia;MULTIPOLYGON(((23.5806238 37.9366858' GROUP BY i.name;
  params:
  - Psittalia;MULTIPOLYGON(((23.5806238 37.9366858
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 3 AND DATE(st.start_ts) = DATE 6;
  params:
  - 6
  - 3
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-03-15 07:12:25.494227', '2019-03-20 07:28:57.315022'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-03-15 07:12:25.494227
    - 2019-03-20 07:28:57.315022
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Ovrios;MULTIPOLYGON(((23.1410247 37.8584852' GROUP BY i.name;
  params:
  - Ovrios;MULTIPOLYGON(((23.1410247 37.8584852
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-07-31 12:00:09.968982', '2019-08-11 07:22:14.075508'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-07-31 12:00:09.968982
    - 2019-08-11 07:22:14.075508
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Makronisos;MULTIPOLYGON(((23.4499771 37.8187979' GROUP BY i.name;
  params:
  - Makronisos;MULTIPOLYGON(((23.4499771 37.8187979
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-01-10 16:41:52.711075', '2019-01-25 14:51:36.884709'];
  params:
  - - 2019-01-10 16:41:52.711075
    - 2019-01-25 14:51:36.884709
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'FLISVOS'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'PIRAEUS'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - FLISVOS
  - PIRAEUS
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-06-12 21:27:55.770144', '2019-06-25 19:36:11.134323'];
  params:
  - - 2019-06-12 21:27:55.770144
    - 2019-06-25 19:36:11.134323
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Nisis Atalanti;MULTIPOLYGON(((23.5716686 37.9346175' GROUP BY i.name;
  params:
  - Nisis Atalanti;MULTIPOLYGON(((23.5716686 37.9346175
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-08-08 04:04:34.470671', '2019-08-22 23:46:06.988540'];
  params:
  - - 2019-08-08 04:04:34.470671
    - 2019-08-22 23:46:06.988540
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'GLYFADA' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-04-26 04:50:45.267280', '2019-04-28 07:35:29.461452'];
  params:
  - GLYFADA
  - - 2019-04-26 04:50:45.267280
    - 2019-04-28 07:35:29.461452
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'AGIOI THEODORI' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-08-19 16:47:58.664034', '2019-08-24 22:44:40.648171'];
  params:
  - AGIOI THEODORI
  - - 2019-08-19 16:47:58.664034
    - 2019-08-24 22:44:40.648171
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'ZEA' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-10-16 12:40:18.864838', '2019-10-22 11:15:53.703152'];
  params:
  - ZEA
  - - 2019-10-16 12:40:18.864838
    - 2019-10-22 11:15:53.703152
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-01-17 16:34:18.620204', '2019-01-22 18:27:50.038316'];
  params:
  - - 2019-01-17 16:34:18.620204
    - 2019-01-22 18:27:50.038316
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'FLISVOS' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-09-16 19:54:38.803321', '2019-09-21 14:08:31.572836'];
  params:
  - FLISVOS
  - - 2019-09-16 19:54:38.803321
    - 2019-09-21 14:08:31.572836
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-10-22 02:59:19.798267', '2019-10-25 14:15:51.163123'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-10-22 02:59:19.798267
    - 2019-10-25 14:15:51.163123
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-11-21 14:11:36.455431', '2019-11-29 10:35:07.006084'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-11-21 14:11:36.455431
    - 2019-11-29 10:35:07.006084
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 3 AND DATE(st.start_ts) = DATE 16;
  params:
  - 16
  - 3
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-04-17 20:57:31.591749', '2019-04-27 14:59:14.472870'];
  params:
  - - 2019-04-17 20:57:31.591749
    - 2019-04-27 14:59:14.472870
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'GLYFADA' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-11-14 14:27:59.835104', '2019-11-26 02:13:35.495435'];
  params:
  - GLYFADA
  - - 2019-11-14 14:27:59.835104
    - 2019-11-26 02:13:35.495435
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 8 AND DATE(st.start_ts) = DATE 23;
  params:
  - 23
  - 8
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-10-18 14:07:24.690142', '2019-11-02 01:29:36.264555'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-10-18 14:07:24.690142
    - 2019-11-02 01:29:36.264555
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-07-06 03:43:56.355556', '2019-07-14 19:40:47.831917'];
  params:
  - - 2019-07-06 03:43:56.355556
    - 2019-07-14 19:40:47.831917
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-06-10 16:56:55.659745', '2019-06-16 20:31:15.141818'];
  params:
  - - 2019-06-10 16:56:55.659745
    - 2019-06-16 20:31:15.141818
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-01-06 22:43:22.534042', '2019-01-17 08:59:59.969292'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-01-06 22:43:22.534042
    - 2019-01-17 08:59:59.969292
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'ELEFSIS' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-10-29 14:43:17.469993', '2019-11-10 06:04:10.109994'];
  params:
  - ELEFSIS
  - - 2019-10-29 14:43:17.469993
    - 2019-11-10 06:04:10.109994
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 23 AND DATE(st.start_ts) = DATE 26;
  params:
  - 26
  - 23
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'ERMIONI'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'CORINTH CANAL'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - ERMIONI
  - CORINTH CANAL
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 3 AND DATE(st.start_ts) = DATE 14;
  params:
  - 14
  - 3
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'FANEROMENI' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-06-11 06:01:57.731167', '2019-06-22 02:24:31.750466'];
  params:
  - FANEROMENI
  - - 2019-06-11 06:01:57.731167
    - 2019-06-22 02:24:31.750466
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 14 AND DATE(st.start_ts) = DATE 21;
  params:
  - 21
  - 14
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-04-22 15:49:07.504638', '2019-05-05 05:00:21.167660'];
  params:
  - - 2019-04-22 15:49:07.504638
    - 2019-05-05 05:00:21.167660
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'FANEROMENI'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'FLISVOS'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - FANEROMENI
  - FLISVOS
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Nisis Metopi;MULTIPOLYGON(((23.3772365 37.7192176' GROUP BY i.name;
  params:
  - Nisis Metopi;MULTIPOLYGON(((23.3772365 37.7192176
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Aegina Moni;MULTIPOLYGON(((23.4230677 37.68617' GROUP BY i.name;
  params:
  - Aegina Moni;MULTIPOLYGON(((23.4230677 37.68617
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-07-21 20:20:03.760858', '2019-07-24 00:55:36.864977'];
  params:
  - - 2019-07-21 20:20:03.760858
    - 2019-07-24 00:55:36.864977
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-08-21 16:14:27.970883', '2019-08-27 15:17:31.734920'];
  params:
  - - 2019-08-21 16:14:27.970883
    - 2019-08-27 15:17:31.734920
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'AGISTRI' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-01-12 19:15:52.981205', '2019-01-21 01:05:40.421248'];
  params:
  - AGISTRI
  - - 2019-01-12 19:15:52.981205
    - 2019-01-21 01:05:40.421248
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'FALIRO'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'AEGINA'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - FALIRO
  - AEGINA
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'PERAMA'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'PIRAEUS'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - PERAMA
  - PIRAEUS
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Makronisos;MULTIPOLYGON(((23.4499771 37.8187979' GROUP BY i.name;
  params:
  - Makronisos;MULTIPOLYGON(((23.4499771 37.8187979
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'PERAMA'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'FANEROMENI'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - PERAMA
  - FANEROMENI
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'ZEA' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-12-02 09:42:40.512577', '2019-12-04 23:03:05.696318'];
  params:
  - ZEA
  - - 2019-12-02 09:42:40.512577
    - 2019-12-04 23:03:05.696318
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-05-21 06:05:04.216254', '2019-06-05 05:18:21.741214'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-05-21 06:05:04.216254
    - 2019-06-05 05:18:21.741214
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 12 AND DATE(st.start_ts) = DATE 26;
  params:
  - 26
  - 12
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'ASPROPYRGOS' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-09-27 20:58:10.740683', '2019-10-11 21:18:52.309695'];
  params:
  - ASPROPYRGOS
  - - 2019-09-27 20:58:10.740683
    - 2019-10-11 21:18:52.309695
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-05-23 16:31:28.964395', '2019-05-28 10:49:49.436768'];
  params:
  - - 2019-05-23 16:31:28.964395
    - 2019-05-28 10:49:49.436768
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'PERAMA' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-09-09 14:44:25.194541', '2019-09-13 19:27:15.428971'];
  params:
  - PERAMA
  - - 2019-09-09 14:44:25.194541
    - 2019-09-13 19:27:15.428971
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Patroklos;MULTIPOLYGON(((23.9580264 37.6565078' GROUP BY i.name;
  params:
  - Patroklos;MULTIPOLYGON(((23.9580264 37.6565078
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'AGIOI THEODORI' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-11-01 18:02:39.349815', '2019-11-15 02:39:09.811168'];
  params:
  - AGIOI THEODORI
  - - 2019-11-01 18:02:39.349815
    - 2019-11-15 02:39:09.811168
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 2 AND DATE(st.start_ts) = DATE 19;
  params:
  - 19
  - 2
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'SOUSAKI' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-09-17 22:46:51.179594', '2019-09-20 06:46:11.036529'];
  params:
  - SOUSAKI
  - - 2019-09-17 22:46:51.179594
    - 2019-09-20 06:46:11.036529
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-01-12 22:36:43.285711', '2019-01-20 12:04:37.265102'];
  params:
  - - 2019-01-12 22:36:43.285711
    - 2019-01-20 12:04:37.265102
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 13 AND DATE(st.start_ts) = DATE 29;
  params:
  - 29
  - 13
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-03-17 12:55:40.787602', '2019-03-25 15:57:06.461290'];
  params:
  - - 2019-03-17 12:55:40.787602
    - 2019-03-25 15:57:06.461290
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Kourmouloudes;MULTIPOLYGON(((23.3193627 37.8000988' GROUP BY i.name;
  params:
  - Kourmouloudes;MULTIPOLYGON(((23.3193627 37.8000988
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'ZEA' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-05-26 05:31:29.443349', '2019-06-07 10:42:12.431357'];
  params:
  - ZEA
  - - 2019-05-26 05:31:29.443349
    - 2019-06-07 10:42:12.431357
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 10 AND DATE(st.start_ts) = DATE 5;
  params:
  - 5
  - 10
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Patroklos;MULTIPOLYGON(((23.9580264 37.6565078' GROUP BY i.name;
  params:
  - Patroklos;MULTIPOLYGON(((23.9580264 37.6565078
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Kourmouloudes;MULTIPOLYGON(((23.3193627 37.8000988' GROUP BY i.name;
  params:
  - Kourmouloudes;MULTIPOLYGON(((23.3193627 37.8000988
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-10-27 17:49:53.501265', '2019-11-01 09:55:58.292859'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-10-27 17:49:53.501265
    - 2019-11-01 09:55:58.292859
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-01-12 00:47:06.017599', '2019-01-19 15:47:25.182816'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-01-12 00:47:06.017599
    - 2019-01-19 15:47:25.182816
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 7 AND DATE(st.start_ts) = DATE 4;
  params:
  - 4
  - 7
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'CORINTH'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'ELEFSIS'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - CORINTH
  - ELEFSIS
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'AEGINA' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-01-14 18:16:22.179586', '2019-01-23 09:16:37.711451'];
  params:
  - AEGINA
  - - 2019-01-14 18:16:22.179586
    - 2019-01-23 09:16:37.711451
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'FLISVOS'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'PERAMA'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - FLISVOS
  - PERAMA
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'ALIMOS' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-09-19 11:45:03.864256', '2019-10-04 00:06:23.620154'];
  params:
  - ALIMOS
  - - 2019-09-19 11:45:03.864256
    - 2019-10-04 00:06:23.620154
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-06-17 15:34:02.798426', '2019-07-01 07:27:56.641700'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-06-17 15:34:02.798426
    - 2019-07-01 07:27:56.641700
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'CORINTH' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-11-25 16:40:34.889937', '2019-12-02 13:32:07.915629'];
  params:
  - CORINTH
  - - 2019-11-25 16:40:34.889937
    - 2019-12-02 13:32:07.915629
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'AEGINA'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'PERAMA'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - AEGINA
  - PERAMA
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'CORINTH' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-09-07 00:19:00.352132', '2019-09-14 06:08:17.739587'];
  params:
  - CORINTH
  - - 2019-09-07 00:19:00.352132
    - 2019-09-14 06:08:17.739587
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'RAFINA' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-11-21 08:11:58.557015', '2019-11-29 13:02:38.842461'];
  params:
  - RAFINA
  - - 2019-11-21 08:11:58.557015
    - 2019-11-29 13:02:38.842461
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'PIRAEUS' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-04-03 03:29:33.698195', '2019-04-15 00:08:11.314611'];
  params:
  - PIRAEUS
  - - 2019-04-03 03:29:33.698195
    - 2019-04-15 00:08:11.314611
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-12-16 06:31:36.344050', '2019-12-19 04:02:13.889217'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-12-16 06:31:36.344050
    - 2019-12-19 04:02:13.889217
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-05-06 09:29:06.349229', '2019-05-14 07:18:30.428818'];
  params:
  - - 2019-05-06 09:29:06.349229
    - 2019-05-14 07:18:30.428818
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'PIRAEUS'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'CORINTH CANAL'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - PIRAEUS
  - CORINTH CANAL
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 12 AND DATE(st.start_ts) = DATE 10;
  params:
  - 10
  - 12
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 9 AND DATE(st.start_ts) = DATE 21;
  params:
  - 21
  - 9
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 1 AND DATE(st.start_ts) = DATE 3;
  params:
  - 3
  - 1
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 5 AND DATE(st.start_ts) = DATE 13;
  params:
  - 13
  - 5
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 5 AND DATE(st.start_ts) = DATE 16;
  params:
  - 16
  - 5
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'AGIOS KOSMAS' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-12-10 13:34:58.128937', '2019-12-18 08:19:43.945470'];
  params:
  - AGIOS KOSMAS
  - - 2019-12-10 13:34:58.128937
    - 2019-12-18 08:19:43.945470
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-05-07 11:34:16.177337', '2019-05-09 18:59:24.976881'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-05-07 11:34:16.177337
    - 2019-05-09 18:59:24.976881
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Nisis Ipsili;MULTIPOLYGON(((23.337696 37.7981419' GROUP BY i.name;
  params:
  - Nisis Ipsili;MULTIPOLYGON(((23.337696 37.7981419
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-04-02 09:44:53.330290', '2019-04-12 08:20:39.285078'];
  params:
  - - 2019-04-02 09:44:53.330290
    - 2019-04-12 08:20:39.285078
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Nisis Ledou;MULTIPOLYGON(((23.2590042 37.8010783' GROUP BY i.name;
  params:
  - Nisis Ledou;MULTIPOLYGON(((23.2590042 37.8010783
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 11 AND DATE(st.start_ts) = DATE 18;
  params:
  - 18
  - 11
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-06-25 12:02:00.934323', '2019-07-05 05:43:49.131707'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-06-25 12:02:00.934323
    - 2019-07-05 05:43:49.131707
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 4 AND DATE(st.start_ts) = DATE 10;
  params:
  - 10
  - 4
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'AEGINA' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-05-10 13:40:16.536836', '2019-05-24 06:27:51.191513'];
  params:
  - AEGINA
  - - 2019-05-10 13:40:16.536836
    - 2019-05-24 06:27:51.191513
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-10-22 13:52:13.377785', '2019-11-02 07:46:45.768771'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-10-22 13:52:13.377785
    - 2019-11-02 07:46:45.768771
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 16 AND DATE(st.start_ts) = DATE 2;
  params:
  - 2
  - 16
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-07-30 21:53:02.241275', '2019-08-12 07:12:16.997898'];
  params:
  - - 2019-07-30 21:53:02.241275
    - 2019-08-12 07:12:16.997898
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-01-07 01:48:57.470289', '2019-01-19 08:49:31.222813'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-01-07 01:48:57.470289
    - 2019-01-19 08:49:31.222813
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'AGIOI THEODORI' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-07-05 19:57:47.149633', '2019-07-17 07:06:23.396878'];
  params:
  - AGIOI THEODORI
  - - 2019-07-05 19:57:47.149633
    - 2019-07-17 07:06:23.396878
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'LAVRIO'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'ASPROPYRGOS'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - LAVRIO
  - ASPROPYRGOS
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'LAVRIO'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'SOUSAKI'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - LAVRIO
  - SOUSAKI
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Kasidis;MULTIPOLYGON(((23.7690617 37.7937917' GROUP BY i.name;
  params:
  - Kasidis;MULTIPOLYGON(((23.7690617 37.7937917
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'SIRI'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'FANEROMENI'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - SIRI
  - FANEROMENI
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Nisis Islet;MULTIPOLYGON(((23.3837032 37.8100009' GROUP BY i.name;
  params:
  - Nisis Islet;MULTIPOLYGON(((23.3837032 37.8100009
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'LAVRIO'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'FLISVOS'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - LAVRIO
  - FLISVOS
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'ELEFSIS'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'LAVRIO'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - ELEFSIS
  - LAVRIO
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-06-11 13:24:11.740491', '2019-06-23 11:03:28.600396'];
  params:
  - - 2019-06-11 13:24:11.740491
    - 2019-06-23 11:03:28.600396
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'GLYFADA'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'LAVRIO'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - GLYFADA
  - LAVRIO
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 17 AND DATE(st.start_ts) = DATE 2;
  params:
  - 2
  - 17
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-06-03 05:00:39.469231', '2019-06-16 20:21:31.067688'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-06-03 05:00:39.469231
    - 2019-06-16 20:21:31.067688
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'PIRAEUS'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'SIRI'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - PIRAEUS
  - SIRI
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Revithousa;MULTIPOLYGON(((23.3970014 37.9622853' GROUP BY i.name;
  params:
  - Revithousa;MULTIPOLYGON(((23.3970014 37.9622853
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Nisis Bisti;MULTIPOLYGON(((23.4866746 37.5525434' GROUP BY i.name;
  params:
  - Nisis Bisti;MULTIPOLYGON(((23.4866746 37.5525434
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 5 AND DATE(st.start_ts) = DATE 26;
  params:
  - 26
  - 5
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-08-31 21:42:49.003002', '2019-09-11 15:10:52.467177'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-08-31 21:42:49.003002
    - 2019-09-11 15:10:52.467177
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'ERMIONI' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-01-06 02:17:48.090051', '2019-01-15 11:25:44.486243'];
  params:
  - ERMIONI
  - - 2019-01-06 02:17:48.090051
    - 2019-01-15 11:25:44.486243
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-02-18 03:23:19.280822', '2019-02-26 04:19:29.217173'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-02-18 03:23:19.280822
    - 2019-02-26 04:19:29.217173
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Nisis Lagousa;MULTIPOLYGON(((23.4656702 37.8165137' GROUP BY i.name;
  params:
  - Nisis Lagousa;MULTIPOLYGON(((23.4656702 37.8165137
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'RAFINA' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-11-24 04:55:18.880040', '2019-12-02 11:47:17.259591'];
  params:
  - RAFINA
  - - 2019-11-24 04:55:18.880040
    - 2019-12-02 11:47:17.259591
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 3 AND DATE(st.start_ts) = DATE 11;
  params:
  - 11
  - 3
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'GLYFADA'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'LAVRIO'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - GLYFADA
  - LAVRIO
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'ERMIONI' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-06-15 17:17:10.219135', '2019-06-21 08:01:02.423761'];
  params:
  - ERMIONI
  - - 2019-06-15 17:17:10.219135
    - 2019-06-21 08:01:02.423761
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'GLYFADA'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'SIRI'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - GLYFADA
  - SIRI
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 13 AND DATE(st.start_ts) = DATE 18;
  params:
  - 18
  - 13
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'PERAMA'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'AGIOS KOSMAS'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - PERAMA
  - AGIOS KOSMAS
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'AGIOS KOSMAS'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'AEGINA'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - AGIOS KOSMAS
  - AEGINA
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-12-07 00:14:41.041999', '2019-12-10 17:06:03.598850'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-12-07 00:14:41.041999
    - 2019-12-10 17:06:03.598850
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-09-01 13:47:37.754288', '2019-09-09 01:37:19.440383'];
  params:
  - - 2019-09-01 13:47:37.754288
    - 2019-09-09 01:37:19.440383
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-05-12 18:56:38.284499', '2019-05-15 00:10:06.360053'];
  params:
  - - 2019-05-12 18:56:38.284499
    - 2019-05-15 00:10:06.360053
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'RAFINA' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-02-10 04:35:26.208324', '2019-02-14 09:17:33.193546'];
  params:
  - RAFINA
  - - 2019-02-10 04:35:26.208324
    - 2019-02-14 09:17:33.193546
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Patroklos;MULTIPOLYGON(((23.9580264 37.6565078' GROUP BY i.name;
  params:
  - Patroklos;MULTIPOLYGON(((23.9580264 37.6565078
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 11 AND DATE(st.start_ts) = DATE 23;
  params:
  - 23
  - 11
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 7 AND DATE(st.start_ts) = DATE 12;
  params:
  - 12
  - 7
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'CORINTH CANAL' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-01-28 13:44:24.974069', '2019-02-01 07:47:52.763689'];
  params:
  - CORINTH CANAL
  - - 2019-01-28 13:44:24.974069
    - 2019-02-01 07:47:52.763689
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-03-31 01:30:13.602385', '2019-04-06 13:49:31.251205'];
  params:
  - - 2019-03-31 01:30:13.602385
    - 2019-04-06 13:49:31.251205
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'PERAMA' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-04-30 02:52:37.693079', '2019-05-14 08:03:52.620049'];
  params:
  - PERAMA
  - - 2019-04-30 02:52:37.693079
    - 2019-05-14 08:03:52.620049
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-03-19 04:34:45.937829', '2019-03-30 20:26:58.247637'];
  params:
  - - 2019-03-19 04:34:45.937829
    - 2019-03-30 20:26:58.247637
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 5 AND DATE(st.start_ts) = DATE 23;
  params:
  - 23
  - 5
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'SOUSAKI' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-02-20 20:31:01.852419', '2019-02-25 18:58:44.142155'];
  params:
  - SOUSAKI
  - - 2019-02-20 20:31:01.852419
    - 2019-02-25 18:58:44.142155
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'RAFINA'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'ALIMOS'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - RAFINA
  - ALIMOS
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'SIRI'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'FALIRO'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - SIRI
  - FALIRO
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-05-01 03:11:28.971729', '2019-05-15 22:43:55.559976'];
  params:
  - - 2019-05-01 03:11:28.971729
    - 2019-05-15 22:43:55.559976
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Spalaphtronisi Islet;MULTIPOLYGON(((23.2363612 37.7013733' GROUP BY i.name;
  params:
  - Spalaphtronisi Islet;MULTIPOLYGON(((23.2363612 37.7013733
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Phleva Island;MULTIPOLYGON(((23.7659544 37.7674259' GROUP BY i.name;
  params:
  - Phleva Island;MULTIPOLYGON(((23.7659544 37.7674259
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'CORINTH'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'GLYFADA'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - CORINTH
  - GLYFADA
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Agios Ioannis;MULTIPOLYGON(((23.2585002 37.8163195' GROUP BY i.name;
  params:
  - Agios Ioannis;MULTIPOLYGON(((23.2585002 37.8163195
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'CORINTH CANAL'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'RAFINA'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - CORINTH CANAL
  - RAFINA
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Nisis Pachaki;MULTIPOLYGON(((23.3614704 37.9692519' GROUP BY i.name;
  params:
  - Nisis Pachaki;MULTIPOLYGON(((23.3614704 37.9692519
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Salamina;MULTIPOLYGON(((23.4052092 37.9299097' GROUP BY i.name;
  params:
  - Salamina;MULTIPOLYGON(((23.4052092 37.9299097
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-05-29 12:28:17.260561', '2019-06-03 11:02:19.672901'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-05-29 12:28:17.260561
    - 2019-06-03 11:02:19.672901
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 12 AND DATE(st.start_ts) = DATE 25;
  params:
  - 25
  - 12
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Vrachonisis Petronisi;MULTIPOLYGON(((23.174325 37.7596882' GROUP BY i.name;
  params:
  - Vrachonisis Petronisi;MULTIPOLYGON(((23.174325 37.7596882
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 3 AND DATE(st.start_ts) = DATE 15;
  params:
  - 15
  - 3
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'ERMIONI'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'AGIOS KOSMAS'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - ERMIONI
  - AGIOS KOSMAS
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'ALIMOS'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'AGIOS KOSMAS'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - ALIMOS
  - AGIOS KOSMAS
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 11 AND DATE(st.start_ts) = DATE 25;
  params:
  - 25
  - 11
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Ovrios;MULTIPOLYGON(((23.1410247 37.8584852' GROUP BY i.name;
  params:
  - Ovrios;MULTIPOLYGON(((23.1410247 37.8584852
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-08-28 02:46:04.393934', '2019-09-11 02:28:12.352195'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-08-28 02:46:04.393934
    - 2019-09-11 02:28:12.352195
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 8 AND DATE(st.start_ts) = DATE 15;
  params:
  - 15
  - 8
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Agistri;MULTIPOLYGON(((23.3404791 37.6728988' GROUP BY i.name;
  params:
  - Agistri;MULTIPOLYGON(((23.3404791 37.6728988
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-04-18 19:18:18.536279', '2019-04-25 13:21:23.544833'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-04-18 19:18:18.536279
    - 2019-04-25 13:21:23.544833
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'FANEROMENI' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-07-23 13:42:02.223549', '2019-08-03 16:23:53.779828'];
  params:
  - FANEROMENI
  - - 2019-07-23 13:42:02.223549
    - 2019-08-03 16:23:53.779828
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-08-18 15:52:58.808777', '2019-08-31 11:59:22.408660'];
  params:
  - - 2019-08-18 15:52:58.808777
    - 2019-08-31 11:59:22.408660
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'SIRI'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'ELEFSIS'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - SIRI
  - ELEFSIS
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 1 AND DATE(st.start_ts) = DATE 27;
  params:
  - 27
  - 1
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-04-26 21:35:31.583316', '2019-04-29 18:22:19.251563'];
  params:
  - - 2019-04-26 21:35:31.583316
    - 2019-04-29 18:22:19.251563
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-12-10 20:06:29.536494', '2019-12-18 01:02:00.768243'];
  params:
  - - 2019-12-10 20:06:29.536494
    - 2019-12-18 01:02:00.768243
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-06-05 12:20:12.073717', '2019-06-10 00:08:11.714592'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-06-05 12:20:12.073717
    - 2019-06-10 00:08:11.714592
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'AEGINA' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-01-05 08:40:17.672011', '2019-01-14 02:48:33.373466'];
  params:
  - AEGINA
  - - 2019-01-05 08:40:17.672011
    - 2019-01-14 02:48:33.373466
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 19 AND DATE(st.start_ts) = DATE 9;
  params:
  - 9
  - 19
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'ERMIONI'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'FALIRO'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - ERMIONI
  - FALIRO
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 18 AND DATE(st.start_ts) = DATE 31;
  params:
  - 31
  - 18
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-11-25 10:47:51.739030', '2019-12-08 04:27:24.968775'];
  params:
  - - 2019-11-25 10:47:51.739030
    - 2019-12-08 04:27:24.968775
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-03-28 12:12:55.810120', '2019-03-30 19:22:02.472035'];
  params:
  - - 2019-03-28 12:12:55.810120
    - 2019-03-30 19:22:02.472035
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-08-02 08:04:32.119448', '2019-08-07 09:24:28.992029'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-08-02 08:04:32.119448
    - 2019-08-07 09:24:28.992029
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'LAVRIO'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'AEGINA'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - LAVRIO
  - AEGINA
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Kavouronisi;MULTIPOLYGON(((23.7531549 37.8136342' GROUP BY i.name;
  params:
  - Kavouronisi;MULTIPOLYGON(((23.7531549 37.8136342
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 3 AND DATE(st.start_ts) = DATE 6;
  params:
  - 6
  - 3
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 16 AND DATE(st.start_ts) = DATE 16;
  params:
  - 16
  - 16
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-10-28 11:01:50.123474', '2019-11-11 03:17:05.253134'];
  params:
  - - 2019-10-28 11:01:50.123474
    - 2019-11-11 03:17:05.253134
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-11-26 10:16:54.147579', '2019-12-06 23:08:49.456451'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-11-26 10:16:54.147579
    - 2019-12-06 23:08:49.456451
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'FLISVOS'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'GLYFADA'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - FLISVOS
  - GLYFADA
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Vrachonisis Moladi;MULTIPOLYGON(((23.2857762 37.8099715' GROUP BY i.name;
  params:
  - Vrachonisis Moladi;MULTIPOLYGON(((23.2857762 37.8099715
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'CORINTH CANAL'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'AGIOI THEODORI'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - CORINTH CANAL
  - AGIOI THEODORI
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 10 AND DATE(st.start_ts) = DATE 8;
  params:
  - 8
  - 10
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-12-13 19:58:56.244310', '2019-12-26 21:01:49'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-12-13 19:58:56.244310
    - 2019-12-26 21:01:49
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Aegina Moni;MULTIPOLYGON(((23.4230677 37.68617' GROUP BY i.name;
  params:
  - Aegina Moni;MULTIPOLYGON(((23.4230677 37.68617
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-08-24 06:07:33.133721', '2019-08-29 23:44:51.076457'];
  params:
  - - 2019-08-24 06:07:33.133721
    - 2019-08-29 23:44:51.076457
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'ERMIONI'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'FALIRO'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - ERMIONI
  - FALIRO
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-03-10 00:59:22.684121', '2019-03-18 12:36:47.161065'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-03-10 00:59:22.684121
    - 2019-03-18 12:36:47.161065
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Aegina;MULTIPOLYGON(((23.429254 37.7433915' GROUP BY i.name;
  params:
  - Aegina;MULTIPOLYGON(((23.429254 37.7433915
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Agios Ioannis;MULTIPOLYGON(((23.2585002 37.8163195' GROUP BY i.name;
  params:
  - Agios Ioannis;MULTIPOLYGON(((23.2585002 37.8163195
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-04-01 13:53:02.746436', '2019-04-06 07:01:18.710540'];
  params:
  - - 2019-04-01 13:53:02.746436
    - 2019-04-06 07:01:18.710540
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 22 AND DATE(st.start_ts) = DATE 19;
  params:
  - 19
  - 22
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'SOUSAKI' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-07-01 15:35:13.449271', '2019-07-12 20:10:11.603522'];
  params:
  - SOUSAKI
  - - 2019-07-01 15:35:13.449271
    - 2019-07-12 20:10:11.603522
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'AGIOI THEODORI'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'CORINTH'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - AGIOI THEODORI
  - CORINTH
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'AGISTRI' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-07-29 02:49:57.869119', '2019-08-02 05:44:29.440404'];
  params:
  - AGISTRI
  - - 2019-07-29 02:49:57.869119
    - 2019-08-02 05:44:29.440404
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'ALIMOS'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'AEGINA'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - ALIMOS
  - AEGINA
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 2 AND DATE(st.start_ts) = DATE 2;
  params:
  - 2
  - 2
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'SIRI' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-12-03 22:08:08.999279', '2019-12-14 22:01:18.690892'];
  params:
  - SIRI
  - - 2019-12-03 22:08:08.999279
    - 2019-12-14 22:01:18.690892
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-08-18 16:37:45.579209', '2019-08-22 07:49:15.305409'];
  params:
  - - 2019-08-18 16:37:45.579209
    - 2019-08-22 07:49:15.305409
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'ALIMOS'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'PERAMA'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - ALIMOS
  - PERAMA
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-11-10 07:45:38.527378', '2019-11-17 21:40:40.506659'];
  params:
  - - 2019-11-10 07:45:38.527378
    - 2019-11-17 21:40:40.506659
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 12 AND DATE(st.start_ts) = DATE 30;
  params:
  - 30
  - 12
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 3 AND DATE(st.start_ts) = DATE 24;
  params:
  - 24
  - 3
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 13 AND DATE(st.start_ts) = DATE 1;
  params:
  - 1
  - 13
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'PIRAEUS' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-03-25 21:15:24.447616', '2019-04-04 23:44:57.626040'];
  params:
  - PIRAEUS
  - - 2019-03-25 21:15:24.447616
    - 2019-04-04 23:44:57.626040
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'ZEA'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'SOUSAKI'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - ZEA
  - SOUSAKI
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-07-19 12:27:51.451278', '2019-08-01 06:20:02.739267'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-07-19 12:27:51.451278
    - 2019-08-01 06:20:02.739267
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'AGIOS KOSMAS' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-12-20 23:11:25.922961', '2019-12-26 14:22:24.922868'];
  params:
  - AGIOS KOSMAS
  - - 2019-12-20 23:11:25.922961
    - 2019-12-26 14:22:24.922868
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-10-24 00:48:07.732329', '2019-10-27 15:50:54.932949'];
  params:
  - - 2019-10-24 00:48:07.732329
    - 2019-10-27 15:50:54.932949
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 7 AND DATE(st.start_ts) = DATE 4;
  params:
  - 4
  - 7
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-04-24 19:37:24.673814', '2019-05-02 13:17:20.925289'];
  params:
  - - 2019-04-24 19:37:24.673814
    - 2019-05-02 13:17:20.925289
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Agistri;MULTIPOLYGON(((23.3404791 37.6728988' GROUP BY i.name;
  params:
  - Agistri;MULTIPOLYGON(((23.3404791 37.6728988
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-09-26 19:32:11.468210', '2019-10-05 01:32:42.934085'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-09-26 19:32:11.468210
    - 2019-10-05 01:32:42.934085
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-10-23 18:36:29.321626', '2019-10-31 08:36:28.253870'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-10-23 18:36:29.321626
    - 2019-10-31 08:36:28.253870
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Nisis Stakhtorroyi;MULTIPOLYGON(((23.3608955 37.8141731' GROUP BY i.name;
  params:
  - Nisis Stakhtorroyi;MULTIPOLYGON(((23.3608955 37.8141731
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Vrachonisis Moladi;MULTIPOLYGON(((23.2857762 37.8099715' GROUP BY i.name;
  params:
  - Vrachonisis Moladi;MULTIPOLYGON(((23.2857762 37.8099715
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'SOUSAKI' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-10-24 23:04:06.751570', '2019-10-27 09:16:38.782683'];
  params:
  - SOUSAKI
  - - 2019-10-24 23:04:06.751570
    - 2019-10-27 09:16:38.782683
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'FALIRO' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-02-26 13:24:42.681040', '2019-03-06 02:14:48.213952'];
  params:
  - FALIRO
  - - 2019-02-26 13:24:42.681040
    - 2019-03-06 02:14:48.213952
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'CORINTH' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-06-12 04:21:42.836158', '2019-06-22 00:43:44.007957'];
  params:
  - CORINTH
  - - 2019-06-12 04:21:42.836158
    - 2019-06-22 00:43:44.007957
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Arsida;MULTIPOLYGON(((23.8940984 37.7083539' GROUP BY i.name;
  params:
  - Arsida;MULTIPOLYGON(((23.8940984 37.7083539
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-08-10 15:23:50.283662', '2019-08-24 15:29:26.193642'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-08-10 15:23:50.283662
    - 2019-08-24 15:29:26.193642
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-01-01 18:43:06.951037', '2019-01-14 14:31:23.182456'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-01-01 18:43:06.951037
    - 2019-01-14 14:31:23.182456
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 22 AND DATE(st.start_ts) = DATE 17;
  params:
  - 17
  - 22
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 5 AND DATE(st.start_ts) = DATE 25;
  params:
  - 25
  - 5
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 11 AND DATE(st.start_ts) = DATE 24;
  params:
  - 24
  - 11
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-04-04 06:12:48.809999', '2019-04-06 17:29:50.302254'];
  params:
  - - 2019-04-04 06:12:48.809999
    - 2019-04-06 17:29:50.302254
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-07-05 11:42:17.657368', '2019-07-13 05:54:08.500632'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-07-05 11:42:17.657368
    - 2019-07-13 05:54:08.500632
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 9 AND DATE(st.start_ts) = DATE 22;
  params:
  - 22
  - 9
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 23 AND DATE(st.start_ts) = DATE 21;
  params:
  - 21
  - 23
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 3 AND DATE(st.start_ts) = DATE 19;
  params:
  - 19
  - 3
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'AGIOS KOSMAS'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'LAVRIO'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - AGIOS KOSMAS
  - LAVRIO
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Vrachonisis Moladi;MULTIPOLYGON(((23.2857762 37.8099715' GROUP BY i.name;
  params:
  - Vrachonisis Moladi;MULTIPOLYGON(((23.2857762 37.8099715
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'GLYFADA' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-02-18 07:36:39.297885', '2019-03-05 05:04:22.041468'];
  params:
  - GLYFADA
  - - 2019-02-18 07:36:39.297885
    - 2019-03-05 05:04:22.041468
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-09-22 23:57:06.667480', '2019-10-07 00:03:08.602406'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-09-22 23:57:06.667480
    - 2019-10-07 00:03:08.602406
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Anagnostis;MULTIPOLYGON(((23.3243555 37.8063016' GROUP BY i.name;
  params:
  - Anagnostis;MULTIPOLYGON(((23.3243555 37.8063016
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'LAVRIO'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'RAFINA'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - LAVRIO
  - RAFINA
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'ERMIONI' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-07-12 19:18:01.992277', '2019-07-16 07:27:18.969538'];
  params:
  - ERMIONI
  - - 2019-07-12 19:18:01.992277
    - 2019-07-16 07:27:18.969538
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-02-14 12:01:44.049255', '2019-02-22 12:10:58.256414'];
  params:
  - - 2019-02-14 12:01:44.049255
    - 2019-02-22 12:10:58.256414
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Thorussa;MULTIPOLYGON(((23.3173612 37.6775666' GROUP BY i.name;
  params:
  - Thorussa;MULTIPOLYGON(((23.3173612 37.6775666
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 18 AND DATE(st.start_ts) = DATE 26;
  params:
  - 26
  - 18
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-03-21 22:31:28.108906', '2019-04-02 12:11:49.961764'];
  params:
  - - 2019-03-21 22:31:28.108906
    - 2019-04-02 12:11:49.961764
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 22 AND DATE(st.start_ts) = DATE 28;
  params:
  - 28
  - 22
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Ydrousa;MULTIPOLYGON(((23.7440149 37.8343154' GROUP BY i.name;
  params:
  - Ydrousa;MULTIPOLYGON(((23.7440149 37.8343154
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'FALIRO'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'RAFINA'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - FALIRO
  - RAFINA
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 16 AND DATE(st.start_ts) = DATE 3;
  params:
  - 3
  - 16
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Phlevopoula;MULTIPOLYGON(((23.7678404 37.7785741' GROUP BY i.name;
  params:
  - Phlevopoula;MULTIPOLYGON(((23.7678404 37.7785741
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Kavouronisi;MULTIPOLYGON(((23.7531549 37.8136342' GROUP BY i.name;
  params:
  - Kavouronisi;MULTIPOLYGON(((23.7531549 37.8136342
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-10-05 15:42:26.600827', '2019-10-19 18:44:08.053569'];
  params:
  - - 2019-10-05 15:42:26.600827
    - 2019-10-19 18:44:08.053569
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-10-28 04:25:02.558697', '2019-11-04 16:11:07.170593'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-10-28 04:25:02.558697
    - 2019-11-04 16:11:07.170593
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'AEGINA'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'FALIRO'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - AEGINA
  - FALIRO
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-06-30 02:49:02.998602', '2019-07-13 21:31:17.018591'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-06-30 02:49:02.998602
    - 2019-07-13 21:31:17.018591
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Nisis Stakhtorroyi;MULTIPOLYGON(((23.3608955 37.8141731' GROUP BY i.name;
  params:
  - Nisis Stakhtorroyi;MULTIPOLYGON(((23.3608955 37.8141731
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Pachi;MULTIPOLYGON(((23.3629071 37.9656804' GROUP BY i.name;
  params:
  - Pachi;MULTIPOLYGON(((23.3629071 37.9656804
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 1 AND DATE(st.start_ts) = DATE 7;
  params:
  - 7
  - 1
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 2 AND DATE(st.start_ts) = DATE 27;
  params:
  - 27
  - 2
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'SOUSAKI' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-03-15 03:55:13.850837', '2019-03-30 01:04:22.109505'];
  params:
  - SOUSAKI
  - - 2019-03-15 03:55:13.850837
    - 2019-03-30 01:04:22.109505
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'ASPROPYRGOS'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'FLISVOS'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - ASPROPYRGOS
  - FLISVOS
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'ERMIONI' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-04-03 23:48:37.081186', '2019-04-16 03:31:29.630116'];
  params:
  - ERMIONI
  - - 2019-04-03 23:48:37.081186
    - 2019-04-16 03:31:29.630116
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 13 AND DATE(st.start_ts) = DATE 4;
  params:
  - 4
  - 13
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-03-22 00:17:59.718061', '2019-04-03 12:22:38.130387'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-03-22 00:17:59.718061
    - 2019-04-03 12:22:38.130387
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-03-13 01:51:46.280825', '2019-03-27 04:35:18.114857'];
  params:
  - - 2019-03-13 01:51:46.280825
    - 2019-03-27 04:35:18.114857
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'AGISTRI'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'ELEFSIS'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - AGISTRI
  - ELEFSIS
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'PERAMA' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-01-07 10:39:59.587689', '2019-01-16 06:02:56.645798'];
  params:
  - PERAMA
  - - 2019-01-07 10:39:59.587689
    - 2019-01-16 06:02:56.645798
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-09-21 00:31:31.655676', '2019-09-30 14:47:32.636076'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-09-21 00:31:31.655676
    - 2019-09-30 14:47:32.636076
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-02-04 01:49:07.588822', '2019-02-11 05:34:49.756267'];
  params:
  - - 2019-02-04 01:49:07.588822
    - 2019-02-11 05:34:49.756267
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'CORINTH'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'ERMIONI'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - CORINTH
  - ERMIONI
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-08-07 00:19:11.767896', '2019-08-18 11:58:57.447949'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-08-07 00:19:11.767896
    - 2019-08-18 11:58:57.447949
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-01-14 05:20:30.195024', '2019-01-23 05:36:02.759945'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-01-14 05:20:30.195024
    - 2019-01-23 05:36:02.759945
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Salamina;MULTIPOLYGON(((23.4052092 37.9299097' GROUP BY i.name;
  params:
  - Salamina;MULTIPOLYGON(((23.4052092 37.9299097
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-08-31 06:04:48.244184', '2019-09-04 19:08:24.073483'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-08-31 06:04:48.244184
    - 2019-09-04 19:08:24.073483
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-03-17 13:25:39.969373', '2019-03-30 09:45:50.907514'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-03-17 13:25:39.969373
    - 2019-03-30 09:45:50.907514
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-06-29 11:40:46.318550', '2019-07-08 14:29:58.590205'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-06-29 11:40:46.318550
    - 2019-07-08 14:29:58.590205
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Makronisos;MULTIPOLYGON(((23.4103812 37.967855' GROUP BY i.name;
  params:
  - Makronisos;MULTIPOLYGON(((23.4103812 37.967855
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-12-04 00:48:32.083432', '2019-12-12 19:09:12.003027'];
  params:
  - - 2019-12-04 00:48:32.083432
    - 2019-12-12 19:09:12.003027
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Vrachonisis Tragonisi;MULTIPOLYGON(((23.2444035 37.8027381' GROUP BY i.name;
  params:
  - Vrachonisis Tragonisi;MULTIPOLYGON(((23.2444035 37.8027381
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'FLISVOS' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-10-18 22:51:14.101729', '2019-10-22 09:41:53.580944'];
  params:
  - FLISVOS
  - - 2019-10-18 22:51:14.101729
    - 2019-10-22 09:41:53.580944
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'AGISTRI'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'FLISVOS'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - AGISTRI
  - FLISVOS
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'CORINTH CANAL' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-04-02 13:39:18.565915', '2019-04-05 00:20:20.915257'];
  params:
  - CORINTH CANAL
  - - 2019-04-02 13:39:18.565915
    - 2019-04-05 00:20:20.915257
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Phlevopoula;MULTIPOLYGON(((23.7678404 37.7785741' GROUP BY i.name;
  params:
  - Phlevopoula;MULTIPOLYGON(((23.7678404 37.7785741
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-10-02 19:58:08.276974', '2019-10-16 08:32:30.624876'];
  params:
  - - 2019-10-02 19:58:08.276974
    - 2019-10-16 08:32:30.624876
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-11-21 04:49:44.880379', '2019-11-26 00:33:16.154784'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-11-21 04:49:44.880379
    - 2019-11-26 00:33:16.154784
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-04-05 06:02:45.519514', '2019-04-11 22:26:43.538454'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-04-05 06:02:45.519514
    - 2019-04-11 22:26:43.538454
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 1 AND DATE(st.start_ts) = DATE 25;
  params:
  - 25
  - 1
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'ASPROPYRGOS'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'ALIMOS'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - ASPROPYRGOS
  - ALIMOS
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'AGIOI THEODORI'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'CORINTH'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - AGIOI THEODORI
  - CORINTH
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'FALIRO' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-11-18 03:59:33.810360', '2019-11-24 07:43:10.270896'];
  params:
  - FALIRO
  - - 2019-11-18 03:59:33.810360
    - 2019-11-24 07:43:10.270896
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-05-06 19:12:57.079815', '2019-05-13 16:26:39.858123'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-05-06 19:12:57.079815
    - 2019-05-13 16:26:39.858123
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'RAFINA'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'AGIOI THEODORI'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - RAFINA
  - AGIOI THEODORI
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Vrachonisis Moladi;MULTIPOLYGON(((23.2857762 37.8099715' GROUP BY i.name;
  params:
  - Vrachonisis Moladi;MULTIPOLYGON(((23.2857762 37.8099715
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 19 AND DATE(st.start_ts) = DATE 15;
  params:
  - 15
  - 19
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 6 AND DATE(st.start_ts) = DATE 19;
  params:
  - 19
  - 6
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-03-30 13:55:26.148474', '2019-04-06 16:22:10.660728'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-03-30 13:55:26.148474
    - 2019-04-06 16:22:10.660728
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 17 AND DATE(st.start_ts) = DATE 22;
  params:
  - 22
  - 17
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-07-07 07:47:23.422196', '2019-07-19 06:12:23.458614'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-07-07 07:47:23.422196
    - 2019-07-19 06:12:23.458614
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 16 AND DATE(st.start_ts) = DATE 1;
  params:
  - 1
  - 16
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Kourmouloudes;MULTIPOLYGON(((23.3193627 37.8000988' GROUP BY i.name;
  params:
  - Kourmouloudes;MULTIPOLYGON(((23.3193627 37.8000988
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Nisis Ledou;MULTIPOLYGON(((23.2590042 37.8010783' GROUP BY i.name;
  params:
  - Nisis Ledou;MULTIPOLYGON(((23.2590042 37.8010783
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-03-20 12:13:00.171002', '2019-04-03 15:50:06.747652'];
  params:
  - - 2019-03-20 12:13:00.171002
    - 2019-04-03 15:50:06.747652
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'LAVRIO'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'RAFINA'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - LAVRIO
  - RAFINA
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 17 AND DATE(st.start_ts) = DATE 8;
  params:
  - 8
  - 17
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 14 AND DATE(st.start_ts) = DATE 2;
  params:
  - 2
  - 14
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 4 AND DATE(st.start_ts) = DATE 2;
  params:
  - 2
  - 4
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'PIRAEUS'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'CORINTH'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - PIRAEUS
  - CORINTH
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Poros;MULTIPOLYGON(((23.4581491 37.5061611' GROUP BY i.name;
  params:
  - Poros;MULTIPOLYGON(((23.4581491 37.5061611
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Vrachonisis Petronisi;MULTIPOLYGON(((23.174325 37.7596882' GROUP BY i.name;
  params:
  - Vrachonisis Petronisi;MULTIPOLYGON(((23.174325 37.7596882
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'ZEA'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'AEGINA'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - ZEA
  - AEGINA
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Plateia;MULTIPOLYGON(((23.0879522 37.8663437' GROUP BY i.name;
  params:
  - Plateia;MULTIPOLYGON(((23.0879522 37.8663437
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'ZEA' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-09-10 04:56:25.847236', '2019-09-12 23:26:30.379025'];
  params:
  - ZEA
  - - 2019-09-10 04:56:25.847236
    - 2019-09-12 23:26:30.379025
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Spalaphtronisi Islet;MULTIPOLYGON(((23.2363612 37.7013733' GROUP BY i.name;
  params:
  - Spalaphtronisi Islet;MULTIPOLYGON(((23.2363612 37.7013733
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'PIRAEUS' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-11-04 18:09:35.553217', '2019-11-10 22:30:37.882345'];
  params:
  - PIRAEUS
  - - 2019-11-04 18:09:35.553217
    - 2019-11-10 22:30:37.882345
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-12-07 16:08:21.148073', '2019-12-15 07:24:43.399640'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-12-07 16:08:21.148073
    - 2019-12-15 07:24:43.399640
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Aegina Moni;MULTIPOLYGON(((23.4230677 37.68617' GROUP BY i.name;
  params:
  - Aegina Moni;MULTIPOLYGON(((23.4230677 37.68617
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'ASPROPYRGOS' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-11-11 03:24:49.875444', '2019-11-23 10:14:53.893411'];
  params:
  - ASPROPYRGOS
  - - 2019-11-11 03:24:49.875444
    - 2019-11-23 10:14:53.893411
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'GLYFADA'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'ERMIONI'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - GLYFADA
  - ERMIONI
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Psittalia;MULTIPOLYGON(((23.5806238 37.9366858' GROUP BY i.name;
  params:
  - Psittalia;MULTIPOLYGON(((23.5806238 37.9366858
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-12-20 00:55:52.659286', '2019-12-24 12:41:53.426582'];
  params:
  - - 2019-12-20 00:55:52.659286
    - 2019-12-24 12:41:53.426582
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'SOUSAKI' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-12-17 20:18:20.247553', '2019-12-20 22:51:46.084685'];
  params:
  - SOUSAKI
  - - 2019-12-17 20:18:20.247553
    - 2019-12-20 22:51:46.084685
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-09-19 03:29:57.508785', '2019-09-22 13:47:37.065310'];
  params:
  - - 2019-09-19 03:29:57.508785
    - 2019-09-22 13:47:37.065310
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'LAVRIO' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-09-02 06:01:52.210664', '2019-09-12 17:26:08.239462'];
  params:
  - LAVRIO
  - - 2019-09-02 06:01:52.210664
    - 2019-09-12 17:26:08.239462
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-07-19 00:25:16.872771', '2019-07-26 13:56:41.240647'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-07-19 00:25:16.872771
    - 2019-07-26 13:56:41.240647
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'AGISTRI' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-03-14 18:04:24.688728', '2019-03-20 18:05:19.034063'];
  params:
  - AGISTRI
  - - 2019-03-14 18:04:24.688728
    - 2019-03-20 18:05:19.034063
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'SIRI' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-04-27 13:04:29.381876', '2019-05-10 16:49:16.804114'];
  params:
  - SIRI
  - - 2019-04-27 13:04:29.381876
    - 2019-05-10 16:49:16.804114
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-10-26 02:36:47.950789', '2019-11-05 07:57:26.684597'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-10-26 02:36:47.950789
    - 2019-11-05 07:57:26.684597
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-07-28 05:41:16.793076', '2019-07-31 07:55:01.601247'];
  params:
  - - 2019-07-28 05:41:16.793076
    - 2019-07-31 07:55:01.601247
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-12-24 11:07:12.311084', '2019-12-26 19:18:03.422380'];
  params:
  - - 2019-12-24 11:07:12.311084
    - 2019-12-26 19:18:03.422380
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-08-10 11:14:45.153130', '2019-08-19 19:16:40.240461'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-08-10 11:14:45.153130
    - 2019-08-19 19:16:40.240461
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'PIRAEUS'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'AEGINA'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - PIRAEUS
  - AEGINA
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-07-13 15:38:26.494854', '2019-07-21 03:49:17.555526'];
  params:
  - - 2019-07-13 15:38:26.494854
    - 2019-07-21 03:49:17.555526
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-03-16 16:12:26.972942', '2019-03-22 10:00:26.554217'];
  params:
  - - 2019-03-16 16:12:26.972942
    - 2019-03-22 10:00:26.554217
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-02-07 13:00:53.430123', '2019-02-21 13:33:19.739995'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-02-07 13:00:53.430123
    - 2019-02-21 13:33:19.739995
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 7 AND DATE(st.start_ts) = DATE 23;
  params:
  - 23
  - 7
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'GLYFADA' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-08-17 00:56:49.706701', '2019-08-19 22:54:17.289157'];
  params:
  - GLYFADA
  - - 2019-08-17 00:56:49.706701
    - 2019-08-19 22:54:17.289157
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 18 AND DATE(st.start_ts) = DATE 19;
  params:
  - 19
  - 18
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'ELEFSIS' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-03-04 03:27:16.333657', '2019-03-10 15:17:44.915417'];
  params:
  - ELEFSIS
  - - 2019-03-04 03:27:16.333657
    - 2019-03-10 15:17:44.915417
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Plateia;MULTIPOLYGON(((23.0879522 37.8663437' GROUP BY i.name;
  params:
  - Plateia;MULTIPOLYGON(((23.0879522 37.8663437
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-07-30 01:52:23.831294', '2019-08-01 04:29:59.055390'];
  params:
  - - 2019-07-30 01:52:23.831294
    - 2019-08-01 04:29:59.055390
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-09-04 09:11:47.234164', '2019-09-14 05:17:16.234232'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-09-04 09:11:47.234164
    - 2019-09-14 05:17:16.234232
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-11-04 19:25:19.848674', '2019-11-14 07:09:04.753518'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-11-04 19:25:19.848674
    - 2019-11-14 07:09:04.753518
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 0 AND DATE(st.start_ts) = DATE 28;
  params:
  - 28
  - 0
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-10-30 02:40:56.784336', '2019-11-05 14:11:07.045793'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-10-30 02:40:56.784336
    - 2019-11-05 14:11:07.045793
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Vrachonisis Petronisi;MULTIPOLYGON(((23.174325 37.7596882' GROUP BY i.name;
  params:
  - Vrachonisis Petronisi;MULTIPOLYGON(((23.174325 37.7596882
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-03-09 07:20:10.134111', '2019-03-13 10:56:07.524980'];
  params:
  - - 2019-03-09 07:20:10.134111
    - 2019-03-13 10:56:07.524980
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-07-11 06:51:12.365746', '2019-07-23 22:50:19.300889'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-07-11 06:51:12.365746
    - 2019-07-23 22:50:19.300889
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-10-31 21:26:15.544056', '2019-11-13 12:02:00.929482'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-10-31 21:26:15.544056
    - 2019-11-13 12:02:00.929482
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'FALIRO'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'SOUSAKI'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - FALIRO
  - SOUSAKI
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-06-22 01:30:05.965624', '2019-06-30 07:25:16.763074'];
  params:
  - - 2019-06-22 01:30:05.965624
    - 2019-06-30 07:25:16.763074
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-01-18 15:10:32.420661', '2019-01-22 05:33:23.090505'];
  params:
  - - 2019-01-18 15:10:32.420661
    - 2019-01-22 05:33:23.090505
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 11 AND DATE(st.start_ts) = DATE 16;
  params:
  - 16
  - 11
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Patroklos;MULTIPOLYGON(((23.9580264 37.6565078' GROUP BY i.name;
  params:
  - Patroklos;MULTIPOLYGON(((23.9580264 37.6565078
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'AEGINA'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'FLISVOS'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - AEGINA
  - FLISVOS
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Arsida;MULTIPOLYGON(((23.8940984 37.7083539' GROUP BY i.name;
  params:
  - Arsida;MULTIPOLYGON(((23.8940984 37.7083539
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Spalaphtronisi Islet;MULTIPOLYGON(((23.2363612 37.7013733' GROUP BY i.name;
  params:
  - Spalaphtronisi Islet;MULTIPOLYGON(((23.2363612 37.7013733
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'ZEA'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'ERMIONI'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - ZEA
  - ERMIONI
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 23 AND DATE(st.start_ts) = DATE 8;
  params:
  - 8
  - 23
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'AEGINA' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-05-07 13:25:03.634868', '2019-05-22 04:27:35.945123'];
  params:
  - AEGINA
  - - 2019-05-07 13:25:03.634868
    - 2019-05-22 04:27:35.945123
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Nisis Pachaki;MULTIPOLYGON(((23.3614704 37.9692519' GROUP BY i.name;
  params:
  - Nisis Pachaki;MULTIPOLYGON(((23.3614704 37.9692519
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-02-15 01:58:04.423270', '2019-02-21 21:31:41.654873'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-02-15 01:58:04.423270
    - 2019-02-21 21:31:41.654873
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Aegina;MULTIPOLYGON(((23.429254 37.7433915' GROUP BY i.name;
  params:
  - Aegina;MULTIPOLYGON(((23.429254 37.7433915
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 16 AND DATE(st.start_ts) = DATE 15;
  params:
  - 15
  - 16
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'RAFINA'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'FALIRO'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - RAFINA
  - FALIRO
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-09-03 14:07:30.065310', '2019-09-14 14:58:28.050605'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-09-03 14:07:30.065310
    - 2019-09-14 14:58:28.050605
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'AGIOI THEODORI' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-05-07 09:45:57.711729', '2019-05-15 04:28:03.620003'];
  params:
  - AGIOI THEODORI
  - - 2019-05-07 09:45:57.711729
    - 2019-05-15 04:28:03.620003
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'AGISTRI'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'GLYFADA'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - AGISTRI
  - GLYFADA
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-09-05 10:28:05.783320', '2019-09-13 08:17:26.862076'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-09-05 10:28:05.783320
    - 2019-09-13 08:17:26.862076
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-11-25 10:10:35.974584', '2019-11-29 00:59:01.090790'];
  params:
  - - 2019-11-25 10:10:35.974584
    - 2019-11-29 00:59:01.090790
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-12-13 11:30:58.661872', '2019-12-17 17:51:48.062318'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-12-13 11:30:58.661872
    - 2019-12-17 17:51:48.062318
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-03-23 00:32:15.820115', '2019-03-26 19:08:06.600155'];
  params:
  - - 2019-03-23 00:32:15.820115
    - 2019-03-26 19:08:06.600155
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'SOUSAKI'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'PIRAEUS'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - SOUSAKI
  - PIRAEUS
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'ALIMOS' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-06-28 16:28:55.725239', '2019-07-05 19:13:57.775428'];
  params:
  - ALIMOS
  - - 2019-06-28 16:28:55.725239
    - 2019-07-05 19:13:57.775428
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Nisis Islet;MULTIPOLYGON(((23.3837032 37.8100009' GROUP BY i.name;
  params:
  - Nisis Islet;MULTIPOLYGON(((23.3837032 37.8100009
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'ASPROPYRGOS'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'LAVRIO'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - ASPROPYRGOS
  - LAVRIO
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-03-27 11:21:38.389685', '2019-04-11 10:39:47.783879'];
  params:
  - - 2019-03-27 11:21:38.389685
    - 2019-04-11 10:39:47.783879
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'AEGINA' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-04-19 09:48:59.091404', '2019-04-22 12:48:07.842682'];
  params:
  - AEGINA
  - - 2019-04-19 09:48:59.091404
    - 2019-04-22 12:48:07.842682
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-11-25 12:38:08.062653', '2019-12-07 00:47:53.773332'];
  params:
  - - 2019-11-25 12:38:08.062653
    - 2019-12-07 00:47:53.773332
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'ALIMOS'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'LAVRIO'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - ALIMOS
  - LAVRIO
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 7 AND DATE(st.start_ts) = DATE 30;
  params:
  - 30
  - 7
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-08-13 03:27:15.300790', '2019-08-24 17:04:44.356472'];
  params:
  - - 2019-08-13 03:27:15.300790
    - 2019-08-24 17:04:44.356472
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'AGIOI THEODORI' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-03-05 18:55:37.260337', '2019-03-18 01:26:55.823848'];
  params:
  - AGIOI THEODORI
  - - 2019-03-05 18:55:37.260337
    - 2019-03-18 01:26:55.823848
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'CORINTH' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-11-26 14:48:30.185008', '2019-12-08 23:00:45.035266'];
  params:
  - CORINTH
  - - 2019-11-26 14:48:30.185008
    - 2019-12-08 23:00:45.035266
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'ERMIONI'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'SIRI'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - ERMIONI
  - SIRI
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-01-27 11:20:34.202759', '2019-02-03 13:03:14.687396'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-01-27 11:20:34.202759
    - 2019-02-03 13:03:14.687396
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Kavouronisi;MULTIPOLYGON(((23.7531549 37.8136342' GROUP BY i.name;
  params:
  - Kavouronisi;MULTIPOLYGON(((23.7531549 37.8136342
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-06-12 22:02:05.858812', '2019-06-15 02:42:22.336843'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-06-12 22:02:05.858812
    - 2019-06-15 02:42:22.336843
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Makronisos;MULTIPOLYGON(((23.4103812 37.967855' GROUP BY i.name;
  params:
  - Makronisos;MULTIPOLYGON(((23.4103812 37.967855
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-11-21 21:45:29.870508', '2019-11-26 12:41:47.020289'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-11-21 21:45:29.870508
    - 2019-11-26 12:41:47.020289
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'AEGINA'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'FLISVOS'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - AEGINA
  - FLISVOS
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'ZEA'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'PIRAEUS'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - ZEA
  - PIRAEUS
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 10 AND DATE(st.start_ts) = DATE 21;
  params:
  - 21
  - 10
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-10-04 06:54:41.561025', '2019-10-08 01:14:46.712522'];
  params:
  - - 2019-10-04 06:54:41.561025
    - 2019-10-08 01:14:46.712522
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 4 AND DATE(st.start_ts) = DATE 27;
  params:
  - 27
  - 4
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'SOUSAKI'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'SOUSAKI'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - SOUSAKI
  - SOUSAKI
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'AEGINA' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-05-14 20:26:57.137548', '2019-05-23 03:21:57.665016'];
  params:
  - AEGINA
  - - 2019-05-14 20:26:57.137548
    - 2019-05-23 03:21:57.665016
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 6 AND DATE(st.start_ts) = DATE 8;
  params:
  - 8
  - 6
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 9 AND DATE(st.start_ts) = DATE 28;
  params:
  - 28
  - 9
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-02-10 04:34:20.566304', '2019-02-22 14:16:06.851136'];
  params:
  - - 2019-02-10 04:34:20.566304
    - 2019-02-22 14:16:06.851136
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-10-01 17:59:39.538764', '2019-10-13 11:05:40.984009'];
  params:
  - - 2019-10-01 17:59:39.538764
    - 2019-10-13 11:05:40.984009
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(DISTINCT crossing_id) FROM crossing_points c JOIN islands i ON ST_DWithin(c.geom, i.geom, 5000) WHERE i.name = 'Phleva Island;MULTIPOLYGON(((23.7659544 37.7674259' GROUP BY i.name;
  params:
  - Phleva Island;MULTIPOLYGON(((23.7659544 37.7674259
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-08-31 07:32:09.986491', '2019-09-11 11:05:03.493607'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-08-31 07:32:09.986491
    - 2019-09-11 11:05:03.493607
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT c.crossing_id) FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-12-13 08:38:16.741806', '2019-12-19 02:38:47.594202'];
  params:
  - - 2019-12-13 08:38:16.741806
    - 2019-12-19 02:38:47.594202
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-01-06 09:30:18.222351', '2019-01-20 12:01:34.259673'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-01-06 09:30:18.222351
    - 2019-01-20 12:01:34.259673
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'GLYFADA' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-08-31 08:41:22.697863', '2019-09-06 05:12:33.624466'];
  params:
  - GLYFADA
  - - 2019-08-31 08:41:22.697863
    - 2019-09-06 05:12:33.624466
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'FALIRO'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'CORINTH'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - FALIRO
  - CORINTH
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-01-22 13:41:50.552283', '2019-02-03 03:43:15.708951'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-01-22 13:41:50.552283
    - 2019-02-03 03:43:15.708951
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    WITH start_timestamps AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_ts FROM crossing_points c GROUP BY crossing_id ) SELECT DISTINCT c.crossing_id FROM crossing_points c JOIN start_timestamps st ON c.crossing_id = st.crossing_id WHERE EXTRACT(HOUR FROM st.start_ts) = 7 AND DATE(st.start_ts) = DATE 9;
  params:
  - 9
  - 7
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossing_data AS ( SELECT c.crossing_id, MIN(c.timestamp) AS start_time, MAX(c.timestamp) AS end_time FROM crossing_points c GROUP BY c.crossing_id ), start_points AS ( SELECT DISTINCT ON (c.crossing_id) crossing_id, geom AS start_geom FROM crossing_points c ORDER BY c.crossing_id, c.timestamp ) SELECT AVG(cd.end_time - cd.start_time) AS avg_duration FROM crossing_data cd JOIN start_points sp ON sp.crossing_id = cd.crossing_id JOIN harbours h ON ST_DWithin(sp.start_geom, h.geom::geography, 500) WHERE h.name = 'GLYFADA' AND (cd.start_time, cd.end_time) OVERLAPS ['2019-09-12 22:42:00.733934', '2019-09-16 02:53:08.813102'];
  params:
  - GLYFADA
  - - 2019-09-12 22:42:00.733934
    - 2019-09-16 02:53:08.813102
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    WITH crossings_in_period AS ( SELECT DISTINCT c.crossing_id FROM crossing_points c WHERE c.timestamp BETWEEN ['2019-08-09 23:04:06.741151', '2019-08-13 17:22:09.230409'] ), crossing_end_points AS ( SELECT DISTINCT ON (c.crossing_id) c.crossing_id, c.geom FROM crossing_points c JOIN crossings_in_period cp ON cp.crossing_id = c.crossing_id ORDER BY c.crossing_id, c.timestamp DESC ) SELECT h.name, COUNT(*) AS crossing_count FROM harbours h JOIN crossing_end_points cep ON ST_DWithin(cep.geom, h.geom, 500) GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - 2019-08-09 23:04:06.741151
    - 2019-08-13 17:22:09.230409
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    WITH ranked_points AS (
    SELECT
        crossing_id,
        geom,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp ASC)  AS rn_asc,
        ROW_NUMBER() OVER(PARTITION BY crossing_id ORDER BY timestamp DESC) AS rn_desc
    FROM crossing_points
    )
    SELECT DISTINCT rp_start.crossing_id
    FROM ranked_points rp_start
    JOIN ranked_points rp_end
      ON rp_start.crossing_id = rp_end.crossing_id
    JOIN harbours h_start
      ON h_start.name = 'RAFINA'
    AND ST_DWithin(rp_start.geom, h_start.geom, 1000)
    JOIN harbours h_end
      ON h_end.name = 'LAVRIO'
    AND ST_DWithin(rp_end.geom, h_end.geom, 1000)
    WHERE rp_start.rn_asc = 1
      AND rp_end.rn_desc = 1;
  params:
  - RAFINA
  - LAVRIO
