- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 2151) WHERE tstzspan '[2019-11-07 20:09:30, 2019-11-10 08:23:05]' @> startTimestamp(c.trip) AND h.name = 'RAFINA';
  params:
  - RAFINA
  - - '2019-11-07 20:09:30'
    - '2019-11-10 08:23:05'
  - 2151
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-11-04 08:57:42, 2019-11-11 22:05:31]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-11-04 08:57:42, 2019-11-11 22:05:31]';
  params:
  - - '2019-11-04 08:57:42'
    - '2019-11-11 22:05:31'
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-09-18 23:34:15, 2019-09-30 08:28:38]' AND edwithin(attime(c.trip,tstzspan '[2019-09-18 23:34:15, 2019-09-30 08:28:38]'), h.geom, 2110) WHERE h.name = 'PERAMA' GROUP BY h.name;
  params:
  - - '2019-09-18 23:34:15'
    - '2019-09-30 08:28:38'
  - 2110
  - PERAMA
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-08-25 02:49:31, 2019-09-04 06:02:06]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-08-25 02:49:31, 2019-09-04 06:02:06]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 3 and tstzspan '[2019-08-25 02:49:31, 2019-09-04 06:02:06]' @> ts;
  params:
  - 3
  - - '2019-08-25 02:49:31'
    - '2019-09-04 06:02:06'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-11-12 17:02:06, 2019-11-19 14:51:57]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-11-12 17:02:06, 2019-11-19 14:51:57]';
  params:
  - - '2019-11-12 17:02:06'
    - '2019-11-19 14:51:57'
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-11-24 17:26:10, 2019-12-01 20:57:11]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-11-24 17:26:10, 2019-12-01 20:57:11]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 9 and tstzspan '[2019-11-24 17:26:10, 2019-12-01 20:57:11]' @> ts;
  params:
  - 9
  - - '2019-11-24 17:26:10'
    - '2019-12-01 20:57:11'
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 4069) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 4069) WHERE h_start.name = 'FANEROMENI' AND h_end.name = 'FALIRO';
  params:
  - FANEROMENI
  - FALIRO
  - 4069
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 3788) WHERE tstzspan '[2019-09-23 18:05:51, 2019-10-02 01:37:53]' @> startTimestamp(c.trip) AND h.name = 'CORINTH CANAL';
  params:
  - CORINTH CANAL
  - - '2019-09-23 18:05:51'
    - '2019-10-02 01:37:53'
  - 3788
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-05-05 00:41:17, 2019-05-07 19:40:54]' AND edwithin(attime(c.trip,tstzspan '[2019-05-05 00:41:17, 2019-05-07 19:40:54]'), h.geom, 1347) WHERE h.name = 'SOUSAKI' GROUP BY h.name;
  params:
  - - '2019-05-05 00:41:17'
    - '2019-05-07 19:40:54'
  - 1347
  - SOUSAKI
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 4964) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 4964) WHERE h_start.name = 'FLISVOS' AND h_end.name = 'FLISVOS';
  params:
  - FLISVOS
  - FLISVOS
  - 4964
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 2362) WHERE tstzspan '[2019-08-31 10:07:07, 2019-09-13 08:29:05]' @> startTimestamp(c.trip) AND h.name = 'AEGINA';
  params:
  - AEGINA
  - - '2019-08-31 10:07:07'
    - '2019-09-13 08:29:05'
  - 2362
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-09-07 02:34:30, 2019-09-13 19:04:00]' AND edwithin(attime(c.trip,tstzspan '[2019-09-07 02:34:30, 2019-09-13 19:04:00]'), h.geom, 2415) WHERE h.name = 'AGIOI THEODORI' GROUP BY h.name;
  params:
  - - '2019-09-07 02:34:30'
    - '2019-09-13 19:04:00'
  - 2415
  - AGIOI THEODORI
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 1377) WHERE i.name = 'Vrachonisis Moladi';
  params:
  - Vrachonisis Moladi
  - 1377
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-01-10 16:27:16, 2019-01-25 14:37:00]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-01-10 16:27:16, 2019-01-25 14:37:00]';
  params:
  - - '2019-01-10 16:27:16'
    - '2019-01-25 14:37:00'
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2018-12-31 23:00:01, 2019-01-02 07:22:15]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2018-12-31 23:00:01, 2019-01-02 07:22:15]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 23 and tstzspan '[2018-12-31 23:00:01, 2019-01-02 07:22:15]' @> ts;
  params:
  - 23
  - - '2018-12-31 23:00:01'
    - '2019-01-02 07:22:15'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 3679) WHERE i.name = 'Kasidis';
  params:
  - Kasidis
  - 3679
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 3384) WHERE i.name = 'Revithousa';
  params:
  - Revithousa
  - 3384
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-06-10 16:49:34, 2019-06-16 20:23:54]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-06-10 16:49:34, 2019-06-16 20:23:54]';
  params:
  - - '2019-06-10 16:49:34'
    - '2019-06-16 20:23:54'
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-03-02 17:06:05, 2019-03-05 22:05:16]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-03-02 17:06:05, 2019-03-05 22:05:16]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 23 and tstzspan '[2019-03-02 17:06:05, 2019-03-05 22:05:16]' @> ts;
  params:
  - 23
  - - '2019-03-02 17:06:05'
    - '2019-03-05 22:05:16'
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-05-07 09:36:58, 2019-05-15 04:19:03]' AND edwithin(attime(c.trip,tstzspan '[2019-05-07 09:36:58, 2019-05-15 04:19:03]'), h.geom, 2696) WHERE h.name = 'CORINTH CANAL' GROUP BY h.name;
  params:
  - - '2019-05-07 09:36:58'
    - '2019-05-15 04:19:03'
  - 2696
  - CORINTH CANAL
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-03-05 11:53:43, 2019-03-09 18:05:11]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-03-05 11:53:43, 2019-03-09 18:05:11]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 4 and tstzspan '[2019-03-05 11:53:43, 2019-03-09 18:05:11]' @> ts;
  params:
  - 4
  - - '2019-03-05 11:53:43'
    - '2019-03-09 18:05:11'
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 4850) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 4850) WHERE h_start.name = 'RAFINA' AND h_end.name = 'FANEROMENI';
  params:
  - RAFINA
  - FANEROMENI
  - 4850
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-07-23 10:42:47, 2019-07-27 19:13:55]' AND edwithin(attime(c.trip,tstzspan '[2019-07-23 10:42:47, 2019-07-27 19:13:55]'), h.geom, 4321) WHERE h.name = 'AGIOS KOSMAS' GROUP BY h.name;
  params:
  - - '2019-07-23 10:42:47'
    - '2019-07-27 19:13:55'
  - 4321
  - AGIOS KOSMAS
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 3393) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 3393) WHERE h_start.name = 'FANEROMENI' AND h_end.name = 'ALIMOS';
  params:
  - FANEROMENI
  - ALIMOS
  - 3393
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-07-06 05:02:58, 2019-07-14 08:54:29]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-07-06 05:02:58, 2019-07-14 08:54:29]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 20 and tstzspan '[2019-07-06 05:02:58, 2019-07-14 08:54:29]' @> ts;
  params:
  - 20
  - - '2019-07-06 05:02:58'
    - '2019-07-14 08:54:29'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 4196) WHERE tstzspan '[2019-09-07 14:18:07, 2019-09-12 03:12:15]' @> startTimestamp(c.trip) AND h.name = 'RAFINA';
  params:
  - RAFINA
  - - '2019-09-07 14:18:07'
    - '2019-09-12 03:12:15'
  - 4196
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 4642) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 4642) WHERE h_start.name = 'FALIRO' AND h_end.name = 'GLYFADA';
  params:
  - FALIRO
  - GLYFADA
  - 4642
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 1663) WHERE i.name = 'Nisis Metopi';
  params:
  - Nisis Metopi
  - 1663
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-11-21 13:04:34, 2019-11-25 10:37:17]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-11-21 13:04:34, 2019-11-25 10:37:17]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 14 and tstzspan '[2019-11-21 13:04:34, 2019-11-25 10:37:17]' @> ts;
  params:
  - 14
  - - '2019-11-21 13:04:34'
    - '2019-11-25 10:37:17'
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-07-28 18:51:48, 2019-08-03 13:24:29]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-07-28 18:51:48, 2019-08-03 13:24:29]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 20 and tstzspan '[2019-07-28 18:51:48, 2019-08-03 13:24:29]' @> ts;
  params:
  - 20
  - - '2019-07-28 18:51:48'
    - '2019-08-03 13:24:29'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 3899) WHERE i.name = 'Trakhyli';
  params:
  - Trakhyli
  - 3899
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 1304) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 1304) WHERE h_start.name = 'FALIRO' AND h_end.name = 'PIRAEUS';
  params:
  - FALIRO
  - PIRAEUS
  - 1304
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 1212) WHERE tstzspan '[2019-10-27 02:07:39, 2019-10-30 18:04:01]' @> startTimestamp(c.trip) AND h.name = 'AGIOS KOSMAS';
  params:
  - AGIOS KOSMAS
  - - '2019-10-27 02:07:39'
    - '2019-10-30 18:04:01'
  - 1212
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 1024) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 1024) WHERE h_start.name = 'LAVRIO' AND h_end.name = 'AEGINA';
  params:
  - LAVRIO
  - AEGINA
  - 1024
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 2749) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 2749) WHERE h_start.name = 'AGIOI THEODORI' AND h_end.name = 'AEGINA';
  params:
  - AGIOI THEODORI
  - AEGINA
  - 2749
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 4140) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 4140) WHERE h_start.name = 'ALIMOS' AND h_end.name = 'FANEROMENI';
  params:
  - ALIMOS
  - FANEROMENI
  - 4140
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 3158) WHERE i.name = 'Anagnostis';
  params:
  - Anagnostis
  - 3158
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-03-27 03:39:09, 2019-04-09 13:31:56]' AND edwithin(attime(c.trip,tstzspan '[2019-03-27 03:39:09, 2019-04-09 13:31:56]'), h.geom, 2525) WHERE h.name = 'AEGINA' GROUP BY h.name;
  params:
  - - '2019-03-27 03:39:09'
    - '2019-04-09 13:31:56'
  - 2525
  - AEGINA
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 4955) WHERE i.name = 'Nisis Pachaki';
  params:
  - Nisis Pachaki
  - 4955
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-06-07 23:48:03, 2019-06-22 05:04:48]' AND edwithin(attime(c.trip,tstzspan '[2019-06-07 23:48:03, 2019-06-22 05:04:48]'), h.geom, 3369) WHERE h.name = 'FLISVOS' GROUP BY h.name;
  params:
  - - '2019-06-07 23:48:03'
    - '2019-06-22 05:04:48'
  - 3369
  - FLISVOS
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 3500) WHERE i.name = 'Patroklos';
  params:
  - Patroklos
  - 3500
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-11-10 07:45:37, 2019-11-17 21:40:39]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-11-10 07:45:37, 2019-11-17 21:40:39]';
  params:
  - - '2019-11-10 07:45:37'
    - '2019-11-17 21:40:39'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 2512) WHERE i.name = 'Agios Ioannis';
  params:
  - Agios Ioannis
  - 2512
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 4176) WHERE i.name = 'Agistri';
  params:
  - Agistri
  - 4176
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-04-20 01:52:10, 2019-04-23 20:17:48]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-04-20 01:52:10, 2019-04-23 20:17:48]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 2 and tstzspan '[2019-04-20 01:52:10, 2019-04-23 20:17:48]' @> ts;
  params:
  - 2
  - - '2019-04-20 01:52:10'
    - '2019-04-23 20:17:48'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 3732) WHERE tstzspan '[2019-11-23 02:56:39, 2019-12-05 15:30:51]' @> startTimestamp(c.trip) AND h.name = 'FANEROMENI';
  params:
  - FANEROMENI
  - - '2019-11-23 02:56:39'
    - '2019-12-05 15:30:51'
  - 3732
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 4402) WHERE i.name = 'Salamina';
  params:
  - Salamina
  - 4402
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 1365) WHERE tstzspan '[2019-09-20 00:16:10, 2019-10-01 11:22:58]' @> startTimestamp(c.trip) AND h.name = 'ELEFSIS';
  params:
  - ELEFSIS
  - - '2019-09-20 00:16:10'
    - '2019-10-01 11:22:58'
  - 1365
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 2183) WHERE i.name = 'Thorussa';
  params:
  - Thorussa
  - 2183
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 3829) WHERE i.name = 'Plateia';
  params:
  - Plateia
  - 3829
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 4564) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 4564) WHERE h_start.name = 'FANEROMENI' AND h_end.name = 'FLISVOS';
  params:
  - FANEROMENI
  - FLISVOS
  - 4564
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-08-08 04:00:02, 2019-08-22 23:41:34]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-08-08 04:00:02, 2019-08-22 23:41:34]';
  params:
  - - '2019-08-08 04:00:02'
    - '2019-08-22 23:41:34'
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 4936) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 4936) WHERE h_start.name = 'GLYFADA' AND h_end.name = 'CORINTH';
  params:
  - GLYFADA
  - CORINTH
  - 4936
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-05-23 16:23:29, 2019-05-28 10:41:50]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-05-23 16:23:29, 2019-05-28 10:41:50]';
  params:
  - - '2019-05-23 16:23:29'
    - '2019-05-28 10:41:50'
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 3590) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 3590) WHERE h_start.name = 'ERMIONI' AND h_end.name = 'AGIOI THEODORI';
  params:
  - ERMIONI
  - AGIOI THEODORI
  - 3590
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-06-19 12:12:18, 2019-06-30 05:28:47]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-06-19 12:12:18, 2019-06-30 05:28:47]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 19 and tstzspan '[2019-06-19 12:12:18, 2019-06-30 05:28:47]' @> ts;
  params:
  - 19
  - - '2019-06-19 12:12:18'
    - '2019-06-30 05:28:47'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 3276) WHERE tstzspan '[2019-04-01 14:29:59, 2019-04-10 05:40:21]' @> startTimestamp(c.trip) AND h.name = 'ZEA';
  params:
  - ZEA
  - - '2019-04-01 14:29:59'
    - '2019-04-10 05:40:21'
  - 3276
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 4381) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 4381) WHERE h_start.name = 'RAFINA' AND h_end.name = 'GLYFADA';
  params:
  - RAFINA
  - GLYFADA
  - 4381
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-07-02 15:39:13, 2019-07-06 17:20:21]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-07-02 15:39:13, 2019-07-06 17:20:21]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 7 and tstzspan '[2019-07-02 15:39:13, 2019-07-06 17:20:21]' @> ts;
  params:
  - 7
  - - '2019-07-02 15:39:13'
    - '2019-07-06 17:20:21'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 1335) WHERE i.name = 'Makronisos';
  params:
  - Makronisos
  - 1335
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 1442) WHERE tstzspan '[2019-11-23 08:48:57, 2019-12-06 21:11:41]' @> startTimestamp(c.trip) AND h.name = 'PERAMA';
  params:
  - PERAMA
  - - '2019-11-23 08:48:57'
    - '2019-12-06 21:11:41'
  - 1442
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-06-22 01:23:41, 2019-06-30 07:18:52]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-06-22 01:23:41, 2019-06-30 07:18:52]';
  params:
  - - '2019-06-22 01:23:41'
    - '2019-06-30 07:18:52'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 4998) WHERE i.name = 'Nisida Kyra';
  params:
  - Nisida Kyra
  - 4998
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-01-12 11:12:25, 2019-01-22 07:13:41]' AND edwithin(attime(c.trip,tstzspan '[2019-01-12 11:12:25, 2019-01-22 07:13:41]'), h.geom, 2184) WHERE h.name = 'AGISTRI' GROUP BY h.name;
  params:
  - - '2019-01-12 11:12:25'
    - '2019-01-22 07:13:41'
  - 2184
  - AGISTRI
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-02-10 04:21:48, 2019-02-22 14:03:34]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-02-10 04:21:48, 2019-02-22 14:03:34]';
  params:
  - - '2019-02-10 04:21:48'
    - '2019-02-22 14:03:34'
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-04-14 21:34:49, 2019-04-17 16:21:19]' AND edwithin(attime(c.trip,tstzspan '[2019-04-14 21:34:49, 2019-04-17 16:21:19]'), h.geom, 3081) WHERE h.name = 'AGIOI THEODORI' GROUP BY h.name;
  params:
  - - '2019-04-14 21:34:49'
    - '2019-04-17 16:21:19'
  - 3081
  - AGIOI THEODORI
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 1360) WHERE i.name = 'Nisis Metopi';
  params:
  - Nisis Metopi
  - 1360
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-05-16 10:22:50, 2019-05-26 02:30:29]' AND edwithin(attime(c.trip,tstzspan '[2019-05-16 10:22:50, 2019-05-26 02:30:29]'), h.geom, 1339) WHERE h.name = 'CORINTH' GROUP BY h.name;
  params:
  - - '2019-05-16 10:22:50'
    - '2019-05-26 02:30:29'
  - 1339
  - CORINTH
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 2713) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 2713) WHERE h_start.name = 'FALIRO' AND h_end.name = 'AEGINA';
  params:
  - FALIRO
  - AEGINA
  - 2713
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 2805) WHERE tstzspan '[2019-05-30 15:28:22, 2019-06-12 19:31:00]' @> startTimestamp(c.trip) AND h.name = 'PERAMA';
  params:
  - PERAMA
  - - '2019-05-30 15:28:22'
    - '2019-06-12 19:31:00'
  - 2805
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-11-21 15:39:39, 2019-11-24 12:14:06]' AND edwithin(attime(c.trip,tstzspan '[2019-11-21 15:39:39, 2019-11-24 12:14:06]'), h.geom, 1244) WHERE h.name = 'PERAMA' GROUP BY h.name;
  params:
  - - '2019-11-21 15:39:39'
    - '2019-11-24 12:14:06'
  - 1244
  - PERAMA
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 4990) WHERE tstzspan '[2019-02-13 04:06:51, 2019-02-23 14:27:28]' @> startTimestamp(c.trip) AND h.name = 'AGIOI THEODORI';
  params:
  - AGIOI THEODORI
  - - '2019-02-13 04:06:51'
    - '2019-02-23 14:27:28'
  - 4990
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 3211) WHERE tstzspan '[2019-11-03 03:04:53, 2019-11-07 12:47:40]' @> startTimestamp(c.trip) AND h.name = 'FLISVOS';
  params:
  - FLISVOS
  - - '2019-11-03 03:04:53'
    - '2019-11-07 12:47:40'
  - 3211
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-01-06 02:02:58, 2019-01-15 11:10:55]' AND edwithin(attime(c.trip,tstzspan '[2019-01-06 02:02:58, 2019-01-15 11:10:55]'), h.geom, 2340) WHERE h.name = 'PERAMA' GROUP BY h.name;
  params:
  - - '2019-01-06 02:02:58'
    - '2019-01-15 11:10:55'
  - 2340
  - PERAMA
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-11-25 12:38:50, 2019-12-07 00:48:36]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-11-25 12:38:50, 2019-12-07 00:48:36]';
  params:
  - - '2019-11-25 12:38:50'
    - '2019-12-07 00:48:36'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-11-24 09:16:01, 2019-12-06 05:29:18]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-11-24 09:16:01, 2019-12-06 05:29:18]';
  params:
  - - '2019-11-24 09:16:01'
    - '2019-12-06 05:29:18'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-08-18 15:49:33, 2019-08-31 11:55:57]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-08-18 15:49:33, 2019-08-31 11:55:57]';
  params:
  - - '2019-08-18 15:49:33'
    - '2019-08-31 11:55:57'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-08-02 02:21:51, 2019-08-09 01:43:32]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-08-02 02:21:51, 2019-08-09 01:43:32]';
  params:
  - - '2019-08-02 02:21:51'
    - '2019-08-09 01:43:32'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-10-05 15:40:42, 2019-10-19 18:42:24]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-10-05 15:40:42, 2019-10-19 18:42:24]';
  params:
  - - '2019-10-05 15:40:42'
    - '2019-10-19 18:42:24'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 3559) WHERE tstzspan '[2019-12-17 04:59:09, 2019-12-26 21:04:02]' @> startTimestamp(c.trip) AND h.name = 'SIRI';
  params:
  - SIRI
  - - '2019-12-17 04:59:09'
    - '2019-12-26 21:04:02'
  - 3559
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-03-21 05:22:51, 2019-03-29 21:02:38]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-03-21 05:22:51, 2019-03-29 21:02:38]';
  params:
  - - '2019-03-21 05:22:51'
    - '2019-03-29 21:02:38'
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-01-13 16:22:56, 2019-01-23 09:27:35]' AND edwithin(attime(c.trip,tstzspan '[2019-01-13 16:22:56, 2019-01-23 09:27:35]'), h.geom, 2873) WHERE h.name = 'ALIMOS' GROUP BY h.name;
  params:
  - - '2019-01-13 16:22:56'
    - '2019-01-23 09:27:35'
  - 2873
  - ALIMOS
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-06-23 23:53:57, 2019-07-03 16:32:36]' AND edwithin(attime(c.trip,tstzspan '[2019-06-23 23:53:57, 2019-07-03 16:32:36]'), h.geom, 3561) WHERE h.name = 'FLISVOS' GROUP BY h.name;
  params:
  - - '2019-06-23 23:53:57'
    - '2019-07-03 16:32:36'
  - 3561
  - FLISVOS
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 3557) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 3557) WHERE h_start.name = 'AGIOS KOSMAS' AND h_end.name = 'ASPROPYRGOS';
  params:
  - AGIOS KOSMAS
  - ASPROPYRGOS
  - 3557
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 4512) WHERE tstzspan '[2019-09-07 16:46:28, 2019-09-12 10:04:51]' @> startTimestamp(c.trip) AND h.name = 'PERAMA';
  params:
  - PERAMA
  - - '2019-09-07 16:46:28'
    - '2019-09-12 10:04:51'
  - 4512
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 3947) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 3947) WHERE h_start.name = 'AEGINA' AND h_end.name = 'ERMIONI';
  params:
  - AEGINA
  - ERMIONI
  - 3947
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-02-11 01:04:30, 2019-02-23 02:57:47]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-02-11 01:04:30, 2019-02-23 02:57:47]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 7 and tstzspan '[2019-02-11 01:04:30, 2019-02-23 02:57:47]' @> ts;
  params:
  - 7
  - - '2019-02-11 01:04:30'
    - '2019-02-23 02:57:47'
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-04-09 13:49:30, 2019-04-24 00:01:19]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-04-09 13:49:30, 2019-04-24 00:01:19]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 6 and tstzspan '[2019-04-09 13:49:30, 2019-04-24 00:01:19]' @> ts;
  params:
  - 6
  - - '2019-04-09 13:49:30'
    - '2019-04-24 00:01:19'
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-04-05 08:44:16, 2019-04-16 08:48:32]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-04-05 08:44:16, 2019-04-16 08:48:32]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 21 and tstzspan '[2019-04-05 08:44:16, 2019-04-16 08:48:32]' @> ts;
  params:
  - 21
  - - '2019-04-05 08:44:16'
    - '2019-04-16 08:48:32'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 2271) WHERE tstzspan '[2019-07-01 05:30:14, 2019-07-05 06:42:44]' @> startTimestamp(c.trip) AND h.name = 'LAVRIO';
  params:
  - LAVRIO
  - - '2019-07-01 05:30:14'
    - '2019-07-05 06:42:44'
  - 2271
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-01-09 21:07:29, 2019-01-15 14:38:07]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-01-09 21:07:29, 2019-01-15 14:38:07]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 9 and tstzspan '[2019-01-09 21:07:29, 2019-01-15 14:38:07]' @> ts;
  params:
  - 9
  - - '2019-01-09 21:07:29'
    - '2019-01-15 14:38:07'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 1212) WHERE tstzspan '[2019-11-19 23:42:32, 2019-12-02 18:17:33]' @> startTimestamp(c.trip) AND h.name = 'PIRAEUS';
  params:
  - PIRAEUS
  - - '2019-11-19 23:42:32'
    - '2019-12-02 18:17:33'
  - 1212
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-12-24 11:09:18, 2019-12-26 19:20:09]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-12-24 11:09:18, 2019-12-26 19:20:09]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 14 and tstzspan '[2019-12-24 11:09:18, 2019-12-26 19:20:09]' @> ts;
  params:
  - 14
  - - '2019-12-24 11:09:18'
    - '2019-12-26 19:20:09'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-03-21 22:20:14, 2019-04-02 12:00:36]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-03-21 22:20:14, 2019-04-02 12:00:36]';
  params:
  - - '2019-03-21 22:20:14'
    - '2019-04-02 12:00:36'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 2398) WHERE i.name = 'Kourmouloudes';
  params:
  - Kourmouloudes
  - 2398
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-02-13 02:03:00, 2019-02-24 15:58:15]' AND edwithin(attime(c.trip,tstzspan '[2019-02-13 02:03:00, 2019-02-24 15:58:15]'), h.geom, 4113) WHERE h.name = 'AGIOI THEODORI' GROUP BY h.name;
  params:
  - - '2019-02-13 02:03:00'
    - '2019-02-24 15:58:15'
  - 4113
  - AGIOI THEODORI
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 3621) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 3621) WHERE h_start.name = 'PIRAEUS' AND h_end.name = 'CORINTH';
  params:
  - PIRAEUS
  - CORINTH
  - 3621
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-05-30 11:41:17, 2019-06-05 16:58:30]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-05-30 11:41:17, 2019-06-05 16:58:30]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 0 and tstzspan '[2019-05-30 11:41:17, 2019-06-05 16:58:30]' @> ts;
  params:
  - 0
  - - '2019-05-30 11:41:17'
    - '2019-06-05 16:58:30'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 3101) WHERE tstzspan '[2019-02-05 04:27:34, 2019-02-15 10:02:37]' @> startTimestamp(c.trip) AND h.name = 'SOUSAKI';
  params:
  - SOUSAKI
  - - '2019-02-05 04:27:34'
    - '2019-02-15 10:02:37'
  - 3101
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-10-18 11:55:43, 2019-10-29 08:31:04]' AND edwithin(attime(c.trip,tstzspan '[2019-10-18 11:55:43, 2019-10-29 08:31:04]'), h.geom, 3898) WHERE h.name = 'PIRAEUS' GROUP BY h.name;
  params:
  - - '2019-10-18 11:55:43'
    - '2019-10-29 08:31:04'
  - 3898
  - PIRAEUS
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-09-19 03:27:35, 2019-09-22 13:45:15]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-09-19 03:27:35, 2019-09-22 13:45:15]';
  params:
  - - '2019-09-19 03:27:35'
    - '2019-09-22 13:45:15'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 3621) WHERE i.name = 'Trakhyli';
  params:
  - Trakhyli
  - 3621
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 4631) WHERE tstzspan '[2019-02-11 17:08:21, 2019-02-20 10:14:08]' @> startTimestamp(c.trip) AND h.name = 'ELEFSIS';
  params:
  - ELEFSIS
  - - '2019-02-11 17:08:21'
    - '2019-02-20 10:14:08'
  - 4631
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-09-02 22:52:09, 2019-09-15 14:22:34]' AND edwithin(attime(c.trip,tstzspan '[2019-09-02 22:52:09, 2019-09-15 14:22:34]'), h.geom, 3491) WHERE h.name = 'ELEFSIS' GROUP BY h.name;
  params:
  - - '2019-09-02 22:52:09'
    - '2019-09-15 14:22:34'
  - 3491
  - ELEFSIS
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-12-20 00:57:58, 2019-12-24 12:43:59]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-12-20 00:57:58, 2019-12-24 12:43:59]';
  params:
  - - '2019-12-20 00:57:58'
    - '2019-12-24 12:43:59'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 3117) WHERE i.name = 'Ovrios';
  params:
  - Ovrios
  - 3117
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-05-30 19:19:21, 2019-06-05 20:36:55]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-05-30 19:19:21, 2019-06-05 20:36:55]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 16 and tstzspan '[2019-05-30 19:19:21, 2019-06-05 20:36:55]' @> ts;
  params:
  - 16
  - - '2019-05-30 19:19:21'
    - '2019-06-05 20:36:55'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 3426) WHERE tstzspan '[2019-09-16 19:30:29, 2019-09-30 15:14:45]' @> startTimestamp(c.trip) AND h.name = 'FALIRO';
  params:
  - FALIRO
  - - '2019-09-16 19:30:29'
    - '2019-09-30 15:14:45'
  - 3426
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 3664) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 3664) WHERE h_start.name = 'CORINTH CANAL' AND h_end.name = 'LAVRIO';
  params:
  - CORINTH CANAL
  - LAVRIO
  - 3664
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-07-01 22:57:07, 2019-07-11 20:53:45]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-07-01 22:57:07, 2019-07-11 20:53:45]';
  params:
  - - '2019-07-01 22:57:07'
    - '2019-07-11 20:53:45'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-09-03 05:41:17, 2019-09-10 12:43:11]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-09-03 05:41:17, 2019-09-10 12:43:11]';
  params:
  - - '2019-09-03 05:41:17'
    - '2019-09-10 12:43:11'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 2075) WHERE tstzspan '[2019-03-16 14:54:51, 2019-03-23 23:27:51]' @> startTimestamp(c.trip) AND h.name = 'GLYFADA';
  params:
  - GLYFADA
  - - '2019-03-16 14:54:51'
    - '2019-03-23 23:27:51'
  - 2075
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-12-20 23:13:21, 2019-12-26 14:24:20]' AND edwithin(attime(c.trip,tstzspan '[2019-12-20 23:13:21, 2019-12-26 14:24:20]'), h.geom, 4592) WHERE h.name = 'AEGINA' GROUP BY h.name;
  params:
  - - '2019-12-20 23:13:21'
    - '2019-12-26 14:24:20'
  - 4592
  - AEGINA
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-03-14 22:29:18, 2019-03-27 19:52:26]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-03-14 22:29:18, 2019-03-27 19:52:26]';
  params:
  - - '2019-03-14 22:29:18'
    - '2019-03-27 19:52:26'
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-07-06 08:54:35, 2019-07-20 23:49:44]' AND edwithin(attime(c.trip,tstzspan '[2019-07-06 08:54:35, 2019-07-20 23:49:44]'), h.geom, 2415) WHERE h.name = 'GLYFADA' GROUP BY h.name;
  params:
  - - '2019-07-06 08:54:35'
    - '2019-07-20 23:49:44'
  - 2415
  - GLYFADA
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-09-18 18:07:46, 2019-09-30 22:44:47]' AND edwithin(attime(c.trip,tstzspan '[2019-09-18 18:07:46, 2019-09-30 22:44:47]'), h.geom, 4379) WHERE h.name = 'ELEFSIS' GROUP BY h.name;
  params:
  - - '2019-09-18 18:07:46'
    - '2019-09-30 22:44:47'
  - 4379
  - ELEFSIS
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-06-09 11:41:16, 2019-06-15 14:56:17]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-06-09 11:41:16, 2019-06-15 14:56:17]';
  params:
  - - '2019-06-09 11:41:16'
    - '2019-06-15 14:56:17'
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-06-03 13:51:39, 2019-06-06 00:14:26]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-06-03 13:51:39, 2019-06-06 00:14:26]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 13 and tstzspan '[2019-06-03 13:51:39, 2019-06-06 00:14:26]' @> ts;
  params:
  - 13
  - - '2019-06-03 13:51:39'
    - '2019-06-06 00:14:26'
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-06-01 23:54:06, 2019-06-12 23:16:59]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-06-01 23:54:06, 2019-06-12 23:16:59]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 7 and tstzspan '[2019-06-01 23:54:06, 2019-06-12 23:16:59]' @> ts;
  params:
  - 7
  - - '2019-06-01 23:54:06'
    - '2019-06-12 23:16:59'
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 3822) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 3822) WHERE h_start.name = 'ASPROPYRGOS' AND h_end.name = 'AGIOI THEODORI';
  params:
  - ASPROPYRGOS
  - AGIOI THEODORI
  - 3822
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 4712) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 4712) WHERE h_start.name = 'AGIOI THEODORI' AND h_end.name = 'CORINTH';
  params:
  - AGIOI THEODORI
  - CORINTH
  - 4712
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-07-13 11:13:29, 2019-07-22 04:31:32]' AND edwithin(attime(c.trip,tstzspan '[2019-07-13 11:13:29, 2019-07-22 04:31:32]'), h.geom, 3946) WHERE h.name = 'LAVRIO' GROUP BY h.name;
  params:
  - - '2019-07-13 11:13:29'
    - '2019-07-22 04:31:32'
  - 3946
  - LAVRIO
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 1780) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 1780) WHERE h_start.name = 'ERMIONI' AND h_end.name = 'ELEFSIS';
  params:
  - ERMIONI
  - ELEFSIS
  - 1780
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 4230) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 4230) WHERE h_start.name = 'ERMIONI' AND h_end.name = 'SOUSAKI';
  params:
  - ERMIONI
  - SOUSAKI
  - 4230
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-08-07 06:45:41, 2019-08-17 13:26:39]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-08-07 06:45:41, 2019-08-17 13:26:39]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 12 and tstzspan '[2019-08-07 06:45:41, 2019-08-17 13:26:39]' @> ts;
  params:
  - 12
  - - '2019-08-07 06:45:41'
    - '2019-08-17 13:26:39'
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-04-12 14:00:05, 2019-04-22 12:35:49]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-04-12 14:00:05, 2019-04-22 12:35:49]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 14 and tstzspan '[2019-04-12 14:00:05, 2019-04-22 12:35:49]' @> ts;
  params:
  - 14
  - - '2019-04-12 14:00:05'
    - '2019-04-22 12:35:49'
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-04-16 22:49:55, 2019-04-30 06:45:50]' AND edwithin(attime(c.trip,tstzspan '[2019-04-16 22:49:55, 2019-04-30 06:45:50]'), h.geom, 1012) WHERE h.name = 'FLISVOS' GROUP BY h.name;
  params:
  - - '2019-04-16 22:49:55'
    - '2019-04-30 06:45:50'
  - 1012
  - FLISVOS
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 2993) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 2993) WHERE h_start.name = 'FANEROMENI' AND h_end.name = 'PERAMA';
  params:
  - FANEROMENI
  - PERAMA
  - 2993
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-10-02 19:56:16, 2019-10-16 08:30:38]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-10-02 19:56:16, 2019-10-16 08:30:38]';
  params:
  - - '2019-10-02 19:56:16'
    - '2019-10-16 08:30:38'
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-12-02 09:43:43, 2019-12-04 23:04:08]' AND edwithin(attime(c.trip,tstzspan '[2019-12-02 09:43:43, 2019-12-04 23:04:08]'), h.geom, 1133) WHERE h.name = 'FALIRO' GROUP BY h.name;
  params:
  - - '2019-12-02 09:43:43'
    - '2019-12-04 23:04:08'
  - 1133
  - FALIRO
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-06-02 15:44:56, 2019-06-07 09:38:05]' AND edwithin(attime(c.trip,tstzspan '[2019-06-02 15:44:56, 2019-06-07 09:38:05]'), h.geom, 1389) WHERE h.name = 'RAFINA' GROUP BY h.name;
  params:
  - - '2019-06-02 15:44:56'
    - '2019-06-07 09:38:05'
  - 1389
  - RAFINA
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 4465) WHERE i.name = 'Nisis Islet';
  params:
  - Nisis Islet
  - 4465
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-08-17 00:52:51, 2019-08-19 22:50:18]' AND edwithin(attime(c.trip,tstzspan '[2019-08-17 00:52:51, 2019-08-19 22:50:18]'), h.geom, 3196) WHERE h.name = 'RAFINA' GROUP BY h.name;
  params:
  - - '2019-08-17 00:52:51'
    - '2019-08-19 22:50:18'
  - 3196
  - RAFINA
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-07-20 08:26:59, 2019-07-26 23:49:46]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-07-20 08:26:59, 2019-07-26 23:49:46]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 11 and tstzspan '[2019-07-20 08:26:59, 2019-07-26 23:49:46]' @> ts;
  params:
  - 11
  - - '2019-07-20 08:26:59'
    - '2019-07-26 23:49:46'
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-01-16 15:09:42, 2019-01-24 18:29:29]' AND edwithin(attime(c.trip,tstzspan '[2019-01-16 15:09:42, 2019-01-24 18:29:29]'), h.geom, 4943) WHERE h.name = 'LAVRIO' GROUP BY h.name;
  params:
  - - '2019-01-16 15:09:42'
    - '2019-01-24 18:29:29'
  - 4943
  - LAVRIO
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-08-05 12:24:59, 2019-08-07 22:26:15]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-08-05 12:24:59, 2019-08-07 22:26:15]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 14 and tstzspan '[2019-08-05 12:24:59, 2019-08-07 22:26:15]' @> ts;
  params:
  - 14
  - - '2019-08-05 12:24:59'
    - '2019-08-07 22:26:15'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-03-02 09:24:42, 2019-03-16 16:42:23]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-03-02 09:24:42, 2019-03-16 16:42:23]';
  params:
  - - '2019-03-02 09:24:42'
    - '2019-03-16 16:42:23'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 1052) WHERE tstzspan '[2019-01-05 04:53:24, 2019-01-14 14:54:15]' @> startTimestamp(c.trip) AND h.name = 'ERMIONI';
  params:
  - ERMIONI
  - - '2019-01-05 04:53:24'
    - '2019-01-14 14:54:15'
  - 1052
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 1156) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 1156) WHERE h_start.name = 'RAFINA' AND h_end.name = 'PIRAEUS';
  params:
  - RAFINA
  - PIRAEUS
  - 1156
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 1059) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 1059) WHERE h_start.name = 'AGISTRI' AND h_end.name = 'LAVRIO';
  params:
  - AGISTRI
  - LAVRIO
  - 1059
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 3626) WHERE tstzspan '[2019-05-18 14:22:53, 2019-05-31 20:25:32]' @> startTimestamp(c.trip) AND h.name = 'GLYFADA';
  params:
  - GLYFADA
  - - '2019-05-18 14:22:53'
    - '2019-05-31 20:25:32'
  - 3626
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 2733) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 2733) WHERE h_start.name = 'SOUSAKI' AND h_end.name = 'PERAMA';
  params:
  - SOUSAKI
  - PERAMA
  - 2733
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-02-03 20:50:55, 2019-02-10 07:12:26]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-02-03 20:50:55, 2019-02-10 07:12:26]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 8 and tstzspan '[2019-02-03 20:50:55, 2019-02-10 07:12:26]' @> ts;
  params:
  - 8
  - - '2019-02-03 20:50:55'
    - '2019-02-10 07:12:26'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 4264) WHERE tstzspan '[2019-04-22 05:12:56, 2019-04-29 11:59:54]' @> startTimestamp(c.trip) AND h.name = 'AEGINA';
  params:
  - AEGINA
  - - '2019-04-22 05:12:56'
    - '2019-04-29 11:59:54'
  - 4264
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 3912) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 3912) WHERE h_start.name = 'AEGINA' AND h_end.name = 'SIRI';
  params:
  - AEGINA
  - SIRI
  - 3912
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 3617) WHERE tstzspan '[2019-04-04 03:04:45, 2019-04-17 16:42:21]' @> startTimestamp(c.trip) AND h.name = 'ERMIONI';
  params:
  - ERMIONI
  - - '2019-04-04 03:04:45'
    - '2019-04-17 16:42:21'
  - 3617
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-02-03 22:15:55, 2019-02-14 17:26:14]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-02-03 22:15:55, 2019-02-14 17:26:14]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 14 and tstzspan '[2019-02-03 22:15:55, 2019-02-14 17:26:14]' @> ts;
  params:
  - 14
  - - '2019-02-03 22:15:55'
    - '2019-02-14 17:26:14'
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-03-22 09:18:12, 2019-04-01 14:19:34]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-03-22 09:18:12, 2019-04-01 14:19:34]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 16 and tstzspan '[2019-03-22 09:18:12, 2019-04-01 14:19:34]' @> ts;
  params:
  - 16
  - - '2019-03-22 09:18:12'
    - '2019-04-01 14:19:34'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 3314) WHERE tstzspan '[2019-10-17 05:57:28, 2019-10-20 06:04:57]' @> startTimestamp(c.trip) AND h.name = 'AGIOI THEODORI';
  params:
  - AGIOI THEODORI
  - - '2019-10-17 05:57:28'
    - '2019-10-20 06:04:57'
  - 3314
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 1494) WHERE i.name = 'Nisis Stakhtorroyi';
  params:
  - Nisis Stakhtorroyi
  - 1494
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-07-30 21:48:06, 2019-08-12 07:07:20]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-07-30 21:48:06, 2019-08-12 07:07:20]';
  params:
  - - '2019-07-30 21:48:06'
    - '2019-08-12 07:07:20'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 1848) WHERE tstzspan '[2019-03-28 14:26:01, 2019-03-31 20:46:29]' @> startTimestamp(c.trip) AND h.name = 'FLISVOS';
  params:
  - FLISVOS
  - - '2019-03-28 14:26:01'
    - '2019-03-31 20:46:29'
  - 1848
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-01-28 11:53:17, 2019-02-05 21:22:18]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-01-28 11:53:17, 2019-02-05 21:22:18]';
  params:
  - - '2019-01-28 11:53:17'
    - '2019-02-05 21:22:18'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 3147) WHERE i.name = 'Nisida Kyra';
  params:
  - Nisida Kyra
  - 3147
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-12-04 00:49:39, 2019-12-12 19:10:19]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-12-04 00:49:39, 2019-12-12 19:10:19]';
  params:
  - - '2019-12-04 00:49:39'
    - '2019-12-12 19:10:19'
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-12-24 16:10:39, 2019-12-26 21:04:02]' AND edwithin(attime(c.trip,tstzspan '[2019-12-24 16:10:39, 2019-12-26 21:04:02]'), h.geom, 3699) WHERE h.name = 'ELEFSIS' GROUP BY h.name;
  params:
  - - '2019-12-24 16:10:39'
    - '2019-12-26 21:04:02'
  - 3699
  - ELEFSIS
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-02-23 20:42:13, 2019-03-06 17:52:05]' AND edwithin(attime(c.trip,tstzspan '[2019-02-23 20:42:13, 2019-03-06 17:52:05]'), h.geom, 3551) WHERE h.name = 'ELEFSIS' GROUP BY h.name;
  params:
  - - '2019-02-23 20:42:13'
    - '2019-03-06 17:52:05'
  - 3551
  - ELEFSIS
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-02-24 14:29:59, 2019-03-04 08:31:37]' AND edwithin(attime(c.trip,tstzspan '[2019-02-24 14:29:59, 2019-03-04 08:31:37]'), h.geom, 1450) WHERE h.name = 'CORINTH CANAL' GROUP BY h.name;
  params:
  - - '2019-02-24 14:29:59'
    - '2019-03-04 08:31:37'
  - 1450
  - CORINTH CANAL
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 3035) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 3035) WHERE h_start.name = 'PIRAEUS' AND h_end.name = 'FLISVOS';
  params:
  - PIRAEUS
  - FLISVOS
  - 3035
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-01-31 01:37:19, 2019-02-06 16:14:48]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-01-31 01:37:19, 2019-02-06 16:14:48]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 16 and tstzspan '[2019-01-31 01:37:19, 2019-02-06 16:14:48]' @> ts;
  params:
  - 16
  - - '2019-01-31 01:37:19'
    - '2019-02-06 16:14:48'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-05-06 09:20:03, 2019-05-14 07:09:27]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-05-06 09:20:03, 2019-05-14 07:09:27]';
  params:
  - - '2019-05-06 09:20:03'
    - '2019-05-14 07:09:27'
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 2271) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 2271) WHERE h_start.name = 'PERAMA' AND h_end.name = 'AEGINA';
  params:
  - PERAMA
  - AEGINA
  - 2271
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 3684) WHERE i.name = 'Nisis Metopi';
  params:
  - Nisis Metopi
  - 3684
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-10-23 20:30:18, 2019-10-29 08:10:37]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-10-23 20:30:18, 2019-10-29 08:10:37]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 13 and tstzspan '[2019-10-23 20:30:18, 2019-10-29 08:10:37]' @> ts;
  params:
  - 13
  - - '2019-10-23 20:30:18'
    - '2019-10-29 08:10:37'
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 1917) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 1917) WHERE h_start.name = 'CORINTH CANAL' AND h_end.name = 'AEGINA';
  params:
  - CORINTH CANAL
  - AEGINA
  - 1917
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 3004) WHERE i.name = 'Makronisos';
  params:
  - Makronisos
  - 3004
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 3204) WHERE tstzspan '[2019-08-23 17:12:30, 2019-08-29 23:23:33]' @> startTimestamp(c.trip) AND h.name = 'ZEA';
  params:
  - ZEA
  - - '2019-08-23 17:12:30'
    - '2019-08-29 23:23:33'
  - 3204
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 4996) WHERE i.name = 'Poros';
  params:
  - Poros
  - 4996
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 2351) WHERE i.name = 'Poros';
  params:
  - Poros
  - 2351
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 3792) WHERE i.name = 'Nisis Islet';
  params:
  - Nisis Islet
  - 3792
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 3492) WHERE tstzspan '[2019-04-06 03:46:12, 2019-04-16 10:09:43]' @> startTimestamp(c.trip) AND h.name = 'AGISTRI';
  params:
  - AGISTRI
  - - '2019-04-06 03:46:12'
    - '2019-04-16 10:09:43'
  - 3492
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 1721) WHERE i.name = 'Agios Thomas';
  params:
  - Agios Thomas
  - 1721
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 1308) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 1308) WHERE h_start.name = 'CORINTH CANAL' AND h_end.name = 'ELEFSIS';
  params:
  - CORINTH CANAL
  - ELEFSIS
  - 1308
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-09-13 05:17:55, 2019-09-25 18:43:06]' AND edwithin(attime(c.trip,tstzspan '[2019-09-13 05:17:55, 2019-09-25 18:43:06]'), h.geom, 3443) WHERE h.name = 'ERMIONI' GROUP BY h.name;
  params:
  - - '2019-09-13 05:17:55'
    - '2019-09-25 18:43:06'
  - 3443
  - ERMIONI
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-04-24 19:27:48, 2019-05-02 13:07:44]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-04-24 19:27:48, 2019-05-02 13:07:44]';
  params:
  - - '2019-04-24 19:27:48'
    - '2019-05-02 13:07:44'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 1055) WHERE i.name = 'Aegina Moni';
  params:
  - Aegina Moni
  - 1055
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 2237) WHERE tstzspan '[2019-06-12 04:33:01, 2019-06-17 12:09:40]' @> startTimestamp(c.trip) AND h.name = 'PIRAEUS';
  params:
  - PIRAEUS
  - - '2019-06-12 04:33:01'
    - '2019-06-17 12:09:40'
  - 2237
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 2981) WHERE i.name = 'Kasidis';
  params:
  - Kasidis
  - 2981
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-03-27 11:11:23, 2019-04-11 10:29:33]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-03-27 11:11:23, 2019-04-11 10:29:33]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 9 and tstzspan '[2019-03-27 11:11:23, 2019-04-11 10:29:33]' @> ts;
  params:
  - 9
  - - '2019-03-27 11:11:23'
    - '2019-04-11 10:29:33'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-05-01 03:02:11, 2019-05-15 22:34:37]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-05-01 03:02:11, 2019-05-15 22:34:37]';
  params:
  - - '2019-05-01 03:02:11'
    - '2019-05-15 22:34:37'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-01-17 16:20:17, 2019-01-22 18:13:48]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-01-17 16:20:17, 2019-01-22 18:13:48]';
  params:
  - - '2019-01-17 16:20:17'
    - '2019-01-22 18:13:48'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 1308) WHERE i.name = 'Trakhyli';
  params:
  - Trakhyli
  - 1308
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 2833) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 2833) WHERE h_start.name = 'LAVRIO' AND h_end.name = 'FANEROMENI';
  params:
  - LAVRIO
  - FANEROMENI
  - 2833
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 3827) WHERE i.name = 'Agios Ioannis';
  params:
  - Agios Ioannis
  - 3827
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 4375) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 4375) WHERE h_start.name = 'ELEFSIS' AND h_end.name = 'AGIOS KOSMAS';
  params:
  - ELEFSIS
  - AGIOS KOSMAS
  - 4375
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 4469) WHERE tstzspan '[2019-08-02 00:32:29, 2019-08-10 10:52:14]' @> startTimestamp(c.trip) AND h.name = 'ZEA';
  params:
  - ZEA
  - - '2019-08-02 00:32:29'
    - '2019-08-10 10:52:14'
  - 4469
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 3823) WHERE tstzspan '[2019-05-30 14:31:03, 2019-06-05 22:57:13]' @> startTimestamp(c.trip) AND h.name = 'AGISTRI';
  params:
  - AGISTRI
  - - '2019-05-30 14:31:03'
    - '2019-06-05 22:57:13'
  - 3823
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 1197) WHERE i.name = 'Anagnostis';
  params:
  - Anagnostis
  - 1197
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-01-31 21:53:27, 2019-02-07 16:33:46]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-01-31 21:53:27, 2019-02-07 16:33:46]';
  params:
  - - '2019-01-31 21:53:27'
    - '2019-02-07 16:33:46'
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-12-17 20:20:07, 2019-12-20 22:53:33]' AND edwithin(attime(c.trip,tstzspan '[2019-12-17 20:20:07, 2019-12-20 22:53:33]'), h.geom, 4548) WHERE h.name = 'ERMIONI' GROUP BY h.name;
  params:
  - - '2019-12-17 20:20:07'
    - '2019-12-20 22:53:33'
  - 4548
  - ERMIONI
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-01-02 13:20:34, 2019-01-13 08:31:20]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-01-02 13:20:34, 2019-01-13 08:31:20]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 0 and tstzspan '[2019-01-02 13:20:34, 2019-01-13 08:31:20]' @> ts;
  params:
  - 0
  - - '2019-01-02 13:20:34'
    - '2019-01-13 08:31:20'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 4316) WHERE i.name = 'Patroklos';
  params:
  - Patroklos
  - 4316
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-01-03 01:22:42, 2019-01-09 20:35:45]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-01-03 01:22:42, 2019-01-09 20:35:45]';
  params:
  - - '2019-01-03 01:22:42'
    - '2019-01-09 20:35:45'
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 3928) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 3928) WHERE h_start.name = 'FANEROMENI' AND h_end.name = 'CORINTH';
  params:
  - FANEROMENI
  - CORINTH
  - 3928
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 3963) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 3963) WHERE h_start.name = 'SOUSAKI' AND h_end.name = 'PERAMA';
  params:
  - SOUSAKI
  - PERAMA
  - 3963
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-08-13 05:12:25, 2019-08-25 07:31:17]' AND edwithin(attime(c.trip,tstzspan '[2019-08-13 05:12:25, 2019-08-25 07:31:17]'), h.geom, 4801) WHERE h.name = 'ZEA' GROUP BY h.name;
  params:
  - - '2019-08-13 05:12:25'
    - '2019-08-25 07:31:17'
  - 4801
  - ZEA
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 3837) WHERE tstzspan '[2019-06-07 06:43:03, 2019-06-14 12:32:10]' @> startTimestamp(c.trip) AND h.name = 'ASPROPYRGOS';
  params:
  - ASPROPYRGOS
  - - '2019-06-07 06:43:03'
    - '2019-06-14 12:32:10'
  - 3837
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2018-12-31 23:00:01, 2019-01-12 19:31:52]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2018-12-31 23:00:01, 2019-01-12 19:31:52]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 10 and tstzspan '[2018-12-31 23:00:01, 2019-01-12 19:31:52]' @> ts;
  params:
  - 10
  - - '2018-12-31 23:00:01'
    - '2019-01-12 19:31:52'
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-05-01 09:39:28, 2019-05-10 11:00:25]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-05-01 09:39:28, 2019-05-10 11:00:25]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 5 and tstzspan '[2019-05-01 09:39:28, 2019-05-10 11:00:25]' @> ts;
  params:
  - 5
  - - '2019-05-01 09:39:28'
    - '2019-05-10 11:00:25'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 1549) WHERE tstzspan '[2019-09-23 13:39:36, 2019-10-05 00:57:14]' @> startTimestamp(c.trip) AND h.name = 'PERAMA';
  params:
  - PERAMA
  - - '2019-09-23 13:39:36'
    - '2019-10-05 00:57:14'
  - 1549
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 1660) WHERE i.name = 'Nisis Atalanti';
  params:
  - Nisis Atalanti
  - 1660
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 4364) WHERE i.name = 'Vrachonisis Petronisi';
  params:
  - Vrachonisis Petronisi
  - 4364
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-06-16 18:38:24, 2019-06-28 14:42:58]' AND edwithin(attime(c.trip,tstzspan '[2019-06-16 18:38:24, 2019-06-28 14:42:58]'), h.geom, 1020) WHERE h.name = 'ELEFSIS' GROUP BY h.name;
  params:
  - - '2019-06-16 18:38:24'
    - '2019-06-28 14:42:58'
  - 1020
  - ELEFSIS
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-10-07 12:37:40, 2019-10-10 06:45:43]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-10-07 12:37:40, 2019-10-10 06:45:43]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 11 and tstzspan '[2019-10-07 12:37:40, 2019-10-10 06:45:43]' @> ts;
  params:
  - 11
  - - '2019-10-07 12:37:40'
    - '2019-10-10 06:45:43'
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 3991) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 3991) WHERE h_start.name = 'GLYFADA' AND h_end.name = 'ERMIONI';
  params:
  - GLYFADA
  - ERMIONI
  - 3991
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 4017) WHERE tstzspan '[2019-02-17 21:35:19, 2019-02-27 22:20:22]' @> startTimestamp(c.trip) AND h.name = 'AEGINA';
  params:
  - AEGINA
  - - '2019-02-17 21:35:19'
    - '2019-02-27 22:20:22'
  - 4017
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 4348) WHERE i.name = 'Aponissos';
  params:
  - Aponissos
  - 4348
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 2964) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 2964) WHERE h_start.name = 'PERAMA' AND h_end.name = 'CORINTH CANAL';
  params:
  - PERAMA
  - CORINTH CANAL
  - 2964
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 1441) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 1441) WHERE h_start.name = 'ASPROPYRGOS' AND h_end.name = 'RAFINA';
  params:
  - ASPROPYRGOS
  - RAFINA
  - 1441
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-03-24 07:05:49, 2019-03-27 19:59:21]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-03-24 07:05:49, 2019-03-27 19:59:21]';
  params:
  - - '2019-03-24 07:05:49'
    - '2019-03-27 19:59:21'
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-03-08 16:36:54, 2019-03-18 03:01:48]' AND edwithin(attime(c.trip,tstzspan '[2019-03-08 16:36:54, 2019-03-18 03:01:48]'), h.geom, 2493) WHERE h.name = 'SIRI' GROUP BY h.name;
  params:
  - - '2019-03-08 16:36:54'
    - '2019-03-18 03:01:48'
  - 2493
  - SIRI
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-09-21 23:21:07, 2019-09-25 09:46:32]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-09-21 23:21:07, 2019-09-25 09:46:32]';
  params:
  - - '2019-09-21 23:21:07'
    - '2019-09-25 09:46:32'
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-01-01 11:56:43, 2019-01-12 17:38:41]' AND edwithin(attime(c.trip,tstzspan '[2019-01-01 11:56:43, 2019-01-12 17:38:41]'), h.geom, 2098) WHERE h.name = 'PIRAEUS' GROUP BY h.name;
  params:
  - - '2019-01-01 11:56:43'
    - '2019-01-12 17:38:41'
  - 2098
  - PIRAEUS
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 1804) WHERE tstzspan '[2019-02-20 15:53:57, 2019-03-04 07:39:12]' @> startTimestamp(c.trip) AND h.name = 'ZEA';
  params:
  - ZEA
  - - '2019-02-20 15:53:57'
    - '2019-03-04 07:39:12'
  - 1804
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 3685) WHERE tstzspan '[2019-10-09 12:31:45, 2019-10-21 02:46:00]' @> startTimestamp(c.trip) AND h.name = 'SIRI';
  params:
  - SIRI
  - - '2019-10-09 12:31:45'
    - '2019-10-21 02:46:00'
  - 3685
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 4354) WHERE tstzspan '[2019-07-01 00:01:14, 2019-07-10 01:23:58]' @> startTimestamp(c.trip) AND h.name = 'FANEROMENI';
  params:
  - FANEROMENI
  - - '2019-07-01 00:01:14'
    - '2019-07-10 01:23:58'
  - 4354
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-05-08 01:48:46, 2019-05-22 22:02:36]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-05-08 01:48:46, 2019-05-22 22:02:36]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 8 and tstzspan '[2019-05-08 01:48:46, 2019-05-22 22:02:36]' @> ts;
  params:
  - 8
  - - '2019-05-08 01:48:46'
    - '2019-05-22 22:02:36'
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-01-16 10:02:22, 2019-01-24 22:18:54]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-01-16 10:02:22, 2019-01-24 22:18:54]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 20 and tstzspan '[2019-01-16 10:02:22, 2019-01-24 22:18:54]' @> ts;
  params:
  - 20
  - - '2019-01-16 10:02:22'
    - '2019-01-24 22:18:54'
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 3383) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 3383) WHERE h_start.name = 'CORINTH' AND h_end.name = 'ZEA';
  params:
  - CORINTH
  - ZEA
  - 3383
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-06-13 11:48:06, 2019-06-25 08:05:58]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-06-13 11:48:06, 2019-06-25 08:05:58]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 3 and tstzspan '[2019-06-13 11:48:06, 2019-06-25 08:05:58]' @> ts;
  params:
  - 3
  - - '2019-06-13 11:48:06'
    - '2019-06-25 08:05:58'
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-11-14 22:43:42, 2019-11-17 23:32:40]' AND edwithin(attime(c.trip,tstzspan '[2019-11-14 22:43:42, 2019-11-17 23:32:40]'), h.geom, 4573) WHERE h.name = 'FALIRO' GROUP BY h.name;
  params:
  - - '2019-11-14 22:43:42'
    - '2019-11-17 23:32:40'
  - 4573
  - FALIRO
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 4358) WHERE i.name = 'Agistri';
  params:
  - Agistri
  - 4358
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 2925) WHERE i.name = 'Vrachonisis Tragonisi';
  params:
  - Vrachonisis Tragonisi
  - 2925
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 1459) WHERE i.name = 'Anagnostis';
  params:
  - Anagnostis
  - 1459
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 2739) WHERE i.name = 'Nisis Bisti';
  params:
  - Nisis Bisti
  - 2739
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-02-15 00:02:40, 2019-02-28 23:16:48]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-02-15 00:02:40, 2019-02-28 23:16:48]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 5 and tstzspan '[2019-02-15 00:02:40, 2019-02-28 23:16:48]' @> ts;
  params:
  - 5
  - - '2019-02-15 00:02:40'
    - '2019-02-28 23:16:48'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-08-24 06:04:03, 2019-08-29 23:41:21]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-08-24 06:04:03, 2019-08-29 23:41:21]';
  params:
  - - '2019-08-24 06:04:03'
    - '2019-08-29 23:41:21'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 2877) WHERE i.name = 'Nisida Kyra';
  params:
  - Nisida Kyra
  - 2877
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 3195) WHERE tstzspan '[2019-06-08 02:59:10, 2019-06-11 18:41:41]' @> startTimestamp(c.trip) AND h.name = 'FLISVOS';
  params:
  - FLISVOS
  - - '2019-06-08 02:59:10'
    - '2019-06-11 18:41:41'
  - 3195
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 3971) WHERE tstzspan '[2019-03-05 01:04:49, 2019-03-09 22:18:13]' @> startTimestamp(c.trip) AND h.name = 'RAFINA';
  params:
  - RAFINA
  - - '2019-03-05 01:04:49'
    - '2019-03-09 22:18:13'
  - 3971
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-07-16 01:38:14, 2019-07-26 08:46:58]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-07-16 01:38:14, 2019-07-26 08:46:58]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 20 and tstzspan '[2019-07-16 01:38:14, 2019-07-26 08:46:58]' @> ts;
  params:
  - 20
  - - '2019-07-16 01:38:14'
    - '2019-07-26 08:46:58'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 4767) WHERE tstzspan '[2019-04-30 19:02:06, 2019-05-14 01:46:52]' @> startTimestamp(c.trip) AND h.name = 'AGISTRI';
  params:
  - AGISTRI
  - - '2019-04-30 19:02:06'
    - '2019-05-14 01:46:52'
  - 4767
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 1713) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 1713) WHERE h_start.name = 'SIRI' AND h_end.name = 'PERAMA';
  params:
  - SIRI
  - PERAMA
  - 1713
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-10-28 11:01:11, 2019-11-11 03:16:27]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-10-28 11:01:11, 2019-11-11 03:16:27]';
  params:
  - - '2019-10-28 11:01:11'
    - '2019-11-11 03:16:27'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 2285) WHERE tstzspan '[2019-03-18 22:01:20, 2019-03-22 22:05:46]' @> startTimestamp(c.trip) AND h.name = 'GLYFADA';
  params:
  - GLYFADA
  - - '2019-03-18 22:01:20'
    - '2019-03-22 22:05:46'
  - 2285
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 1131) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 1131) WHERE h_start.name = 'SIRI' AND h_end.name = 'PIRAEUS';
  params:
  - SIRI
  - PIRAEUS
  - 1131
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-06-21 05:50:23, 2019-07-01 07:40:43]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-06-21 05:50:23, 2019-07-01 07:40:43]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 18 and tstzspan '[2019-06-21 05:50:23, 2019-07-01 07:40:43]' @> ts;
  params:
  - 18
  - - '2019-06-21 05:50:23'
    - '2019-07-01 07:40:43'
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-01-13 23:24:12, 2019-01-24 15:14:05]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-01-13 23:24:12, 2019-01-24 15:14:05]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 5 and tstzspan '[2019-01-13 23:24:12, 2019-01-24 15:14:05]' @> ts;
  params:
  - 5
  - - '2019-01-13 23:24:12'
    - '2019-01-24 15:14:05'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 1682) WHERE i.name = 'Vrachonisis Tragonisi';
  params:
  - Vrachonisis Tragonisi
  - 1682
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 4649) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 4649) WHERE h_start.name = 'FLISVOS' AND h_end.name = 'CORINTH CANAL';
  params:
  - FLISVOS
  - CORINTH CANAL
  - 4649
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 1969) WHERE i.name = 'Phleva Island';
  params:
  - Phleva Island
  - 1969
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 3258) WHERE i.name = 'Agios Thomas';
  params:
  - Agios Thomas
  - 3258
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-03-13 01:40:47, 2019-03-27 04:24:19]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-03-13 01:40:47, 2019-03-27 04:24:19]';
  params:
  - - '2019-03-13 01:40:47'
    - '2019-03-27 04:24:19'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-03-16 16:01:14, 2019-03-22 09:49:14]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-03-16 16:01:14, 2019-03-22 09:49:14]';
  params:
  - - '2019-03-16 16:01:14'
    - '2019-03-22 09:49:14'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-11-25 10:49:10, 2019-12-08 04:28:44]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-11-25 10:49:10, 2019-12-08 04:28:44]';
  params:
  - - '2019-11-25 10:49:10'
    - '2019-12-08 04:28:44'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 1221) WHERE tstzspan '[2019-12-03 17:35:27, 2019-12-14 13:21:24]' @> startTimestamp(c.trip) AND h.name = 'FLISVOS';
  params:
  - FLISVOS
  - - '2019-12-03 17:35:27'
    - '2019-12-14 13:21:24'
  - 1221
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-10-29 08:32:02, 2019-11-07 11:34:33]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-10-29 08:32:02, 2019-11-07 11:34:33]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 6 and tstzspan '[2019-10-29 08:32:02, 2019-11-07 11:34:33]' @> ts;
  params:
  - 6
  - - '2019-10-29 08:32:02'
    - '2019-11-07 11:34:33'
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-03-24 11:03:45, 2019-03-27 13:58:58]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-03-24 11:03:45, 2019-03-27 13:58:58]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 10 and tstzspan '[2019-03-24 11:03:45, 2019-03-27 13:58:58]' @> ts;
  params:
  - 10
  - - '2019-03-24 11:03:45'
    - '2019-03-27 13:58:58'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 1737) WHERE i.name = 'Kasidis';
  params:
  - Kasidis
  - 1737
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 3091) WHERE tstzspan '[2018-12-31 23:00:01, 2019-01-01 01:14:39]' @> startTimestamp(c.trip) AND h.name = 'FALIRO';
  params:
  - FALIRO
  - - '2018-12-31 23:00:01'
    - '2019-01-01 01:14:39'
  - 3091
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-10-27 06:27:33, 2019-10-30 16:39:37]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-10-27 06:27:33, 2019-10-30 16:39:37]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 8 and tstzspan '[2019-10-27 06:27:33, 2019-10-30 16:39:37]' @> ts;
  params:
  - 8
  - - '2019-10-27 06:27:33'
    - '2019-10-30 16:39:37'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 1439) WHERE i.name = 'Lagousa';
  params:
  - Lagousa
  - 1439
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-06-24 03:49:00, 2019-06-30 04:26:33]' AND edwithin(attime(c.trip,tstzspan '[2019-06-24 03:49:00, 2019-06-30 04:26:33]'), h.geom, 4213) WHERE h.name = 'ZEA' GROUP BY h.name;
  params:
  - - '2019-06-24 03:49:00'
    - '2019-06-30 04:26:33'
  - 4213
  - ZEA
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 3887) WHERE tstzspan '[2019-04-28 18:59:33, 2019-05-01 22:50:08]' @> startTimestamp(c.trip) AND h.name = 'AEGINA';
  params:
  - AEGINA
  - - '2019-04-28 18:59:33'
    - '2019-05-01 22:50:08'
  - 3887
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-01-03 19:38:55, 2019-01-10 10:32:07]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-01-03 19:38:55, 2019-01-10 10:32:07]';
  params:
  - - '2019-01-03 19:38:55'
    - '2019-01-10 10:32:07'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-04-05 06:18:29, 2019-04-19 01:49:29]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-04-05 06:18:29, 2019-04-19 01:49:29]';
  params:
  - - '2019-04-05 06:18:29'
    - '2019-04-19 01:49:29'
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 3470) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 3470) WHERE h_start.name = 'GLYFADA' AND h_end.name = 'FLISVOS';
  params:
  - GLYFADA
  - FLISVOS
  - 3470
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-01-18 14:56:29, 2019-01-22 05:19:20]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-01-18 14:56:29, 2019-01-22 05:19:20]';
  params:
  - - '2019-01-18 14:56:29'
    - '2019-01-22 05:19:20'
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-01-08 04:32:19, 2019-01-15 05:53:36]' AND edwithin(attime(c.trip,tstzspan '[2019-01-08 04:32:19, 2019-01-15 05:53:36]'), h.geom, 2172) WHERE h.name = 'CORINTH CANAL' GROUP BY h.name;
  params:
  - - '2019-01-08 04:32:19'
    - '2019-01-15 05:53:36'
  - 2172
  - CORINTH CANAL
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-06-12 20:52:39, 2019-06-16 14:49:47]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-06-12 20:52:39, 2019-06-16 14:49:47]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 13 and tstzspan '[2019-06-12 20:52:39, 2019-06-16 14:49:47]' @> ts;
  params:
  - 13
  - - '2019-06-12 20:52:39'
    - '2019-06-16 14:49:47'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 3602) WHERE tstzspan '[2019-04-08 05:23:00, 2019-04-16 16:27:42]' @> startTimestamp(c.trip) AND h.name = 'PIRAEUS';
  params:
  - PIRAEUS
  - - '2019-04-08 05:23:00'
    - '2019-04-16 16:27:42'
  - 3602
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-06-17 19:58:57, 2019-06-24 05:54:06]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-06-17 19:58:57, 2019-06-24 05:54:06]';
  params:
  - - '2019-06-17 19:58:57'
    - '2019-06-24 05:54:06'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 2533) WHERE i.name = 'Vrachonisis Moladi';
  params:
  - Vrachonisis Moladi
  - 2533
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 3290) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 3290) WHERE h_start.name = 'ERMIONI' AND h_end.name = 'LAVRIO';
  params:
  - ERMIONI
  - LAVRIO
  - 3290
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 1828) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 1828) WHERE h_start.name = 'ZEA' AND h_end.name = 'AEGINA';
  params:
  - ZEA
  - AEGINA
  - 1828
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-10-14 09:50:08, 2019-10-18 02:40:07]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-10-14 09:50:08, 2019-10-18 02:40:07]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 16 and tstzspan '[2019-10-14 09:50:08, 2019-10-18 02:40:07]' @> ts;
  params:
  - 16
  - - '2019-10-14 09:50:08'
    - '2019-10-18 02:40:07'
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 2718) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 2718) WHERE h_start.name = 'AGIOI THEODORI' AND h_end.name = 'ZEA';
  params:
  - AGIOI THEODORI
  - ZEA
  - 2718
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-08-21 05:35:49, 2019-08-29 16:02:46]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-08-21 05:35:49, 2019-08-29 16:02:46]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 21 and tstzspan '[2019-08-21 05:35:49, 2019-08-29 16:02:46]' @> ts;
  params:
  - 21
  - - '2019-08-21 05:35:49'
    - '2019-08-29 16:02:46'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-12-10 20:08:17, 2019-12-18 01:03:48]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-12-10 20:08:17, 2019-12-18 01:03:48]';
  params:
  - - '2019-12-10 20:08:17'
    - '2019-12-18 01:03:48'
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-03-31 07:54:06, 2019-04-09 10:04:08]' AND edwithin(attime(c.trip,tstzspan '[2019-03-31 07:54:06, 2019-04-09 10:04:08]'), h.geom, 2811) WHERE h.name = 'SOUSAKI' GROUP BY h.name;
  params:
  - - '2019-03-31 07:54:06'
    - '2019-04-09 10:04:08'
  - 2811
  - SOUSAKI
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 4918) WHERE i.name = 'Kourmouloudes';
  params:
  - Kourmouloudes
  - 4918
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-07-30 01:47:31, 2019-08-01 04:25:06]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-07-30 01:47:31, 2019-08-01 04:25:06]';
  params:
  - - '2019-07-30 01:47:31'
    - '2019-08-01 04:25:06'
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 3136) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 3136) WHERE h_start.name = 'PERAMA' AND h_end.name = 'ZEA';
  params:
  - PERAMA
  - ZEA
  - 3136
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-03-25 21:04:22, 2019-04-04 23:33:55]' AND edwithin(attime(c.trip,tstzspan '[2019-03-25 21:04:22, 2019-04-04 23:33:55]'), h.geom, 3560) WHERE h.name = 'PERAMA' GROUP BY h.name;
  params:
  - - '2019-03-25 21:04:22'
    - '2019-04-04 23:33:55'
  - 3560
  - PERAMA
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 2448) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 2448) WHERE h_start.name = 'PERAMA' AND h_end.name = 'GLYFADA';
  params:
  - PERAMA
  - GLYFADA
  - 2448
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-05-12 18:48:00, 2019-05-15 00:01:28]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-05-12 18:48:00, 2019-05-15 00:01:28]';
  params:
  - - '2019-05-12 18:48:00'
    - '2019-05-15 00:01:28'
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-03-17 00:43:25, 2019-03-29 14:10:02]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-03-17 00:43:25, 2019-03-29 14:10:02]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 18 and tstzspan '[2019-03-17 00:43:25, 2019-03-29 14:10:02]' @> ts;
  params:
  - 18
  - - '2019-03-17 00:43:25'
    - '2019-03-29 14:10:02'
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-08-10 08:41:55, 2019-08-20 19:57:16]' AND edwithin(attime(c.trip,tstzspan '[2019-08-10 08:41:55, 2019-08-20 19:57:16]'), h.geom, 3508) WHERE h.name = 'FANEROMENI' GROUP BY h.name;
  params:
  - - '2019-08-10 08:41:55'
    - '2019-08-20 19:57:16'
  - 3508
  - FANEROMENI
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-02-03 05:04:01, 2019-02-13 10:00:40]' AND edwithin(attime(c.trip,tstzspan '[2019-02-03 05:04:01, 2019-02-13 10:00:40]'), h.geom, 1415) WHERE h.name = 'ASPROPYRGOS' GROUP BY h.name;
  params:
  - - '2019-02-03 05:04:01'
    - '2019-02-13 10:00:40'
  - 1415
  - ASPROPYRGOS
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 1147) WHERE i.name = 'Nisida Kyra';
  params:
  - Nisida Kyra
  - 1147
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 1994) WHERE tstzspan '[2019-01-31 12:20:19, 2019-02-14 11:07:20]' @> startTimestamp(c.trip) AND h.name = 'ZEA';
  params:
  - ZEA
  - - '2019-01-31 12:20:19'
    - '2019-02-14 11:07:20'
  - 1994
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 3694) WHERE i.name = 'Salamina';
  params:
  - Salamina
  - 3694
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-01-03 22:29:06, 2019-01-10 12:31:09]' AND edwithin(attime(c.trip,tstzspan '[2019-01-03 22:29:06, 2019-01-10 12:31:09]'), h.geom, 3095) WHERE h.name = 'FANEROMENI' GROUP BY h.name;
  params:
  - - '2019-01-03 22:29:06'
    - '2019-01-10 12:31:09'
  - 3095
  - FANEROMENI
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 3305) WHERE tstzspan '[2019-04-02 13:28:38, 2019-04-05 00:09:40]' @> startTimestamp(c.trip) AND h.name = 'CORINTH CANAL';
  params:
  - CORINTH CANAL
  - - '2019-04-02 13:28:38'
    - '2019-04-05 00:09:40'
  - 3305
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-07-23 08:34:58, 2019-07-31 23:12:45]' AND edwithin(attime(c.trip,tstzspan '[2019-07-23 08:34:58, 2019-07-31 23:12:45]'), h.geom, 4321) WHERE h.name = 'ELEFSIS' GROUP BY h.name;
  params:
  - - '2019-07-23 08:34:58'
    - '2019-07-31 23:12:45'
  - 4321
  - ELEFSIS
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-05-01 00:24:34, 2019-05-07 07:42:01]' AND edwithin(attime(c.trip,tstzspan '[2019-05-01 00:24:34, 2019-05-07 07:42:01]'), h.geom, 3208) WHERE h.name = 'CORINTH CANAL' GROUP BY h.name;
  params:
  - - '2019-05-01 00:24:34'
    - '2019-05-07 07:42:01'
  - 3208
  - CORINTH CANAL
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-11-07 10:01:28, 2019-11-12 10:02:08]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-11-07 10:01:28, 2019-11-12 10:02:08]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 10 and tstzspan '[2019-11-07 10:01:28, 2019-11-12 10:02:08]' @> ts;
  params:
  - 10
  - - '2019-11-07 10:01:28'
    - '2019-11-12 10:02:08'
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-09-24 04:34:02, 2019-09-28 03:19:51]' AND edwithin(attime(c.trip,tstzspan '[2019-09-24 04:34:02, 2019-09-28 03:19:51]'), h.geom, 1713) WHERE h.name = 'PERAMA' GROUP BY h.name;
  params:
  - - '2019-09-24 04:34:02'
    - '2019-09-28 03:19:51'
  - 1713
  - PERAMA
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-11-25 10:11:28, 2019-11-29 00:59:53]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-11-25 10:11:28, 2019-11-29 00:59:53]';
  params:
  - - '2019-11-25 10:11:28'
    - '2019-11-29 00:59:53'
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 2433) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 2433) WHERE h_start.name = 'PIRAEUS' AND h_end.name = 'FALIRO';
  params:
  - PIRAEUS
  - FALIRO
  - 2433
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 1880) WHERE tstzspan '[2019-01-28 10:54:30, 2019-02-08 20:35:20]' @> startTimestamp(c.trip) AND h.name = 'LAVRIO';
  params:
  - LAVRIO
  - - '2019-01-28 10:54:30'
    - '2019-02-08 20:35:20'
  - 1880
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 3286) WHERE tstzspan '[2019-09-03 02:53:08, 2019-09-10 08:20:56]' @> startTimestamp(c.trip) AND h.name = 'CORINTH';
  params:
  - CORINTH
  - - '2019-09-03 02:53:08'
    - '2019-09-10 08:20:56'
  - 3286
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-11-21 04:29:51, 2019-11-25 00:36:37]' AND edwithin(attime(c.trip,tstzspan '[2019-11-21 04:29:51, 2019-11-25 00:36:37]'), h.geom, 3063) WHERE h.name = 'CORINTH' GROUP BY h.name;
  params:
  - - '2019-11-21 04:29:51'
    - '2019-11-25 00:36:37'
  - 3063
  - CORINTH
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-09-10 05:53:16, 2019-09-12 06:32:46]' AND edwithin(attime(c.trip,tstzspan '[2019-09-10 05:53:16, 2019-09-12 06:32:46]'), h.geom, 1542) WHERE h.name = 'FALIRO' GROUP BY h.name;
  params:
  - - '2019-09-10 05:53:16'
    - '2019-09-12 06:32:46'
  - 1542
  - FALIRO
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-08-01 20:59:57, 2019-08-09 06:31:50]' AND edwithin(attime(c.trip,tstzspan '[2019-08-01 20:59:57, 2019-08-09 06:31:50]'), h.geom, 3829) WHERE h.name = 'LAVRIO' GROUP BY h.name;
  params:
  - - '2019-08-01 20:59:57'
    - '2019-08-09 06:31:50'
  - 3829
  - LAVRIO
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 4705) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 4705) WHERE h_start.name = 'SIRI' AND h_end.name = 'FANEROMENI';
  params:
  - SIRI
  - FANEROMENI
  - 4705
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-03-19 04:23:58, 2019-03-30 20:16:10]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-03-19 04:23:58, 2019-03-30 20:16:10]';
  params:
  - - '2019-03-19 04:23:58'
    - '2019-03-30 20:16:10'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings_adapttimegrid c JOIN islands i ON edwithin(c.trip, i.geom, 3062) WHERE i.name = 'Daskalio';
  params:
  - Daskalio
  - 3062
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-10-18 22:50:18, 2019-10-22 09:40:57]' AND edwithin(attime(c.trip,tstzspan '[2019-10-18 22:50:18, 2019-10-22 09:40:57]'), h.geom, 3640) WHERE h.name = 'AGIOS KOSMAS' GROUP BY h.name;
  params:
  - - '2019-10-18 22:50:18'
    - '2019-10-22 09:40:57'
  - 3640
  - AGIOS KOSMAS
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-09-11 03:30:18, 2019-09-16 22:24:01]' AND edwithin(attime(c.trip,tstzspan '[2019-09-11 03:30:18, 2019-09-16 22:24:01]'), h.geom, 2835) WHERE h.name = 'AGIOS KOSMAS' GROUP BY h.name;
  params:
  - - '2019-09-11 03:30:18'
    - '2019-09-16 22:24:01'
  - 2835
  - AGIOS KOSMAS
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 4755) WHERE tstzspan '[2019-11-26 14:49:51, 2019-12-08 23:02:06]' @> startTimestamp(c.trip) AND h.name = 'CORINTH';
  params:
  - CORINTH
  - - '2019-11-26 14:49:51'
    - '2019-12-08 23:02:06'
  - 4755
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-04-02 09:34:41, 2019-04-12 08:10:27]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-04-02 09:34:41, 2019-04-12 08:10:27]';
  params:
  - - '2019-04-02 09:34:41'
    - '2019-04-12 08:10:27'
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-05-14 15:41:22, 2019-05-27 11:00:42]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-05-14 15:41:22, 2019-05-27 11:00:42]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 22 and tstzspan '[2019-05-14 15:41:22, 2019-05-27 11:00:42]' @> ts;
  params:
  - 22
  - - '2019-05-14 15:41:22'
    - '2019-05-27 11:00:42'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-12-22 02:46:50, 2019-12-26 03:20:25]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-12-22 02:46:50, 2019-12-26 03:20:25]';
  params:
  - - '2019-12-22 02:46:50'
    - '2019-12-26 03:20:25'
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 3120) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 3120) WHERE h_start.name = 'CORINTH' AND h_end.name = 'ERMIONI';
  params:
  - CORINTH
  - ERMIONI
  - 3120
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-04-22 15:39:25, 2019-05-05 04:50:38]' FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-04-22 15:39:25, 2019-05-05 04:50:38]';
  params:
  - - '2019-04-22 15:39:25'
    - '2019-05-05 04:50:38'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 2073) WHERE tstzspan '[2019-08-03 18:11:26, 2019-08-08 22:05:29]' @> startTimestamp(c.trip) AND h.name = 'FALIRO';
  params:
  - FALIRO
  - - '2019-08-03 18:11:26'
    - '2019-08-08 22:05:29'
  - 2073
- name: crossings_adapttimegridConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings_adapttimegrid c JOIN harbours h_start ON ST_DWithin(startValue(c.trip), h_start.geom, 2581) JOIN harbours h_end ON ST_DWithin(endValue(c.trip), h_end.geom, 2581) WHERE h_start.name = 'FANEROMENI' AND h_end.name = 'PIRAEUS';
  params:
  - FANEROMENI
  - PIRAEUS
  - 2581
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-11-27 17:43:49, 2019-12-10 13:37:48]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-11-27 17:43:49, 2019-12-10 13:37:48]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 20 and tstzspan '[2019-11-27 17:43:49, 2019-12-10 13:37:48]' @> ts;
  params:
  - 20
  - - '2019-11-27 17:43:49'
    - '2019-12-10 13:37:48'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(endTimestamp(c.trip)-startTimestamp(c.trip)) as avg_duration FROM crossings_adapttimegrid c JOIN harbours h ON ST_DWithin(startValue(c.trip), h.geom, 1708) WHERE tstzspan '[2019-11-14 15:45:45, 2019-11-23 01:51:02]' @> startTimestamp(c.trip) AND h.name = 'FALIRO';
  params:
  - FALIRO
  - - '2019-11-14 15:45:45'
    - '2019-11-23 01:51:02'
  - 1708
- name: HarbourActivityInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(DISTINCT c.crossing_id) AS unique_crossings_adapttimegrid_near_harbour FROM harbours h JOIN crossings_adapttimegrid c ON c.trip && tstzspan '[2019-06-19 20:29:55, 2019-06-23 06:04:26]' AND edwithin(attime(c.trip,tstzspan '[2019-06-19 20:29:55, 2019-06-23 06:04:26]'), h.geom, 2754) WHERE h.name = 'ELEFSIS' GROUP BY h.name;
  params:
  - - '2019-06-19 20:29:55'
    - '2019-06-23 06:04:26'
  - 2754
  - ELEFSIS
- name: CrossingsActiveAtGivenHourOfDay
  type: temporal
  sql: |
    WITH ts_table AS (SELECT c.crossing_id,unnest(timestamps(atTime(trip,tstzspan '[2019-02-23 10:33:48, 2019-03-03 20:37:00]'))) AS ts FROM crossings_adapttimegrid c WHERE c.trip && tstzspan '[2019-02-23 10:33:48, 2019-03-03 20:37:00]') SELECT COUNT(DISTINCT crossing_id) FROM ts_table WHERE EXTRACT(HOUR FROM ts) = 0 and tstzspan '[2019-02-23 10:33:48, 2019-03-03 20:37:00]' @> ts;
  params:
  - 0
  - - '2019-02-23 10:33:48'
    - '2019-03-03 20:37:00'
