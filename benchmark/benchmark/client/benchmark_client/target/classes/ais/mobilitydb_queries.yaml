- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-05-30 07:40:27, 2019-06-01 11:40:34]' FROM crossings c WHERE c.traj && tstzspan '[2019-05-30 07:40:27, 2019-06-01 11:40:34]';
  params:
  - - '2019-05-30 07:40:27'
    - '2019-06-01 11:40:34'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 3 AND DATE(startTimestamp(c.traj)) = DATE '2019-03-08';
  params:
  - '2019-03-08'
  - 3
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-09-03 15:26:58, 2019-09-18 09:42:17]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-09-03 15:26:58'
    - '2019-09-18 09:42:17'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 11 AND DATE(startTimestamp(c.traj)) = DATE '2019-09-17';
  params:
  - '2019-09-17'
  - 11
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-01-01 02:32:47, 2019-01-12 18:24:14]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-01-01 02:32:47'
    - '2019-01-12 18:24:14'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Nisis Islet' GROUP BY i.name;
  params:
  - Nisis Islet
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 23 AND DATE(startTimestamp(c.traj)) = DATE '2019-11-09';
  params:
  - '2019-11-09'
  - 23
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-05-21 03:29:58, 2019-06-01 03:15:53]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-05-21 03:29:58'
    - '2019-06-01 03:15:53'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Poros' GROUP BY i.name;
  params:
  - Poros
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-09-29 23:01:34, 2019-10-10 11:33:25]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-09-29 23:01:34'
    - '2019-10-10 11:33:25'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-12-23 23:21:34, 2019-12-31 23:59:59]' AND h.name = 'PIRAEUS';
  params:
  - PIRAEUS
  - - '2019-12-23 23:21:34'
    - '2019-12-31 23:59:59'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 13 AND DATE(startTimestamp(c.traj)) = DATE '2019-09-22';
  params:
  - '2019-09-22'
  - 13
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'PERAMA' AND h_end.name = 'AEGINA';
  params:
  - PERAMA
  - AEGINA
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-04-25 12:17:54, 2019-05-06 01:15:02]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-04-25 12:17:54'
    - '2019-05-06 01:15:02'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Thorussa' GROUP BY i.name;
  params:
  - Thorussa
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Kourmouloudes' GROUP BY i.name;
  params:
  - Kourmouloudes
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-08-17 11:08:06, 2019-08-30 21:33:28]' FROM crossings c WHERE c.traj && tstzspan '[2019-08-17 11:08:06, 2019-08-30 21:33:28]';
  params:
  - - '2019-08-17 11:08:06'
    - '2019-08-30 21:33:28'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-03-19 19:43:58, 2019-03-28 19:24:00]' FROM crossings c WHERE c.traj && tstzspan '[2019-03-19 19:43:58, 2019-03-28 19:24:00]';
  params:
  - - '2019-03-19 19:43:58'
    - '2019-03-28 19:24:00'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'ERMIONI' AND h_end.name = 'SOUSAKI';
  params:
  - ERMIONI
  - SOUSAKI
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-11-01 18:28:33, 2019-11-15 15:34:24]' AND h.name = 'AGISTRI';
  params:
  - AGISTRI
  - - '2019-11-01 18:28:33'
    - '2019-11-15 15:34:24'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 20 AND DATE(startTimestamp(c.traj)) = DATE '2019-11-02';
  params:
  - '2019-11-02'
  - 20
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'SOUSAKI' AND h_end.name = 'SIRI';
  params:
  - SOUSAKI
  - SIRI
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 0 AND DATE(startTimestamp(c.traj)) = DATE '2019-08-29';
  params:
  - '2019-08-29'
  - 0
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-03-12 04:49:59, 2019-03-16 09:28:24]' FROM crossings c WHERE c.traj && tstzspan '[2019-03-12 04:49:59, 2019-03-16 09:28:24]';
  params:
  - - '2019-03-12 04:49:59'
    - '2019-03-16 09:28:24'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-01-23 23:25:31, 2019-02-06 19:16:57]' FROM crossings c WHERE c.traj && tstzspan '[2019-01-23 23:25:31, 2019-02-06 19:16:57]';
  params:
  - - '2019-01-23 23:25:31'
    - '2019-02-06 19:16:57'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'AEGINA' AND h_end.name = 'PERAMA';
  params:
  - AEGINA
  - PERAMA
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 8 AND DATE(startTimestamp(c.traj)) = DATE '2019-06-04';
  params:
  - '2019-06-04'
  - 8
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 20 AND DATE(startTimestamp(c.traj)) = DATE '2019-06-02';
  params:
  - '2019-06-02'
  - 20
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'FALIRO' AND h_end.name = 'SIRI';
  params:
  - FALIRO
  - SIRI
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-12-09 06:27:19, 2019-12-17 06:53:18]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-12-09 06:27:19'
    - '2019-12-17 06:53:18'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-02-22 02:30:17, 2019-03-08 10:41:08]' AND h.name = 'AGIOI THEODORI';
  params:
  - AGIOI THEODORI
  - - '2019-02-22 02:30:17'
    - '2019-03-08 10:41:08'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-01-27 15:47:33, 2019-02-03 14:10:17]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-01-27 15:47:33'
    - '2019-02-03 14:10:17'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 7 AND DATE(startTimestamp(c.traj)) = DATE '2019-05-10';
  params:
  - '2019-05-10'
  - 7
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-03-15 11:25:41, 2019-03-29 16:58:17]' AND h.name = 'SIRI';
  params:
  - SIRI
  - - '2019-03-15 11:25:41'
    - '2019-03-29 16:58:17'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-08-13 12:55:07, 2019-08-25 01:32:23]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-08-13 12:55:07'
    - '2019-08-25 01:32:23'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-05-09 04:49:52, 2019-05-16 13:07:32]' FROM crossings c WHERE c.traj && tstzspan '[2019-05-09 04:49:52, 2019-05-16 13:07:32]';
  params:
  - - '2019-05-09 04:49:52'
    - '2019-05-16 13:07:32'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 20 AND DATE(startTimestamp(c.traj)) = DATE '2019-11-15';
  params:
  - '2019-11-15'
  - 20
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-07-26 11:09:38, 2019-08-09 15:48:46]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-07-26 11:09:38'
    - '2019-08-09 15:48:46'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-11-13 12:55:48, 2019-11-27 18:04:56]' AND h.name = 'ERMIONI';
  params:
  - ERMIONI
  - - '2019-11-13 12:55:48'
    - '2019-11-27 18:04:56'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 3 AND DATE(startTimestamp(c.traj)) = DATE '2019-09-20';
  params:
  - '2019-09-20'
  - 3
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-03-11 04:40:01, 2019-03-23 12:41:09]' AND h.name = 'FALIRO';
  params:
  - FALIRO
  - - '2019-03-11 04:40:01'
    - '2019-03-23 12:41:09'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Kasidis' GROUP BY i.name;
  params:
  - Kasidis
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'ASPROPYRGOS' AND h_end.name = 'LAVRIO';
  params:
  - ASPROPYRGOS
  - LAVRIO
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'FALIRO' AND h_end.name = 'AGISTRI';
  params:
  - FALIRO
  - AGISTRI
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-05-22 05:42:28, 2019-06-02 06:39:37]' FROM crossings c WHERE c.traj && tstzspan '[2019-05-22 05:42:28, 2019-06-02 06:39:37]';
  params:
  - - '2019-05-22 05:42:28'
    - '2019-06-02 06:39:37'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-06-11 23:59:53, 2019-06-18 10:18:40]' AND h.name = 'SIRI';
  params:
  - SIRI
  - - '2019-06-11 23:59:53'
    - '2019-06-18 10:18:40'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-01-01 00:00:01, 2019-01-15 00:51:06]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-01-01 00:00:01'
    - '2019-01-15 00:51:06'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-01-13 15:19:24, 2019-01-23 23:26:39]' AND h.name = 'CORINTH CANAL';
  params:
  - CORINTH CANAL
  - - '2019-01-13 15:19:24'
    - '2019-01-23 23:26:39'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 14 AND DATE(startTimestamp(c.traj)) = DATE '2019-01-22';
  params:
  - '2019-01-22'
  - 14
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-07-13 00:48:14, 2019-07-24 02:57:06]' AND h.name = 'CORINTH';
  params:
  - CORINTH
  - - '2019-07-13 00:48:14'
    - '2019-07-24 02:57:06'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-09-21 01:43:54, 2019-09-29 20:30:47]' AND h.name = 'AGIOS KOSMAS';
  params:
  - AGIOS KOSMAS
  - - '2019-09-21 01:43:54'
    - '2019-09-29 20:30:47'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'FLISVOS' AND h_end.name = 'LAVRIO';
  params:
  - FLISVOS
  - LAVRIO
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-03-09 16:38:03, 2019-03-15 19:03:27]' AND h.name = 'FLISVOS';
  params:
  - FLISVOS
  - - '2019-03-09 16:38:03'
    - '2019-03-15 19:03:27'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-04-09 13:08:48, 2019-04-13 06:08:36]' FROM crossings c WHERE c.traj && tstzspan '[2019-04-09 13:08:48, 2019-04-13 06:08:36]';
  params:
  - - '2019-04-09 13:08:48'
    - '2019-04-13 06:08:36'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'PIRAEUS' AND h_end.name = 'AGISTRI';
  params:
  - PIRAEUS
  - AGISTRI
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 12 AND DATE(startTimestamp(c.traj)) = DATE '2019-01-31';
  params:
  - '2019-01-31'
  - 12
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-03-04 16:57:46, 2019-03-07 08:14:14]' FROM crossings c WHERE c.traj && tstzspan '[2019-03-04 16:57:46, 2019-03-07 08:14:14]';
  params:
  - - '2019-03-04 16:57:46'
    - '2019-03-07 08:14:14'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-09-15 09:23:43, 2019-09-20 21:35:47]' FROM crossings c WHERE c.traj && tstzspan '[2019-09-15 09:23:43, 2019-09-20 21:35:47]';
  params:
  - - '2019-09-15 09:23:43'
    - '2019-09-20 21:35:47'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-10-07 06:57:32, 2019-10-15 04:15:07]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-10-07 06:57:32'
    - '2019-10-15 04:15:07'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-10-07 21:34:29, 2019-10-20 05:59:54]' FROM crossings c WHERE c.traj && tstzspan '[2019-10-07 21:34:29, 2019-10-20 05:59:54]';
  params:
  - - '2019-10-07 21:34:29'
    - '2019-10-20 05:59:54'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'AEGINA' AND h_end.name = 'ZEA';
  params:
  - AEGINA
  - ZEA
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-04-18 14:23:50, 2019-04-20 23:39:18]' FROM crossings c WHERE c.traj && tstzspan '[2019-04-18 14:23:50, 2019-04-20 23:39:18]';
  params:
  - - '2019-04-18 14:23:50'
    - '2019-04-20 23:39:18'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-04-11 09:03:48, 2019-04-24 06:58:32]' AND h.name = 'ERMIONI';
  params:
  - ERMIONI
  - - '2019-04-11 09:03:48'
    - '2019-04-24 06:58:32'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-10-23 04:20:16, 2019-10-26 21:03:28]' AND h.name = 'ZEA';
  params:
  - ZEA
  - - '2019-10-23 04:20:16'
    - '2019-10-26 21:03:28'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-06-30 04:06:52, 2019-07-07 18:58:16]' AND h.name = 'CORINTH CANAL';
  params:
  - CORINTH CANAL
  - - '2019-06-30 04:06:52'
    - '2019-07-07 18:58:16'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-08-27 03:07:36, 2019-08-30 15:24:42]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-08-27 03:07:36'
    - '2019-08-30 15:24:42'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-08-05 01:05:19, 2019-08-18 11:12:54]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-08-05 01:05:19'
    - '2019-08-18 11:12:54'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'LAVRIO' AND h_end.name = 'CORINTH';
  params:
  - LAVRIO
  - CORINTH
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'ERMIONI' AND h_end.name = 'LAVRIO';
  params:
  - ERMIONI
  - LAVRIO
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-07-20 12:35:03, 2019-08-01 01:46:28]' AND h.name = 'ALIMOS';
  params:
  - ALIMOS
  - - '2019-07-20 12:35:03'
    - '2019-08-01 01:46:28'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-10-13 07:35:31, 2019-10-27 15:20:35]' FROM crossings c WHERE c.traj && tstzspan '[2019-10-13 07:35:31, 2019-10-27 15:20:35]';
  params:
  - - '2019-10-13 07:35:31'
    - '2019-10-27 15:20:35'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-03-12 11:47:28, 2019-03-23 13:36:13]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-03-12 11:47:28'
    - '2019-03-23 13:36:13'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'FANEROMENI' AND h_end.name = 'FALIRO';
  params:
  - FANEROMENI
  - FALIRO
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-08-06 19:31:59, 2019-08-20 18:15:50]' FROM crossings c WHERE c.traj && tstzspan '[2019-08-06 19:31:59, 2019-08-20 18:15:50]';
  params:
  - - '2019-08-06 19:31:59'
    - '2019-08-20 18:15:50'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Ydrousa' GROUP BY i.name;
  params:
  - Ydrousa
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-10-27 17:49:05, 2019-11-02 11:37:03]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-10-27 17:49:05'
    - '2019-11-02 11:37:03'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 5 AND DATE(startTimestamp(c.traj)) = DATE '2019-05-13';
  params:
  - '2019-05-13'
  - 5
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-10-25 17:55:26, 2019-10-28 06:19:45]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-10-25 17:55:26'
    - '2019-10-28 06:19:45'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 11 AND DATE(startTimestamp(c.traj)) = DATE '2019-01-19';
  params:
  - '2019-01-19'
  - 11
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Nisis Metopi' GROUP BY i.name;
  params:
  - Nisis Metopi
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'PIRAEUS' AND h_end.name = 'SOUSAKI';
  params:
  - PIRAEUS
  - SOUSAKI
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-12-04 00:15:31, 2019-12-08 11:12:12]' AND h.name = 'FALIRO';
  params:
  - FALIRO
  - - '2019-12-04 00:15:31'
    - '2019-12-08 11:12:12'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-05-04 22:44:41, 2019-05-10 23:05:12]' FROM crossings c WHERE c.traj && tstzspan '[2019-05-04 22:44:41, 2019-05-10 23:05:12]';
  params:
  - - '2019-05-04 22:44:41'
    - '2019-05-10 23:05:12'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-12-23 01:54:54, 2019-12-30 09:18:13]' AND h.name = 'FLISVOS';
  params:
  - FLISVOS
  - - '2019-12-23 01:54:54'
    - '2019-12-30 09:18:13'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-09-20 18:59:39, 2019-09-26 19:01:07]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-09-20 18:59:39'
    - '2019-09-26 19:01:07'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-08-26 17:22:06, 2019-09-07 19:13:09]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-08-26 17:22:06'
    - '2019-09-07 19:13:09'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-05-26 21:59:54, 2019-05-31 18:52:49]' FROM crossings c WHERE c.traj && tstzspan '[2019-05-26 21:59:54, 2019-05-31 18:52:49]';
  params:
  - - '2019-05-26 21:59:54'
    - '2019-05-31 18:52:49'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-05-08 10:54:30, 2019-05-20 23:47:59]' AND h.name = 'SIRI';
  params:
  - SIRI
  - - '2019-05-08 10:54:30'
    - '2019-05-20 23:47:59'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-08-07 13:21:54, 2019-08-09 21:23:16]' AND h.name = 'CORINTH CANAL';
  params:
  - CORINTH CANAL
  - - '2019-08-07 13:21:54'
    - '2019-08-09 21:23:16'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-06-14 12:45:55, 2019-06-26 21:24:11]' FROM crossings c WHERE c.traj && tstzspan '[2019-06-14 12:45:55, 2019-06-26 21:24:11]';
  params:
  - - '2019-06-14 12:45:55'
    - '2019-06-26 21:24:11'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Vrachonisis Moladi' GROUP BY i.name;
  params:
  - Vrachonisis Moladi
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-09-08 07:54:40, 2019-09-17 12:40:11]' AND h.name = 'AGISTRI';
  params:
  - AGISTRI
  - - '2019-09-08 07:54:40'
    - '2019-09-17 12:40:11'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-04-05 03:58:00, 2019-04-08 15:01:18]' AND h.name = 'FANEROMENI';
  params:
  - FANEROMENI
  - - '2019-04-05 03:58:00'
    - '2019-04-08 15:01:18'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 2 AND DATE(startTimestamp(c.traj)) = DATE '2019-04-03';
  params:
  - '2019-04-03'
  - 2
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-07-08 14:55:19, 2019-07-15 18:04:58]' AND h.name = 'RAFINA';
  params:
  - RAFINA
  - - '2019-07-08 14:55:19'
    - '2019-07-15 18:04:58'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Nisis Metopi' GROUP BY i.name;
  params:
  - Nisis Metopi
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Trakhyli' GROUP BY i.name;
  params:
  - Trakhyli
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-11-21 06:37:00, 2019-12-03 14:28:56]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-11-21 06:37:00'
    - '2019-12-03 14:28:56'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Nisis Pachaki' GROUP BY i.name;
  params:
  - Nisis Pachaki
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-10-13 10:39:01, 2019-10-28 00:28:30]' AND h.name = 'AGIOI THEODORI';
  params:
  - AGIOI THEODORI
  - - '2019-10-13 10:39:01'
    - '2019-10-28 00:28:30'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Nisis Atalanti' GROUP BY i.name;
  params:
  - Nisis Atalanti
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-08-21 00:21:15, 2019-08-24 12:40:02]' AND h.name = 'ELEFSIS';
  params:
  - ELEFSIS
  - - '2019-08-21 00:21:15'
    - '2019-08-24 12:40:02'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-03-28 07:00:34, 2019-04-02 10:11:02]' FROM crossings c WHERE c.traj && tstzspan '[2019-03-28 07:00:34, 2019-04-02 10:11:02]';
  params:
  - - '2019-03-28 07:00:34'
    - '2019-04-02 10:11:02'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-01-01 00:00:01, 2019-01-09 23:04:12]' FROM crossings c WHERE c.traj && tstzspan '[2019-01-01 00:00:01, 2019-01-09 23:04:12]';
  params:
  - - '2019-01-01 00:00:01'
    - '2019-01-09 23:04:12'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-10-25 19:26:36, 2019-10-30 04:09:07]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-10-25 19:26:36'
    - '2019-10-30 04:09:07'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'FANEROMENI' AND h_end.name = 'ALIMOS';
  params:
  - FANEROMENI
  - ALIMOS
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-11-08 16:46:28, 2019-11-20 22:48:04]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-11-08 16:46:28'
    - '2019-11-20 22:48:04'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Vrachonisis Petronisi' GROUP BY i.name;
  params:
  - Vrachonisis Petronisi
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-05-21 00:34:20, 2019-05-27 15:43:05]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-05-21 00:34:20'
    - '2019-05-27 15:43:05'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-12-11 05:24:13, 2019-12-21 12:47:49]' FROM crossings c WHERE c.traj && tstzspan '[2019-12-11 05:24:13, 2019-12-21 12:47:49]';
  params:
  - - '2019-12-11 05:24:13'
    - '2019-12-21 12:47:49'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-07-18 08:48:59, 2019-07-20 19:55:36]' FROM crossings c WHERE c.traj && tstzspan '[2019-07-18 08:48:59, 2019-07-20 19:55:36]';
  params:
  - - '2019-07-18 08:48:59'
    - '2019-07-20 19:55:36'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'CORINTH' AND h_end.name = 'ERMIONI';
  params:
  - CORINTH
  - ERMIONI
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Nisis Ledou' GROUP BY i.name;
  params:
  - Nisis Ledou
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-08-23 00:56:18, 2019-08-26 23:47:53]' AND h.name = 'AGISTRI';
  params:
  - AGISTRI
  - - '2019-08-23 00:56:18'
    - '2019-08-26 23:47:53'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'SOUSAKI' AND h_end.name = 'ERMIONI';
  params:
  - SOUSAKI
  - ERMIONI
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-05-29 13:47:39, 2019-06-05 02:12:57]' FROM crossings c WHERE c.traj && tstzspan '[2019-05-29 13:47:39, 2019-06-05 02:12:57]';
  params:
  - - '2019-05-29 13:47:39'
    - '2019-06-05 02:12:57'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Nisis Stakhtorroyi' GROUP BY i.name;
  params:
  - Nisis Stakhtorroyi
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'LAVRIO' AND h_end.name = 'ELEFSIS';
  params:
  - LAVRIO
  - ELEFSIS
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 13 AND DATE(startTimestamp(c.traj)) = DATE '2019-06-18';
  params:
  - '2019-06-18'
  - 13
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'CORINTH' AND h_end.name = 'PERAMA';
  params:
  - CORINTH
  - PERAMA
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'FALIRO' AND h_end.name = 'FLISVOS';
  params:
  - FALIRO
  - FLISVOS
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-03-19 17:18:03, 2019-03-23 06:57:45]' AND h.name = 'ELEFSIS';
  params:
  - ELEFSIS
  - - '2019-03-19 17:18:03'
    - '2019-03-23 06:57:45'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 20 AND DATE(startTimestamp(c.traj)) = DATE '2019-08-02';
  params:
  - '2019-08-02'
  - 20
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-09-24 01:47:32, 2019-10-04 13:10:17]' AND h.name = 'CORINTH';
  params:
  - CORINTH
  - - '2019-09-24 01:47:32'
    - '2019-10-04 13:10:17'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 8 AND DATE(startTimestamp(c.traj)) = DATE '2019-11-23';
  params:
  - '2019-11-23'
  - 8
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Nisis Atalanti' GROUP BY i.name;
  params:
  - Nisis Atalanti
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Nisis Pachaki' GROUP BY i.name;
  params:
  - Nisis Pachaki
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-06-26 20:00:16, 2019-07-06 23:56:52]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-06-26 20:00:16'
    - '2019-07-06 23:56:52'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-05-19 18:58:03, 2019-05-29 09:54:04]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-05-19 18:58:03'
    - '2019-05-29 09:54:04'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Vrachonisis Moladi' GROUP BY i.name;
  params:
  - Vrachonisis Moladi
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Anagnostis' GROUP BY i.name;
  params:
  - Anagnostis
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-06-13 06:49:26, 2019-06-22 12:19:47]' AND h.name = 'AEGINA';
  params:
  - AEGINA
  - - '2019-06-13 06:49:26'
    - '2019-06-22 12:19:47'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'PERAMA' AND h_end.name = 'AEGINA';
  params:
  - PERAMA
  - AEGINA
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-11-05 06:34:11, 2019-11-09 03:36:47]' AND h.name = 'AGIOI THEODORI';
  params:
  - AGIOI THEODORI
  - - '2019-11-05 06:34:11'
    - '2019-11-09 03:36:47'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-02-14 21:30:49, 2019-02-26 18:11:23]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-02-14 21:30:49'
    - '2019-02-26 18:11:23'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-11-05 23:55:01, 2019-11-13 08:43:11]' FROM crossings c WHERE c.traj && tstzspan '[2019-11-05 23:55:01, 2019-11-13 08:43:11]';
  params:
  - - '2019-11-05 23:55:01'
    - '2019-11-13 08:43:11'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-02-22 05:59:07, 2019-03-04 08:18:16]' AND h.name = 'FLISVOS';
  params:
  - FLISVOS
  - - '2019-02-22 05:59:07'
    - '2019-03-04 08:18:16'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-10-26 17:33:06, 2019-11-09 14:48:53]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-10-26 17:33:06'
    - '2019-11-09 14:48:53'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-07-20 15:29:03, 2019-07-23 07:09:46]' AND h.name = 'FANEROMENI';
  params:
  - FANEROMENI
  - - '2019-07-20 15:29:03'
    - '2019-07-23 07:09:46'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-07-28 01:56:22, 2019-07-30 13:38:33]' AND h.name = 'ERMIONI';
  params:
  - ERMIONI
  - - '2019-07-28 01:56:22'
    - '2019-07-30 13:38:33'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'FLISVOS' AND h_end.name = 'SIRI';
  params:
  - FLISVOS
  - SIRI
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-06-19 22:15:10, 2019-06-26 20:15:26]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-06-19 22:15:10'
    - '2019-06-26 20:15:26'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-03-15 08:12:52, 2019-03-18 09:26:12]' AND h.name = 'RAFINA';
  params:
  - RAFINA
  - - '2019-03-15 08:12:52'
    - '2019-03-18 09:26:12'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-03-18 11:05:20, 2019-03-29 09:52:05]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-03-18 11:05:20'
    - '2019-03-29 09:52:05'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'ERMIONI' AND h_end.name = 'LAVRIO';
  params:
  - ERMIONI
  - LAVRIO
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Ydrousa' GROUP BY i.name;
  params:
  - Ydrousa
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-12-09 19:17:46, 2019-12-23 18:59:50]' AND h.name = 'FALIRO';
  params:
  - FALIRO
  - - '2019-12-09 19:17:46'
    - '2019-12-23 18:59:50'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-09-02 06:50:56, 2019-09-05 04:57:44]' AND h.name = 'ERMIONI';
  params:
  - ERMIONI
  - - '2019-09-02 06:50:56'
    - '2019-09-05 04:57:44'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-05-02 21:02:18, 2019-05-07 12:48:57]' AND h.name = 'RAFINA';
  params:
  - RAFINA
  - - '2019-05-02 21:02:18'
    - '2019-05-07 12:48:57'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 1 AND DATE(startTimestamp(c.traj)) = DATE '2019-06-26';
  params:
  - '2019-06-26'
  - 1
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 4 AND DATE(startTimestamp(c.traj)) = DATE '2019-09-10';
  params:
  - '2019-09-10'
  - 4
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-04-17 22:46:41, 2019-04-22 04:27:42]' FROM crossings c WHERE c.traj && tstzspan '[2019-04-17 22:46:41, 2019-04-22 04:27:42]';
  params:
  - - '2019-04-17 22:46:41'
    - '2019-04-22 04:27:42'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-06-28 03:50:40, 2019-07-08 01:26:54]' FROM crossings c WHERE c.traj && tstzspan '[2019-06-28 03:50:40, 2019-07-08 01:26:54]';
  params:
  - - '2019-06-28 03:50:40'
    - '2019-07-08 01:26:54'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 10 AND DATE(startTimestamp(c.traj)) = DATE '2019-05-20';
  params:
  - '2019-05-20'
  - 10
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 18 AND DATE(startTimestamp(c.traj)) = DATE '2019-12-20';
  params:
  - '2019-12-20'
  - 18
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 17 AND DATE(startTimestamp(c.traj)) = DATE '2019-02-23';
  params:
  - '2019-02-23'
  - 17
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-07-22 13:04:18, 2019-07-25 13:03:34]' AND h.name = 'AGIOI THEODORI';
  params:
  - AGIOI THEODORI
  - - '2019-07-22 13:04:18'
    - '2019-07-25 13:03:34'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'CORINTH CANAL' AND h_end.name = 'ELEFSIS';
  params:
  - CORINTH CANAL
  - ELEFSIS
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-11-01 08:05:43, 2019-11-11 13:46:05]' AND h.name = 'ERMIONI';
  params:
  - ERMIONI
  - - '2019-11-01 08:05:43'
    - '2019-11-11 13:46:05'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-04-28 03:35:08, 2019-05-01 12:29:28]' FROM crossings c WHERE c.traj && tstzspan '[2019-04-28 03:35:08, 2019-05-01 12:29:28]';
  params:
  - - '2019-04-28 03:35:08'
    - '2019-05-01 12:29:28'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'ELEFSIS' AND h_end.name = 'AGIOS KOSMAS';
  params:
  - ELEFSIS
  - AGIOS KOSMAS
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-03-13 01:31:11, 2019-03-22 13:55:54]' AND h.name = 'AGISTRI';
  params:
  - AGISTRI
  - - '2019-03-13 01:31:11'
    - '2019-03-22 13:55:54'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-01-05 21:34:15, 2019-01-08 18:51:08]' AND h.name = 'AGISTRI';
  params:
  - AGISTRI
  - - '2019-01-05 21:34:15'
    - '2019-01-08 18:51:08'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-06-01 01:15:12, 2019-06-08 19:49:53]' AND h.name = 'AGIOI THEODORI';
  params:
  - AGIOI THEODORI
  - - '2019-06-01 01:15:12'
    - '2019-06-08 19:49:53'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 3 AND DATE(startTimestamp(c.traj)) = DATE '2019-09-15';
  params:
  - '2019-09-15'
  - 3
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Nisida Kyra' GROUP BY i.name;
  params:
  - Nisida Kyra
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Makronisos' GROUP BY i.name;
  params:
  - Makronisos
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 11 AND DATE(startTimestamp(c.traj)) = DATE '2019-08-26';
  params:
  - '2019-08-26'
  - 11
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-11-25 12:20:33, 2019-12-04 11:58:40]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-11-25 12:20:33'
    - '2019-12-04 11:58:40'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-02-18 03:17:19, 2019-02-28 21:09:07]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-02-18 03:17:19'
    - '2019-02-28 21:09:07'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-03-09 04:51:34, 2019-03-19 14:05:45]' AND h.name = 'ALIMOS';
  params:
  - ALIMOS
  - - '2019-03-09 04:51:34'
    - '2019-03-19 14:05:45'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Revithousa' GROUP BY i.name;
  params:
  - Revithousa
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Aegina Moni' GROUP BY i.name;
  params:
  - Aegina Moni
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'CORINTH' AND h_end.name = 'ERMIONI';
  params:
  - CORINTH
  - ERMIONI
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-10-03 12:31:00, 2019-10-05 13:08:16]' FROM crossings c WHERE c.traj && tstzspan '[2019-10-03 12:31:00, 2019-10-05 13:08:16]';
  params:
  - - '2019-10-03 12:31:00'
    - '2019-10-05 13:08:16'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-05-20 03:30:17, 2019-06-01 18:55:54]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-05-20 03:30:17'
    - '2019-06-01 18:55:54'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-05-19 04:14:32, 2019-05-24 10:00:14]' FROM crossings c WHERE c.traj && tstzspan '[2019-05-19 04:14:32, 2019-05-24 10:00:14]';
  params:
  - - '2019-05-19 04:14:32'
    - '2019-05-24 10:00:14'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-02-03 01:22:04, 2019-02-11 13:09:29]' AND h.name = 'SOUSAKI';
  params:
  - SOUSAKI
  - - '2019-02-03 01:22:04'
    - '2019-02-11 13:09:29'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'AGIOI THEODORI' AND h_end.name = 'PIRAEUS';
  params:
  - AGIOI THEODORI
  - PIRAEUS
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'PERAMA' AND h_end.name = 'ZEA';
  params:
  - PERAMA
  - ZEA
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'PERAMA' AND h_end.name = 'ALIMOS';
  params:
  - PERAMA
  - ALIMOS
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'FLISVOS' AND h_end.name = 'FANEROMENI';
  params:
  - FLISVOS
  - FANEROMENI
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'RAFINA' AND h_end.name = 'ERMIONI';
  params:
  - RAFINA
  - ERMIONI
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-11-23 15:49:00, 2019-11-28 07:40:27]' FROM crossings c WHERE c.traj && tstzspan '[2019-11-23 15:49:00, 2019-11-28 07:40:27]';
  params:
  - - '2019-11-23 15:49:00'
    - '2019-11-28 07:40:27'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-06-18 22:27:52, 2019-06-22 15:34:02]' AND h.name = 'AGISTRI';
  params:
  - AGISTRI
  - - '2019-06-18 22:27:52'
    - '2019-06-22 15:34:02'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Phleva Island' GROUP BY i.name;
  params:
  - Phleva Island
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'LAVRIO' AND h_end.name = 'AGIOS KOSMAS';
  params:
  - LAVRIO
  - AGIOS KOSMAS
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-07-04 21:55:05, 2019-07-13 15:51:20]' AND h.name = 'ERMIONI';
  params:
  - ERMIONI
  - - '2019-07-04 21:55:05'
    - '2019-07-13 15:51:20'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-12-03 10:30:35, 2019-12-17 00:25:14]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-12-03 10:30:35'
    - '2019-12-17 00:25:14'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-07-08 21:11:13, 2019-07-18 17:46:08]' FROM crossings c WHERE c.traj && tstzspan '[2019-07-08 21:11:13, 2019-07-18 17:46:08]';
  params:
  - - '2019-07-08 21:11:13'
    - '2019-07-18 17:46:08'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-12-28 22:55:24, 2019-12-31 23:59:59]' AND h.name = 'ZEA';
  params:
  - ZEA
  - - '2019-12-28 22:55:24'
    - '2019-12-31 23:59:59'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-08-20 16:33:03, 2019-08-25 13:23:30]' AND h.name = 'FANEROMENI';
  params:
  - FANEROMENI
  - - '2019-08-20 16:33:03'
    - '2019-08-25 13:23:30'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'LAVRIO' AND h_end.name = 'AGISTRI';
  params:
  - LAVRIO
  - AGISTRI
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-06-10 01:14:54, 2019-06-17 19:12:49]' FROM crossings c WHERE c.traj && tstzspan '[2019-06-10 01:14:54, 2019-06-17 19:12:49]';
  params:
  - - '2019-06-10 01:14:54'
    - '2019-06-17 19:12:49'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Agios Ioannis' GROUP BY i.name;
  params:
  - Agios Ioannis
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'FALIRO' AND h_end.name = 'GLYFADA';
  params:
  - FALIRO
  - GLYFADA
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 3 AND DATE(startTimestamp(c.traj)) = DATE '2019-10-22';
  params:
  - '2019-10-22'
  - 3
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 9 AND DATE(startTimestamp(c.traj)) = DATE '2019-02-01';
  params:
  - '2019-02-01'
  - 9
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-01-15 07:14:17, 2019-01-27 00:25:16]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-01-15 07:14:17'
    - '2019-01-27 00:25:16'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 22 AND DATE(startTimestamp(c.traj)) = DATE '2019-05-18';
  params:
  - '2019-05-18'
  - 22
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-12-19 18:42:37, 2019-12-25 02:48:15]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-12-19 18:42:37'
    - '2019-12-25 02:48:15'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-07-05 06:47:01, 2019-07-12 14:17:30]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-07-05 06:47:01'
    - '2019-07-12 14:17:30'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-02-08 00:16:12, 2019-02-22 00:32:59]' AND h.name = 'SOUSAKI';
  params:
  - SOUSAKI
  - - '2019-02-08 00:16:12'
    - '2019-02-22 00:32:59'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-11-23 03:58:53, 2019-11-30 07:46:56]' FROM crossings c WHERE c.traj && tstzspan '[2019-11-23 03:58:53, 2019-11-30 07:46:56]';
  params:
  - - '2019-11-23 03:58:53'
    - '2019-11-30 07:46:56'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-12-12 12:46:56, 2019-12-20 03:56:16]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-12-12 12:46:56'
    - '2019-12-20 03:56:16'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-04-14 23:01:04, 2019-04-17 13:25:20]' FROM crossings c WHERE c.traj && tstzspan '[2019-04-14 23:01:04, 2019-04-17 13:25:20]';
  params:
  - - '2019-04-14 23:01:04'
    - '2019-04-17 13:25:20'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Kanakia' GROUP BY i.name;
  params:
  - Kanakia
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-12-24 20:29:22, 2019-12-29 22:13:15]' AND h.name = 'FANEROMENI';
  params:
  - FANEROMENI
  - - '2019-12-24 20:29:22'
    - '2019-12-29 22:13:15'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 21 AND DATE(startTimestamp(c.traj)) = DATE '2019-04-03';
  params:
  - '2019-04-03'
  - 21
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'CORINTH' AND h_end.name = 'RAFINA';
  params:
  - CORINTH
  - RAFINA
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-04-06 21:50:50, 2019-04-19 21:11:35]' FROM crossings c WHERE c.traj && tstzspan '[2019-04-06 21:50:50, 2019-04-19 21:11:35]';
  params:
  - - '2019-04-06 21:50:50'
    - '2019-04-19 21:11:35'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-10-17 04:30:00, 2019-10-22 23:10:01]' FROM crossings c WHERE c.traj && tstzspan '[2019-10-17 04:30:00, 2019-10-22 23:10:01]';
  params:
  - - '2019-10-17 04:30:00'
    - '2019-10-22 23:10:01'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'PERAMA' AND h_end.name = 'ASPROPYRGOS';
  params:
  - PERAMA
  - ASPROPYRGOS
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Ovrios' GROUP BY i.name;
  params:
  - Ovrios
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-02-06 15:41:23, 2019-02-20 04:29:02]' FROM crossings c WHERE c.traj && tstzspan '[2019-02-06 15:41:23, 2019-02-20 04:29:02]';
  params:
  - - '2019-02-06 15:41:23'
    - '2019-02-20 04:29:02'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 0 AND DATE(startTimestamp(c.traj)) = DATE '2019-02-03';
  params:
  - '2019-02-03'
  - 0
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 17 AND DATE(startTimestamp(c.traj)) = DATE '2019-04-10';
  params:
  - '2019-04-10'
  - 17
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-04-28 02:26:40, 2019-05-04 01:32:26]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-04-28 02:26:40'
    - '2019-05-04 01:32:26'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Nisis Atalanti' GROUP BY i.name;
  params:
  - Nisis Atalanti
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-06-27 19:41:58, 2019-07-01 15:09:30]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-06-27 19:41:58'
    - '2019-07-01 15:09:30'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'AEGINA' AND h_end.name = 'CORINTH';
  params:
  - AEGINA
  - CORINTH
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'AEGINA' AND h_end.name = 'CORINTH';
  params:
  - AEGINA
  - CORINTH
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Kordeliaris' GROUP BY i.name;
  params:
  - Kordeliaris
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-05-07 14:59:52, 2019-05-09 20:07:27]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-05-07 14:59:52'
    - '2019-05-09 20:07:27'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-12-05 18:59:28, 2019-12-15 14:21:29]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-12-05 18:59:28'
    - '2019-12-15 14:21:29'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'FLISVOS' AND h_end.name = 'CORINTH CANAL';
  params:
  - FLISVOS
  - CORINTH CANAL
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Revithousa' GROUP BY i.name;
  params:
  - Revithousa
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'ERMIONI' AND h_end.name = 'SIRI';
  params:
  - ERMIONI
  - SIRI
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'ALIMOS' AND h_end.name = 'ASPROPYRGOS';
  params:
  - ALIMOS
  - ASPROPYRGOS
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 0 AND DATE(startTimestamp(c.traj)) = DATE '2019-02-06';
  params:
  - '2019-02-06'
  - 0
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Anagnostis' GROUP BY i.name;
  params:
  - Anagnostis
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'AEGINA' AND h_end.name = 'ASPROPYRGOS';
  params:
  - AEGINA
  - ASPROPYRGOS
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-07-06 23:44:15, 2019-07-11 14:25:36]' AND h.name = 'AEGINA';
  params:
  - AEGINA
  - - '2019-07-06 23:44:15'
    - '2019-07-11 14:25:36'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-11-22 12:41:22, 2019-12-06 21:34:54]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-11-22 12:41:22'
    - '2019-12-06 21:34:54'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-10-10 22:09:53, 2019-10-18 00:15:24]' AND h.name = 'ELEFSIS';
  params:
  - ELEFSIS
  - - '2019-10-10 22:09:53'
    - '2019-10-18 00:15:24'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-04-24 13:57:07, 2019-05-09 07:00:25]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-04-24 13:57:07'
    - '2019-05-09 07:00:25'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 14 AND DATE(startTimestamp(c.traj)) = DATE '2019-03-03';
  params:
  - '2019-03-03'
  - 14
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-05-13 10:32:05, 2019-05-26 21:59:11]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-05-13 10:32:05'
    - '2019-05-26 21:59:11'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-11-22 18:12:45, 2019-12-01 07:57:36]' AND h.name = 'AGIOI THEODORI';
  params:
  - AGIOI THEODORI
  - - '2019-11-22 18:12:45'
    - '2019-12-01 07:57:36'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 20 AND DATE(startTimestamp(c.traj)) = DATE '2019-11-22';
  params:
  - '2019-11-22'
  - 20
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Daskalio' GROUP BY i.name;
  params:
  - Daskalio
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-03-28 15:58:18, 2019-04-02 22:13:39]' AND h.name = 'ELEFSIS';
  params:
  - ELEFSIS
  - - '2019-03-28 15:58:18'
    - '2019-04-02 22:13:39'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 11 AND DATE(startTimestamp(c.traj)) = DATE '2019-04-19';
  params:
  - '2019-04-19'
  - 11
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-02-22 14:56:03, 2019-02-27 07:32:37]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-02-22 14:56:03'
    - '2019-02-27 07:32:37'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-08-11 09:58:01, 2019-08-16 14:52:50]' FROM crossings c WHERE c.traj && tstzspan '[2019-08-11 09:58:01, 2019-08-16 14:52:50]';
  params:
  - - '2019-08-11 09:58:01'
    - '2019-08-16 14:52:50'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 1 AND DATE(startTimestamp(c.traj)) = DATE '2019-03-04';
  params:
  - '2019-03-04'
  - 1
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Vrachonisis Moladi' GROUP BY i.name;
  params:
  - Vrachonisis Moladi
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Prasou' GROUP BY i.name;
  params:
  - Prasou
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-04-09 16:11:16, 2019-04-14 07:20:43]' AND h.name = 'ERMIONI';
  params:
  - ERMIONI
  - - '2019-04-09 16:11:16'
    - '2019-04-14 07:20:43'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 7 AND DATE(startTimestamp(c.traj)) = DATE '2019-09-05';
  params:
  - '2019-09-05'
  - 7
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Agios Thomas' GROUP BY i.name;
  params:
  - Agios Thomas
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-06-07 11:16:13, 2019-06-20 13:37:22]' AND h.name = 'AGIOI THEODORI';
  params:
  - AGIOI THEODORI
  - - '2019-06-07 11:16:13'
    - '2019-06-20 13:37:22'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 8 AND DATE(startTimestamp(c.traj)) = DATE '2019-05-31';
  params:
  - '2019-05-31'
  - 8
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-10-24 05:01:02, 2019-11-07 03:35:22]' FROM crossings c WHERE c.traj && tstzspan '[2019-10-24 05:01:02, 2019-11-07 03:35:22]';
  params:
  - - '2019-10-24 05:01:02'
    - '2019-11-07 03:35:22'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Anagnostis' GROUP BY i.name;
  params:
  - Anagnostis
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Agistri' GROUP BY i.name;
  params:
  - Agistri
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 6 AND DATE(startTimestamp(c.traj)) = DATE '2019-08-20';
  params:
  - '2019-08-20'
  - 6
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 9 AND DATE(startTimestamp(c.traj)) = DATE '2019-03-23';
  params:
  - '2019-03-23'
  - 9
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-10-02 08:49:51, 2019-10-06 13:27:24]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-10-02 08:49:51'
    - '2019-10-06 13:27:24'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'AEGINA' AND h_end.name = 'LAVRIO';
  params:
  - AEGINA
  - LAVRIO
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-04-29 06:01:18, 2019-05-11 02:50:08]' FROM crossings c WHERE c.traj && tstzspan '[2019-04-29 06:01:18, 2019-05-11 02:50:08]';
  params:
  - - '2019-04-29 06:01:18'
    - '2019-05-11 02:50:08'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'AGIOI THEODORI' AND h_end.name = 'ZEA';
  params:
  - AGIOI THEODORI
  - ZEA
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'AGIOS KOSMAS' AND h_end.name = 'AEGINA';
  params:
  - AGIOS KOSMAS
  - AEGINA
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Trakhyli' GROUP BY i.name;
  params:
  - Trakhyli
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'AEGINA' AND h_end.name = 'ERMIONI';
  params:
  - AEGINA
  - ERMIONI
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'PIRAEUS' AND h_end.name = 'ASPROPYRGOS';
  params:
  - PIRAEUS
  - ASPROPYRGOS
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'PERAMA' AND h_end.name = 'GLYFADA';
  params:
  - PERAMA
  - GLYFADA
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-11-26 14:21:45, 2019-11-30 00:31:15]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-11-26 14:21:45'
    - '2019-11-30 00:31:15'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-09-10 18:41:21, 2019-09-22 15:52:23]' FROM crossings c WHERE c.traj && tstzspan '[2019-09-10 18:41:21, 2019-09-22 15:52:23]';
  params:
  - - '2019-09-10 18:41:21'
    - '2019-09-22 15:52:23'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-09-05 20:57:09, 2019-09-19 06:48:46]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-09-05 20:57:09'
    - '2019-09-19 06:48:46'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-08-18 11:34:36, 2019-08-29 05:20:49]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-08-18 11:34:36'
    - '2019-08-29 05:20:49'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'FALIRO' AND h_end.name = 'PIRAEUS';
  params:
  - FALIRO
  - PIRAEUS
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-09-06 22:53:49, 2019-09-21 22:12:29]' AND h.name = 'LAVRIO';
  params:
  - LAVRIO
  - - '2019-09-06 22:53:49'
    - '2019-09-21 22:12:29'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-02-20 13:22:20, 2019-02-24 06:18:29]' FROM crossings c WHERE c.traj && tstzspan '[2019-02-20 13:22:20, 2019-02-24 06:18:29]';
  params:
  - - '2019-02-20 13:22:20'
    - '2019-02-24 06:18:29'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-11-10 07:57:42, 2019-11-21 05:56:14]' FROM crossings c WHERE c.traj && tstzspan '[2019-11-10 07:57:42, 2019-11-21 05:56:14]';
  params:
  - - '2019-11-10 07:57:42'
    - '2019-11-21 05:56:14'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Kanakia' GROUP BY i.name;
  params:
  - Kanakia
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 21 AND DATE(startTimestamp(c.traj)) = DATE '2019-12-08';
  params:
  - '2019-12-08'
  - 21
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-08-26 21:00:53, 2019-09-05 09:35:31]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-08-26 21:00:53'
    - '2019-09-05 09:35:31'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 3 AND DATE(startTimestamp(c.traj)) = DATE '2019-05-12';
  params:
  - '2019-05-12'
  - 3
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-05-22 14:26:07, 2019-05-26 07:21:59]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-05-22 14:26:07'
    - '2019-05-26 07:21:59'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-07-20 22:51:42, 2019-07-25 04:58:57]' FROM crossings c WHERE c.traj && tstzspan '[2019-07-20 22:51:42, 2019-07-25 04:58:57]';
  params:
  - - '2019-07-20 22:51:42'
    - '2019-07-25 04:58:57'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-02-25 06:44:58, 2019-03-10 06:59:19]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-02-25 06:44:58'
    - '2019-03-10 06:59:19'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-01-02 23:45:54, 2019-01-11 11:54:09]' FROM crossings c WHERE c.traj && tstzspan '[2019-01-02 23:45:54, 2019-01-11 11:54:09]';
  params:
  - - '2019-01-02 23:45:54'
    - '2019-01-11 11:54:09'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Kourmouloudes' GROUP BY i.name;
  params:
  - Kourmouloudes
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'SIRI' AND h_end.name = 'FALIRO';
  params:
  - SIRI
  - FALIRO
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-05-24 02:52:20, 2019-05-29 13:02:57]' FROM crossings c WHERE c.traj && tstzspan '[2019-05-24 02:52:20, 2019-05-29 13:02:57]';
  params:
  - - '2019-05-24 02:52:20'
    - '2019-05-29 13:02:57'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Pachi' GROUP BY i.name;
  params:
  - Pachi
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-04-29 18:29:10, 2019-05-01 23:32:23]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-04-29 18:29:10'
    - '2019-05-01 23:32:23'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 1 AND DATE(startTimestamp(c.traj)) = DATE '2019-05-28';
  params:
  - '2019-05-28'
  - 1
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-03-03 17:33:27, 2019-03-17 10:37:18]' FROM crossings c WHERE c.traj && tstzspan '[2019-03-03 17:33:27, 2019-03-17 10:37:18]';
  params:
  - - '2019-03-03 17:33:27'
    - '2019-03-17 10:37:18'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-08-07 22:56:33, 2019-08-12 00:18:51]' FROM crossings c WHERE c.traj && tstzspan '[2019-08-07 22:56:33, 2019-08-12 00:18:51]';
  params:
  - - '2019-08-07 22:56:33'
    - '2019-08-12 00:18:51'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'GLYFADA' AND h_end.name = 'CORINTH CANAL';
  params:
  - GLYFADA
  - CORINTH CANAL
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'LAVRIO' AND h_end.name = 'GLYFADA';
  params:
  - LAVRIO
  - GLYFADA
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-03-18 05:23:53, 2019-03-20 12:55:28]' AND h.name = 'AGISTRI';
  params:
  - AGISTRI
  - - '2019-03-18 05:23:53'
    - '2019-03-20 12:55:28'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'FLISVOS' AND h_end.name = 'ASPROPYRGOS';
  params:
  - FLISVOS
  - ASPROPYRGOS
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Anagnostis' GROUP BY i.name;
  params:
  - Anagnostis
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 11 AND DATE(startTimestamp(c.traj)) = DATE '2019-03-11';
  params:
  - '2019-03-11'
  - 11
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 12 AND DATE(startTimestamp(c.traj)) = DATE '2019-11-06';
  params:
  - '2019-11-06'
  - 12
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Prasou' GROUP BY i.name;
  params:
  - Prasou
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Nisis Islet' GROUP BY i.name;
  params:
  - Nisis Islet
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Nisis Stakhtorroyi' GROUP BY i.name;
  params:
  - Nisis Stakhtorroyi
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Agios Thomas' GROUP BY i.name;
  params:
  - Agios Thomas
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-07-14 22:43:45, 2019-07-22 04:01:53]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-07-14 22:43:45'
    - '2019-07-22 04:01:53'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Kasidis' GROUP BY i.name;
  params:
  - Kasidis
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Makronisos' GROUP BY i.name;
  params:
  - Makronisos
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 18 AND DATE(startTimestamp(c.traj)) = DATE '2019-09-27';
  params:
  - '2019-09-27'
  - 18
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-01-26 07:23:10, 2019-02-09 15:11:39]' FROM crossings c WHERE c.traj && tstzspan '[2019-01-26 07:23:10, 2019-02-09 15:11:39]';
  params:
  - - '2019-01-26 07:23:10'
    - '2019-02-09 15:11:39'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-10-16 12:46:49, 2019-10-18 14:57:47]' FROM crossings c WHERE c.traj && tstzspan '[2019-10-16 12:46:49, 2019-10-18 14:57:47]';
  params:
  - - '2019-10-16 12:46:49'
    - '2019-10-18 14:57:47'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-05-08 19:20:14, 2019-05-11 19:06:18]' FROM crossings c WHERE c.traj && tstzspan '[2019-05-08 19:20:14, 2019-05-11 19:06:18]';
  params:
  - - '2019-05-08 19:20:14'
    - '2019-05-11 19:06:18'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Makronisos' GROUP BY i.name;
  params:
  - Makronisos
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'SIRI' AND h_end.name = 'PERAMA';
  params:
  - SIRI
  - PERAMA
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'FALIRO' AND h_end.name = 'SIRI';
  params:
  - FALIRO
  - SIRI
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Daskalio' GROUP BY i.name;
  params:
  - Daskalio
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Nisis Lagousa' GROUP BY i.name;
  params:
  - Nisis Lagousa
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-06-11 11:36:02, 2019-06-22 00:30:19]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-06-11 11:36:02'
    - '2019-06-22 00:30:19'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'AGISTRI' AND h_end.name = 'GLYFADA';
  params:
  - AGISTRI
  - GLYFADA
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-09-15 05:48:08, 2019-09-28 00:51:29]' AND h.name = 'AGIOS KOSMAS';
  params:
  - AGIOS KOSMAS
  - - '2019-09-15 05:48:08'
    - '2019-09-28 00:51:29'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-04-15 01:50:30, 2019-04-24 03:33:15]' AND h.name = 'AGISTRI';
  params:
  - AGISTRI
  - - '2019-04-15 01:50:30'
    - '2019-04-24 03:33:15'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-06-21 19:25:13, 2019-06-24 04:03:17]' AND h.name = 'PERAMA';
  params:
  - PERAMA
  - - '2019-06-21 19:25:13'
    - '2019-06-24 04:03:17'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'FLISVOS' AND h_end.name = 'AEGINA';
  params:
  - FLISVOS
  - AEGINA
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-12-13 17:58:33, 2019-12-17 18:30:58]' FROM crossings c WHERE c.traj && tstzspan '[2019-12-13 17:58:33, 2019-12-17 18:30:58]';
  params:
  - - '2019-12-13 17:58:33'
    - '2019-12-17 18:30:58'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-01-21 09:58:57, 2019-01-31 05:37:36]' FROM crossings c WHERE c.traj && tstzspan '[2019-01-21 09:58:57, 2019-01-31 05:37:36]';
  params:
  - - '2019-01-21 09:58:57'
    - '2019-01-31 05:37:36'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'SIRI' AND h_end.name = 'ERMIONI';
  params:
  - SIRI
  - ERMIONI
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 9 AND DATE(startTimestamp(c.traj)) = DATE '2019-04-29';
  params:
  - '2019-04-29'
  - 9
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Agios Thomas' GROUP BY i.name;
  params:
  - Agios Thomas
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-07-17 07:46:31, 2019-07-30 23:02:18]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-07-17 07:46:31'
    - '2019-07-30 23:02:18'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-07-02 18:53:08, 2019-07-16 09:33:26]' AND h.name = 'FALIRO';
  params:
  - FALIRO
  - - '2019-07-02 18:53:08'
    - '2019-07-16 09:33:26'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-03-31 06:46:54, 2019-04-07 20:46:20]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-03-31 06:46:54'
    - '2019-04-07 20:46:20'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-04-30 04:48:56, 2019-05-06 19:01:02]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-04-30 04:48:56'
    - '2019-05-06 19:01:02'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Agios Thomas' GROUP BY i.name;
  params:
  - Agios Thomas
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-02-05 09:24:08, 2019-02-16 12:50:34]' AND h.name = 'ALIMOS';
  params:
  - ALIMOS
  - - '2019-02-05 09:24:08'
    - '2019-02-16 12:50:34'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-11-23 10:19:09, 2019-12-04 15:56:07]' AND h.name = 'CORINTH';
  params:
  - CORINTH
  - - '2019-11-23 10:19:09'
    - '2019-12-04 15:56:07'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'AEGINA' AND h_end.name = 'ZEA';
  params:
  - AEGINA
  - ZEA
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-03-01 06:21:45, 2019-03-14 00:10:46]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-03-01 06:21:45'
    - '2019-03-14 00:10:46'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-04-30 04:34:03, 2019-05-03 20:23:29]' FROM crossings c WHERE c.traj && tstzspan '[2019-04-30 04:34:03, 2019-05-03 20:23:29]';
  params:
  - - '2019-04-30 04:34:03'
    - '2019-05-03 20:23:29'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Salamina' GROUP BY i.name;
  params:
  - Salamina
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-07-01 09:51:40, 2019-07-14 14:21:07]' FROM crossings c WHERE c.traj && tstzspan '[2019-07-01 09:51:40, 2019-07-14 14:21:07]';
  params:
  - - '2019-07-01 09:51:40'
    - '2019-07-14 14:21:07'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-06-25 15:07:36, 2019-07-04 01:07:28]' FROM crossings c WHERE c.traj && tstzspan '[2019-06-25 15:07:36, 2019-07-04 01:07:28]';
  params:
  - - '2019-06-25 15:07:36'
    - '2019-07-04 01:07:28'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-12-03 14:52:29, 2019-12-16 12:23:51]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-12-03 14:52:29'
    - '2019-12-16 12:23:51'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-05-11 10:03:27, 2019-05-21 19:57:23]' AND h.name = 'AGISTRI';
  params:
  - AGISTRI
  - - '2019-05-11 10:03:27'
    - '2019-05-21 19:57:23'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Nisis Ipsili' GROUP BY i.name;
  params:
  - Nisis Ipsili
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Nisis Pachaki' GROUP BY i.name;
  params:
  - Nisis Pachaki
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-03-12 23:43:17, 2019-03-16 02:31:40]' AND h.name = 'FLISVOS';
  params:
  - FLISVOS
  - - '2019-03-12 23:43:17'
    - '2019-03-16 02:31:40'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-10-07 22:50:33, 2019-10-13 07:45:36]' AND h.name = 'CORINTH CANAL';
  params:
  - CORINTH CANAL
  - - '2019-10-07 22:50:33'
    - '2019-10-13 07:45:36'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 3 AND DATE(startTimestamp(c.traj)) = DATE '2019-01-17';
  params:
  - '2019-01-17'
  - 3
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-05-28 23:14:26, 2019-06-08 14:16:46]' FROM crossings c WHERE c.traj && tstzspan '[2019-05-28 23:14:26, 2019-06-08 14:16:46]';
  params:
  - - '2019-05-28 23:14:26'
    - '2019-06-08 14:16:46'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 7 AND DATE(startTimestamp(c.traj)) = DATE '2019-05-29';
  params:
  - '2019-05-29'
  - 7
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'RAFINA' AND h_end.name = 'ALIMOS';
  params:
  - RAFINA
  - ALIMOS
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-07-16 00:29:50, 2019-07-24 02:37:50]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-07-16 00:29:50'
    - '2019-07-24 02:37:50'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-07-14 09:23:03, 2019-07-20 08:13:13]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-07-14 09:23:03'
    - '2019-07-20 08:13:13'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 10 AND DATE(startTimestamp(c.traj)) = DATE '2019-09-22';
  params:
  - '2019-09-22'
  - 10
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Gaidaros' GROUP BY i.name;
  params:
  - Gaidaros
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 2 AND DATE(startTimestamp(c.traj)) = DATE '2019-04-01';
  params:
  - '2019-04-01'
  - 2
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Ydrousa' GROUP BY i.name;
  params:
  - Ydrousa
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Nisis Ipsili' GROUP BY i.name;
  params:
  - Nisis Ipsili
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 13 AND DATE(startTimestamp(c.traj)) = DATE '2019-03-06';
  params:
  - '2019-03-06'
  - 13
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 18 AND DATE(startTimestamp(c.traj)) = DATE '2019-02-23';
  params:
  - '2019-02-23'
  - 18
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-01-13 14:10:34, 2019-01-18 13:50:15]' FROM crossings c WHERE c.traj && tstzspan '[2019-01-13 14:10:34, 2019-01-18 13:50:15]';
  params:
  - - '2019-01-13 14:10:34'
    - '2019-01-18 13:50:15'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-10-07 07:52:45, 2019-10-15 23:04:41]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-10-07 07:52:45'
    - '2019-10-15 23:04:41'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-10-22 12:49:34, 2019-10-25 05:05:27]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-10-22 12:49:34'
    - '2019-10-25 05:05:27'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-07-21 16:26:10, 2019-07-26 08:33:07]' AND h.name = 'ASPROPYRGOS';
  params:
  - ASPROPYRGOS
  - - '2019-07-21 16:26:10'
    - '2019-07-26 08:33:07'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 16 AND DATE(startTimestamp(c.traj)) = DATE '2019-11-17';
  params:
  - '2019-11-17'
  - 16
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 1 AND DATE(startTimestamp(c.traj)) = DATE '2019-10-28';
  params:
  - '2019-10-28'
  - 1
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 3 AND DATE(startTimestamp(c.traj)) = DATE '2019-01-07';
  params:
  - '2019-01-07'
  - 3
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-09-12 15:14:41, 2019-09-20 16:46:39]' AND h.name = 'AGIOI THEODORI';
  params:
  - AGIOI THEODORI
  - - '2019-09-12 15:14:41'
    - '2019-09-20 16:46:39'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-11-30 02:32:00, 2019-12-09 03:09:00]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-11-30 02:32:00'
    - '2019-12-09 03:09:00'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Ovrios' GROUP BY i.name;
  params:
  - Ovrios
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 12 AND DATE(startTimestamp(c.traj)) = DATE '2019-11-01';
  params:
  - '2019-11-01'
  - 12
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-05-22 07:22:30, 2019-05-27 20:48:56]' AND h.name = 'AGIOI THEODORI';
  params:
  - AGIOI THEODORI
  - - '2019-05-22 07:22:30'
    - '2019-05-27 20:48:56'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-04-09 20:12:28, 2019-04-20 00:25:11]' AND h.name = 'CORINTH CANAL';
  params:
  - CORINTH CANAL
  - - '2019-04-09 20:12:28'
    - '2019-04-20 00:25:11'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Nisis Metopi' GROUP BY i.name;
  params:
  - Nisis Metopi
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-05-25 11:13:51, 2019-06-08 05:00:39]' AND h.name = 'AEGINA';
  params:
  - AEGINA
  - - '2019-05-25 11:13:51'
    - '2019-06-08 05:00:39'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'AGIOS KOSMAS' AND h_end.name = 'PIRAEUS';
  params:
  - AGIOS KOSMAS
  - PIRAEUS
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-10-08 10:19:17, 2019-10-11 01:14:15]' AND h.name = 'SOUSAKI';
  params:
  - SOUSAKI
  - - '2019-10-08 10:19:17'
    - '2019-10-11 01:14:15'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Phleva Island' GROUP BY i.name;
  params:
  - Phleva Island
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'AEGINA' AND h_end.name = 'ZEA';
  params:
  - AEGINA
  - ZEA
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-06-27 09:20:57, 2019-07-07 09:46:40]' FROM crossings c WHERE c.traj && tstzspan '[2019-06-27 09:20:57, 2019-07-07 09:46:40]';
  params:
  - - '2019-06-27 09:20:57'
    - '2019-07-07 09:46:40'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-07-17 22:05:18, 2019-07-21 14:59:47]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-07-17 22:05:18'
    - '2019-07-21 14:59:47'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 0 AND DATE(startTimestamp(c.traj)) = DATE '2019-08-10';
  params:
  - '2019-08-10'
  - 0
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'CORINTH' AND h_end.name = 'LAVRIO';
  params:
  - CORINTH
  - LAVRIO
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-05-14 17:54:59, 2019-05-21 18:51:37]' FROM crossings c WHERE c.traj && tstzspan '[2019-05-14 17:54:59, 2019-05-21 18:51:37]';
  params:
  - - '2019-05-14 17:54:59'
    - '2019-05-21 18:51:37'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-09-26 01:17:40, 2019-09-30 23:32:21]' FROM crossings c WHERE c.traj && tstzspan '[2019-09-26 01:17:40, 2019-09-30 23:32:21]';
  params:
  - - '2019-09-26 01:17:40'
    - '2019-09-30 23:32:21'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'CORINTH' AND h_end.name = 'ERMIONI';
  params:
  - CORINTH
  - ERMIONI
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Makronisos' GROUP BY i.name;
  params:
  - Makronisos
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 9 AND DATE(startTimestamp(c.traj)) = DATE '2019-09-20';
  params:
  - '2019-09-20'
  - 9
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 15 AND DATE(startTimestamp(c.traj)) = DATE '2019-08-19';
  params:
  - '2019-08-19'
  - 15
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-12-16 02:04:49, 2019-12-24 02:54:44]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-12-16 02:04:49'
    - '2019-12-24 02:54:44'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-03-20 17:14:44, 2019-03-27 11:54:38]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-03-20 17:14:44'
    - '2019-03-27 11:54:38'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 2 AND DATE(startTimestamp(c.traj)) = DATE '2019-10-28';
  params:
  - '2019-10-28'
  - 2
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-11-26 22:31:35, 2019-12-07 10:24:14]' AND h.name = 'GLYFADA';
  params:
  - GLYFADA
  - - '2019-11-26 22:31:35'
    - '2019-12-07 10:24:14'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-04-15 01:52:24, 2019-04-20 07:02:34]' AND h.name = 'RAFINA';
  params:
  - RAFINA
  - - '2019-04-15 01:52:24'
    - '2019-04-20 07:02:34'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'FANEROMENI' AND h_end.name = 'AGIOS KOSMAS';
  params:
  - FANEROMENI
  - AGIOS KOSMAS
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-02-14 23:34:16, 2019-02-18 14:28:18]' FROM crossings c WHERE c.traj && tstzspan '[2019-02-14 23:34:16, 2019-02-18 14:28:18]';
  params:
  - - '2019-02-14 23:34:16'
    - '2019-02-18 14:28:18'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-01-01 00:00:01, 2019-01-13 18:28:01]' AND h.name = 'AGISTRI';
  params:
  - AGISTRI
  - - '2019-01-01 00:00:01'
    - '2019-01-13 18:28:01'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-04-04 09:10:02, 2019-04-06 22:31:14]' FROM crossings c WHERE c.traj && tstzspan '[2019-04-04 09:10:02, 2019-04-06 22:31:14]';
  params:
  - - '2019-04-04 09:10:02'
    - '2019-04-06 22:31:14'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-06-28 18:56:59, 2019-06-30 22:28:32]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-06-28 18:56:59'
    - '2019-06-30 22:28:32'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Nisis Stakhtorroyi' GROUP BY i.name;
  params:
  - Nisis Stakhtorroyi
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Arsida' GROUP BY i.name;
  params:
  - Arsida
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-03-23 02:23:16, 2019-04-05 07:32:27]' FROM crossings c WHERE c.traj && tstzspan '[2019-03-23 02:23:16, 2019-04-05 07:32:27]';
  params:
  - - '2019-03-23 02:23:16'
    - '2019-04-05 07:32:27'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-06-11 22:16:22, 2019-06-21 10:50:49]' FROM crossings c WHERE c.traj && tstzspan '[2019-06-11 22:16:22, 2019-06-21 10:50:49]';
  params:
  - - '2019-06-11 22:16:22'
    - '2019-06-21 10:50:49'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'FLISVOS' AND h_end.name = 'FALIRO';
  params:
  - FLISVOS
  - FALIRO
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-10-03 07:16:03, 2019-10-16 14:06:19]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-10-03 07:16:03'
    - '2019-10-16 14:06:19'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-09-21 02:41:33, 2019-09-23 21:29:50]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-09-21 02:41:33'
    - '2019-09-23 21:29:50'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Aegina Moni' GROUP BY i.name;
  params:
  - Aegina Moni
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'FANEROMENI' AND h_end.name = 'FLISVOS';
  params:
  - FANEROMENI
  - FLISVOS
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-07-10 04:40:50, 2019-07-15 17:11:38]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-07-10 04:40:50'
    - '2019-07-15 17:11:38'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'ELEFSIS' AND h_end.name = 'FLISVOS';
  params:
  - ELEFSIS
  - FLISVOS
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-09-26 17:22:13, 2019-10-08 06:15:13]' AND h.name = 'SIRI';
  params:
  - SIRI
  - - '2019-09-26 17:22:13'
    - '2019-10-08 06:15:13'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'CORINTH' AND h_end.name = 'PIRAEUS';
  params:
  - CORINTH
  - PIRAEUS
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 0 AND DATE(startTimestamp(c.traj)) = DATE '2019-12-29';
  params:
  - '2019-12-29'
  - 0
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-06-23 10:41:03, 2019-07-03 04:35:50]' FROM crossings c WHERE c.traj && tstzspan '[2019-06-23 10:41:03, 2019-07-03 04:35:50]';
  params:
  - - '2019-06-23 10:41:03'
    - '2019-07-03 04:35:50'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'ZEA' AND h_end.name = 'ZEA';
  params:
  - ZEA
  - ZEA
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Kavouronisi' GROUP BY i.name;
  params:
  - Kavouronisi
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-04-06 00:56:19, 2019-04-18 03:34:08]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-04-06 00:56:19'
    - '2019-04-18 03:34:08'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'SOUSAKI' AND h_end.name = 'FANEROMENI';
  params:
  - SOUSAKI
  - FANEROMENI
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-11-22 06:16:58, 2019-11-28 14:33:45]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-11-22 06:16:58'
    - '2019-11-28 14:33:45'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-06-29 20:34:49, 2019-07-11 07:23:37]' FROM crossings c WHERE c.traj && tstzspan '[2019-06-29 20:34:49, 2019-07-11 07:23:37]';
  params:
  - - '2019-06-29 20:34:49'
    - '2019-07-11 07:23:37'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Kourmouloudes' GROUP BY i.name;
  params:
  - Kourmouloudes
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-04-02 06:43:52, 2019-04-08 07:51:30]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-04-02 06:43:52'
    - '2019-04-08 07:51:30'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Psittalia' GROUP BY i.name;
  params:
  - Psittalia
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'ELEFSIS' AND h_end.name = 'PIRAEUS';
  params:
  - ELEFSIS
  - PIRAEUS
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Vrachonisis Tragonisi' GROUP BY i.name;
  params:
  - Vrachonisis Tragonisi
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-10-22 03:08:54, 2019-11-04 17:23:57]' FROM crossings c WHERE c.traj && tstzspan '[2019-10-22 03:08:54, 2019-11-04 17:23:57]';
  params:
  - - '2019-10-22 03:08:54'
    - '2019-11-04 17:23:57'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'ERMIONI' AND h_end.name = 'AGIOI THEODORI';
  params:
  - ERMIONI
  - AGIOI THEODORI
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-10-29 04:53:28, 2019-11-06 18:35:26]' AND h.name = 'ZEA';
  params:
  - ZEA
  - - '2019-10-29 04:53:28'
    - '2019-11-06 18:35:26'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-01-30 18:58:27, 2019-02-05 19:26:16]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-01-30 18:58:27'
    - '2019-02-05 19:26:16'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-02-26 18:52:13, 2019-03-02 20:01:40]' FROM crossings c WHERE c.traj && tstzspan '[2019-02-26 18:52:13, 2019-03-02 20:01:40]';
  params:
  - - '2019-02-26 18:52:13'
    - '2019-03-02 20:01:40'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-12-29 03:03:00, 2019-12-31 23:59:59]' AND h.name = 'CORINTH';
  params:
  - CORINTH
  - - '2019-12-29 03:03:00'
    - '2019-12-31 23:59:59'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-09-18 17:01:35, 2019-09-21 15:35:32]' AND h.name = 'FLISVOS';
  params:
  - FLISVOS
  - - '2019-09-18 17:01:35'
    - '2019-09-21 15:35:32'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'FLISVOS' AND h_end.name = 'PERAMA';
  params:
  - FLISVOS
  - PERAMA
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-10-24 14:14:57, 2019-10-30 04:43:15]' FROM crossings c WHERE c.traj && tstzspan '[2019-10-24 14:14:57, 2019-10-30 04:43:15]';
  params:
  - - '2019-10-24 14:14:57'
    - '2019-10-30 04:43:15'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'PIRAEUS' AND h_end.name = 'FALIRO';
  params:
  - PIRAEUS
  - FALIRO
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Makronisos' GROUP BY i.name;
  params:
  - Makronisos
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-08-27 11:55:42, 2019-09-06 05:14:26]' FROM crossings c WHERE c.traj && tstzspan '[2019-08-27 11:55:42, 2019-09-06 05:14:26]';
  params:
  - - '2019-08-27 11:55:42'
    - '2019-09-06 05:14:26'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 17 AND DATE(startTimestamp(c.traj)) = DATE '2019-05-27';
  params:
  - '2019-05-27'
  - 17
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-06-15 03:18:39, 2019-06-20 12:31:13]' AND h.name = 'SOUSAKI';
  params:
  - SOUSAKI
  - - '2019-06-15 03:18:39'
    - '2019-06-20 12:31:13'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'AGIOI THEODORI' AND h_end.name = 'ERMIONI';
  params:
  - AGIOI THEODORI
  - ERMIONI
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-05-14 20:59:40, 2019-05-17 03:23:16]' AND h.name = 'ASPROPYRGOS';
  params:
  - ASPROPYRGOS
  - - '2019-05-14 20:59:40'
    - '2019-05-17 03:23:16'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 20 AND DATE(startTimestamp(c.traj)) = DATE '2019-12-03';
  params:
  - '2019-12-03'
  - 20
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 10 AND DATE(startTimestamp(c.traj)) = DATE '2019-08-06';
  params:
  - '2019-08-06'
  - 10
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Kordeliaris' GROUP BY i.name;
  params:
  - Kordeliaris
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-10-19 05:50:31, 2019-10-30 16:37:12]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-10-19 05:50:31'
    - '2019-10-30 16:37:12'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 5 AND DATE(startTimestamp(c.traj)) = DATE '2019-03-24';
  params:
  - '2019-03-24'
  - 5
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'ELEFSIS' AND h_end.name = 'AEGINA';
  params:
  - ELEFSIS
  - AEGINA
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-03-19 00:55:30, 2019-03-23 12:41:32]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-03-19 00:55:30'
    - '2019-03-23 12:41:32'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-08-27 15:50:56, 2019-09-11 07:22:38]' AND h.name = 'RAFINA';
  params:
  - RAFINA
  - - '2019-08-27 15:50:56'
    - '2019-09-11 07:22:38'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-01-30 20:10:56, 2019-02-12 20:21:51]' FROM crossings c WHERE c.traj && tstzspan '[2019-01-30 20:10:56, 2019-02-12 20:21:51]';
  params:
  - - '2019-01-30 20:10:56'
    - '2019-02-12 20:21:51'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Anagnostis' GROUP BY i.name;
  params:
  - Anagnostis
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-09-13 16:01:02, 2019-09-22 20:54:26]' FROM crossings c WHERE c.traj && tstzspan '[2019-09-13 16:01:02, 2019-09-22 20:54:26]';
  params:
  - - '2019-09-13 16:01:02'
    - '2019-09-22 20:54:26'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Plateia' GROUP BY i.name;
  params:
  - Plateia
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-01-02 14:41:22, 2019-01-06 20:33:05]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-01-02 14:41:22'
    - '2019-01-06 20:33:05'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'CORINTH' AND h_end.name = 'ERMIONI';
  params:
  - CORINTH
  - ERMIONI
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 12 AND DATE(startTimestamp(c.traj)) = DATE '2019-02-17';
  params:
  - '2019-02-17'
  - 12
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-05-15 05:38:45, 2019-05-19 03:58:50]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-05-15 05:38:45'
    - '2019-05-19 03:58:50'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-10-15 11:03:23, 2019-10-23 15:38:14]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-10-15 11:03:23'
    - '2019-10-23 15:38:14'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-07-10 03:53:18, 2019-07-17 14:03:57]' FROM crossings c WHERE c.traj && tstzspan '[2019-07-10 03:53:18, 2019-07-17 14:03:57]';
  params:
  - - '2019-07-10 03:53:18'
    - '2019-07-17 14:03:57'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Nisis Islet' GROUP BY i.name;
  params:
  - Nisis Islet
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 17 AND DATE(startTimestamp(c.traj)) = DATE '2019-03-09';
  params:
  - '2019-03-09'
  - 17
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-09-30 00:10:52, 2019-10-02 13:19:15]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-09-30 00:10:52'
    - '2019-10-02 13:19:15'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-06-28 19:00:00, 2019-07-07 03:38:06]' FROM crossings c WHERE c.traj && tstzspan '[2019-06-28 19:00:00, 2019-07-07 03:38:06]';
  params:
  - - '2019-06-28 19:00:00'
    - '2019-07-07 03:38:06'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 10 AND DATE(startTimestamp(c.traj)) = DATE '2019-12-16';
  params:
  - '2019-12-16'
  - 10
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'FANEROMENI' AND h_end.name = 'FANEROMENI';
  params:
  - FANEROMENI
  - FANEROMENI
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 13 AND DATE(startTimestamp(c.traj)) = DATE '2019-12-08';
  params:
  - '2019-12-08'
  - 13
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-05-06 07:15:19, 2019-05-16 08:13:14]' FROM crossings c WHERE c.traj && tstzspan '[2019-05-06 07:15:19, 2019-05-16 08:13:14]';
  params:
  - - '2019-05-06 07:15:19'
    - '2019-05-16 08:13:14'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Nisis Ledou' GROUP BY i.name;
  params:
  - Nisis Ledou
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'GLYFADA' AND h_end.name = 'LAVRIO';
  params:
  - GLYFADA
  - LAVRIO
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Makronisos' GROUP BY i.name;
  params:
  - Makronisos
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-01-13 16:58:48, 2019-01-26 15:57:38]' AND h.name = 'ELEFSIS';
  params:
  - ELEFSIS
  - - '2019-01-13 16:58:48'
    - '2019-01-26 15:57:38'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-03-07 21:25:45, 2019-03-19 12:09:33]' FROM crossings c WHERE c.traj && tstzspan '[2019-03-07 21:25:45, 2019-03-19 12:09:33]';
  params:
  - - '2019-03-07 21:25:45'
    - '2019-03-19 12:09:33'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-03-18 07:27:10, 2019-03-21 18:13:05]' AND h.name = 'AGIOI THEODORI';
  params:
  - AGIOI THEODORI
  - - '2019-03-18 07:27:10'
    - '2019-03-21 18:13:05'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 16 AND DATE(startTimestamp(c.traj)) = DATE '2019-03-03';
  params:
  - '2019-03-03'
  - 16
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-11-06 11:26:22, 2019-11-19 12:39:43]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-11-06 11:26:22'
    - '2019-11-19 12:39:43'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-04-17 22:56:58, 2019-04-29 17:09:18]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-04-17 22:56:58'
    - '2019-04-29 17:09:18'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'RAFINA' AND h_end.name = 'ZEA';
  params:
  - RAFINA
  - ZEA
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-12-15 09:04:21, 2019-12-23 09:45:49]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-12-15 09:04:21'
    - '2019-12-23 09:45:49'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Nisis Pachaki' GROUP BY i.name;
  params:
  - Nisis Pachaki
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-10-28 21:08:04, 2019-11-12 01:54:34]' AND h.name = 'AGIOI THEODORI';
  params:
  - AGIOI THEODORI
  - - '2019-10-28 21:08:04'
    - '2019-11-12 01:54:34'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-11-26 12:52:19, 2019-12-07 16:52:34]' FROM crossings c WHERE c.traj && tstzspan '[2019-11-26 12:52:19, 2019-12-07 16:52:34]';
  params:
  - - '2019-11-26 12:52:19'
    - '2019-12-07 16:52:34'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Kourmouloudes' GROUP BY i.name;
  params:
  - Kourmouloudes
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'PIRAEUS' AND h_end.name = 'ALIMOS';
  params:
  - PIRAEUS
  - ALIMOS
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'ALIMOS' AND h_end.name = 'FANEROMENI';
  params:
  - ALIMOS
  - FANEROMENI
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-01-07 08:17:57, 2019-01-12 12:28:18]' FROM crossings c WHERE c.traj && tstzspan '[2019-01-07 08:17:57, 2019-01-12 12:28:18]';
  params:
  - - '2019-01-07 08:17:57'
    - '2019-01-12 12:28:18'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'CORINTH' AND h_end.name = 'ERMIONI';
  params:
  - CORINTH
  - ERMIONI
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 1 AND DATE(startTimestamp(c.traj)) = DATE '2019-06-04';
  params:
  - '2019-06-04'
  - 1
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-04-24 02:13:11, 2019-05-07 01:58:03]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-04-24 02:13:11'
    - '2019-05-07 01:58:03'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'ELEFSIS' AND h_end.name = 'LAVRIO';
  params:
  - ELEFSIS
  - LAVRIO
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-07-03 09:19:11, 2019-07-10 22:26:16]' AND h.name = 'SIRI';
  params:
  - SIRI
  - - '2019-07-03 09:19:11'
    - '2019-07-10 22:26:16'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-05-01 05:42:57, 2019-05-10 23:55:04]' AND h.name = 'RAFINA';
  params:
  - RAFINA
  - - '2019-05-01 05:42:57'
    - '2019-05-10 23:55:04'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Agios Ioannis' GROUP BY i.name;
  params:
  - Agios Ioannis
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Agios Thomas' GROUP BY i.name;
  params:
  - Agios Thomas
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-03-21 03:05:47, 2019-03-27 13:27:33]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-03-21 03:05:47'
    - '2019-03-27 13:27:33'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-07-17 21:28:13, 2019-07-29 13:38:27]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-07-17 21:28:13'
    - '2019-07-29 13:38:27'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'CORINTH CANAL' AND h_end.name = 'LAVRIO';
  params:
  - CORINTH CANAL
  - LAVRIO
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-08-01 10:18:43, 2019-08-08 02:46:19]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-08-01 10:18:43'
    - '2019-08-08 02:46:19'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 1 AND DATE(startTimestamp(c.traj)) = DATE '2019-02-22';
  params:
  - '2019-02-22'
  - 1
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-03-29 01:04:19, 2019-04-11 17:31:12]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-03-29 01:04:19'
    - '2019-04-11 17:31:12'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-09-27 00:35:06, 2019-10-09 07:40:03]' AND h.name = 'GLYFADA';
  params:
  - GLYFADA
  - - '2019-09-27 00:35:06'
    - '2019-10-09 07:40:03'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-02-12 16:30:25, 2019-02-26 01:52:26]' FROM crossings c WHERE c.traj && tstzspan '[2019-02-12 16:30:25, 2019-02-26 01:52:26]';
  params:
  - - '2019-02-12 16:30:25'
    - '2019-02-26 01:52:26'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Phleva Island' GROUP BY i.name;
  params:
  - Phleva Island
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-12-20 23:08:38, 2019-12-30 18:35:10]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-12-20 23:08:38'
    - '2019-12-30 18:35:10'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 19 AND DATE(startTimestamp(c.traj)) = DATE '2019-03-30';
  params:
  - '2019-03-30'
  - 19
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'RAFINA' AND h_end.name = 'AEGINA';
  params:
  - RAFINA
  - AEGINA
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-06-22 18:45:46, 2019-07-02 08:00:01]' FROM crossings c WHERE c.traj && tstzspan '[2019-06-22 18:45:46, 2019-07-02 08:00:01]';
  params:
  - - '2019-06-22 18:45:46'
    - '2019-07-02 08:00:01'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-01-10 22:04:51, 2019-01-13 19:00:55]' FROM crossings c WHERE c.traj && tstzspan '[2019-01-10 22:04:51, 2019-01-13 19:00:55]';
  params:
  - - '2019-01-10 22:04:51'
    - '2019-01-13 19:00:55'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-10-25 20:14:51, 2019-10-31 01:32:48]' AND h.name = 'SOUSAKI';
  params:
  - SOUSAKI
  - - '2019-10-25 20:14:51'
    - '2019-10-31 01:32:48'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-03-10 13:23:51, 2019-03-20 04:35:09]' FROM crossings c WHERE c.traj && tstzspan '[2019-03-10 13:23:51, 2019-03-20 04:35:09]';
  params:
  - - '2019-03-10 13:23:51'
    - '2019-03-20 04:35:09'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 17 AND DATE(startTimestamp(c.traj)) = DATE '2019-10-14';
  params:
  - '2019-10-14'
  - 17
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-05-15 19:59:39, 2019-05-21 15:22:47]' FROM crossings c WHERE c.traj && tstzspan '[2019-05-15 19:59:39, 2019-05-21 15:22:47]';
  params:
  - - '2019-05-15 19:59:39'
    - '2019-05-21 15:22:47'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 1 AND DATE(startTimestamp(c.traj)) = DATE '2019-02-08';
  params:
  - '2019-02-08'
  - 1
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'FLISVOS' AND h_end.name = 'ERMIONI';
  params:
  - FLISVOS
  - ERMIONI
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-10-29 06:16:10, 2019-11-09 03:13:02]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-10-29 06:16:10'
    - '2019-11-09 03:13:02'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-11-25 06:52:44, 2019-12-09 17:54:04]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-11-25 06:52:44'
    - '2019-12-09 17:54:04'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-08-02 12:39:21, 2019-08-04 23:00:00]' AND h.name = 'PERAMA';
  params:
  - PERAMA
  - - '2019-08-02 12:39:21'
    - '2019-08-04 23:00:00'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'AGIOI THEODORI' AND h_end.name = 'AGIOI THEODORI';
  params:
  - AGIOI THEODORI
  - AGIOI THEODORI
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-09-28 10:56:16, 2019-10-13 09:11:42]' AND h.name = 'PERAMA';
  params:
  - PERAMA
  - - '2019-09-28 10:56:16'
    - '2019-10-13 09:11:42'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Agistri' GROUP BY i.name;
  params:
  - Agistri
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-01-01 12:53:01, 2019-01-13 22:04:44]' FROM crossings c WHERE c.traj && tstzspan '[2019-01-01 12:53:01, 2019-01-13 22:04:44]';
  params:
  - - '2019-01-01 12:53:01'
    - '2019-01-13 22:04:44'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Nisis Stakhtorroyi' GROUP BY i.name;
  params:
  - Nisis Stakhtorroyi
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 22 AND DATE(startTimestamp(c.traj)) = DATE '2019-08-20';
  params:
  - '2019-08-20'
  - 22
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-04-15 22:08:29, 2019-04-24 08:53:24]' FROM crossings c WHERE c.traj && tstzspan '[2019-04-15 22:08:29, 2019-04-24 08:53:24]';
  params:
  - - '2019-04-15 22:08:29'
    - '2019-04-24 08:53:24'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-08-02 04:06:45, 2019-08-08 13:38:24]' AND h.name = 'CORINTH CANAL';
  params:
  - CORINTH CANAL
  - - '2019-08-02 04:06:45'
    - '2019-08-08 13:38:24'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'ALIMOS' AND h_end.name = 'PIRAEUS';
  params:
  - ALIMOS
  - PIRAEUS
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Aponissos' GROUP BY i.name;
  params:
  - Aponissos
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Nisis Metopi' GROUP BY i.name;
  params:
  - Nisis Metopi
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Salamina' GROUP BY i.name;
  params:
  - Salamina
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'LAVRIO' AND h_end.name = 'CORINTH';
  params:
  - LAVRIO
  - CORINTH
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 17 AND DATE(startTimestamp(c.traj)) = DATE '2019-09-25';
  params:
  - '2019-09-25'
  - 17
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-05-05 16:53:26, 2019-05-20 03:48:04]' AND h.name = 'ERMIONI';
  params:
  - ERMIONI
  - - '2019-05-05 16:53:26'
    - '2019-05-20 03:48:04'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Vrachonisis Tragonisi' GROUP BY i.name;
  params:
  - Vrachonisis Tragonisi
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'SIRI' AND h_end.name = 'FANEROMENI';
  params:
  - SIRI
  - FANEROMENI
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-03-01 12:38:47, 2019-03-15 16:25:54]' FROM crossings c WHERE c.traj && tstzspan '[2019-03-01 12:38:47, 2019-03-15 16:25:54]';
  params:
  - - '2019-03-01 12:38:47'
    - '2019-03-15 16:25:54'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 22 AND DATE(startTimestamp(c.traj)) = DATE '2019-09-22';
  params:
  - '2019-09-22'
  - 22
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Aegina' GROUP BY i.name;
  params:
  - Aegina
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Salamina' GROUP BY i.name;
  params:
  - Salamina
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-06-21 14:02:42, 2019-06-24 08:45:20]' FROM crossings c WHERE c.traj && tstzspan '[2019-06-21 14:02:42, 2019-06-24 08:45:20]';
  params:
  - - '2019-06-21 14:02:42'
    - '2019-06-24 08:45:20'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'RAFINA' AND h_end.name = 'AGIOI THEODORI';
  params:
  - RAFINA
  - AGIOI THEODORI
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 18 AND DATE(startTimestamp(c.traj)) = DATE '2019-03-06';
  params:
  - '2019-03-06'
  - 18
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Kanakia' GROUP BY i.name;
  params:
  - Kanakia
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'PIRAEUS' AND h_end.name = 'FLISVOS';
  params:
  - PIRAEUS
  - FLISVOS
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-01-24 15:58:54, 2019-01-30 09:44:29]' AND h.name = 'GLYFADA';
  params:
  - GLYFADA
  - - '2019-01-24 15:58:54'
    - '2019-01-30 09:44:29'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 21 AND DATE(startTimestamp(c.traj)) = DATE '2019-05-02';
  params:
  - '2019-05-02'
  - 21
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-12-03 05:37:44, 2019-12-08 12:09:20]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-12-03 05:37:44'
    - '2019-12-08 12:09:20'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-11-08 21:52:57, 2019-11-19 18:59:05]' FROM crossings c WHERE c.traj && tstzspan '[2019-11-08 21:52:57, 2019-11-19 18:59:05]';
  params:
  - - '2019-11-08 21:52:57'
    - '2019-11-19 18:59:05'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Prasou' GROUP BY i.name;
  params:
  - Prasou
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-05-11 01:42:35, 2019-05-18 15:14:35]' FROM crossings c WHERE c.traj && tstzspan '[2019-05-11 01:42:35, 2019-05-18 15:14:35]';
  params:
  - - '2019-05-11 01:42:35'
    - '2019-05-18 15:14:35'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-07-10 04:50:48, 2019-07-21 16:05:47]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-07-10 04:50:48'
    - '2019-07-21 16:05:47'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-01-12 09:25:51, 2019-01-22 16:12:22]' FROM crossings c WHERE c.traj && tstzspan '[2019-01-12 09:25:51, 2019-01-22 16:12:22]';
  params:
  - - '2019-01-12 09:25:51'
    - '2019-01-22 16:12:22'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 3 AND DATE(startTimestamp(c.traj)) = DATE '2019-02-11';
  params:
  - '2019-02-11'
  - 3
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'ASPROPYRGOS' AND h_end.name = 'LAVRIO';
  params:
  - ASPROPYRGOS
  - LAVRIO
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-01-24 01:01:20, 2019-02-01 12:49:19]' FROM crossings c WHERE c.traj && tstzspan '[2019-01-24 01:01:20, 2019-02-01 12:49:19]';
  params:
  - - '2019-01-24 01:01:20'
    - '2019-02-01 12:49:19'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 2 AND DATE(startTimestamp(c.traj)) = DATE '2019-04-17';
  params:
  - '2019-04-17'
  - 2
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 7 AND DATE(startTimestamp(c.traj)) = DATE '2019-06-05';
  params:
  - '2019-06-05'
  - 7
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Vrachonisis Tragonisi' GROUP BY i.name;
  params:
  - Vrachonisis Tragonisi
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-12-04 16:33:00, 2019-12-18 00:30:38]' AND h.name = 'GLYFADA';
  params:
  - GLYFADA
  - - '2019-12-04 16:33:00'
    - '2019-12-18 00:30:38'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 12 AND DATE(startTimestamp(c.traj)) = DATE '2019-08-03';
  params:
  - '2019-08-03'
  - 12
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-12-02 16:19:06, 2019-12-17 05:40:00]' AND h.name = 'AGIOI THEODORI';
  params:
  - AGIOI THEODORI
  - - '2019-12-02 16:19:06'
    - '2019-12-17 05:40:00'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-05-23 17:42:03, 2019-06-02 09:46:26]' FROM crossings c WHERE c.traj && tstzspan '[2019-05-23 17:42:03, 2019-06-02 09:46:26]';
  params:
  - - '2019-05-23 17:42:03'
    - '2019-06-02 09:46:26'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-06-04 04:26:35, 2019-06-10 06:58:45]' FROM crossings c WHERE c.traj && tstzspan '[2019-06-04 04:26:35, 2019-06-10 06:58:45]';
  params:
  - - '2019-06-04 04:26:35'
    - '2019-06-10 06:58:45'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 4 AND DATE(startTimestamp(c.traj)) = DATE '2019-01-03';
  params:
  - '2019-01-03'
  - 4
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-06-11 08:34:33, 2019-06-19 06:30:26]' FROM crossings c WHERE c.traj && tstzspan '[2019-06-11 08:34:33, 2019-06-19 06:30:26]';
  params:
  - - '2019-06-11 08:34:33'
    - '2019-06-19 06:30:26'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Aponissos' GROUP BY i.name;
  params:
  - Aponissos
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-12-22 01:39:29, 2019-12-27 22:14:31]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-12-22 01:39:29'
    - '2019-12-27 22:14:31'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-12-21 17:56:16, 2019-12-27 22:21:16]' FROM crossings c WHERE c.traj && tstzspan '[2019-12-21 17:56:16, 2019-12-27 22:21:16]';
  params:
  - - '2019-12-21 17:56:16'
    - '2019-12-27 22:21:16'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Ydrousa' GROUP BY i.name;
  params:
  - Ydrousa
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 13 AND DATE(startTimestamp(c.traj)) = DATE '2019-06-19';
  params:
  - '2019-06-19'
  - 13
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'SIRI' AND h_end.name = 'ERMIONI';
  params:
  - SIRI
  - ERMIONI
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 16 AND DATE(startTimestamp(c.traj)) = DATE '2019-05-04';
  params:
  - '2019-05-04'
  - 16
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 8 AND DATE(startTimestamp(c.traj)) = DATE '2019-06-16';
  params:
  - '2019-06-16'
  - 8
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-08-22 05:37:06, 2019-08-27 22:53:20]' FROM crossings c WHERE c.traj && tstzspan '[2019-08-22 05:37:06, 2019-08-27 22:53:20]';
  params:
  - - '2019-08-22 05:37:06'
    - '2019-08-27 22:53:20'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 1 AND DATE(startTimestamp(c.traj)) = DATE '2019-03-24';
  params:
  - '2019-03-24'
  - 1
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-11-06 12:46:29, 2019-11-17 05:47:17]' FROM crossings c WHERE c.traj && tstzspan '[2019-11-06 12:46:29, 2019-11-17 05:47:17]';
  params:
  - - '2019-11-06 12:46:29'
    - '2019-11-17 05:47:17'
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'AEGINA' AND h_end.name = 'FALIRO';
  params:
  - AEGINA
  - FALIRO
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-09-22 14:12:21, 2019-10-03 05:01:58]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-09-22 14:12:21'
    - '2019-10-03 05:01:58'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 18 AND DATE(startTimestamp(c.traj)) = DATE '2019-06-05';
  params:
  - '2019-06-05'
  - 18
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 1 AND DATE(startTimestamp(c.traj)) = DATE '2019-09-01';
  params:
  - '2019-09-01'
  - 1
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'SOUSAKI' AND h_end.name = 'PERAMA';
  params:
  - SOUSAKI
  - PERAMA
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'FANEROMENI' AND h_end.name = 'FANEROMENI';
  params:
  - FANEROMENI
  - FANEROMENI
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-10-23 17:30:52, 2019-10-26 17:50:21]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-10-23 17:30:52'
    - '2019-10-26 17:50:21'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Nisida Kyra' GROUP BY i.name;
  params:
  - Nisida Kyra
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-04-07 22:17:06, 2019-04-17 18:32:55]' AND h.name = 'ELEFSIS';
  params:
  - ELEFSIS
  - - '2019-04-07 22:17:06'
    - '2019-04-17 18:32:55'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 10 AND DATE(startTimestamp(c.traj)) = DATE '2019-07-02';
  params:
  - '2019-07-02'
  - 10
- name: crossingsConnectTwoGivenHarbours
  type: spatial
  sql: |
    SELECT c.crossing_id FROM crossings c JOIN harbours h_start ON ST_DWithin(startValue(c.traj), h_start.geom, 1000) JOIN harbours h_end ON ST_DWithin(endValue(c.traj), h_end.geom, 1000) WHERE h_start.name = 'AGISTRI' AND h_end.name = 'AEGINA';
  params:
  - AGISTRI
  - AEGINA
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-06-07 15:19:57, 2019-06-14 18:20:57]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-06-07 15:19:57'
    - '2019-06-14 18:20:57'
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-02-06 22:36:54, 2019-02-11 15:43:07]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-02-06 22:36:54'
    - '2019-02-11 15:43:07'
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-03-31 22:16:33, 2019-04-11 11:43:22]' AND h.name = 'ZEA';
  params:
  - ZEA
  - - '2019-03-31 22:16:33'
    - '2019-04-11 11:43:22'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-10-05 21:09:16, 2019-10-16 21:32:42]' FROM crossings c WHERE c.traj && tstzspan '[2019-10-05 21:09:16, 2019-10-16 21:32:42]';
  params:
  - - '2019-10-05 21:09:16'
    - '2019-10-16 21:32:42'
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Thorussa' GROUP BY i.name;
  params:
  - Thorussa
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 12 AND DATE(startTimestamp(c.traj)) = DATE '2019-09-26';
  params:
  - '2019-09-26'
  - 12
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Arsida' GROUP BY i.name;
  params:
  - Arsida
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 3 AND DATE(startTimestamp(c.traj)) = DATE '2019-09-16';
  params:
  - '2019-09-16'
  - 3
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 4 AND DATE(startTimestamp(c.traj)) = DATE '2019-03-11';
  params:
  - '2019-03-11'
  - 4
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-10-03 04:02:53, 2019-10-14 05:19:40]' AND h.name = 'ZEA';
  params:
  - ZEA
  - - '2019-10-03 04:02:53'
    - '2019-10-14 05:19:40'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 10 AND DATE(startTimestamp(c.traj)) = DATE '2019-04-17';
  params:
  - '2019-04-17'
  - 10
- name: countActiveCrossingsNearIsland
  type: spatial
  sql: |
    SELECT COUNT(*) FROM crossings c JOIN islands i ON ST_DWithin(trajectory(c.traj), i.geom, 5000)  WHERE i.name = 'Spalaphtronisi Islet' GROUP BY i.name;
  params:
  - Spalaphtronisi Islet
- name: mostFrequentHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT h.name, COUNT(*) as crossing_count FROM harbours h JOIN crossings c ON ST_DWithin(endValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-09-17 02:54:34, 2019-09-27 02:27:04]' GROUP BY h.name ORDER BY crossing_count DESC LIMIT 1;
  params:
  - - '2019-09-17 02:54:34'
    - '2019-09-27 02:27:04'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-05-08 11:44:34, 2019-05-12 13:50:33]' FROM crossings c WHERE c.traj && tstzspan '[2019-05-08 11:44:34, 2019-05-12 13:50:33]';
  params:
  - - '2019-05-08 11:44:34'
    - '2019-05-12 13:50:33'
- name: countActiveCrossingsInPeriod
  type: temporal
  sql: |
    SELECT COUNT(*), tstzspan '[2019-10-13 08:21:10, 2019-10-27 13:39:42]' FROM crossings c WHERE c.traj && tstzspan '[2019-10-13 08:21:10, 2019-10-27 13:39:42]';
  params:
  - - '2019-10-13 08:21:10'
    - '2019-10-27 13:39:42'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 15 AND DATE(startTimestamp(c.traj)) = DATE '2019-03-10';
  params:
  - '2019-03-10'
  - 15
- name: averageDurationCrossingStartAtHarbourInPeriod
  type: spatiotemporal
  sql: |
    SELECT AVG(duration(c.traj)) as avg_duration FROM crossings c JOIN harbours h ON ST_DWithin(startValue(c.traj), h.geom, 500) WHERE c.traj && tstzspan '[2019-09-01 17:32:21, 2019-09-12 05:36:31]' AND h.name = 'CORINTH CANAL';
  params:
  - CORINTH CANAL
  - - '2019-09-01 17:32:21'
    - '2019-09-12 05:36:31'
- name: crossingsStartedAtSpecificTimeOnDay
  type: temporal
  sql: |
    SELECT c.crossing_id FROM crossings c WHERE EXTRACT(HOUR FROM startTimestamp(c.traj)) = 16 AND DATE(startTimestamp(c.traj)) = DATE '2019-12-02';
  params:
  - '2019-12-02'
  - 16
