- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf';
  params:
  - Steglitz-Zehlendorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2009-11-26'::timestamp AND timestamp < ('2009-11-26'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2009-11-26'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2009-05-06 22:53:02', '2009-05-11 22:38:49'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2009-05-06 22:53:02'
    - '2009-05-11 22:38:49'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2016-04-30 06:46:32', '2016-05-03 01:06:39'];
  params:
  - - '2016-04-30 06:46:32'
    - '2016-05-03 01:06:39'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf';
  params:
  - Charlottenburg-Wilmersdorf
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Mitte';
  params:
  - Mitte
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2014-11-28 04:54:19', '2014-12-05 23:06:10'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2014-11-28 04:54:19'
    - '2014-12-05 23:06:10'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2005-06-12'::timestamp AND timestamp < ('2005-06-12'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2005-06-12'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2022-11-29'::timestamp AND timestamp < ('2022-11-29'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2022-11-29'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Neukölln' GROUP BY d.name;
  params:
  - Neukölln
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2022-07-31 21:29:50', '2022-08-12 09:15:26'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2022-07-31 21:29:50'
    - '2022-08-12 09:15:26'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Mitte' GROUP BY d.name;
  params:
  - Mitte
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg' GROUP BY d.name;
  params:
  - Friedrichshain-Kreuzberg
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2012-01-31'::timestamp AND timestamp < ('2012-01-31'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2012-01-31'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2022-07-22'::timestamp AND timestamp < ('2022-07-22'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2022-07-22'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2017-06-26 09:57:41', '2017-06-28 21:48:18']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Bard-College';
  params:
  - - '2017-06-26 09:57:41'
    - '2017-06-28 21:48:18'
  - Bard-College
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Pankow' GROUP BY d.name;
  params:
  - Pankow
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2008-03-04 13:16:22', '2008-03-16 15:36:12'];
  params:
  - - '2008-03-04 13:16:22'
    - '2008-03-16 15:36:12'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2007-02-26 14:27:12', '2007-03-11 00:08:59'];
  params:
  - - '2007-02-26 14:27:12'
    - '2007-03-11 00:08:59'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2004-03-30'::timestamp AND timestamp < ('2004-03-30'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2004-03-30'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Treptow-Köpenick';
  params:
  - Treptow-Köpenick
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Spandau';
  params:
  - Spandau
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2015-05-05 19:13:19', '2015-05-15 18:12:12'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2015-05-05 19:13:19'
    - '2015-05-15 18:12:12'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2018-02-11 21:15:29', '2018-02-17 14:52:47'];
  params:
  - - '2018-02-11 21:15:29'
    - '2018-02-17 14:52:47'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Reinickendorf';
  params:
  - Reinickendorf
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2009-06-23 19:13:19', '2009-07-07 22:50:25'];
  params:
  - - '2009-06-23 19:13:19'
    - '2009-07-07 22:50:25'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2017-04-21'::timestamp AND timestamp < ('2017-04-21'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2017-04-21'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2010-06-13 00:07:22', '2010-06-26 18:51:43']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2010-06-13 00:07:22'
    - '2010-06-26 18:51:43'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2007-08-23 14:30:28', '2007-09-06 21:48:09'];
  params:
  - - '2007-08-23 14:30:28'
    - '2007-09-06 21:48:09'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2021-11-30 11:36:00', '2021-12-04 21:18:47']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2021-11-30 11:36:00'
    - '2021-12-04 21:18:47'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2014-08-13'::timestamp AND timestamp < ('2014-08-13'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2014-08-13'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2009-01-16 09:34:10', '2009-01-30 12:17:41'];
  params:
  - - '2009-01-16 09:34:10'
    - '2009-01-30 12:17:41'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Neukölln';
  params:
  - Neukölln
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2022-10-06'::timestamp AND timestamp < ('2022-10-06'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2022-10-06'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg' GROUP BY d.name;
  params:
  - Friedrichshain-Kreuzberg
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg';
  params:
  - Tempelhof-Schöneberg
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2015-11-22'::timestamp AND timestamp < ('2015-11-22'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2015-11-22'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf';
  params:
  - Steglitz-Zehlendorf
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf';
  params:
  - Marzahn-Hellersdorf
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2018-07-29 04:44:55', '2018-08-12 13:12:58']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - - '2018-07-29 04:44:55'
    - '2018-08-12 13:12:58'
  - European-School-of-Management-and-Technology-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2015-04-02 18:49:46', '2015-04-12 16:46:24'];
  params:
  - - '2015-04-02 18:49:46'
    - '2015-04-12 16:46:24'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2017-10-29 09:06:50', '2017-11-10 11:25:42'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2017-10-29 09:06:50'
    - '2017-11-10 11:25:42'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg';
  params:
  - Friedrichshain-Kreuzberg
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2012-03-29'::timestamp AND timestamp < ('2012-03-29'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2012-03-29'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Neukölln' GROUP BY d.name;
  params:
  - Neukölln
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2019-10-23 03:12:09', '2019-11-05 20:34:24']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - - '2019-10-23 03:12:09'
    - '2019-11-05 20:34:24'
  - Charité-Campus-Klinik
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2021-02-02 23:35:52', '2021-02-11 12:24:12']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2021-02-02 23:35:52'
    - '2021-02-11 12:24:12'
  - Technische-Universität-Berlin
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2006-06-02'::timestamp AND timestamp < ('2006-06-02'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2006-06-02'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Pankow' GROUP BY d.name;
  params:
  - Pankow
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2010-03-25'::timestamp AND timestamp < ('2010-03-25'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2010-03-25'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2013-06-26'::timestamp AND timestamp < ('2013-06-26'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2013-06-26'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2016-10-18 04:53:08', '2016-10-29 16:32:54'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2016-10-18 04:53:08'
    - '2016-10-29 16:32:54'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2010-08-26'::timestamp AND timestamp < ('2010-08-26'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2010-08-26'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2021-07-13'::timestamp AND timestamp < ('2021-07-13'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2021-07-13'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2015-08-14 19:39:04', '2015-08-17 11:50:47']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Bard-College';
  params:
  - - '2015-08-14 19:39:04'
    - '2015-08-17 11:50:47'
  - Bard-College
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2008-01-04 06:01:55', '2008-01-13 16:26:49'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2008-01-04 06:01:55'
    - '2008-01-13 16:26:49'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2022-02-02'::timestamp AND timestamp < ('2022-02-02'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2022-02-02'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Pankow';
  params:
  - Pankow
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-05-30 13:42:29', '2023-06-03 04:30:54'];
  params:
  - - '2023-05-30 13:42:29'
    - '2023-06-03 04:30:54'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2013-07-22'::timestamp AND timestamp < ('2013-07-22'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2013-07-22'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2011-06-02 09:37:49', '2011-06-10 07:27:13'];
  params:
  - - '2011-06-02 09:37:49'
    - '2011-06-10 07:27:13'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg';
  params:
  - Tempelhof-Schöneberg
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Treptow-Köpenick';
  params:
  - Treptow-Köpenick
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2020-08-14 15:48:14', '2020-08-25 21:31:04']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2020-08-14 15:48:14'
    - '2020-08-25 21:31:04'
  - Humboldt-Universität-zu-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2009-09-02 23:08:28', '2009-09-10 01:35:12'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2009-09-02 23:08:28'
    - '2009-09-10 01:35:12'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2013-09-19 22:10:16', '2013-10-01 22:58:36'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2013-09-19 22:10:16'
    - '2013-10-01 22:58:36'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2017-08-25 06:32:50', '2017-08-31 05:35:53'];
  params:
  - - '2017-08-25 06:32:50'
    - '2017-08-31 05:35:53'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2021-04-04'::timestamp AND timestamp < ('2021-04-04'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2021-04-04'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2014-09-11 19:27:55', '2014-09-19 21:05:20'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2014-09-11 19:27:55'
    - '2014-09-19 21:05:20'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2017-11-02 11:03:53', '2017-11-17 02:40:56']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2017-11-02 11:03:53'
    - '2017-11-17 02:40:56'
  - Universität-der-Künste-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Mitte';
  params:
  - Mitte
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2015-12-06'::timestamp AND timestamp < ('2015-12-06'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2015-12-06'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf' GROUP BY d.name;
  params:
  - Marzahn-Hellersdorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2006-03-13'::timestamp AND timestamp < ('2006-03-13'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2006-03-13'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2009-03-31'::timestamp AND timestamp < ('2009-03-31'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2009-03-31'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Spandau' GROUP BY d.name;
  params:
  - Spandau
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2012-10-24 10:34:09', '2012-11-02 15:13:41'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2012-10-24 10:34:09'
    - '2012-11-02 15:13:41'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2022-01-05 03:15:38', '2022-01-14 14:59:23'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2022-01-05 03:15:38'
    - '2022-01-14 14:59:23'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2019-02-19 18:33:03', '2019-03-03 02:57:16'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2019-02-19 18:33:03'
    - '2019-03-03 02:57:16'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2008-05-11 15:35:46', '2008-05-17 15:36:40']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2008-05-11 15:35:46'
    - '2008-05-17 15:36:40'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Pankow' GROUP BY d.name;
  params:
  - Pankow
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Lichtenberg' GROUP BY d.name;
  params:
  - Lichtenberg
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2020-03-06'::timestamp AND timestamp < ('2020-03-06'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2020-03-06'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Treptow-Köpenick';
  params:
  - Treptow-Köpenick
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Neukölln';
  params:
  - Neukölln
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Lichtenberg';
  params:
  - Lichtenberg
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2006-11-22'::timestamp AND timestamp < ('2006-11-22'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2006-11-22'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg' GROUP BY d.name;
  params:
  - Friedrichshain-Kreuzberg
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2019-06-20 05:28:26', '2019-06-23 15:53:51'];
  params:
  - - '2019-06-20 05:28:26'
    - '2019-06-23 15:53:51'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf';
  params:
  - Steglitz-Zehlendorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2017-09-12'::timestamp AND timestamp < ('2017-09-12'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2017-09-12'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2022-06-21 17:40:50', '2022-06-28 15:30:41'];
  params:
  - - '2022-06-21 17:40:50'
    - '2022-06-28 15:30:41'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Pankow';
  params:
  - Pankow
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2012-02-14 08:30:24', '2012-02-20 10:28:58'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2012-02-14 08:30:24'
    - '2012-02-20 10:28:58'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Pankow';
  params:
  - Pankow
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2013-05-22 20:59:47', '2013-06-03 04:11:19']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2013-05-22 20:59:47'
    - '2013-06-03 04:11:19'
  - Technische-Universität-Berlin
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2021-12-24'::timestamp AND timestamp < ('2021-12-24'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2021-12-24'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2024-02-11 05:10:12', '2024-02-18 22:54:37'];
  params:
  - - '2024-02-11 05:10:12'
    - '2024-02-18 22:54:37'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Treptow-Köpenick' GROUP BY d.name;
  params:
  - Treptow-Köpenick
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2009-01-18 09:09:26', '2009-01-22 03:45:16'];
  params:
  - - '2009-01-18 09:09:26'
    - '2009-01-22 03:45:16'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2004-08-18 14:20:06', '2004-08-25 09:33:09'];
  params:
  - - '2004-08-18 14:20:06'
    - '2004-08-25 09:33:09'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-12-13 08:42:16', '2024-12-19 19:53:09']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Bard-College';
  params:
  - - '2024-12-13 08:42:16'
    - '2024-12-19 19:53:09'
  - Bard-College
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Pankow' GROUP BY d.name;
  params:
  - Pankow
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2021-04-04 14:44:11', '2021-04-06 17:26:35'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2021-04-04 14:44:11'
    - '2021-04-06 17:26:35'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2019-07-28 09:52:32', '2019-08-08 14:12:36']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2019-07-28 09:52:32'
    - '2019-08-08 14:12:36'
  - Humboldt-Universität-zu-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg';
  params:
  - Tempelhof-Schöneberg
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2024-07-22'::timestamp AND timestamp < ('2024-07-22'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-07-22'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Spandau' GROUP BY d.name;
  params:
  - Spandau
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2009-01-02 19:37:35', '2009-01-12 22:07:08']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2009-01-02 19:37:35'
    - '2009-01-12 22:07:08'
  - Freie-Universität-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf';
  params:
  - Marzahn-Hellersdorf
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2009-12-29 07:33:31', '2010-01-08 06:09:16'];
  params:
  - - '2009-12-29 07:33:31'
    - '2010-01-08 06:09:16'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2008-11-23'::timestamp AND timestamp < ('2008-11-23'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2008-11-23'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2017-06-23 21:04:42', '2017-07-07 00:42:11']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2017-06-23 21:04:42'
    - '2017-07-07 00:42:11'
  - Freie-Universität-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2004-05-22 15:06:52', '2004-05-29 07:27:50'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2004-05-22 15:06:52'
    - '2004-05-29 07:27:50'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2016-09-14 15:28:29', '2016-09-26 19:59:52']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2016-09-14 15:28:29'
    - '2016-09-26 19:59:52'
  - Freie-Universität-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Reinickendorf' GROUP BY d.name;
  params:
  - Reinickendorf
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Neukölln';
  params:
  - Neukölln
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2010-11-13 17:44:31', '2010-11-27 13:45:12'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2010-11-13 17:44:31'
    - '2010-11-27 13:45:12'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2016-11-11 17:42:30', '2016-11-26 13:24:03'];
  params:
  - - '2016-11-11 17:42:30'
    - '2016-11-26 13:24:03'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2015-11-09'::timestamp AND timestamp < ('2015-11-09'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2015-11-09'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2006-06-03 17:06:22', '2006-06-07 06:43:42'];
  params:
  - - '2006-06-03 17:06:22'
    - '2006-06-07 06:43:42'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg';
  params:
  - Friedrichshain-Kreuzberg
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Lichtenberg';
  params:
  - Lichtenberg
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2011-01-08 06:35:58', '2011-01-21 02:04:32']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - - '2011-01-08 06:35:58'
    - '2011-01-21 02:04:32'
  - European-School-of-Management-and-Technology-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2021-08-16 04:28:30', '2021-08-21 16:36:33'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2021-08-16 04:28:30'
    - '2021-08-21 16:36:33'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Spandau';
  params:
  - Spandau
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-07-14 05:22:34', '2023-07-23 13:41:41'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-07-14 05:22:34'
    - '2023-07-23 13:41:41'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Pankow' GROUP BY d.name;
  params:
  - Pankow
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2005-08-09 03:56:37', '2005-08-23 03:33:29'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2005-08-09 03:56:37'
    - '2005-08-23 03:33:29'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2014-06-25 04:45:12', '2014-07-08 22:03:55'];
  params:
  - - '2014-06-25 04:45:12'
    - '2014-07-08 22:03:55'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2005-09-14 08:51:01', '2005-09-23 17:19:52'];
  params:
  - - '2005-09-14 08:51:01'
    - '2005-09-23 17:19:52'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2012-09-07 12:51:53', '2012-09-12 07:10:13'];
  params:
  - - '2012-09-07 12:51:53'
    - '2012-09-12 07:10:13'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2004-07-20 23:48:19', '2004-07-28 01:09:37']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2004-07-20 23:48:19'
    - '2004-07-28 01:09:37'
  - Universität-der-Künste-Berlin
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-09-10 07:28:37', '2024-09-15 22:39:36']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2024-09-10 07:28:37'
    - '2024-09-15 22:39:36'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2020-02-05 13:21:32', '2020-02-19 01:55:54'];
  params:
  - - '2020-02-05 13:21:32'
    - '2020-02-19 01:55:54'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-05-02'::timestamp AND timestamp < ('2023-05-02'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-05-02'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2008-02-07 20:16:58', '2008-02-14 08:07:26'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2008-02-07 20:16:58'
    - '2008-02-14 08:07:26'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2018-10-18 14:34:16', '2018-11-01 14:16:24'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2018-10-18 14:34:16'
    - '2018-11-01 14:16:24'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2021-08-31 22:26:58', '2021-09-04 12:07:20']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2021-08-31 22:26:58'
    - '2021-09-04 12:07:20'
  - Technische-Universität-Berlin
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2016-03-22'::timestamp AND timestamp < ('2016-03-22'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2016-03-22'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2009-04-06 12:18:45', '2009-04-18 04:10:58'];
  params:
  - - '2009-04-06 12:18:45'
    - '2009-04-18 04:10:58'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-07-06 02:52:02', '2024-07-09 05:25:28']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2024-07-06 02:52:02'
    - '2024-07-09 05:25:28'
  - Humboldt-Universität-zu-Berlin
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2007-01-25'::timestamp AND timestamp < ('2007-01-25'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2007-01-25'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2022-05-28 10:42:10', '2022-06-04 23:49:59'];
  params:
  - - '2022-05-28 10:42:10'
    - '2022-06-04 23:49:59'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2009-02-27 11:14:00', '2009-03-01 18:23:07'];
  params:
  - - '2009-02-27 11:14:00'
    - '2009-03-01 18:23:07'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf';
  params:
  - Marzahn-Hellersdorf
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2020-07-23 11:19:29', '2020-07-26 09:37:03'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2020-07-23 11:19:29'
    - '2020-07-26 09:37:03'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2013-05-25 17:37:00', '2013-05-31 20:52:00'];
  params:
  - - '2013-05-25 17:37:00'
    - '2013-05-31 20:52:00'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-03-20 15:09:14', '2023-04-01 03:18:59'];
  params:
  - - '2023-03-20 15:09:14'
    - '2023-04-01 03:18:59'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2007-03-01 03:44:57', '2007-03-09 03:54:11'];
  params:
  - - '2007-03-01 03:44:57'
    - '2007-03-09 03:54:11'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2017-11-12 21:01:07', '2017-11-25 14:28:41'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2017-11-12 21:01:07'
    - '2017-11-25 14:28:41'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Mitte';
  params:
  - Mitte
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-05-09 15:32:37', '2023-05-18 21:06:33'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-05-09 15:32:37'
    - '2023-05-18 21:06:33'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf';
  params:
  - Marzahn-Hellersdorf
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2007-02-02 02:26:06', '2007-02-07 00:53:48']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2007-02-02 02:26:06'
    - '2007-02-07 00:53:48'
  - Universität-der-Künste-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2022-12-27 03:39:26', '2023-01-04 00:02:57'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2022-12-27 03:39:26'
    - '2023-01-04 00:02:57'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2022-08-03 00:52:13', '2022-08-14 22:27:11']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2022-08-03 00:52:13'
    - '2022-08-14 22:27:11'
  - Technische-Universität-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2005-05-21 00:01:44', '2005-05-26 01:55:16'];
  params:
  - - '2005-05-21 00:01:44'
    - '2005-05-26 01:55:16'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2005-01-29'::timestamp AND timestamp < ('2005-01-29'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2005-01-29'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Treptow-Köpenick';
  params:
  - Treptow-Köpenick
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2011-11-04'::timestamp AND timestamp < ('2011-11-04'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2011-11-04'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg' GROUP BY d.name;
  params:
  - Friedrichshain-Kreuzberg
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-03-26 08:16:35', '2023-03-31 04:00:07'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-03-26 08:16:35'
    - '2023-03-31 04:00:07'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Reinickendorf' GROUP BY d.name;
  params:
  - Reinickendorf
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Neukölln';
  params:
  - Neukölln
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Spandau' GROUP BY d.name;
  params:
  - Spandau
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2013-07-09 16:47:18', '2013-07-13 08:29:49']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2013-07-09 16:47:18'
    - '2013-07-13 08:29:49'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2014-08-06 06:41:09', '2014-08-20 01:23:23'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2014-08-06 06:41:09'
    - '2014-08-20 01:23:23'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2017-05-11 04:56:41', '2017-05-25 10:32:20'];
  params:
  - - '2017-05-11 04:56:41'
    - '2017-05-25 10:32:20'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2010-12-30 23:31:33', '2011-01-07 06:18:31']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2010-12-30 23:31:33'
    - '2011-01-07 06:18:31'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Lichtenberg';
  params:
  - Lichtenberg
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf';
  params:
  - Steglitz-Zehlendorf
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2005-05-13 13:58:10', '2005-05-23 01:17:29']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Bard-College';
  params:
  - - '2005-05-13 13:58:10'
    - '2005-05-23 01:17:29'
  - Bard-College
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2010-05-05 11:26:29', '2010-05-15 05:28:12'];
  params:
  - - '2010-05-05 11:26:29'
    - '2010-05-15 05:28:12'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Mitte' GROUP BY d.name;
  params:
  - Mitte
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-11-07'::timestamp AND timestamp < ('2023-11-07'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-11-07'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2021-06-06'::timestamp AND timestamp < ('2021-06-06'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2021-06-06'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Pankow' GROUP BY d.name;
  params:
  - Pankow
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2022-07-29 07:24:18', '2022-08-11 16:00:49']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2022-07-29 07:24:18'
    - '2022-08-11 16:00:49'
  - Technische-Universität-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2014-12-17 00:54:25', '2014-12-31 15:49:34'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2014-12-17 00:54:25'
    - '2014-12-31 15:49:34'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2018-05-18 18:36:38', '2018-05-26 01:38:33'];
  params:
  - - '2018-05-18 18:36:38'
    - '2018-05-26 01:38:33'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2006-05-18'::timestamp AND timestamp < ('2006-05-18'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2006-05-18'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Reinickendorf' GROUP BY d.name;
  params:
  - Reinickendorf
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2007-12-12 09:28:30', '2007-12-17 00:18:05']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2007-12-12 09:28:30'
    - '2007-12-17 00:18:05'
  - Freie-Universität-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2024-04-01 22:48:15', '2024-04-07 16:48:46'];
  params:
  - - '2024-04-01 22:48:15'
    - '2024-04-07 16:48:46'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2018-03-01'::timestamp AND timestamp < ('2018-03-01'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2018-03-01'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2020-01-08 18:39:57', '2020-01-19 04:14:26']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2020-01-08 18:39:57'
    - '2020-01-19 04:14:26'
  - Freie-Universität-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Spandau';
  params:
  - Spandau
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg' GROUP BY d.name;
  params:
  - Tempelhof-Schöneberg
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2006-06-20'::timestamp AND timestamp < ('2006-06-20'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2006-06-20'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Treptow-Köpenick' GROUP BY d.name;
  params:
  - Treptow-Köpenick
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2005-09-02 20:32:12', '2005-09-09 22:14:52'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2005-09-02 20:32:12'
    - '2005-09-09 22:14:52'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2024-11-23 11:57:36', '2024-11-25 20:08:27'];
  params:
  - - '2024-11-23 11:57:36'
    - '2024-11-25 20:08:27'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2008-05-15 17:20:36', '2008-05-28 14:43:43'];
  params:
  - - '2008-05-15 17:20:36'
    - '2008-05-28 14:43:43'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf';
  params:
  - Steglitz-Zehlendorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2020-12-02'::timestamp AND timestamp < ('2020-12-02'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2020-12-02'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Treptow-Köpenick' GROUP BY d.name;
  params:
  - Treptow-Köpenick
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2020-03-07 10:37:53', '2020-03-11 04:57:58'];
  params:
  - - '2020-03-07 10:37:53'
    - '2020-03-11 04:57:58'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Lichtenberg' GROUP BY d.name;
  params:
  - Lichtenberg
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2008-03-28 22:56:10', '2008-04-03 02:45:01']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - - '2008-03-28 22:56:10'
    - '2008-04-03 02:45:01'
  - Charité-Campus-Klinik
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2022-04-16'::timestamp AND timestamp < ('2022-04-16'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2022-04-16'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2007-08-22 15:01:06', '2007-09-03 08:49:23']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2007-08-22 15:01:06'
    - '2007-09-03 08:49:23'
  - Technische-Universität-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Spandau';
  params:
  - Spandau
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Pankow' GROUP BY d.name;
  params:
  - Pankow
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2011-10-11'::timestamp AND timestamp < ('2011-10-11'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2011-10-11'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg';
  params:
  - Friedrichshain-Kreuzberg
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf';
  params:
  - Steglitz-Zehlendorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2011-05-31'::timestamp AND timestamp < ('2011-05-31'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2011-05-31'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2018-07-04'::timestamp AND timestamp < ('2018-07-04'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2018-07-04'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Reinickendorf' GROUP BY d.name;
  params:
  - Reinickendorf
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Reinickendorf';
  params:
  - Reinickendorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2024-07-28'::timestamp AND timestamp < ('2024-07-28'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-07-28'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2020-04-05 10:21:47', '2020-04-19 13:23:28'];
  params:
  - - '2020-04-05 10:21:47'
    - '2020-04-19 13:23:28'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2015-12-08'::timestamp AND timestamp < ('2015-12-08'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2015-12-08'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2016-11-07 19:57:52', '2016-11-17 19:58:10']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2016-11-07 19:57:52'
    - '2016-11-17 19:58:10'
  - Technische-Universität-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg';
  params:
  - Tempelhof-Schöneberg
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2013-04-19 13:08:18', '2013-05-01 17:24:58'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2013-04-19 13:08:18'
    - '2013-05-01 17:24:58'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2010-02-22'::timestamp AND timestamp < ('2010-02-22'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2010-02-22'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2014-08-01 18:48:07', '2014-08-07 19:25:39']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2014-08-01 18:48:07'
    - '2014-08-07 19:25:39'
  - Humboldt-Universität-zu-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2021-03-30 10:42:41', '2021-04-10 04:37:14'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2021-03-30 10:42:41'
    - '2021-04-10 04:37:14'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Lichtenberg' GROUP BY d.name;
  params:
  - Lichtenberg
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Pankow';
  params:
  - Pankow
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Neukölln' GROUP BY d.name;
  params:
  - Neukölln
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2006-08-24'::timestamp AND timestamp < ('2006-08-24'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2006-08-24'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2008-07-10 04:27:00', '2008-07-23 00:47:11'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2008-07-10 04:27:00'
    - '2008-07-23 00:47:11'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf';
  params:
  - Marzahn-Hellersdorf
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Lichtenberg' GROUP BY d.name;
  params:
  - Lichtenberg
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2018-11-06'::timestamp AND timestamp < ('2018-11-06'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2018-11-06'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2011-08-03 09:00:06', '2011-08-06 05:22:48'];
  params:
  - - '2011-08-03 09:00:06'
    - '2011-08-06 05:22:48'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2014-12-12 08:54:40', '2014-12-21 00:51:32'];
  params:
  - - '2014-12-12 08:54:40'
    - '2014-12-21 00:51:32'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg' GROUP BY d.name;
  params:
  - Tempelhof-Schöneberg
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2016-07-12 03:52:37', '2016-07-19 12:41:15']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2016-07-12 03:52:37'
    - '2016-07-19 12:41:15'
  - Universität-der-Künste-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2021-01-30 22:33:56', '2021-02-05 00:25:00'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2021-01-30 22:33:56'
    - '2021-02-05 00:25:00'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf';
  params:
  - Charlottenburg-Wilmersdorf
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2014-07-18 06:59:05', '2014-07-31 16:17:44'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2014-07-18 06:59:05'
    - '2014-07-31 16:17:44'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Lichtenberg' GROUP BY d.name;
  params:
  - Lichtenberg
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2008-10-11 01:58:24', '2008-10-22 15:38:46'];
  params:
  - - '2008-10-11 01:58:24'
    - '2008-10-22 15:38:46'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2004-11-12'::timestamp AND timestamp < ('2004-11-12'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2004-11-12'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2010-11-12 23:06:16', '2010-11-15 19:53:04'];
  params:
  - - '2010-11-12 23:06:16'
    - '2010-11-15 19:53:04'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2011-10-25 11:48:03', '2011-11-01 07:41:46'];
  params:
  - - '2011-10-25 11:48:03'
    - '2011-11-01 07:41:46'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2004-11-25 18:27:21', '2004-12-04 18:42:53'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2004-11-25 18:27:21'
    - '2004-12-04 18:42:53'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2007-09-04 03:04:46', '2007-09-17 17:29:06'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2007-09-04 03:04:46'
    - '2007-09-17 17:29:06'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2014-04-16'::timestamp AND timestamp < ('2014-04-16'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2014-04-16'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2024-05-21'::timestamp AND timestamp < ('2024-05-21'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-05-21'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2009-04-22'::timestamp AND timestamp < ('2009-04-22'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2009-04-22'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2022-05-03'::timestamp AND timestamp < ('2022-05-03'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2022-05-03'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Treptow-Köpenick';
  params:
  - Treptow-Köpenick
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2010-05-29 12:36:09', '2010-06-08 19:04:16'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2010-05-29 12:36:09'
    - '2010-06-08 19:04:16'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2022-01-15 05:47:55', '2022-01-21 17:18:06'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2022-01-15 05:47:55'
    - '2022-01-21 17:18:06'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Treptow-Köpenick';
  params:
  - Treptow-Köpenick
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2019-06-29 12:41:49', '2019-07-02 22:59:28'];
  params:
  - - '2019-06-29 12:41:49'
    - '2019-07-02 22:59:28'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2009-09-27 06:03:40', '2009-10-03 14:08:07'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2009-09-27 06:03:40'
    - '2009-10-03 14:08:07'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2021-03-23 07:21:32', '2021-03-26 18:12:11']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2021-03-23 07:21:32'
    - '2021-03-26 18:12:11'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2004-06-27 03:42:20', '2004-07-09 10:42:53'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2004-06-27 03:42:20'
    - '2004-07-09 10:42:53'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2014-03-03 17:31:31', '2014-03-12 20:16:28']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2014-03-03 17:31:31'
    - '2014-03-12 20:16:28'
  - Freie-Universität-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Reinickendorf';
  params:
  - Reinickendorf
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2024-11-20 09:40:14', '2024-11-24 21:26:15'];
  params:
  - - '2024-11-20 09:40:14'
    - '2024-11-24 21:26:15'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2006-05-22 20:37:19', '2006-06-01 19:07:15']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2006-05-22 20:37:19'
    - '2006-06-01 19:07:15'
  - Freie-Universität-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg' GROUP BY d.name;
  params:
  - Tempelhof-Schöneberg
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2010-12-15'::timestamp AND timestamp < ('2010-12-15'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2010-12-15'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2016-05-20 13:15:14', '2016-06-01 22:34:29'];
  params:
  - - '2016-05-20 13:15:14'
    - '2016-06-01 22:34:29'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2014-03-28 09:44:56', '2014-04-03 19:40:05'];
  params:
  - - '2014-03-28 09:44:56'
    - '2014-04-03 19:40:05'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Neukölln';
  params:
  - Neukölln
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2017-05-05 09:35:37', '2017-05-15 18:26:52']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2017-05-05 09:35:37'
    - '2017-05-15 18:26:52'
  - Freie-Universität-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2021-10-20 13:22:35', '2021-10-28 10:13:29'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2021-10-20 13:22:35'
    - '2021-10-28 10:13:29'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2004-10-29 14:33:19', '2004-11-06 04:01:13'];
  params:
  - - '2004-10-29 14:33:19'
    - '2004-11-06 04:01:13'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2022-04-10 01:26:46', '2022-04-12 03:55:10'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2022-04-10 01:26:46'
    - '2022-04-12 03:55:10'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2004-06-12 17:41:08', '2004-06-26 20:12:24'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2004-06-12 17:41:08'
    - '2004-06-26 20:12:24'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2011-02-10 18:26:00', '2011-02-25 13:58:26'];
  params:
  - - '2011-02-10 18:26:00'
    - '2011-02-25 13:58:26'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-02-23 14:14:09', '2024-03-05 17:42:51']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2024-02-23 14:14:09'
    - '2024-03-05 17:42:51'
  - Universität-der-Künste-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Neukölln';
  params:
  - Neukölln
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2015-10-19 03:40:09', '2015-10-26 15:51:00'];
  params:
  - - '2015-10-19 03:40:09'
    - '2015-10-26 15:51:00'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Pankow' GROUP BY d.name;
  params:
  - Pankow
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2016-12-03 20:01:26', '2016-12-08 04:11:04'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2016-12-03 20:01:26'
    - '2016-12-08 04:11:04'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2018-03-08 19:36:44', '2018-03-21 15:43:08'];
  params:
  - - '2018-03-08 19:36:44'
    - '2018-03-21 15:43:08'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf';
  params:
  - Charlottenburg-Wilmersdorf
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Pankow';
  params:
  - Pankow
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Reinickendorf';
  params:
  - Reinickendorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2021-05-02'::timestamp AND timestamp < ('2021-05-02'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2021-05-02'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Spandau' GROUP BY d.name;
  params:
  - Spandau
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Mitte';
  params:
  - Mitte
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Reinickendorf';
  params:
  - Reinickendorf
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Mitte';
  params:
  - Mitte
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2009-08-16 07:13:14', '2009-08-24 03:51:09']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - - '2009-08-16 07:13:14'
    - '2009-08-24 03:51:09'
  - Charité-Campus-Klinik
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg' GROUP BY d.name;
  params:
  - Friedrichshain-Kreuzberg
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2019-08-13'::timestamp AND timestamp < ('2019-08-13'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2019-08-13'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2019-06-14'::timestamp AND timestamp < ('2019-06-14'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2019-06-14'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2020-06-06 17:07:36', '2020-06-20 05:49:29'];
  params:
  - - '2020-06-06 17:07:36'
    - '2020-06-20 05:49:29'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Lichtenberg';
  params:
  - Lichtenberg
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2024-03-19'::timestamp AND timestamp < ('2024-03-19'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-03-19'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Mitte' GROUP BY d.name;
  params:
  - Mitte
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2009-06-28 18:20:11', '2009-07-09 22:59:07'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2009-06-28 18:20:11'
    - '2009-07-09 22:59:07'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2009-10-17 01:15:20', '2009-10-21 21:28:58']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2009-10-17 01:15:20'
    - '2009-10-21 21:28:58'
  - Humboldt-Universität-zu-Berlin
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2007-10-06'::timestamp AND timestamp < ('2007-10-06'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2007-10-06'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Reinickendorf';
  params:
  - Reinickendorf
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2010-11-06 03:29:45', '2010-11-12 02:15:53'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2010-11-06 03:29:45'
    - '2010-11-12 02:15:53'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Reinickendorf' GROUP BY d.name;
  params:
  - Reinickendorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2011-09-06'::timestamp AND timestamp < ('2011-09-06'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2011-09-06'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2015-10-15 01:40:09', '2015-10-21 07:48:50']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2015-10-15 01:40:09'
    - '2015-10-21 07:48:50'
  - Universität-der-Künste-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Mitte' GROUP BY d.name;
  params:
  - Mitte
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-12-01 10:45:58', '2023-12-14 04:25:31'];
  params:
  - - '2023-12-01 10:45:58'
    - '2023-12-14 04:25:31'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf';
  params:
  - Marzahn-Hellersdorf
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2009-08-11 02:43:58', '2009-08-24 22:14:58'];
  params:
  - - '2009-08-11 02:43:58'
    - '2009-08-24 22:14:58'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2022-07-19 19:29:34', '2022-07-30 00:48:12'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2022-07-19 19:29:34'
    - '2022-07-30 00:48:12'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Pankow';
  params:
  - Pankow
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Neukölln' GROUP BY d.name;
  params:
  - Neukölln
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2021-12-13 21:58:54', '2021-12-24 21:41:34'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2021-12-13 21:58:54'
    - '2021-12-24 21:41:34'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2010-10-08 17:12:26', '2010-10-15 11:15:31'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2010-10-08 17:12:26'
    - '2010-10-15 11:15:31'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2015-09-14'::timestamp AND timestamp < ('2015-09-14'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2015-09-14'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2014-08-02 02:25:54', '2014-08-10 08:21:05'];
  params:
  - - '2014-08-02 02:25:54'
    - '2014-08-10 08:21:05'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Treptow-Köpenick' GROUP BY d.name;
  params:
  - Treptow-Köpenick
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2021-08-02 05:17:11', '2021-08-15 21:32:26'];
  params:
  - - '2021-08-02 05:17:11'
    - '2021-08-15 21:32:26'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2005-06-08'::timestamp AND timestamp < ('2005-06-08'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2005-06-08'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2017-06-22 23:22:25', '2017-06-26 14:33:55'];
  params:
  - - '2017-06-22 23:22:25'
    - '2017-06-26 14:33:55'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2013-08-06 09:54:36', '2013-08-08 14:34:53'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2013-08-06 09:54:36'
    - '2013-08-08 14:34:53'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg' GROUP BY d.name;
  params:
  - Friedrichshain-Kreuzberg
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2016-03-30 23:53:18', '2016-04-04 13:18:58'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2016-03-30 23:53:18'
    - '2016-04-04 13:18:58'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2013-04-14 18:02:21', '2013-04-23 00:14:33'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2013-04-14 18:02:21'
    - '2013-04-23 00:14:33'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg';
  params:
  - Friedrichshain-Kreuzberg
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2016-03-16'::timestamp AND timestamp < ('2016-03-16'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2016-03-16'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2009-07-11'::timestamp AND timestamp < ('2009-07-11'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2009-07-11'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2015-09-03 17:40:55', '2015-09-10 02:04:15'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2015-09-03 17:40:55'
    - '2015-09-10 02:04:15'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2021-09-21'::timestamp AND timestamp < ('2021-09-21'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2021-09-21'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Mitte';
  params:
  - Mitte
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2017-04-15'::timestamp AND timestamp < ('2017-04-15'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2017-04-15'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2021-07-12 15:18:46', '2021-07-16 06:21:33'];
  params:
  - - '2021-07-12 15:18:46'
    - '2021-07-16 06:21:33'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2005-01-09 15:04:10', '2005-01-14 04:17:20']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - - '2005-01-09 15:04:10'
    - '2005-01-14 04:17:20'
  - Charité-Campus-Klinik
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2008-07-09 17:50:53', '2008-07-17 20:52:18'];
  params:
  - - '2008-07-09 17:50:53'
    - '2008-07-17 20:52:18'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2016-11-10'::timestamp AND timestamp < ('2016-11-10'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2016-11-10'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Spandau' GROUP BY d.name;
  params:
  - Spandau
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2020-09-06 08:30:02', '2020-09-18 01:36:03'];
  params:
  - - '2020-09-06 08:30:02'
    - '2020-09-18 01:36:03'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2019-01-01 21:45:07', '2019-01-15 06:45:16'];
  params:
  - - '2019-01-01 21:45:07'
    - '2019-01-15 06:45:16'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2012-11-07 11:29:13', '2012-11-11 20:25:35']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - - '2012-11-07 11:29:13'
    - '2012-11-11 20:25:35'
  - Charité-Campus-Klinik
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2008-09-26 02:16:23', '2008-10-04 17:56:10'];
  params:
  - - '2008-09-26 02:16:23'
    - '2008-10-04 17:56:10'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2016-09-09'::timestamp AND timestamp < ('2016-09-09'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2016-09-09'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2006-10-02 15:14:53', '2006-10-09 10:48:30'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2006-10-02 15:14:53'
    - '2006-10-09 10:48:30'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2021-11-10 10:17:02', '2021-11-22 02:35:35']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Bard-College';
  params:
  - - '2021-11-10 10:17:02'
    - '2021-11-22 02:35:35'
  - Bard-College
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2022-11-23 03:05:24', '2022-12-05 21:40:25']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2022-11-23 03:05:24'
    - '2022-12-05 21:40:25'
  - Humboldt-Universität-zu-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Lichtenberg';
  params:
  - Lichtenberg
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2020-01-09 01:22:47', '2020-01-18 15:36:27'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2020-01-09 01:22:47'
    - '2020-01-18 15:36:27'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2005-07-02'::timestamp AND timestamp < ('2005-07-02'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2005-07-02'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Lichtenberg' GROUP BY d.name;
  params:
  - Lichtenberg
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2017-02-25 06:11:43', '2017-03-08 19:49:13'];
  params:
  - - '2017-02-25 06:11:43'
    - '2017-03-08 19:49:13'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2005-09-11 19:21:30', '2005-09-18 17:10:23']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - - '2005-09-11 19:21:30'
    - '2005-09-18 17:10:23'
  - Charité-Campus-Klinik
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2016-07-04 19:18:30', '2016-07-08 22:13:01']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2016-07-04 19:18:30'
    - '2016-07-08 22:13:01'
  - Technische-Universität-Berlin
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2008-02-26'::timestamp AND timestamp < ('2008-02-26'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2008-02-26'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2006-04-28 22:47:22', '2006-05-05 05:22:34'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2006-04-28 22:47:22'
    - '2006-05-05 05:22:34'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf';
  params:
  - Marzahn-Hellersdorf
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2019-11-25 01:50:28', '2019-11-27 11:51:54']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Bard-College';
  params:
  - - '2019-11-25 01:50:28'
    - '2019-11-27 11:51:54'
  - Bard-College
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Lichtenberg';
  params:
  - Lichtenberg
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Reinickendorf';
  params:
  - Reinickendorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2007-09-14'::timestamp AND timestamp < ('2007-09-14'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2007-09-14'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2005-12-12'::timestamp AND timestamp < ('2005-12-12'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2005-12-12'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Treptow-Köpenick' GROUP BY d.name;
  params:
  - Treptow-Köpenick
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2009-12-05 02:54:41', '2009-12-20 02:12:51'];
  params:
  - - '2009-12-05 02:54:41'
    - '2009-12-20 02:12:51'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2007-06-26'::timestamp AND timestamp < ('2007-06-26'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2007-06-26'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2014-07-17'::timestamp AND timestamp < ('2014-07-17'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2014-07-17'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2021-10-20 10:26:36', '2021-10-25 02:32:41'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2021-10-20 10:26:36'
    - '2021-10-25 02:32:41'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2011-05-05 09:23:28', '2011-05-10 02:34:54']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Bard-College';
  params:
  - - '2011-05-05 09:23:28'
    - '2011-05-10 02:34:54'
  - Bard-College
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf';
  params:
  - Marzahn-Hellersdorf
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2023-06-24'::timestamp AND timestamp < ('2023-06-24'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2023-06-24'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Neukölln';
  params:
  - Neukölln
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2016-10-21 04:20:55', '2016-10-26 05:40:52'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2016-10-21 04:20:55'
    - '2016-10-26 05:40:52'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2012-12-24'::timestamp AND timestamp < ('2012-12-24'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2012-12-24'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2013-11-01'::timestamp AND timestamp < ('2013-11-01'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2013-11-01'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf';
  params:
  - Charlottenburg-Wilmersdorf
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Neukölln';
  params:
  - Neukölln
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg';
  params:
  - Tempelhof-Schöneberg
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2016-10-01 22:59:46', '2016-10-06 13:05:14']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - - '2016-10-01 22:59:46'
    - '2016-10-06 13:05:14'
  - Charité-Campus-Klinik
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2011-07-23'::timestamp AND timestamp < ('2011-07-23'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2011-07-23'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf';
  params:
  - Steglitz-Zehlendorf
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2019-04-28 12:15:04', '2019-05-13 00:36:24']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2019-04-28 12:15:04'
    - '2019-05-13 00:36:24'
  - Universität-der-Künste-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2016-11-23 23:12:31', '2016-11-30 22:34:12'];
  params:
  - - '2016-11-23 23:12:31'
    - '2016-11-30 22:34:12'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2013-07-08 13:39:38', '2013-07-20 11:18:55'];
  params:
  - - '2013-07-08 13:39:38'
    - '2013-07-20 11:18:55'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2014-09-11 06:52:52', '2014-09-26 02:26:16'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2014-09-11 06:52:52'
    - '2014-09-26 02:26:16'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Treptow-Köpenick';
  params:
  - Treptow-Köpenick
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2013-08-05 21:49:46', '2013-08-18 19:58:01'];
  params:
  - - '2013-08-05 21:49:46'
    - '2013-08-18 19:58:01'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2013-04-21 15:06:12', '2013-05-06 06:23:23']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2013-04-21 15:06:12'
    - '2013-05-06 06:23:23'
  - Technische-Universität-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2005-08-10 07:35:58', '2005-08-16 22:52:48'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2005-08-10 07:35:58'
    - '2005-08-16 22:52:48'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Reinickendorf' GROUP BY d.name;
  params:
  - Reinickendorf
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2008-10-15 11:46:19', '2008-10-21 05:34:19'];
  params:
  - - '2008-10-15 11:46:19'
    - '2008-10-21 05:34:19'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2008-11-30 06:02:02', '2008-12-03 18:55:34'];
  params:
  - - '2008-11-30 06:02:02'
    - '2008-12-03 18:55:34'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2024-07-03 02:14:24', '2024-07-10 07:09:56'];
  params:
  - - '2024-07-03 02:14:24'
    - '2024-07-10 07:09:56'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2007-03-22 03:22:35', '2007-04-01 13:43:12']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2007-03-22 03:22:35'
    - '2007-04-01 13:43:12'
  - Technische-Universität-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg' GROUP BY d.name;
  params:
  - Friedrichshain-Kreuzberg
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2019-05-12 23:43:28', '2019-05-15 07:42:48']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2019-05-12 23:43:28'
    - '2019-05-15 07:42:48'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2012-10-25 20:17:11', '2012-10-29 07:54:09'];
  params:
  - - '2012-10-25 20:17:11'
    - '2012-10-29 07:54:09'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2014-11-29 06:44:35', '2014-12-10 08:54:45']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - - '2014-11-29 06:44:35'
    - '2014-12-10 08:54:45'
  - Charité-Campus-Klinik
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2017-02-18 03:19:08', '2017-02-25 15:41:11'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2017-02-18 03:19:08'
    - '2017-02-25 15:41:11'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2018-05-07 08:11:25', '2018-05-21 12:26:16'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2018-05-07 08:11:25'
    - '2018-05-21 12:26:16'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2005-09-24 04:17:42', '2005-10-06 11:21:14']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2005-09-24 04:17:42'
    - '2005-10-06 11:21:14'
  - Freie-Universität-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg';
  params:
  - Friedrichshain-Kreuzberg
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2016-03-24 03:25:42', '2016-04-02 06:41:14']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2016-03-24 03:25:42'
    - '2016-04-02 06:41:14'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2022-01-05 23:50:21', '2022-01-16 05:11:00'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2022-01-05 23:50:21'
    - '2022-01-16 05:11:00'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2012-10-08 15:36:39', '2012-10-22 09:36:45']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2012-10-08 15:36:39'
    - '2012-10-22 09:36:45'
  - Universität-der-Künste-Berlin
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2011-05-07'::timestamp AND timestamp < ('2011-05-07'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2011-05-07'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2013-02-09 03:50:46', '2013-02-24 03:04:04'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2013-02-09 03:50:46'
    - '2013-02-24 03:04:04'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Reinickendorf' GROUP BY d.name;
  params:
  - Reinickendorf
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2017-03-07 22:06:44', '2017-03-11 18:03:56']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Bard-College';
  params:
  - - '2017-03-07 22:06:44'
    - '2017-03-11 18:03:56'
  - Bard-College
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2005-08-01 02:27:30', '2005-08-10 02:24:07']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2005-08-01 02:27:30'
    - '2005-08-10 02:24:07'
  - Freie-Universität-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Lichtenberg';
  params:
  - Lichtenberg
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-10-21 19:22:43', '2023-11-02 15:35:59'];
  params:
  - - '2023-10-21 19:22:43'
    - '2023-11-02 15:35:59'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2007-07-21 15:29:46', '2007-07-28 03:39:52']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - - '2007-07-21 15:29:46'
    - '2007-07-28 03:39:52'
  - Charité-Campus-Klinik
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2008-05-23 06:12:42', '2008-05-28 06:29:13'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2008-05-23 06:12:42'
    - '2008-05-28 06:29:13'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2017-08-01 18:31:58', '2017-08-08 06:40:00']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2017-08-01 18:31:58'
    - '2017-08-08 06:40:00'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2004-03-20 08:19:16', '2004-03-27 04:41:34'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2004-03-20 08:19:16'
    - '2004-03-27 04:41:34'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2017-07-07 04:39:50', '2017-07-16 12:41:45'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2017-07-07 04:39:50'
    - '2017-07-16 12:41:45'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2018-06-12 01:00:41', '2018-06-21 21:06:10'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2018-06-12 01:00:41'
    - '2018-06-21 21:06:10'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2024-10-04 16:04:17', '2024-10-08 16:37:52'];
  params:
  - - '2024-10-04 16:04:17'
    - '2024-10-08 16:37:52'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Neukölln' GROUP BY d.name;
  params:
  - Neukölln
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2018-12-05 22:32:12', '2018-12-13 23:35:35'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2018-12-05 22:32:12'
    - '2018-12-13 23:35:35'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2022-10-15 11:50:58', '2022-10-21 15:34:35']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2022-10-15 11:50:58'
    - '2022-10-21 15:34:35'
  - Humboldt-Universität-zu-Berlin
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2022-08-18 02:09:53', '2022-08-20 16:45:18']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2022-08-18 02:09:53'
    - '2022-08-20 16:45:18'
  - Humboldt-Universität-zu-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2004-09-11 22:49:19', '2004-09-26 20:59:03'];
  params:
  - - '2004-09-11 22:49:19'
    - '2004-09-26 20:59:03'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2013-07-02 01:18:05', '2013-07-12 21:40:39'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2013-07-02 01:18:05'
    - '2013-07-12 21:40:39'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Treptow-Köpenick' GROUP BY d.name;
  params:
  - Treptow-Köpenick
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2011-11-29 20:59:22', '2011-12-02 02:12:50'];
  params:
  - - '2011-11-29 20:59:22'
    - '2011-12-02 02:12:50'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2019-09-20'::timestamp AND timestamp < ('2019-09-20'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2019-09-20'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Treptow-Köpenick';
  params:
  - Treptow-Köpenick
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg' GROUP BY d.name;
  params:
  - Tempelhof-Schöneberg
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Mitte';
  params:
  - Mitte
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2010-01-06 06:48:13', '2010-01-20 07:33:02']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2010-01-06 06:48:13'
    - '2010-01-20 07:33:02'
  - Technische-Universität-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Pankow' GROUP BY d.name;
  params:
  - Pankow
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2018-12-31 05:40:39', '2019-01-07 11:29:56']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2018-12-31 05:40:39'
    - '2019-01-07 11:29:56'
  - Technische-Universität-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Mitte';
  params:
  - Mitte
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2017-03-05 23:04:42', '2017-03-17 04:21:19']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2017-03-05 23:04:42'
    - '2017-03-17 04:21:19'
  - Universität-der-Künste-Berlin
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-02-20 14:22:47', '2023-02-28 21:14:45']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Bard-College';
  params:
  - - '2023-02-20 14:22:47'
    - '2023-02-28 21:14:45'
  - Bard-College
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2024-11-26'::timestamp AND timestamp < ('2024-11-26'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-11-26'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Pankow' GROUP BY d.name;
  params:
  - Pankow
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2006-02-11 03:35:03', '2006-02-18 07:20:46'];
  params:
  - - '2006-02-11 03:35:03'
    - '2006-02-18 07:20:46'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf';
  params:
  - Marzahn-Hellersdorf
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2006-03-28 09:16:03', '2006-04-03 20:49:09']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2006-03-28 09:16:03'
    - '2006-04-03 20:49:09'
  - Technische-Universität-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg';
  params:
  - Friedrichshain-Kreuzberg
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2005-05-11 01:43:14', '2005-05-14 16:06:05'];
  params:
  - - '2005-05-11 01:43:14'
    - '2005-05-14 16:06:05'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2004-02-18 14:28:56', '2004-02-20 16:32:53'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2004-02-18 14:28:56'
    - '2004-02-20 16:32:53'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2007-11-02 09:55:12', '2007-11-09 22:45:17']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2007-11-02 09:55:12'
    - '2007-11-09 22:45:17'
  - Humboldt-Universität-zu-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2017-05-19 17:25:58', '2017-05-30 00:06:56'];
  params:
  - - '2017-05-19 17:25:58'
    - '2017-05-30 00:06:56'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Mitte' GROUP BY d.name;
  params:
  - Mitte
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2009-08-10 17:26:39', '2009-08-17 09:50:37'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2009-08-10 17:26:39'
    - '2009-08-17 09:50:37'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-07-08 23:10:57', '2024-07-16 17:55:43']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - - '2024-07-08 23:10:57'
    - '2024-07-16 17:55:43'
  - European-School-of-Management-and-Technology-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2021-08-02 18:38:33', '2021-08-14 03:37:50'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2021-08-02 18:38:33'
    - '2021-08-14 03:37:50'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2005-12-06 05:39:10', '2005-12-13 00:19:29'];
  params:
  - - '2005-12-06 05:39:10'
    - '2005-12-13 00:19:29'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2018-12-11 06:12:14', '2018-12-19 04:01:35'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2018-12-11 06:12:14'
    - '2018-12-19 04:01:35'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2016-07-28 10:43:42', '2016-08-08 13:25:34']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2016-07-28 10:43:42'
    - '2016-08-08 13:25:34'
  - Technische-Universität-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2021-07-27 08:59:37', '2021-08-03 20:45:42'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2021-07-27 08:59:37'
    - '2021-08-03 20:45:42'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Neukölln';
  params:
  - Neukölln
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2017-07-27 22:19:27', '2017-08-07 09:34:48'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2017-07-27 22:19:27'
    - '2017-08-07 09:34:48'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2022-02-12 02:21:51', '2022-02-20 17:38:36'];
  params:
  - - '2022-02-12 02:21:51'
    - '2022-02-20 17:38:36'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2013-02-20'::timestamp AND timestamp < ('2013-02-20'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2013-02-20'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2020-01-12 01:29:16', '2020-01-20 09:01:18']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2020-01-12 01:29:16'
    - '2020-01-20 09:01:18'
  - Freie-Universität-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2009-09-01 07:17:27', '2009-09-07 19:36:44'];
  params:
  - - '2009-09-01 07:17:27'
    - '2009-09-07 19:36:44'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2007-01-17 23:24:35', '2007-01-31 22:41:38']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2007-01-17 23:24:35'
    - '2007-01-31 22:41:38'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2021-06-08 00:34:59', '2021-06-15 16:04:31'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2021-06-08 00:34:59'
    - '2021-06-15 16:04:31'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2011-12-02 21:53:04', '2011-12-05 17:19:59'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2011-12-02 21:53:04'
    - '2011-12-05 17:19:59'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf' GROUP BY d.name;
  params:
  - Marzahn-Hellersdorf
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2020-12-16 13:48:45', '2020-12-24 22:35:41'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2020-12-16 13:48:45'
    - '2020-12-24 22:35:41'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2016-03-24 19:23:59', '2016-03-27 21:37:44'];
  params:
  - - '2016-03-24 19:23:59'
    - '2016-03-27 21:37:44'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2019-02-10 05:20:46', '2019-02-20 14:27:51']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2019-02-10 05:20:46'
    - '2019-02-20 14:27:51'
  - Universität-der-Künste-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2017-02-14 08:49:54', '2017-02-20 05:21:50'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2017-02-14 08:49:54'
    - '2017-02-20 05:21:50'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2006-02-26 10:11:08', '2006-03-12 09:31:24'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2006-02-26 10:11:08'
    - '2006-03-12 09:31:24'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Neukölln' GROUP BY d.name;
  params:
  - Neukölln
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Treptow-Köpenick' GROUP BY d.name;
  params:
  - Treptow-Köpenick
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2024-05-06'::timestamp AND timestamp < ('2024-05-06'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2024-05-06'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg' GROUP BY d.name;
  params:
  - Friedrichshain-Kreuzberg
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg';
  params:
  - Friedrichshain-Kreuzberg
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Reinickendorf' GROUP BY d.name;
  params:
  - Reinickendorf
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2009-07-20 15:51:47', '2009-07-23 03:08:48'];
  params:
  - - '2009-07-20 15:51:47'
    - '2009-07-23 03:08:48'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2006-10-25 22:10:37', '2006-11-01 15:30:57']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2006-10-25 22:10:37'
    - '2006-11-01 15:30:57'
  - Universität-der-Künste-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Reinickendorf';
  params:
  - Reinickendorf
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2016-10-25 03:29:01', '2016-11-05 18:16:10'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2016-10-25 03:29:01'
    - '2016-11-05 18:16:10'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2012-05-09 10:22:00', '2012-05-15 16:45:38']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2012-05-09 10:22:00'
    - '2012-05-15 16:45:38'
  - Technische-Universität-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2011-02-09 01:40:58', '2011-02-18 18:27:40'];
  params:
  - - '2011-02-09 01:40:58'
    - '2011-02-18 18:27:40'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Lichtenberg' GROUP BY d.name;
  params:
  - Lichtenberg
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2009-03-01 14:08:56', '2009-03-04 20:29:23']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2009-03-01 14:08:56'
    - '2009-03-04 20:29:23'
  - Freie-Universität-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Spandau' GROUP BY d.name;
  params:
  - Spandau
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Lichtenberg' GROUP BY d.name;
  params:
  - Lichtenberg
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Neukölln' GROUP BY d.name;
  params:
  - Neukölln
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf' GROUP BY d.name;
  params:
  - Steglitz-Zehlendorf
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2010-08-15 00:04:58', '2010-08-27 13:16:12'];
  params:
  - - '2010-08-15 00:04:58'
    - '2010-08-27 13:16:12'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Mitte';
  params:
  - Mitte
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2019-08-26 17:58:24', '2019-08-31 01:48:44'];
  params:
  - - '2019-08-26 17:58:24'
    - '2019-08-31 01:48:44'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2022-03-10 10:20:10', '2022-03-12 22:33:45']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2022-03-10 10:20:10'
    - '2022-03-12 22:33:45'
  - Universität-der-Künste-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2008-01-17 02:07:52', '2008-01-21 05:43:50'];
  params:
  - - '2008-01-17 02:07:52'
    - '2008-01-21 05:43:50'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2009-06-14 19:27:23', '2009-06-17 06:08:25']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2009-06-14 19:27:23'
    - '2009-06-17 06:08:25'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg' GROUP BY d.name;
  params:
  - Friedrichshain-Kreuzberg
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2013-11-14 18:23:24', '2013-11-28 10:17:18'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2013-11-14 18:23:24'
    - '2013-11-28 10:17:18'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Pankow' GROUP BY d.name;
  params:
  - Pankow
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Lichtenberg';
  params:
  - Lichtenberg
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2024-04-23 23:58:49', '2024-05-04 23:51:58']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2024-04-23 23:58:49'
    - '2024-05-04 23:51:58'
  - Humboldt-Universität-zu-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Reinickendorf';
  params:
  - Reinickendorf
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2018-04-13 11:07:51', '2018-04-20 22:57:33'];
  params:
  - - '2018-04-13 11:07:51'
    - '2018-04-20 22:57:33'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2011-05-01 13:18:39', '2011-05-11 21:32:59'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2011-05-01 13:18:39'
    - '2011-05-11 21:32:59'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2013-03-23'::timestamp AND timestamp < ('2013-03-23'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2013-03-23'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2020-10-10 21:24:42', '2020-10-15 19:57:12'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2020-10-10 21:24:42'
    - '2020-10-15 19:57:12'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2006-01-04 14:27:59', '2006-01-11 21:13:34'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2006-01-04 14:27:59'
    - '2006-01-11 21:13:34'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2015-07-08'::timestamp AND timestamp < ('2015-07-08'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2015-07-08'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Neukölln' GROUP BY d.name;
  params:
  - Neukölln
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Mitte';
  params:
  - Mitte
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf' GROUP BY d.name;
  params:
  - Steglitz-Zehlendorf
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf' GROUP BY d.name;
  params:
  - Steglitz-Zehlendorf
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2010-09-29 19:04:12', '2010-10-07 12:44:09'];
  params:
  - - '2010-09-29 19:04:12'
    - '2010-10-07 12:44:09'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2015-11-10 06:09:13', '2015-11-12 10:44:46'];
  params:
  - - '2015-11-10 06:09:13'
    - '2015-11-12 10:44:46'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Spandau' GROUP BY d.name;
  params:
  - Spandau
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Spandau' GROUP BY d.name;
  params:
  - Spandau
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Neukölln' GROUP BY d.name;
  params:
  - Neukölln
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2020-03-11 22:42:41', '2020-03-23 10:00:18']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Technische-Universität-Berlin';
  params:
  - - '2020-03-11 22:42:41'
    - '2020-03-23 10:00:18'
  - Technische-Universität-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2018-04-12 00:18:10', '2018-04-14 05:54:59'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2018-04-12 00:18:10'
    - '2018-04-14 05:54:59'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2021-11-03 15:31:01', '2021-11-11 06:07:55']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - - '2021-11-03 15:31:01'
    - '2021-11-11 06:07:55'
  - Charité-Campus-Klinik
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Neukölln';
  params:
  - Neukölln
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2009-10-22'::timestamp AND timestamp < ('2009-10-22'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2009-10-22'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2020-06-11 18:27:43', '2020-06-17 14:06:47']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - - '2020-06-11 18:27:43'
    - '2020-06-17 14:06:47'
  - Charité-Campus-Klinik
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2006-09-10'::timestamp AND timestamp < ('2006-09-10'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2006-09-10'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg';
  params:
  - Friedrichshain-Kreuzberg
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2014-09-14 17:45:22', '2014-09-22 23:00:30'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2014-09-14 17:45:22'
    - '2014-09-22 23:00:30'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Spandau';
  params:
  - Spandau
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2013-01-04'::timestamp AND timestamp < ('2013-01-04'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2013-01-04'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2004-03-17'::timestamp AND timestamp < ('2004-03-17'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2004-03-17'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2018-04-07 20:34:33', '2018-04-14 03:27:28'];
  params:
  - - '2018-04-07 20:34:33'
    - '2018-04-14 03:27:28'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2004-10-24 09:30:15', '2004-11-05 22:13:29']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2004-10-24 09:30:15'
    - '2004-11-05 22:13:29'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg';
  params:
  - Tempelhof-Schöneberg
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2010-09-15 13:29:31', '2010-09-21 12:29:30'];
  params:
  - - '2010-09-15 13:29:31'
    - '2010-09-21 12:29:30'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2007-11-08 16:04:19', '2007-11-18 16:40:43']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2007-11-08 16:04:19'
    - '2007-11-18 16:40:43'
  - Freie-Universität-Berlin
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2016-07-01'::timestamp AND timestamp < ('2016-07-01'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2016-07-01'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2006-09-30 23:16:33', '2006-10-09 16:28:09'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2006-09-30 23:16:33'
    - '2006-10-09 16:28:09'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2016-07-07 01:26:42', '2016-07-15 00:05:57']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2016-07-07 01:26:42'
    - '2016-07-15 00:05:57'
  - Universität-der-Künste-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-04-26 11:11:08', '2023-05-01 16:40:47'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-04-26 11:11:08'
    - '2023-05-01 16:40:47'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2009-08-28 02:08:43', '2009-09-01 19:16:59'];
  params:
  - - '2009-08-28 02:08:43'
    - '2009-09-01 19:16:59'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2013-08-27'::timestamp AND timestamp < ('2013-08-27'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2013-08-27'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2014-06-23 15:03:05', '2014-07-05 11:07:39'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2014-06-23 15:03:05'
    - '2014-07-05 11:07:39'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2004-04-19 06:44:40', '2004-04-25 21:37:52'];
  params:
  - - '2004-04-19 06:44:40'
    - '2004-04-25 21:37:52'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Lichtenberg' GROUP BY d.name;
  params:
  - Lichtenberg
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2010-07-06'::timestamp AND timestamp < ('2010-07-06'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2010-07-06'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2014-11-27 17:50:59', '2014-12-04 20:36:01']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - - '2014-11-27 17:50:59'
    - '2014-12-04 20:36:01'
  - European-School-of-Management-and-Technology-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Treptow-Köpenick' GROUP BY d.name;
  params:
  - Treptow-Köpenick
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Tempelhof-Schöneberg';
  params:
  - Tempelhof-Schöneberg
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Pankow';
  params:
  - Pankow
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2022-08-02 00:55:23', '2022-08-10 11:00:41']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2022-08-02 00:55:23'
    - '2022-08-10 11:00:41'
  - Freie-Universität-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2019-02-12 20:35:17', '2019-02-16 00:46:25'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2019-02-12 20:35:17'
    - '2019-02-16 00:46:25'
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Reinickendorf';
  params:
  - Reinickendorf
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2021-03-13 08:21:08', '2021-03-24 22:12:45']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - - '2021-03-13 08:21:08'
    - '2021-03-24 22:12:45'
  - Charité-Campus-Klinik
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Steglitz-Zehlendorf';
  params:
  - Steglitz-Zehlendorf
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2005-09-24 18:06:11', '2005-10-03 03:35:11'];
  params:
  - - '2005-09-24 18:06:11'
    - '2005-10-03 03:35:11'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Spandau' GROUP BY d.name;
  params:
  - Spandau
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2012-05-12 12:27:46', '2012-05-27 10:56:54']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Katholische-Hochschule-für-Sozialwesen-Berlin';
  params:
  - - '2012-05-12 12:27:46'
    - '2012-05-27 10:56:54'
  - Katholische-Hochschule-für-Sozialwesen-Berlin
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2021-11-24 00:58:52', '2021-11-26 05:07:35']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Freie-Universität-Berlin';
  params:
  - - '2021-11-24 00:58:52'
    - '2021-11-26 05:07:35'
  - Freie-Universität-Berlin
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2016-06-14 12:06:40', '2016-06-16 14:44:15'];
  params:
  - - '2016-06-14 12:06:40'
    - '2016-06-16 14:44:15'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2015-08-26'::timestamp AND timestamp < ('2015-08-26'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2015-08-26'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2008-02-01 23:03:20', '2008-02-12 02:06:33'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2008-02-01 23:03:20'
    - '2008-02-12 02:06:33'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2019-01-16 09:50:23', '2019-01-27 02:40:02'];
  params:
  - - '2019-01-16 09:50:23'
    - '2019-01-27 02:40:02'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-28 23:36:26', '2023-09-01 15:05:48']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2023-08-28 23:36:26'
    - '2023-09-01 15:05:48'
  - Universität-der-Künste-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Pankow' GROUP BY d.name;
  params:
  - Pankow
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Treptow-Köpenick';
  params:
  - Treptow-Köpenick
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2004-11-14 18:35:40', '2004-11-23 12:43:56']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Charité-Campus-Klinik';
  params:
  - - '2004-11-14 18:35:40'
    - '2004-11-23 12:43:56'
  - Charité-Campus-Klinik
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg';
  params:
  - Friedrichshain-Kreuzberg
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Mitte' GROUP BY d.name;
  params:
  - Mitte
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf' GROUP BY d.name;
  params:
  - Marzahn-Hellersdorf
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2014-03-10 08:37:36', '2014-03-13 18:12:08']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'European-School-of-Management-and-Technology-Berlin';
  params:
  - - '2014-03-10 08:37:36'
    - '2014-03-13 18:12:08'
  - European-School-of-Management-and-Technology-Berlin
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg' GROUP BY d.name;
  params:
  - Friedrichshain-Kreuzberg
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Mitte' GROUP BY d.name;
  params:
  - Mitte
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf';
  params:
  - Charlottenburg-Wilmersdorf
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2023-09-17 02:29:26', '2023-09-25 20:50:05'];
  params:
  - - '2023-09-17 02:29:26'
    - '2023-09-25 20:50:05'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2020-03-13'::timestamp AND timestamp < ('2020-03-13'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2020-03-13'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2005-05-16 16:04:27', '2005-05-27 15:35:55'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2005-05-16 16:04:27'
    - '2005-05-27 15:35:55'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2015-06-05'::timestamp AND timestamp < ('2015-06-05'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2015-06-05'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2015-06-22'::timestamp AND timestamp < ('2015-06-22'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2015-06-22'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-10 01:20:28', '2023-08-16 22:12:01']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2023-08-10 01:20:28'
    - '2023-08-16 22:12:01'
  - Universität-der-Künste-Berlin
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Mitte';
  params:
  - Mitte
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Treptow-Köpenick';
  params:
  - Treptow-Köpenick
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2007-02-05 11:42:11', '2007-02-17 10:06:47']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Universität-der-Künste-Berlin';
  params:
  - - '2007-02-05 11:42:11'
    - '2007-02-17 10:06:47'
  - Universität-der-Künste-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2009-02-07 21:05:07', '2009-02-16 05:40:51'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2009-02-07 21:05:07'
    - '2009-02-16 05:40:51'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-08-13 13:04:19', '2023-08-16 02:24:45']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Humboldt-Universität-zu-Berlin';
  params:
  - - '2023-08-13 13:04:19'
    - '2023-08-16 02:24:45'
  - Humboldt-Universität-zu-Berlin
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2018-08-17 20:25:12', '2018-08-29 20:25:23'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2018-08-17 20:25:12'
    - '2018-08-29 20:25:23'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2006-02-15'::timestamp AND timestamp < ('2006-02-15'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2006-02-15'
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2016-09-10'::timestamp AND timestamp < ('2016-09-10'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2016-09-10'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg' GROUP BY d.name;
  params:
  - Friedrichshain-Kreuzberg
- name: averageRideDurationDuringDay
  type: temporal
  sql: |
    SELECT AVG(max_ts - min_ts) AS avg_duration FROM (SELECT r.ride_id, MAX(timestamp) AS max_ts, MIN(timestamp) AS min_ts FROM ride_points r WHERE timestamp >= '2010-12-04'::timestamp AND timestamp < ('2010-12-04'::timestamp + INTERVAL '1 day') GROUP BY ride_id);
  params:
  - '2010-12-04'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2011-10-03 10:48:50', '2011-10-14 16:35:17'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2011-10-03 10:48:50'
    - '2011-10-14 16:35:17'
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2013-06-20 11:44:21', '2013-06-26 15:18:41'];
  params:
  - - '2013-06-20 11:44:21'
    - '2013-06-26 15:18:41'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2014-01-06 19:24:44', '2014-01-14 19:16:07'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2014-01-06 19:24:44'
    - '2014-01-14 19:16:07'
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Charlottenburg-Wilmersdorf' GROUP BY d.name;
  params:
  - Charlottenburg-Wilmersdorf
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Marzahn-Hellersdorf' GROUP BY d.name;
  params:
  - Marzahn-Hellersdorf
- name: ridesStartedInDistrict
  type: spatial
  sql: |
    WITH ride_start AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts FROM ride_points r GROUP BY ride_id), start_points AS ( SELECT r.ride_id, r.geom FROM ride_points r JOIN ride_start s ON r.ride_id = s.ride_id AND r.timestamp = s.start_ts) SELECT s.ride_id FROM start_points s JOIN berlin_districts d ON ST_Intersects(s.geom, d.geom) WHERE d.name = 'Friedrichshain-Kreuzberg';
  params:
  - Friedrichshain-Kreuzberg
- name: countActiveRidesInPeriod
  type: temporal
  sql: |
    SELECT COUNT(DISTINCT r.ride_id) FROM ride_points r WHERE r.timestamp BETWEEN ['2022-05-02 02:41:32', '2022-05-09 16:36:34'];
  params:
  - - '2022-05-02 02:41:32'
    - '2022-05-09 16:36:34'
- name: ridesCrossSeveralDistrictsOnEveningInPeriod
  type: spatiotemporal
  sql: |
    WITH evening_rides AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2023-07-13 22:29:28', '2023-07-27 06:40:04'] AND EXTRACT(HOUR FROM r.timestamp) BETWEEN 18 AND 23 ), ride_districts AS ( SELECT er.ride_id, d.name FROM evening_rides er JOIN ride_points r ON r.ride_id = er.ride_id JOIN berlin_districts d ON ST_Intersects(r.geom, d.geom) GROUP BY er.ride_id, d.name ) SELECT rd.ride_id FROM ride_districts rd GROUP BY rd.ride_id HAVING COUNT(*) > 1;
  params:
  - - '2023-07-13 22:29:28'
    - '2023-07-27 06:40:04'
- name: averageRideDurationToGoAtUniversityInPeriod
  type: spatiotemporal
  sql: |
    WITH rides_in_period AS ( SELECT DISTINCT r.ride_id FROM ride_points r WHERE r.timestamp BETWEEN ['2004-04-21 18:54:51', '2004-04-28 08:56:53']), ride_stats AS ( SELECT r.ride_id, MIN(r.timestamp) AS start_ts, MAX(r.timestamp) AS end_ts FROM ride_points r JOIN rides_in_period rp ON r.ride_id = rp.ride_id GROUP BY r.ride_id) SELECT AVG(rs.end_ts - rs.start_ts) AS avg_duration FROM ride_stats rs JOIN ride_points rend ON rend.ride_id = rs.ride_id AND rend.timestamp = rs.end_ts JOIN universities u ON ST_DWithin(rend.geom, u.geom, 2500) WHERE u.name = 'Bard-College';
  params:
  - - '2004-04-21 18:54:51'
    - '2004-04-28 08:56:53'
  - Bard-College
- name: countActiveRidesInDistrict
  type: spatial
  sql: |
    SELECT d.name, COUNT(DISTINCT r.ride_id) AS ride_count FROM berlin_districts d JOIN ride_points r ON ST_Intersects(r.geom, d.geom) WHERE d.name = 'Lichtenberg' GROUP BY d.name;
  params:
  - Lichtenberg
